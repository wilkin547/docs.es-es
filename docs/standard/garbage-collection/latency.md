---
title: Modos de latencia
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- garbage collection, intrusiveness
- garbage collection, latency modes
ms.assetid: 96278bb7-6eab-4612-8594-ceebfc887d81
ms.openlocfilehash: a8eaf0c80aa32978eead80c51a905cbcd66a537b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 03/15/2020
ms.locfileid: "74283593"
---
# <a name="latency-modes"></a><span data-ttu-id="a08e7-102">Modos de latencia</span><span class="sxs-lookup"><span data-stu-id="a08e7-102">Latency modes</span></span>

<span data-ttu-id="a08e7-103">Para reclamar objetos, el recolector de elementos no utilizados (GC) debe detener todos los subprocesos en ejecución en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="a08e7-103">To reclaim objects, the garbage collector (GC) must stop all the executing threads in an application.</span></span> <span data-ttu-id="a08e7-104">El período de tiempo durante el que está activo el recolector de elementos no utilizados se conoce como su *latencia*.</span><span class="sxs-lookup"><span data-stu-id="a08e7-104">The period of time during which the garbage collector is active is referred to as its *latency*.</span></span>

<span data-ttu-id="a08e7-105">En algunos casos, como cuando una aplicación recupera datos o muestra contenido, la recolección completa de elementos no utilizados puede producirse en un momento crítico y reducir el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="a08e7-105">In some situations, such as when an application retrieves data or displays content, a full garbage collection can occur at a critical time and impede performance.</span></span> <span data-ttu-id="a08e7-106">Puede ajustar la tendencia a la intrusión del recolector de elementos no utilizados estableciendo la propiedad <xref:System.Runtime.GCSettings.LatencyMode%2A?displayProperty=nameWithType> en uno de los valores de <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="a08e7-106">You can adjust the intrusiveness of the garbage collector by setting the <xref:System.Runtime.GCSettings.LatencyMode%2A?displayProperty=nameWithType> property to one of the <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType> values.</span></span>

## <a name="low-latency-settings"></a><span data-ttu-id="a08e7-107">Configuración de latencia baja</span><span class="sxs-lookup"><span data-stu-id="a08e7-107">Low latency settings</span></span>

<span data-ttu-id="a08e7-108">El uso de una configuración de latencia "baja" significa que el recolector de elementos no utilizados interfiere menos en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="a08e7-108">Using a "low" latency setting means the garbage collector intrudes less in your application.</span></span> <span data-ttu-id="a08e7-109">La recolección de elementos no utilizados es más conservadora sobre la recuperación de memoria.</span><span class="sxs-lookup"><span data-stu-id="a08e7-109">Garbage collection is more conservative about reclaiming memory.</span></span>

<span data-ttu-id="a08e7-110">La enumeración <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType> proporciona dos opciones de configuración de latencia baja:</span><span class="sxs-lookup"><span data-stu-id="a08e7-110">The <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType> enumeration provides two low latency settings:</span></span>

- <span data-ttu-id="a08e7-111">[GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) suprime las recolecciones de generación 2 y realiza solo las recolecciones de generación 0 y 1.</span><span class="sxs-lookup"><span data-stu-id="a08e7-111">[GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) suppresses generation 2 collections and performs only generation 0 and 1 collections.</span></span> <span data-ttu-id="a08e7-112">Se puede usar solo durante breves períodos de tiempo.</span><span class="sxs-lookup"><span data-stu-id="a08e7-112">It can be used only for short periods of time.</span></span> <span data-ttu-id="a08e7-113">En períodos más largos, si la memoria del sistema está bajo presión, el recolector de elementos no utilizados activará una colección que puede pausar brevemente la aplicación e interrumpir una operación crítica en el tiempo.</span><span class="sxs-lookup"><span data-stu-id="a08e7-113">Over longer periods, if the system is under memory pressure, the garbage collector will trigger a collection, which can briefly pause the application and disrupt a time-critical operation.</span></span> <span data-ttu-id="a08e7-114">Esta opción está disponible solo para la recopilación de elementos no utilizados de estación de trabajo.</span><span class="sxs-lookup"><span data-stu-id="a08e7-114">This setting is available only for workstation garbage collection.</span></span>

- <span data-ttu-id="a08e7-115">[GCLatencyMode.SustainedLowLatency](xref:System.Runtime.GCLatencyMode.SustainedLowLatency) suprime las recolecciones de generación 2 de primer plano y realiza solo las recolecciones de generación 0, 1 y las recolecciones de generación 2 de segundo plano.</span><span class="sxs-lookup"><span data-stu-id="a08e7-115">[GCLatencyMode.SustainedLowLatency](xref:System.Runtime.GCLatencyMode.SustainedLowLatency) suppresses foreground generation 2 collections and performs only generation 0, 1, and background generation 2 collections.</span></span> <span data-ttu-id="a08e7-116">Se puede usar durante periodos más largos de tiempo y está disponible para la recolección de elementos utilizados de estación de trabajo y de servidor.</span><span class="sxs-lookup"><span data-stu-id="a08e7-116">It can be used for longer periods of time, and is available for both workstation and server garbage collection.</span></span> <span data-ttu-id="a08e7-117">Esta opción de configuración no se puede usar si la recolección de elementos no utilizados en segundo plano está deshabilitada.</span><span class="sxs-lookup"><span data-stu-id="a08e7-117">This setting cannot be used if background garbage collection is disabled.</span></span>

<span data-ttu-id="a08e7-118">Durante los períodos de latencia baja, se suprimen las recolecciones de generación 2 a menos que ocurra lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="a08e7-118">During low latency periods, generation 2 collections are suppressed unless the following occurs:</span></span>

- <span data-ttu-id="a08e7-119">El sistema recibe una notificación de memoria insuficiente desde el sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="a08e7-119">The system receives a low memory notification from the operating system.</span></span>

- <span data-ttu-id="a08e7-120">El código de aplicación induce una recolección mediante una llamada al método <xref:System.GC.Collect%2A?displayProperty=nameWithType> y especifica 2 en el parámetro `generation`.</span><span class="sxs-lookup"><span data-stu-id="a08e7-120">Application code induces a collection by calling the <xref:System.GC.Collect%2A?displayProperty=nameWithType> method and specifying 2 for the `generation` parameter.</span></span>

## <a name="scenarios"></a><span data-ttu-id="a08e7-121">Escenarios</span><span class="sxs-lookup"><span data-stu-id="a08e7-121">Scenarios</span></span>

<span data-ttu-id="a08e7-122">En la tabla siguiente se enumeran los escenarios de aplicación en los que se usan los valores de <xref:System.Runtime.GCLatencyMode>:</span><span class="sxs-lookup"><span data-stu-id="a08e7-122">The following table lists the application scenarios for using the <xref:System.Runtime.GCLatencyMode> values:</span></span>

|<span data-ttu-id="a08e7-123">Modo de latencia</span><span class="sxs-lookup"><span data-stu-id="a08e7-123">Latency mode</span></span>|<span data-ttu-id="a08e7-124">Escenarios de aplicación</span><span class="sxs-lookup"><span data-stu-id="a08e7-124">Application scenarios</span></span>|
|------------------|---------------------------|
|<xref:System.Runtime.GCLatencyMode.Batch>|<span data-ttu-id="a08e7-125">Para las aplicaciones que no tienen interfaz de usuario (UI) u operaciones de servidor.</span><span class="sxs-lookup"><span data-stu-id="a08e7-125">For applications that have no user interface (UI) or server-side operations.</span></span><br /><br /><span data-ttu-id="a08e7-126">Cuando se deshabilita la recolección de elementos no utilizados en segundo plano, este es el modo predeterminado para la recolección de elementos no utilizados de estación de trabajo y de servidor.</span><span class="sxs-lookup"><span data-stu-id="a08e7-126">When background garbage collection is disabled, this is the default mode for workstation and server garbage collection.</span></span> <span data-ttu-id="a08e7-127">El modo <xref:System.Runtime.GCLatencyMode.Batch> también invalida el valor [gcConcurrent](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md), es decir, impide las recolecciones simultáneas o en segundo plano.</span><span class="sxs-lookup"><span data-stu-id="a08e7-127"><xref:System.Runtime.GCLatencyMode.Batch> mode also overrides the [gcConcurrent](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md) setting, that is, it prevents background or concurrent collections.</span></span>|
|<xref:System.Runtime.GCLatencyMode.Interactive>|<span data-ttu-id="a08e7-128">Para la mayoría de las aplicaciones que tienen una interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="a08e7-128">For most applications that have a UI.</span></span><br /><br /><span data-ttu-id="a08e7-129">Este es el modo predeterminado para la recolección de elementos no utilizados de estación de trabajo y de servidor.</span><span class="sxs-lookup"><span data-stu-id="a08e7-129">This is the default mode for workstation and server garbage collection.</span></span> <span data-ttu-id="a08e7-130">Sin embargo, si se hospeda una aplicación, la configuración del recolector de elementos no utilizados del proceso de hospedaje tiene prioridad.</span><span class="sxs-lookup"><span data-stu-id="a08e7-130">However, if an app is hosted, the garbage collector settings of the hosting process take precedence.</span></span>|
|<xref:System.Runtime.GCLatencyMode.LowLatency>|<span data-ttu-id="a08e7-131">Para aplicaciones que tienen operaciones a corto plazo sujetas a limitación temporal durante las cuales las interrupciones del recolector de elementos no utilizados podrían ser perjudiciales.</span><span class="sxs-lookup"><span data-stu-id="a08e7-131">For applications that have short-term, time-sensitive operations during which interruptions from the garbage collector could be disruptive.</span></span> <span data-ttu-id="a08e7-132">Por ejemplo, las aplicaciones que realizan funciones de adquisición de datos o representación de animación.</span><span class="sxs-lookup"><span data-stu-id="a08e7-132">For example, applications that render animations or data acquisition functions.</span></span>|
|<xref:System.Runtime.GCLatencyMode.SustainedLowLatency>|<span data-ttu-id="a08e7-133">Para aplicaciones que tienen operaciones sujetas a limitación temporal con una duración limitada pero posiblemente larga durante las cuales las interrupciones del recolector de elementos no utilizados podrían ser perjudiciales.</span><span class="sxs-lookup"><span data-stu-id="a08e7-133">For applications that have time-sensitive operations for a contained but potentially longer duration of time during which interruptions from the garbage collector could be disruptive.</span></span> <span data-ttu-id="a08e7-134">Por ejemplo, las aplicaciones que necesitan tiempos de respuesta rápidos, como los cambios de los datos del mercado durante las horas de comercio.</span><span class="sxs-lookup"><span data-stu-id="a08e7-134">For example, applications that need quick response times as market data changes during trading hours.</span></span><br /><br /><span data-ttu-id="a08e7-135">Este modo produce montón administrado de mayor tamaño que otros modos.</span><span class="sxs-lookup"><span data-stu-id="a08e7-135">This mode results in a larger managed heap size than other modes.</span></span> <span data-ttu-id="a08e7-136">Como no compacta el montón administrado, es posible una fragmentación mayor.</span><span class="sxs-lookup"><span data-stu-id="a08e7-136">Because it does not compact the managed heap, higher fragmentation is possible.</span></span> <span data-ttu-id="a08e7-137">Asegúrese de que hay suficiente memoria disponible.</span><span class="sxs-lookup"><span data-stu-id="a08e7-137">Ensure that sufficient memory is available.</span></span>|

## <a name="guidelines-for-using-low-latency"></a><span data-ttu-id="a08e7-138">Directrices para usar una latencia baja</span><span class="sxs-lookup"><span data-stu-id="a08e7-138">Guidelines for using low latency</span></span>

<span data-ttu-id="a08e7-139">Cuando use el modo [GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency), tenga en cuenta las siguientes instrucciones:</span><span class="sxs-lookup"><span data-stu-id="a08e7-139">When you use [GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) mode, consider the following guidelines:</span></span>

- <span data-ttu-id="a08e7-140">Haga que el período de tiempo de latencia baja sea lo más corto posible.</span><span class="sxs-lookup"><span data-stu-id="a08e7-140">Keep the period of time in low latency as short as possible.</span></span>

- <span data-ttu-id="a08e7-141">Evite asignar gran cantidad de memoria durante los períodos de latencia baja.</span><span class="sxs-lookup"><span data-stu-id="a08e7-141">Avoid allocating high amounts of memory during low latency periods.</span></span> <span data-ttu-id="a08e7-142">Se pueden producir notificaciones de memoria insuficiente porque la recolección de elementos no utilizados reclama menos objetos.</span><span class="sxs-lookup"><span data-stu-id="a08e7-142">Low memory notifications can occur because garbage collection reclaims fewer objects.</span></span>

- <span data-ttu-id="a08e7-143">Mientras esté en modo de latencia baja, minimice el número de asignaciones nuevas, en particular las asignaciones en el montón de objetos grandes y de objetos anclados.</span><span class="sxs-lookup"><span data-stu-id="a08e7-143">While in the low latency mode, minimize the number of new allocations, in particular allocations onto the large object heap and pinned objects.</span></span>

- <span data-ttu-id="a08e7-144">Tenga en cuenta los subprocesos que podrían estar realizando asignaciones.</span><span class="sxs-lookup"><span data-stu-id="a08e7-144">Be aware of threads that could be allocating.</span></span> <span data-ttu-id="a08e7-145">Como el valor de la propiedad <xref:System.Runtime.GCSettings.LatencyMode%2A> se aplica a todo el proceso, se pueden generar excepciones <xref:System.OutOfMemoryException> en cualquier subproceso que esté realizando asignaciones.</span><span class="sxs-lookup"><span data-stu-id="a08e7-145">Because the <xref:System.Runtime.GCSettings.LatencyMode%2A> property setting is process-wide, <xref:System.OutOfMemoryException> exceptions can be generated on any thread that is allocating.</span></span>

- <span data-ttu-id="a08e7-146">Ajuste el código de latencia baja en regiones de ejecución restringidas.</span><span class="sxs-lookup"><span data-stu-id="a08e7-146">Wrap the low latency code in constrained execution regions.</span></span> <span data-ttu-id="a08e7-147">Para obtener más información, vea [Regiones de ejecución restringidas](../../../docs/framework/performance/constrained-execution-regions.md).</span><span class="sxs-lookup"><span data-stu-id="a08e7-147">For more information, see [Constrained execution regions](../../../docs/framework/performance/constrained-execution-regions.md).</span></span>

- <span data-ttu-id="a08e7-148">Para forzar las recolecciones de generación 2 durante un período de latencia baja, llame al método <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%29?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="a08e7-148">You can force generation 2 collections during a low latency period by calling the <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%29?displayProperty=nameWithType> method.</span></span>

## <a name="see-also"></a><span data-ttu-id="a08e7-149">Vea también</span><span class="sxs-lookup"><span data-stu-id="a08e7-149">See also</span></span>

- <xref:System.GC?displayProperty=nameWithType>
- [<span data-ttu-id="a08e7-150">Colecciones inducidas</span><span class="sxs-lookup"><span data-stu-id="a08e7-150">Induced Collections</span></span>](../../../docs/standard/garbage-collection/induced.md)
- [<span data-ttu-id="a08e7-151">Recolección de elementos no utilizados</span><span class="sxs-lookup"><span data-stu-id="a08e7-151">Garbage Collection</span></span>](../../../docs/standard/garbage-collection/index.md)
