---
title: 'CA2012: usar ValueTasks correctamente (análisis de código)'
description: 'Más información sobre la regla de análisis de código CA2012: uso de ValueTasks correctamente'
ms.date: 06/18/2020
ms.topic: reference
f1_keywords:
- UseValueTasksCorrectly
- CA2012
helpviewer_keywords:
- UseValueTasksCorrectly
- CA2012
author: stephentoub
ms.author: stoub
ms.openlocfilehash: d1526a4a8db994b517a248591421b3a009395087
ms.sourcegitcommit: 4df8e005c074ceb1f978f007b222fe253be2baf3
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/04/2021
ms.locfileid: "99545698"
---
# <a name="ca2012-use-valuetasks-correctly"></a><span data-ttu-id="1ecbe-103">CA2012: Usar ValueTasks correctamente</span><span class="sxs-lookup"><span data-stu-id="1ecbe-103">CA2012: Use ValueTasks correctly</span></span>

| | <span data-ttu-id="1ecbe-104">Valor</span><span class="sxs-lookup"><span data-stu-id="1ecbe-104">Value</span></span> |
|-|-|
| <span data-ttu-id="1ecbe-105">**Identificador de la regla**</span><span class="sxs-lookup"><span data-stu-id="1ecbe-105">**Rule ID**</span></span> |<span data-ttu-id="1ecbe-106">CA2012</span><span class="sxs-lookup"><span data-stu-id="1ecbe-106">CA2012</span></span>|
| <span data-ttu-id="1ecbe-107">**Categoría**</span><span class="sxs-lookup"><span data-stu-id="1ecbe-107">**Category**</span></span> |[<span data-ttu-id="1ecbe-108">Microsoft.Reliability</span><span class="sxs-lookup"><span data-stu-id="1ecbe-108">Microsoft.Reliability</span></span>](reliability-warnings.md)|
| <span data-ttu-id="1ecbe-109">**Corrección o interrupción**</span><span class="sxs-lookup"><span data-stu-id="1ecbe-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="1ecbe-110">Poco problemático</span><span class="sxs-lookup"><span data-stu-id="1ecbe-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="1ecbe-111">Causa</span><span class="sxs-lookup"><span data-stu-id="1ecbe-111">Cause</span></span>

<span data-ttu-id="1ecbe-112">Una <xref:System.Threading.Tasks.ValueTask> instancia devuelta de una invocación de miembro se utiliza de forma que pueda provocar excepciones, daños o un rendimiento deficiente.</span><span class="sxs-lookup"><span data-stu-id="1ecbe-112">A <xref:System.Threading.Tasks.ValueTask> instance returned from a member invocation is used in a way that could lead to exceptions, corruption, or poor performance.</span></span>

## <a name="rule-description"></a><span data-ttu-id="1ecbe-113">Descripción de la regla</span><span class="sxs-lookup"><span data-stu-id="1ecbe-113">Rule description</span></span>

<span data-ttu-id="1ecbe-114"><xref:System.Threading.Tasks.ValueTask> las instancias devueltas de las invocaciones de miembro están diseñadas para esperarse directamente.</span><span class="sxs-lookup"><span data-stu-id="1ecbe-114"><xref:System.Threading.Tasks.ValueTask> instances returned from member invocations are intended to be directly awaited.</span></span>  <span data-ttu-id="1ecbe-115">Los intentos de consumir un ValueTask varias veces o de tener acceso directamente a uno de los resultados antes de que se sepa que se han completado pueden producir una excepción o daños.</span><span class="sxs-lookup"><span data-stu-id="1ecbe-115">Attempts to consume a ValueTask multiple times or to directly access one's result before it's known to be completed may result in an exception or corruption.</span></span>  <span data-ttu-id="1ecbe-116">Omitir tal ValueTask es probable que se trate de un error funcional y puede degradar el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="1ecbe-116">Ignoring such a ValueTask is likely an indication of a functional bug and may degrade performance.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="1ecbe-117">Cómo corregir infracciones</span><span class="sxs-lookup"><span data-stu-id="1ecbe-117">How to fix violations</span></span>

<span data-ttu-id="1ecbe-118">En general, ValueTasks debe estar directamente en espera en lugar de descartarse o almacenarse en otras ubicaciones, como variables locales o campos.</span><span class="sxs-lookup"><span data-stu-id="1ecbe-118">In general, ValueTasks should be directly awaited rather than discarded or stored into other locations like local variables or fields.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="1ecbe-119">Cuándo suprimir advertencias</span><span class="sxs-lookup"><span data-stu-id="1ecbe-119">When to suppress warnings</span></span>

<span data-ttu-id="1ecbe-120">En el caso de los ValueTasks devueltos por llamadas de miembro arbitrarias, el autor de la llamada debe asumir que el ValueTask debe consumirse (por ejemplo, en espera) una sola vez.</span><span class="sxs-lookup"><span data-stu-id="1ecbe-120">For ValueTasks returned from arbitrary member calls, the caller needs to assume that the ValueTask must be consumed (e.g. awaited) once and only once.</span></span>  <span data-ttu-id="1ecbe-121">Sin embargo, si el desarrollador controla también el miembro que se invoca y tiene conocimiento completo de su implementación, es posible que el desarrollador sepa que es seguro suprimir la advertencia, por ejemplo, si el ValueTask devuelto siempre ajusta un <xref:System.Threading.Tasks.Task> objeto.</span><span class="sxs-lookup"><span data-stu-id="1ecbe-121">However, if the developer also controls the member being invoked and has complete knowledge of its implementation, the developer may know it's safe to suppress the warning, for example, if the return ValueTask always wraps a <xref:System.Threading.Tasks.Task> object.</span></span>

## <a name="see-also"></a><span data-ttu-id="1ecbe-122">Vea también</span><span class="sxs-lookup"><span data-stu-id="1ecbe-122">See also</span></span>

- [<span data-ttu-id="1ecbe-123">Reglas de confiabilidad</span><span class="sxs-lookup"><span data-stu-id="1ecbe-123">Reliability rules</span></span>](reliability-warnings.md)
