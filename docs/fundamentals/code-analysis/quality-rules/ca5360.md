---
title: 'CA5360: no llamar a métodos peligrosos en la deserialización (análisis de código)'
description: Proporciona información sobre la regla de análisis de código CA5360, incluidas las causas, cómo corregir las infracciones y cuándo suprimirlas.
ms.date: 05/27/2020
ms.topic: reference
author: LLLXXXCCC
ms.author: linche
f1_keywords:
- CA5360
- DoNotCallDangerousMethodsInDeserialization
ms.openlocfilehash: d3b1e93b955b2584ce7b6d2865b520cfc58e65d6
ms.sourcegitcommit: 4f5f1855849cb02c3b610c7006ac21d7429f3348
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/15/2021
ms.locfileid: "98235278"
---
# <a name="ca5360-do-not-call-dangerous-methods-in-deserialization"></a><span data-ttu-id="e22d5-103">CA5360: No llamar a métodos peligrosos durante la deserialización</span><span class="sxs-lookup"><span data-stu-id="e22d5-103">CA5360: Do not call dangerous methods in deserialization</span></span>

| | <span data-ttu-id="e22d5-104">Valor</span><span class="sxs-lookup"><span data-stu-id="e22d5-104">Value</span></span> |
|-|-|
| <span data-ttu-id="e22d5-105">**Identificador de la regla**</span><span class="sxs-lookup"><span data-stu-id="e22d5-105">**Rule ID**</span></span> |<span data-ttu-id="e22d5-106">CA5360</span><span class="sxs-lookup"><span data-stu-id="e22d5-106">CA5360</span></span>|
| <span data-ttu-id="e22d5-107">**Categoría**</span><span class="sxs-lookup"><span data-stu-id="e22d5-107">**Category**</span></span> |<span data-ttu-id="e22d5-108">Microsoft.Security</span><span class="sxs-lookup"><span data-stu-id="e22d5-108">Microsoft.Security</span></span>|
| <span data-ttu-id="e22d5-109">**Corrección o interrupción**</span><span class="sxs-lookup"><span data-stu-id="e22d5-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="e22d5-110">Poco problemático</span><span class="sxs-lookup"><span data-stu-id="e22d5-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="e22d5-111">Causa</span><span class="sxs-lookup"><span data-stu-id="e22d5-111">Cause</span></span>

<span data-ttu-id="e22d5-112">Llamar a uno de los métodos peligrosos siguientes en deserializatio:</span><span class="sxs-lookup"><span data-stu-id="e22d5-112">Calling one of the following dangerous methods in deserializatio:</span></span>

- <xref:System.IO.Directory.Delete%2A?displayProperty=fullName>
- <xref:System.IO.DirectoryInfo.Delete%2A?displayProperty=fullName>
- <xref:System.IO.File.AppendAllLines%2A?displayProperty=fullName>
- <xref:System.IO.File.AppendAllText%2A?displayProperty=fullName>
- <xref:System.IO.File.AppendText%2A?displayProperty=fullName>
- <xref:System.IO.File.Copy%2A?displayProperty=fullName>
- <xref:System.IO.File.Delete%2A?displayProperty=fullName>
- <xref:System.IO.File.WriteAllBytes%2A?displayProperty=fullName>
- <xref:System.IO.File.WriteAllLines%2A?displayProperty=fullName>
- <xref:System.IO.File.WriteAllText%2A?displayProperty=fullName>
- <xref:System.IO.FileInfo.Delete%2A?displayProperty=fullName>
- <xref:System.IO.Log.LogStore.Delete%2A?displayProperty=fullName>
- <xref:System.Reflection.Assembly.GetLoadedModules%2A?displayProperty=fullName>
- <xref:System.Reflection.Assembly.Load%2A?displayProperty=fullName>
- <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=fullName>
- <xref:System.Reflection.Assembly.LoadFile%2A?displayProperty=fullName>
- <xref:System.Reflection.Assembly.LoadModule%2A?displayProperty=fullName>
- <xref:System.Reflection.Assembly.LoadWithPartialName%2A?displayProperty=fullName>
- <xref:System.Reflection.Assembly.ReflectionOnlyLoad%2A?displayProperty=fullName>
- <xref:System.Reflection.Assembly.ReflectionOnlyLoadFrom%2A?displayProperty=fullName>
- <xref:System.Reflection.Assembly.UnsafeLoadFrom%2A?displayProperty=fullName>

<span data-ttu-id="e22d5-113">Todos los métodos cumplen uno de los siguientes requisitos podrían ser la devolución de llamada de deserializatio:</span><span class="sxs-lookup"><span data-stu-id="e22d5-113">All methods meets one of the following requirements could be the callback of deserializatio:</span></span>

- <span data-ttu-id="e22d5-114">Marcado con <xref:System.Runtime.Serialization.OnDeserializingAttribute?displayProperty=fullName> .</span><span class="sxs-lookup"><span data-stu-id="e22d5-114">Marked with <xref:System.Runtime.Serialization.OnDeserializingAttribute?displayProperty=fullName>.</span></span>
- <span data-ttu-id="e22d5-115">Marcado con <xref:System.Runtime.Serialization.OnDeserializedAttribute?displayProperty=fullName> .</span><span class="sxs-lookup"><span data-stu-id="e22d5-115">Marked with <xref:System.Runtime.Serialization.OnDeserializedAttribute?displayProperty=fullName>.</span></span>
- <span data-ttu-id="e22d5-116">Implementar <xref:System.Runtime.Serialization.IDeserializationCallback.OnDeserialization%2A?displayProperty=fullName> .</span><span class="sxs-lookup"><span data-stu-id="e22d5-116">Implementing <xref:System.Runtime.Serialization.IDeserializationCallback.OnDeserialization%2A?displayProperty=fullName>.</span></span>
- <span data-ttu-id="e22d5-117">Implementar <xref:System.IDisposable.Dispose%2A?displayProperty=fullName> .</span><span class="sxs-lookup"><span data-stu-id="e22d5-117">Implementing <xref:System.IDisposable.Dispose%2A?displayProperty=fullName>.</span></span>
- <span data-ttu-id="e22d5-118">Es un destructor.</span><span class="sxs-lookup"><span data-stu-id="e22d5-118">Is a destructor.</span></span>

## <a name="rule-description"></a><span data-ttu-id="e22d5-119">Descripción de la regla</span><span class="sxs-lookup"><span data-stu-id="e22d5-119">Rule description</span></span>

<span data-ttu-id="e22d5-120">La deserialización no segura es una vulnerabilidad que se produce cuando los datos que no son de confianza se usan para abusar la lógica de una aplicación, provocar un ataque de denegación de servicio (DoS) o incluso ejecutar código arbitrario cuando se deserializa.</span><span class="sxs-lookup"><span data-stu-id="e22d5-120">Insecure deserialization is a vulnerability which occurs when untrusted data is used to abuse the logic of an application, inflict a Denial-of-Service (DoS) attack, or even execute arbitrary code upon it being deserialized.</span></span> <span data-ttu-id="e22d5-121">A menudo, es posible que los usuarios malintencionados abusan estas características de deserialización cuando la aplicación está deserializando datos que no son de confianza y están bajo su control.</span><span class="sxs-lookup"><span data-stu-id="e22d5-121">It's frequently possible for malicious users to abuse these deserialization features when the application is deserializing untrusted data which is under their control.</span></span> <span data-ttu-id="e22d5-122">En concreto, invoque métodos peligrosos en el proceso de deserialización.</span><span class="sxs-lookup"><span data-stu-id="e22d5-122">Specifically, invoke dangerous methods in the process of deserialization.</span></span> <span data-ttu-id="e22d5-123">Los ataques de deserialización inseguros que se han realizado correctamente podrían permitir que un atacante lleve a cabo ataques como ataques de DoS, omisiones de autenticación y ejecución remota de código.</span><span class="sxs-lookup"><span data-stu-id="e22d5-123">Successful insecure deserialization attacks could allow an attacker to carry out attacks such as DoS attacks, authentication bypasses, and remote code execution.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="e22d5-124">Cómo corregir infracciones</span><span class="sxs-lookup"><span data-stu-id="e22d5-124">How to fix violations</span></span>

<span data-ttu-id="e22d5-125">Quite estos métodos peligrosos de ejecutar automáticamente las devoluciones de llamada de deserialización.</span><span class="sxs-lookup"><span data-stu-id="e22d5-125">Remove these dangerous methods from automatically run deserialization callbacks.</span></span> <span data-ttu-id="e22d5-126">Llame a métodos peligrosos solo después de validar la entrada.</span><span class="sxs-lookup"><span data-stu-id="e22d5-126">Call dangerous methods only after validating the input.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="e22d5-127">Cuándo suprimir advertencias</span><span class="sxs-lookup"><span data-stu-id="e22d5-127">When to suppress warnings</span></span>

<span data-ttu-id="e22d5-128">Es seguro suprimir esta regla si:</span><span class="sxs-lookup"><span data-stu-id="e22d5-128">It's safe to suppress this rule if:</span></span>

- <span data-ttu-id="e22d5-129">Sabe que la entrada es de confianza.</span><span class="sxs-lookup"><span data-stu-id="e22d5-129">You know the input is trusted.</span></span> <span data-ttu-id="e22d5-130">Tenga en cuenta que el límite de confianza de la aplicación y los flujos de datos pueden cambiar con el tiempo.</span><span class="sxs-lookup"><span data-stu-id="e22d5-130">Consider that your application's trust boundary and data flows may change over time.</span></span>
- <span data-ttu-id="e22d5-131">Los datos serializados tienen una prueba de alteración.</span><span class="sxs-lookup"><span data-stu-id="e22d5-131">The serialized data is tamper-proof.</span></span> <span data-ttu-id="e22d5-132">Después de la serialización, firme criptográficamente los datos serializados.</span><span class="sxs-lookup"><span data-stu-id="e22d5-132">After serialization, cryptographically sign the serialized data.</span></span> <span data-ttu-id="e22d5-133">Antes de la deserialización, valide la firma criptográfica.</span><span class="sxs-lookup"><span data-stu-id="e22d5-133">Before deserialization, validate the cryptographic signature.</span></span> <span data-ttu-id="e22d5-134">Proteja la clave criptográfica para que no se revele y diseñe las rotaciones de clave.</span><span class="sxs-lookup"><span data-stu-id="e22d5-134">Protect the cryptographic key from being disclosed and design for key rotations.</span></span>
- <span data-ttu-id="e22d5-135">Los datos se validan como seguros para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e22d5-135">The data is validated as safe to the application.</span></span>

## <a name="pseudo-code-examples"></a><span data-ttu-id="e22d5-136">Ejemplos de pseudocódigo</span><span class="sxs-lookup"><span data-stu-id="e22d5-136">Pseudo-code examples</span></span>

### <a name="violation"></a><span data-ttu-id="e22d5-137">Infracción</span><span class="sxs-lookup"><span data-stu-id="e22d5-137">Violation</span></span>

```csharp
using System;
using System.IO;
using System.Runtime.Serialization;

[Serializable()]
public class ExampleClass : IDeserializationCallback
{
    private string member;

    void IDeserializationCallback.OnDeserialization(Object sender)
    {
        var sourceFileName = "malicious file";
        var destFileName = "sensitive file";
        File.Copy(sourceFileName, destFileName);
    }
}
```

### <a name="solution"></a><span data-ttu-id="e22d5-138">Solución</span><span class="sxs-lookup"><span data-stu-id="e22d5-138">Solution</span></span>

```csharp
using System;
using System.IO;
using System.Runtime.Serialization;

[Serializable()]
public class ExampleClass : IDeserializationCallback
{
    private string member;

    void IDeserializationCallback.OnDeserialization(Object sender)
    {
        var sourceFileName = "malicious file";
        var destFileName = "sensitive file";
        // Remove the potential dangerous operation.
        // File.Copy(sourceFileName, destFileName);
    }
}
```
