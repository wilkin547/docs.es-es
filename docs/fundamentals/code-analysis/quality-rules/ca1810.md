---
title: 'CA1810: inicializar campos estáticos de tipo de referencia insertados (análisis de código)'
description: 'Más información sobre la regla de análisis de código CA1810: inicializar campos estáticos de tipo de referencia insertados'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- InitializeReferenceTypeStaticFieldsInline
- CA1810
helpviewer_keywords:
- InitializeReferenceTypeStaticFieldsInline
- CA1810
author: gewarren
ms.author: gewarren
dev_langs:
- CSharp
- VB
ms.openlocfilehash: f0aa5dd9ffe05b2755a5c9ee2b5c2784aebbb0e6
ms.sourcegitcommit: 4df8e005c074ceb1f978f007b222fe253be2baf3
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/04/2021
ms.locfileid: "99547972"
---
# <a name="ca1810-initialize-reference-type-static-fields-inline"></a><span data-ttu-id="ff146-103">CA1810: Inicializar campos estáticos de tipo de referencia insertados</span><span class="sxs-lookup"><span data-stu-id="ff146-103">CA1810: Initialize reference type static fields inline</span></span>

| | <span data-ttu-id="ff146-104">Valor</span><span class="sxs-lookup"><span data-stu-id="ff146-104">Value</span></span> |
|-|-|
| <span data-ttu-id="ff146-105">**Identificador de la regla**</span><span class="sxs-lookup"><span data-stu-id="ff146-105">**Rule ID**</span></span> |<span data-ttu-id="ff146-106">CA1810</span><span class="sxs-lookup"><span data-stu-id="ff146-106">CA1810</span></span>|
| <span data-ttu-id="ff146-107">**Categoría**</span><span class="sxs-lookup"><span data-stu-id="ff146-107">**Category**</span></span> |[<span data-ttu-id="ff146-108">Microsoft. performance</span><span class="sxs-lookup"><span data-stu-id="ff146-108">Microsoft.Performance</span></span>](performance-warnings.md)|
| <span data-ttu-id="ff146-109">**Corrección o interrupción**</span><span class="sxs-lookup"><span data-stu-id="ff146-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="ff146-110">Poco problemático</span><span class="sxs-lookup"><span data-stu-id="ff146-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="ff146-111">Causa</span><span class="sxs-lookup"><span data-stu-id="ff146-111">Cause</span></span>

<span data-ttu-id="ff146-112">Un tipo de referencia declara un constructor estático explícito.</span><span class="sxs-lookup"><span data-stu-id="ff146-112">A reference type declares an explicit static constructor.</span></span>

## <a name="rule-description"></a><span data-ttu-id="ff146-113">Descripción de la regla</span><span class="sxs-lookup"><span data-stu-id="ff146-113">Rule description</span></span>

<span data-ttu-id="ff146-114">Cuando un tipo declara un constructor estático explícito, el compilador Just-In-Time (JIT) agrega una comprobación a cada constructor de instancia y a cada método estático del tipo para asegurarse de que se ha llamado anteriormente al constructor estático.</span><span class="sxs-lookup"><span data-stu-id="ff146-114">When a type declares an explicit static constructor, the just-in-time (JIT) compiler adds a check to each static method and instance constructor of the type to make sure that the static constructor was previously called.</span></span> <span data-ttu-id="ff146-115">La inicialización estática se desencadena cuando se tiene acceso a cualquier miembro estático o cuando se crea una instancia del tipo.</span><span class="sxs-lookup"><span data-stu-id="ff146-115">Static initialization is triggered when any static member is accessed or when an instance of the type is created.</span></span> <span data-ttu-id="ff146-116">Sin embargo, la inicialización estática no se desencadena si se declara una variable del tipo pero no se usa, lo que puede ser importante si la inicialización cambia el estado global.</span><span class="sxs-lookup"><span data-stu-id="ff146-116">However, static initialization is not triggered if you declare a variable of the type but do not use it, which can be important if the initialization changes global state.</span></span>

<span data-ttu-id="ff146-117">Cuando todos los datos estáticos se inicializan en línea y no se declara un constructor estático explícito, los compiladores del lenguaje intermedio de Microsoft (MSIL) agregan la `beforefieldinit` marca y un constructor estático implícito, que inicializa los datos estáticos, en la definición de tipo de MSIL.</span><span class="sxs-lookup"><span data-stu-id="ff146-117">When all static data is initialized inline and an explicit static constructor is not declared, Microsoft intermediate language (MSIL) compilers add the `beforefieldinit` flag and an implicit static constructor, which initializes the static data, to the MSIL type definition.</span></span> <span data-ttu-id="ff146-118">Cuando el compilador JIT encuentra la `beforefieldinit` marca, no se agrega la mayor parte del tiempo que las comprobaciones del constructor estático.</span><span class="sxs-lookup"><span data-stu-id="ff146-118">When the JIT compiler encounters the `beforefieldinit` flag, most of the time the static constructor checks are not added.</span></span> <span data-ttu-id="ff146-119">Se garantiza que la inicialización estática se produce en algún momento antes de que se tenga acceso a los campos estáticos, pero no antes de que se invoque un método estático o un constructor de instancia.</span><span class="sxs-lookup"><span data-stu-id="ff146-119">Static initialization is guaranteed to occur at some time before any static fields are accessed but not before a static method or instance constructor is invoked.</span></span> <span data-ttu-id="ff146-120">Tenga en cuenta que la inicialización estática puede producirse en cualquier momento después de declarar una variable del tipo.</span><span class="sxs-lookup"><span data-stu-id="ff146-120">Note that static initialization can occur at any time after a variable of the type is declared.</span></span>

<span data-ttu-id="ff146-121">Las comprobaciones del constructor estático pueden reducir el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="ff146-121">Static constructor checks can decrease performance.</span></span> <span data-ttu-id="ff146-122">A menudo, solo se usa un constructor estático para inicializar campos estáticos, en cuyo caso solo debe asegurarse de que la inicialización estática se produce antes del primer acceso de un campo estático.</span><span class="sxs-lookup"><span data-stu-id="ff146-122">Often a static constructor is used only to initialize static fields, in which case you must only make sure that static initialization occurs before the first access of a static field.</span></span> <span data-ttu-id="ff146-123">El `beforefieldinit` comportamiento es adecuado para estos y otros tipos.</span><span class="sxs-lookup"><span data-stu-id="ff146-123">The `beforefieldinit` behavior is appropriate for these and most other types.</span></span> <span data-ttu-id="ff146-124">Solo es apropiado cuando la inicialización estática afecta al estado global y se cumple una de las siguientes condiciones:</span><span class="sxs-lookup"><span data-stu-id="ff146-124">It is only inappropriate when static initialization affects global state and one of the following is true:</span></span>

- <span data-ttu-id="ff146-125">El efecto en el estado global es costoso y no es necesario si no se utiliza el tipo.</span><span class="sxs-lookup"><span data-stu-id="ff146-125">The effect on global state is expensive and is not required if the type is not used.</span></span>

- <span data-ttu-id="ff146-126">Se puede tener acceso a los efectos globales de estado sin tener acceso a los campos estáticos del tipo.</span><span class="sxs-lookup"><span data-stu-id="ff146-126">The global state effects can be accessed without accessing any static fields of the type.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="ff146-127">Cómo corregir infracciones</span><span class="sxs-lookup"><span data-stu-id="ff146-127">How to fix violations</span></span>

<span data-ttu-id="ff146-128">Para corregir una infracción de esta regla, inicialice todos los datos estáticos cuando se declara y quite el constructor estático.</span><span class="sxs-lookup"><span data-stu-id="ff146-128">To fix a violation of this rule, initialize all static data when it is declared and remove the static constructor.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="ff146-129">Cuándo suprimir advertencias</span><span class="sxs-lookup"><span data-stu-id="ff146-129">When to suppress warnings</span></span>

<span data-ttu-id="ff146-130">Es seguro suprimir una advertencia de esta regla si el rendimiento no es un problema. o bien, si los cambios de estado global causados por la inicialización estática son caros o se debe garantizar que se produzcan antes de que se llame a un método estático del tipo o se cree una instancia del tipo.</span><span class="sxs-lookup"><span data-stu-id="ff146-130">It is safe to suppress a warning from this rule if performance is not a concern; or if global state changes that are caused by static initialization are expensive or must be guaranteed to occur before a static method of the type is called or an instance of the type is created.</span></span>

## <a name="example"></a><span data-ttu-id="ff146-131">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="ff146-131">Example</span></span>

<span data-ttu-id="ff146-132">En el ejemplo siguiente se muestra un tipo, `StaticConstructor` , que infringe la regla y un tipo, `NoStaticConstructor` , que reemplaza el constructor estático con la inicialización alineada para satisfacer la regla.</span><span class="sxs-lookup"><span data-stu-id="ff146-132">The following example shows a type, `StaticConstructor`, that violates the rule and a type, `NoStaticConstructor`, that replaces the static constructor with inline initialization to satisfy the rule.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca1810.cs" id="snippet1":::

:::code language="vb" source="snippets/vb/all-rules/ca1810-initialize-reference-type-static-fields-inline_1.vb":::

<span data-ttu-id="ff146-133">Observe la adición de la `beforefieldinit` marca en la definición de MSIL para la `NoStaticConstructor` clase.</span><span class="sxs-lookup"><span data-stu-id="ff146-133">Note the addition of the `beforefieldinit` flag on the MSIL definition for the `NoStaticConstructor` class.</span></span>

```il
.class public auto ansi StaticConstructor
extends [mscorlib]System.Object
{
} // end of class StaticConstructor

.class public auto ansi beforefieldinit NoStaticConstructor
extends [mscorlib]System.Object
{
} // end of class NoStaticConstructor
```

## <a name="related-rules"></a><span data-ttu-id="ff146-134">Reglas relacionadas</span><span class="sxs-lookup"><span data-stu-id="ff146-134">Related rules</span></span>

- [<span data-ttu-id="ff146-135">CA2207: Inicializar campos estáticos de tipo de valor insertados</span><span class="sxs-lookup"><span data-stu-id="ff146-135">CA2207: Initialize value type static fields inline</span></span>](ca2207.md)
