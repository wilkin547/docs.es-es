---
title: 'CA2247: el argumento pasado al constructor TaskCompletionSource debe ser una enumeración TaskCreationOptions en lugar de TaskContinuationOptions enum (análisis de código)'
description: 'Más información sobre la regla de análisis de código CA2247: el argumento pasado al constructor TaskCompletionSource debe ser una enumeración TaskCreationOptions en lugar de TaskContinuationOptions enum'
ms.date: 05/16/2020
ms.topic: reference
f1_keywords:
- DoNotCreateTaskCompletionSourceWithWrongArguments
- CA2247
helpviewer_keywords:
- DoNotCreateTaskCompletionSourceWithWrongArguments
- CA2247
author: stephentoub
ms.author: stoub
ms.openlocfilehash: 594476616cddb87b64af4b874f62723cb0a97e4c
ms.sourcegitcommit: 2e4adc490c1d2a705a0592b295d606b10b9f51f1
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/25/2020
ms.locfileid: "96592331"
---
# <a name="ca2247-argument-passed-to-taskcompletionsource-constructor-should-be-taskcreationoptions-enum-instead-of-taskcontinuationoptions-enum"></a><span data-ttu-id="5a181-103">CA2247: El argumento pasado al constructor TaskCompletionSource debe ser una enumeración TaskCreationOptions en lugar de TaskContinuationOptions</span><span class="sxs-lookup"><span data-stu-id="5a181-103">CA2247: Argument passed to TaskCompletionSource constructor should be TaskCreationOptions enum instead of TaskContinuationOptions enum</span></span>

| | <span data-ttu-id="5a181-104">Valor</span><span class="sxs-lookup"><span data-stu-id="5a181-104">Value</span></span> |
|-|-|
| <span data-ttu-id="5a181-105">**Identificador de la regla**</span><span class="sxs-lookup"><span data-stu-id="5a181-105">**Rule ID**</span></span> |<span data-ttu-id="5a181-106">CA2247</span><span class="sxs-lookup"><span data-stu-id="5a181-106">CA2247</span></span>|
| <span data-ttu-id="5a181-107">**Categoría**</span><span class="sxs-lookup"><span data-stu-id="5a181-107">**Category**</span></span> |<span data-ttu-id="5a181-108">Microsoft. Usage</span><span class="sxs-lookup"><span data-stu-id="5a181-108">Microsoft.Usage</span></span>|
| <span data-ttu-id="5a181-109">**Corrección o interrupción**</span><span class="sxs-lookup"><span data-stu-id="5a181-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="5a181-110">Poco problemático</span><span class="sxs-lookup"><span data-stu-id="5a181-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="5a181-111">Causa</span><span class="sxs-lookup"><span data-stu-id="5a181-111">Cause</span></span>

<span data-ttu-id="5a181-112">Construir un `System.Threading.Tasks.TaskCompletionSource` con un <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> valor de enumeración en lugar de un valor de <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> enumeración.</span><span class="sxs-lookup"><span data-stu-id="5a181-112">Constructing a `System.Threading.Tasks.TaskCompletionSource` with a <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> enum value rather than a <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> enum value.</span></span>
<span data-ttu-id="5a181-113">Usar el <xref:System.Object.ReferenceEquals%2A?displayProperty=fullName> método para comprobar la igualdad de uno o varios tipos de valor.</span><span class="sxs-lookup"><span data-stu-id="5a181-113">Using <xref:System.Object.ReferenceEquals%2A?displayProperty=fullName> method to test one or more value types for equality.</span></span>

## <a name="rule-description"></a><span data-ttu-id="5a181-114">Descripción de la regla</span><span class="sxs-lookup"><span data-stu-id="5a181-114">Rule description</span></span>

<span data-ttu-id="5a181-115">El tipo TaskCompletionSource tiene un constructor que acepta un <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> valor enum y otro constructor que acepta <xref:System.Object> .</span><span class="sxs-lookup"><span data-stu-id="5a181-115">The TaskCompletionSource type has a constructor that accepts a <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> enum value, and another constructor that accepts a <xref:System.Object>.</span></span>  <span data-ttu-id="5a181-116">Pasar accidentalmente un <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> valor de enumeración en lugar de un valor de enumeración producirá una <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> llamada al <xref:System.Object> constructor basado en: se compilará y ejecutará, pero no tendrá el comportamiento previsto.</span><span class="sxs-lookup"><span data-stu-id="5a181-116">Accidentally passing a <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> enum value instead of a <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> enum value will result in calling the <xref:System.Object>-based constructor: it will compile and run, but it will not have the intended behavior.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="5a181-117">Cómo corregir infracciones</span><span class="sxs-lookup"><span data-stu-id="5a181-117">How to fix violations</span></span>

<span data-ttu-id="5a181-118">Para corregir la infracción, reemplace el <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> valor de enumeración por el <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> valor de enumeración correspondiente.</span><span class="sxs-lookup"><span data-stu-id="5a181-118">To fix the violation, replace the <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> enum value with the corresponding <xref:System.Threading.Tasks.TaskCreationOptions?displayProperty=fullName> enum value.</span></span>

```csharp
    // Violation
    var tcs = new TaskCompletionSource<int>(TaskContinuationOptions.RunContinuationsAsynchronously);

    // Fixed
    var tcs = new TaskCompletionSource<int>(TaskCreationOptions.RunContinuationsAsynchronously);
```

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="5a181-119">Cuándo suprimir advertencias</span><span class="sxs-lookup"><span data-stu-id="5a181-119">When to suppress warnings</span></span>

<span data-ttu-id="5a181-120">Una infracción de esta regla casi siempre resalta un error en el código de llamada, de modo que el código no se comportará como el desarrollador previsto, con el TaskCompletionSource de forma eficaz, omitiendo la opción especificada.</span><span class="sxs-lookup"><span data-stu-id="5a181-120">A violation of this rule almost always highlights a bug in the calling code, such that the code will not behave as the developer intended, with the TaskCompletionSource effectively ignoring the specified option.</span></span>  <span data-ttu-id="5a181-121">La única vez que es seguro suprimir la advertencia es si el desarrollador pretende realmente pasar una conversión boxing <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> como el argumento de estado del objeto a TaskCompletionSource.</span><span class="sxs-lookup"><span data-stu-id="5a181-121">The only time it is safe to suppress the warning is if the developer actually intended to pass a boxed <xref:System.Threading.Tasks.TaskContinuationOptions?displayProperty=fullName> as the object state argument to the TaskCompletionSource.</span></span>

## <a name="see-also"></a><span data-ttu-id="5a181-122">Vea también</span><span class="sxs-lookup"><span data-stu-id="5a181-122">See also</span></span>

- [<span data-ttu-id="5a181-123">Reglas de uso</span><span class="sxs-lookup"><span data-stu-id="5a181-123">Usage rules</span></span>](usage-warnings.md)
