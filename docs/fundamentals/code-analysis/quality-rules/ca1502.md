---
title: 'CA1502: Evite una complejidad excesiva (análisis de código)'
description: 'Más información sobre la regla de análisis de código CA1502: evitar una complejidad excesiva'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- AvoidExcessiveComplexity
- CA1502
helpviewer_keywords:
- CA1502
- AvoidExcessiveComplexity
author: gewarren
ms.author: gewarren
dev_langs:
- CSharp
- VB
ms.openlocfilehash: 19c05fa59274b87ad9b64336d73d252ed3b5c68a
ms.sourcegitcommit: 2e4adc490c1d2a705a0592b295d606b10b9f51f1
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/25/2020
ms.locfileid: "96592258"
---
# <a name="ca1502-avoid-excessive-complexity"></a><span data-ttu-id="f6647-103">CA1502: Evitar una complejidad excesiva</span><span class="sxs-lookup"><span data-stu-id="f6647-103">CA1502: Avoid excessive complexity</span></span>

| | <span data-ttu-id="f6647-104">Valor</span><span class="sxs-lookup"><span data-stu-id="f6647-104">Value</span></span> |
|-|-|
| <span data-ttu-id="f6647-105">**Identificador de la regla**</span><span class="sxs-lookup"><span data-stu-id="f6647-105">**Rule ID**</span></span> |<span data-ttu-id="f6647-106">CA1502</span><span class="sxs-lookup"><span data-stu-id="f6647-106">CA1502</span></span>|
| <span data-ttu-id="f6647-107">**Categoría**</span><span class="sxs-lookup"><span data-stu-id="f6647-107">**Category**</span></span> |<span data-ttu-id="f6647-108">Microsoft. mantenibilidad</span><span class="sxs-lookup"><span data-stu-id="f6647-108">Microsoft.Maintainability</span></span>|
| <span data-ttu-id="f6647-109">**Corrección o interrupción**</span><span class="sxs-lookup"><span data-stu-id="f6647-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="f6647-110">Poco problemático</span><span class="sxs-lookup"><span data-stu-id="f6647-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="f6647-111">Causa</span><span class="sxs-lookup"><span data-stu-id="f6647-111">Cause</span></span>

<span data-ttu-id="f6647-112">Un método tiene una complejidad de ciclomática excesiva.</span><span class="sxs-lookup"><span data-stu-id="f6647-112">A method has an excessive cyclomatic complexity.</span></span>

## <a name="rule-description"></a><span data-ttu-id="f6647-113">Descripción de la regla</span><span class="sxs-lookup"><span data-stu-id="f6647-113">Rule description</span></span>

<span data-ttu-id="f6647-114">La *complejidad ciclomática* mide el número de rutas de acceso independientes de forma lineal a través del método, que viene determinado por el número y la complejidad de las bifurcaciones condicionales.</span><span class="sxs-lookup"><span data-stu-id="f6647-114">*Cyclomatic complexity* measures the number of linearly independent paths through the method, which is determined by the number and complexity of conditional branches.</span></span> <span data-ttu-id="f6647-115">Generalmente, una complejidad de ciclomática baja indica un método que es fácil de entender, probar y mantener.</span><span class="sxs-lookup"><span data-stu-id="f6647-115">A low cyclomatic complexity generally indicates a method that is easy to understand, test, and maintain.</span></span> <span data-ttu-id="f6647-116">La complejidad ciclomática se calcula a partir de un gráfico de flujo de control del método y se proporciona de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="f6647-116">The cyclomatic complexity is calculated from a control flow graph of the method and is given as follows:</span></span>

<span data-ttu-id="f6647-117">complejidad ciclomática = el número de límites (el número de nodos + 1)</span><span class="sxs-lookup"><span data-stu-id="f6647-117">cyclomatic complexity = the number of edges - the number of nodes + 1</span></span>

<span data-ttu-id="f6647-118">Un *nodo* representa un punto de bifurcación lógico y un *borde* representa una línea entre los nodos.</span><span class="sxs-lookup"><span data-stu-id="f6647-118">A *node* represents a logic branch point and an *edge* represents a line between nodes.</span></span>

<span data-ttu-id="f6647-119">La regla notifica una infracción cuando la complejidad ciclomática es superior a 25.</span><span class="sxs-lookup"><span data-stu-id="f6647-119">The rule reports a violation when the cyclomatic complexity is more than 25.</span></span>

<span data-ttu-id="f6647-120">Puede obtener más información sobre las métricas de código en [la medida de la complejidad del código administrado](/visualstudio/code-quality/code-metrics-values).</span><span class="sxs-lookup"><span data-stu-id="f6647-120">You can learn more about code metrics at [Measure complexity of managed code](/visualstudio/code-quality/code-metrics-values).</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="f6647-121">Cómo corregir infracciones</span><span class="sxs-lookup"><span data-stu-id="f6647-121">How to fix violations</span></span>

<span data-ttu-id="f6647-122">Para corregir una infracción de esta regla, refactorice el método para reducir su complejidad ciclomática.</span><span class="sxs-lookup"><span data-stu-id="f6647-122">To fix a violation of this rule, refactor the method to reduce its cyclomatic complexity.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="f6647-123">Cuándo suprimir advertencias</span><span class="sxs-lookup"><span data-stu-id="f6647-123">When to suppress warnings</span></span>

<span data-ttu-id="f6647-124">Es seguro suprimir una advertencia de esta regla si la complejidad no se puede reducir fácilmente y el método es fácil de entender, probar y mantener.</span><span class="sxs-lookup"><span data-stu-id="f6647-124">It is safe to suppress a warning from this rule if the complexity cannot easily be reduced and the method is easy to understand, test, and maintain.</span></span> <span data-ttu-id="f6647-125">En concreto, un método que contiene una `switch` instrucción grande ( `Select` en Visual Basic) es un candidato para la exclusión.</span><span class="sxs-lookup"><span data-stu-id="f6647-125">In particular, a method that contains a large `switch` (`Select` in Visual Basic) statement is a candidate for exclusion.</span></span> <span data-ttu-id="f6647-126">El riesgo de desestabilizadores la base de código tardíamente en el ciclo de desarrollo o la introducción de un cambio inesperado en el comportamiento en tiempo de ejecución en el código enviado anteriormente podría superar las ventajas de mantenimiento de la refactorización del código.</span><span class="sxs-lookup"><span data-stu-id="f6647-126">The risk of destabilizing the code base late in the development cycle or introducing an unexpected change in run-time behavior in previously shipped code might outweigh the maintainability benefits of refactoring the code.</span></span>

## <a name="how-cyclomatic-complexity-is-calculated"></a><span data-ttu-id="f6647-127">Cómo se calcula la complejidad de ciclomática</span><span class="sxs-lookup"><span data-stu-id="f6647-127">How cyclomatic complexity is calculated</span></span>

<span data-ttu-id="f6647-128">La complejidad ciclomática se calcula agregando 1 a lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="f6647-128">The cyclomatic complexity is calculated by adding 1 to the following:</span></span>

- <span data-ttu-id="f6647-129">Número de bifurcaciones (como `if` , `while` y `do` )</span><span class="sxs-lookup"><span data-stu-id="f6647-129">Number of branches (such as `if`, `while`, and `do`)</span></span>

- <span data-ttu-id="f6647-130">Número de `case` instrucciones en un `switch`</span><span class="sxs-lookup"><span data-stu-id="f6647-130">Number of `case` statements in a `switch`</span></span>

## <a name="examples"></a><span data-ttu-id="f6647-131">Ejemplos</span><span class="sxs-lookup"><span data-stu-id="f6647-131">Examples</span></span>

<span data-ttu-id="f6647-132">En los ejemplos siguientes se muestran métodos que tienen diferentes complejidades de ciclomática.</span><span class="sxs-lookup"><span data-stu-id="f6647-132">The following examples show methods that have varying cyclomatic complexities.</span></span>

### <a name="cyclomatic-complexity-of-1"></a><span data-ttu-id="f6647-133">Complejidad ciclomática de 1</span><span class="sxs-lookup"><span data-stu-id="f6647-133">Cyclomatic complexity of 1</span></span>

```csharp
public void Method()
{
    Console.WriteLine("Hello World!");
}
```

```vb
Public Sub Method()
    Console.WriteLine("Hello World!")
End Sub
```

### <a name="cyclomatic-complexity-of-2"></a><span data-ttu-id="f6647-134">Complejidad ciclomática de 2</span><span class="sxs-lookup"><span data-stu-id="f6647-134">Cyclomatic complexity of 2</span></span>

```csharp
void Method(bool condition)
{
    if (condition)
    {
        Console.WriteLine("Hello World!");
    }
}
```

```vb
Public Sub Method(ByVal condition As Boolean)
    If (condition) Then
        Console.WriteLine("Hello World!")
    End If
End Sub
```

### <a name="cyclomatic-complexity-of-3"></a><span data-ttu-id="f6647-135">Complejidad ciclomática de 3</span><span class="sxs-lookup"><span data-stu-id="f6647-135">Cyclomatic complexity of 3</span></span>

```csharp
public void Method(bool condition1, bool condition2)
{
    if (condition1 || condition2)
    {
        Console.WriteLine("Hello World!");
    }
}
```

```vb
Public Sub Method(ByVal condition1 As Boolean, ByVal condition2 As Boolean)
    If (condition1 OrElse condition2) Then
        Console.WriteLine("Hello World!")
    End If
End Sub
```

### <a name="cyclomatic-complexity-of-8"></a><span data-ttu-id="f6647-136">Complejidad ciclomática de 8</span><span class="sxs-lookup"><span data-stu-id="f6647-136">Cyclomatic complexity of 8</span></span>

```csharp
public void Method(DayOfWeek day)
{
    switch (day)
    {
        case DayOfWeek.Monday:
            Console.WriteLine("Today is Monday!");
            break;
        case DayOfWeek.Tuesday:
            Console.WriteLine("Today is Tuesday!");
            break;
        case DayOfWeek.Wednesday:
            Console.WriteLine("Today is Wednesday!");
            break;
        case DayOfWeek.Thursday:
            Console.WriteLine("Today is Thursday!");
            break;
        case DayOfWeek.Friday:
            Console.WriteLine("Today is Friday!");
            break;
        case DayOfWeek.Saturday:
            Console.WriteLine("Today is Saturday!");
            break;
        case DayOfWeek.Sunday:
            Console.WriteLine("Today is Sunday!");
            break;
    }
}
```

```vb
Public Sub Method(ByVal day As DayOfWeek)
    Select Case day
        Case DayOfWeek.Monday
            Console.WriteLine("Today is Monday!")
        Case DayOfWeek.Tuesday
            Console.WriteLine("Today is Tuesday!")
        Case DayOfWeek.Wednesday
            Console.WriteLine("Today is Wednesday!")
        Case DayOfWeek.Thursday
            Console.WriteLine("Today is Thursday!")
        Case DayOfWeek.Friday
            Console.WriteLine("Today is Friday!")
        Case DayOfWeek.Saturday
            Console.WriteLine("Today is Saturday!")
        Case DayOfWeek.Sunday
            Console.WriteLine("Today is Sunday!")
    End Select
End Sub
```

## <a name="related-rules"></a><span data-ttu-id="f6647-137">Reglas relacionadas</span><span class="sxs-lookup"><span data-stu-id="f6647-137">Related rules</span></span>

[<span data-ttu-id="f6647-138">CA1501: Evitar una herencia excesiva</span><span class="sxs-lookup"><span data-stu-id="f6647-138">CA1501: Avoid excessive inheritance</span></span>](ca1501.md)

## <a name="see-also"></a><span data-ttu-id="f6647-139">Vea también</span><span class="sxs-lookup"><span data-stu-id="f6647-139">See also</span></span>

- [<span data-ttu-id="f6647-140">Medir la complejidad y el mantenimiento del código administrado</span><span class="sxs-lookup"><span data-stu-id="f6647-140">Measuring Complexity and Maintainability of Managed Code</span></span>](/visualstudio/code-quality/code-metrics-values)
