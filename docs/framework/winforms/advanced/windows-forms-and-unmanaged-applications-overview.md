---
title: Información general sobre formularios Windows Forms y aplicaciones no administradas
ms.date: 03/30/2017
helpviewer_keywords:
- COM [Windows Forms]
- Windows Forms, unmanaged
- COM interop
- ActiveX controls [Windows Forms], about ActiveX controls
- Windows Forms, interop
ms.assetid: 0a26d99d-8135-4895-8760-c9a2b5f67f14
ms.openlocfilehash: 964597f2e47cee8f61111a684375e73e8a13107d
ms.sourcegitcommit: acd8ed14fe94e9d4e3a7fb685fe83d05e941073c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/20/2019
ms.locfileid: "56442352"
---
# <a name="windows-forms-and-unmanaged-applications-overview"></a><span data-ttu-id="9cfde-102">Información general sobre formularios Windows Forms y aplicaciones no administradas</span><span class="sxs-lookup"><span data-stu-id="9cfde-102">Windows Forms and Unmanaged Applications Overview</span></span>
<span data-ttu-id="9cfde-103">Los controles y aplicaciones de Windows Forms pueden interoperar con aplicaciones no administradas, con algunas advertencias.</span><span class="sxs-lookup"><span data-stu-id="9cfde-103">Windows Forms applications and controls can interoperate with unmanaged applications, with some caveats.</span></span> <span data-ttu-id="9cfde-104">En las secciones siguientes se describen los escenarios y las configuraciones que las aplicaciones y los controles de Windows Forms admiten y no admiten.</span><span class="sxs-lookup"><span data-stu-id="9cfde-104">The following sections describe the scenarios and configurations that Windows Forms applications and controls support and those that they do not support.</span></span>  
  
## <a name="windows-forms-controls-and-activex-applications"></a><span data-ttu-id="9cfde-105">Aplicaciones ActiveX y controles de Windows Forms</span><span class="sxs-lookup"><span data-stu-id="9cfde-105">Windows Forms Controls and ActiveX Applications</span></span>  
 <span data-ttu-id="9cfde-106">Con la excepción de Microsoft Internet Explorer y Microsoft Foundation Classes (MFC), los controles de Windows Forms no se admiten en aplicaciones diseñadas para hospedar controles ActiveX.</span><span class="sxs-lookup"><span data-stu-id="9cfde-106">With the exception of Microsoft Internet Explorer and Microsoft Foundation Classes (MFC), Windows Forms controls are not supported in applications designed to host ActiveX controls.</span></span> <span data-ttu-id="9cfde-107">Otras aplicaciones y herramientas de desarrollo que pueden hospedar controles ActiveX, incluidos los contenedores de prueba de ActiveX de versiones de Visual Studio anteriores a Visual Studio .NET 2003, no son hosts admitidos para controles de Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="9cfde-107">Other applications and development tools that are capable of hosting ActiveX controls, including the ActiveX test containers from versions of Visual Studio that are earlier than Visual Studio .NET 2003, are not supported hosts for Windows Forms controls.</span></span>  
  
 <span data-ttu-id="9cfde-108">Estas restricciones también se aplican al uso de controles de Windows Forms mediante la interoperabilidad del Modelo de objetos componentes (COM).</span><span class="sxs-lookup"><span data-stu-id="9cfde-108">These constraints also apply to the use of Windows Forms controls through Component Object Model COM interop.</span></span> <span data-ttu-id="9cfde-109">El uso de controles de Windows Forms mediante un contenedor COM invocable (CCW) solo se admite en Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="9cfde-109">The use of a Windows Forms control through a COM callable wrapper (CCW) is supported only in Internet Explorer.</span></span> <span data-ttu-id="9cfde-110">Para obtener más información sobre la interoperabilidad COM, consulte</span><span class="sxs-lookup"><span data-stu-id="9cfde-110">For more information about COM interop, see</span></span>  
  
 <span data-ttu-id="9cfde-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).</span><span class="sxs-lookup"><span data-stu-id="9cfde-111">[COM Interop](../../../visual-basic/programming-guide/com-interop/index.md).</span></span>  
  
 <span data-ttu-id="9cfde-112">En la siguiente tabla se muestra que hosts ActiveX admiten controles de Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="9cfde-112">The following table shows the available ActiveX hosting support for Windows Forms controls.</span></span>  
  
|<span data-ttu-id="9cfde-113">Versión de Windows Forms</span><span class="sxs-lookup"><span data-stu-id="9cfde-113">Windows Forms version</span></span>|<span data-ttu-id="9cfde-114">Compatibilidad</span><span class="sxs-lookup"><span data-stu-id="9cfde-114">Support</span></span>|  
|---------------------------|-------------|  
|<span data-ttu-id="9cfde-115">.NET Framework versión 1.0</span><span class="sxs-lookup"><span data-stu-id="9cfde-115">.NET Framework version 1.0</span></span>|<span data-ttu-id="9cfde-116">Internet Explorer 5.01 y versiones posteriores</span><span class="sxs-lookup"><span data-stu-id="9cfde-116">Internet Explorer 5.01 and later versions</span></span>|  
|<span data-ttu-id="9cfde-117">.NET framework versión 1.1 y versiones posteriores</span><span class="sxs-lookup"><span data-stu-id="9cfde-117">.NET Framework version 1.1 and later</span></span>|<span data-ttu-id="9cfde-118">Internet Explorer 5.01 y versiones posteriores</span><span class="sxs-lookup"><span data-stu-id="9cfde-118">Internet Explorer 5.01 and later versions</span></span><br /><br /> <span data-ttu-id="9cfde-119">Microsoft Foundation Classes (MFC) 7.0 y versiones posteriores</span><span class="sxs-lookup"><span data-stu-id="9cfde-119">Microsoft Foundation Classes (MFC) 7.0 and later</span></span>|  
  
## <a name="hosting-windows-forms-components-as-activex-controls"></a><span data-ttu-id="9cfde-120">Hospedaje de componentes de Windows Forms como controles ActiveX</span><span class="sxs-lookup"><span data-stu-id="9cfde-120">Hosting Windows Forms components as ActiveX controls</span></span>  
 <span data-ttu-id="9cfde-121">En .NET Framework 1.1, se amplió la compatibilidad para incluir MFC 7.0 y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="9cfde-121">In the .NET Framework 1.1, support was extended to include MFC 7.0 and later versions.</span></span> <span data-ttu-id="9cfde-122">Esta compatibilidad incluye cualquier contenedor que sea totalmente compatible con el contenedor de controles ActiveX de MFC 7.0 y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="9cfde-122">This support includes any container that is fully compatible with the MFC 7.0 and later ActiveX control container.</span></span>  
  
 <span data-ttu-id="9cfde-123">Sin embargo, no se permite registrar controles de Windows Forms como controles ActiveX.</span><span class="sxs-lookup"><span data-stu-id="9cfde-123">However, registration of Windows Forms controls as ActiveX controls is not supported.</span></span> <span data-ttu-id="9cfde-124">Tampoco se permite llamar al método `com.ms.win32.Ole32.CoCreateInstance` para los controles de Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="9cfde-124">Also, calling the `com.ms.win32.Ole32.CoCreateInstance` method for Windows Forms controls is not supported.</span></span> <span data-ttu-id="9cfde-125">Solo se permite la activación administrada de controles de Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="9cfde-125">Only managed activation of Windows Forms controls is supported.</span></span> <span data-ttu-id="9cfde-126">Una vez creado un control de Windows Forms, puede hospedarlo en una aplicación MFC igual que haría con un control ActiveX.</span><span class="sxs-lookup"><span data-stu-id="9cfde-126">Once you create a Windows Forms control, you can host it in an MFC application just as with an ActiveX control.</span></span>  
  
 <span data-ttu-id="9cfde-127">Para usar controles de Windows Forms en la aplicación no administrada, debe hospedar el CLR usando las API de hospedaje de CLR no administradas o usando las características de interoperabilidad de C++.</span><span class="sxs-lookup"><span data-stu-id="9cfde-127">To use Windows Forms controls in your unmanaged application, you must either host the CLR using the unmanaged CLR hosting APIs or use the C++ interop features.</span></span> <span data-ttu-id="9cfde-128">El procedimiento recomendado es usar las características de interoperabilidad de C++.</span><span class="sxs-lookup"><span data-stu-id="9cfde-128">Using the C++ interop features is the recommended solution.</span></span>  
  
## <a name="windows-forms-in-com-client-applications"></a><span data-ttu-id="9cfde-129">Windows Forms en aplicaciones cliente COM.</span><span class="sxs-lookup"><span data-stu-id="9cfde-129">Windows Forms in COM client applications</span></span>  
 <span data-ttu-id="9cfde-130">Al abrir un Windows Form con una aplicación cliente COM, por ejemplo, una aplicación de Visual Basic 6.0 o una aplicación MFC, el formulario puede tener un comportamiento inesperado.</span><span class="sxs-lookup"><span data-stu-id="9cfde-130">When you open a Windows Form from a COM client application, such as a Visual Basic 6.0 application or an MFC application, the form may behave unexpectedly.</span></span> <span data-ttu-id="9cfde-131">Por ejemplo, al presionar la tecla TAB, el foco no cambia de un control a otro.</span><span class="sxs-lookup"><span data-stu-id="9cfde-131">For example, when you press the TAB key, the focus does not change from one control to another control.</span></span> <span data-ttu-id="9cfde-132">Al presionar la tecla ENTRAR cuando un botón de comando tiene el foco, no se produce el evento <xref:System.Windows.Forms.Control.Click> del botón.</span><span class="sxs-lookup"><span data-stu-id="9cfde-132">When you press the ENTER key while a command button has focus, the button's <xref:System.Windows.Forms.Control.Click> event is not raised.</span></span> <span data-ttu-id="9cfde-133">También puede experimentar un comportamiento inesperado de las pulsaciones de teclas o de la actividad del mouse.</span><span class="sxs-lookup"><span data-stu-id="9cfde-133">You may also experience unexpected behavior for keystrokes or mouse activity.</span></span>  
  
 <span data-ttu-id="9cfde-134">Este comportamiento se produce porque la aplicación no administrada no implementa la compatibilidad con el bucle de mensajes que Windows Forms necesita para funcionar correctamente.</span><span class="sxs-lookup"><span data-stu-id="9cfde-134">This behavior occurs because the unmanaged application does not implement the message loop support that Windows Forms requires to work correctly.</span></span> <span data-ttu-id="9cfde-135">El bucle de mensajes proporcionado por la aplicación cliente COM es diferente del bucle de mensajes de Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="9cfde-135">The message loop provided by the COM client application is fundamentally different from the Windows Forms message loop.</span></span>  
  
 <span data-ttu-id="9cfde-136">El bucle de mensajes de una aplicación en un bucle de programa interno que recupera los mensajes de una cola de mensajes del subproceso, los traduce y, después, los envía a la aplicación para que los controle.</span><span class="sxs-lookup"><span data-stu-id="9cfde-136">An application's message loop is an internal program loop that retrieves messages from a thread's message queue, translates them, and then sends them to the application to be handled.</span></span> <span data-ttu-id="9cfde-137">El bucle de mensajes de un Windows Form no tiene la misma arquitectura que los bucles de mensajes que proporcionan aplicaciones anteriores, como las aplicaciones de Visual Basic 6.0 y las aplicaciones MFC.</span><span class="sxs-lookup"><span data-stu-id="9cfde-137">The message loop for a Windows Form does not have the same architecture as message loops that earlier applications, such as Visual Basic 6.0 applications and MFC applications, provide.</span></span> <span data-ttu-id="9cfde-138">Es posible que los mensajes de ventana que se publican en el bucle de mensajes se controlen de una forma diferente a la que espera el Windows Form.</span><span class="sxs-lookup"><span data-stu-id="9cfde-138">The window messages that are posted to the message loop may be handled differently than the Windows Form expects.</span></span> <span data-ttu-id="9cfde-139">Por lo tanto, se puede producir un comportamiento inesperado.</span><span class="sxs-lookup"><span data-stu-id="9cfde-139">Therefore, unexpected behavior may occur.</span></span> <span data-ttu-id="9cfde-140">Puede que algunas combinaciones de teclas no funcionen, que alguna actividad del mouse no funcione o que algunos eventos no se generen como se esperaba.</span><span class="sxs-lookup"><span data-stu-id="9cfde-140">Some keystroke combinations may not work, some mouse activity may not work, or some events may not be raised as expected.</span></span>  
  
## <a name="resolving-interoperability-issues"></a><span data-ttu-id="9cfde-141">Resolver problemas de interoperabilidad</span><span class="sxs-lookup"><span data-stu-id="9cfde-141">Resolving Interoperability Issues</span></span>  
 <span data-ttu-id="9cfde-142">Puede resolver estos problemas mostrando el formulario en un bucle de mensajes de [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], que se crea con el método <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="9cfde-142">You can resolve these problems by displaying the form on a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="9cfde-143">Para que un Windows Form funcione correctamente con una aplicación cliente COM, debe ejecutarlo en un bucle de mensajes de Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="9cfde-143">To make a Windows Form work correctly from a COM client application, you must run it on a Windows Forms message loop.</span></span> <span data-ttu-id="9cfde-144">Para ello, siga uno de estos procedimientos:</span><span class="sxs-lookup"><span data-stu-id="9cfde-144">To do this, use one of the following approaches:</span></span>  
  
-   <span data-ttu-id="9cfde-145">Use el método <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> para mostrar el Windows Form.</span><span class="sxs-lookup"><span data-stu-id="9cfde-145">Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the Windows Form.</span></span> <span data-ttu-id="9cfde-146">Para obtener más información, vea [Cómo: Admitir la interoperabilidad COM al mostrar Windows Forms con el método ShowDialog](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md).</span><span class="sxs-lookup"><span data-stu-id="9cfde-146">For more information, see [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md).</span></span>  
  
-   <span data-ttu-id="9cfde-147">Muestre cada Windows Form en un nuevo subproceso.</span><span class="sxs-lookup"><span data-stu-id="9cfde-147">Display each Windows Form on a new thread.</span></span> <span data-ttu-id="9cfde-148">Para obtener más información, vea [Cómo: Admitir la interoperabilidad COM al mostrar Windows Forms en su propio subproceso](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span><span class="sxs-lookup"><span data-stu-id="9cfde-148">For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9cfde-149">Vea también</span><span class="sxs-lookup"><span data-stu-id="9cfde-149">See also</span></span>
- [<span data-ttu-id="9cfde-150">Windows Forms and Unmanaged Applications</span><span class="sxs-lookup"><span data-stu-id="9cfde-150">Windows Forms and Unmanaged Applications</span></span>](../../../../docs/framework/winforms/advanced/windows-forms-and-unmanaged-applications.md)
- [<span data-ttu-id="9cfde-151">Interoperabilidad COM</span><span class="sxs-lookup"><span data-stu-id="9cfde-151">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)
- [<span data-ttu-id="9cfde-152">Interoperabilidad COM en aplicaciones .NET Framework</span><span class="sxs-lookup"><span data-stu-id="9cfde-152">COM Interoperability in .NET Framework Applications</span></span>](../../../visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)
- <span data-ttu-id="9cfde-153">[Ejemplos de interoperabilidad COM](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="9cfde-153">[COM Interoperability Samples](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span></span>
- [<span data-ttu-id="9cfde-154">Aximp.exe (Importador de controles ActiveX de Windows Forms)</span><span class="sxs-lookup"><span data-stu-id="9cfde-154">Aximp.exe (Windows Forms ActiveX Control Importer)</span></span>](../../../../docs/framework/tools/aximp-exe-windows-forms-activex-control-importer.md)
- [<span data-ttu-id="9cfde-155">Exponer componentes de .NET Framework en COM</span><span class="sxs-lookup"><span data-stu-id="9cfde-155">Exposing .NET Framework Components to COM</span></span>](../../../../docs/framework/interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="9cfde-156">Empaquetar un ensamblado para COM</span><span class="sxs-lookup"><span data-stu-id="9cfde-156">Packaging an Assembly for COM</span></span>](../../../../docs/framework/interop/packaging-an-assembly-for-com.md)
- [<span data-ttu-id="9cfde-157">Registrar ensamblados con COM</span><span class="sxs-lookup"><span data-stu-id="9cfde-157">Registering Assemblies with COM</span></span>](../../../../docs/framework/interop/registering-assemblies-with-com.md)
- [<span data-ttu-id="9cfde-158">Cómo: Admitir la interoperabilidad COM al mostrar Windows Forms con el método ShowDialog</span><span class="sxs-lookup"><span data-stu-id="9cfde-158">How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method</span></span>](../../../../docs/framework/winforms/advanced/com-interop-by-displaying-a-windows-form-shadow.md)
- [<span data-ttu-id="9cfde-159">Cómo: Admitir la interoperabilidad COM al mostrar Windows Forms en su propio subproceso</span><span class="sxs-lookup"><span data-stu-id="9cfde-159">How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread</span></span>](../../../../docs/framework/winforms/advanced/how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)
