---
title: Contadores de rendimiento y aplicaciones en paralelo en proceso
description: Revise los contadores de rendimiento y las aplicaciones en paralelo en proceso en .NET. Utilice Perfmon.exe para diferenciar los contadores de rendimiento por tiempo de ejecución.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- performance counters
- performance counters,and in-process side-by-side applications
- performance,.NET Framework applications
- performance monitoring,counters
ms.assetid: 6888f9be-c65b-4b03-a07b-df7ebdee2436
ms.openlocfilehash: 5cc3951c65a0be37294324c767a00bc7a35634b8
ms.sourcegitcommit: 78eb25647b0c750cd80354ebd6ce83a60668e22c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/29/2021
ms.locfileid: "99065043"
---
# <a name="performance-counters-and-in-process-side-by-side-applications"></a><span data-ttu-id="e48b6-104">Contadores de rendimiento y aplicaciones en paralelo en proceso</span><span class="sxs-lookup"><span data-stu-id="e48b6-104">Performance Counters and In-Process Side-By-Side Applications</span></span>

<span data-ttu-id="e48b6-105">Con el Monitor de rendimiento (Perfmon.exe), es posible diferenciar los contadores de rendimiento por tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="e48b6-105">Using the Performance Monitor (Perfmon.exe), it is possible to differentiate the performance counters on a per-runtime basis.</span></span> <span data-ttu-id="e48b6-106">En este tema se describe el cambio del Registro necesario para habilitar esta funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="e48b6-106">This topic describes the registry change needed to enable this functionality.</span></span>  
  
## <a name="the-default-behavior"></a><span data-ttu-id="e48b6-107">El comportamiento predeterminado</span><span class="sxs-lookup"><span data-stu-id="e48b6-107">The Default Behavior</span></span>  

 <span data-ttu-id="e48b6-108">De forma predeterminada, el Monitor de rendimiento muestra los contadores de rendimiento según cada aplicación.</span><span class="sxs-lookup"><span data-stu-id="e48b6-108">By default, the Performance Monitor displays performance counters on a per-application basis.</span></span> <span data-ttu-id="e48b6-109">Pero hay dos escenarios en los que esto es problemático:</span><span class="sxs-lookup"><span data-stu-id="e48b6-109">However, there are two scenarios in which this is problematic:</span></span>  
  
- <span data-ttu-id="e48b6-110">Al supervisar dos aplicaciones que tienen el mismo nombre.</span><span class="sxs-lookup"><span data-stu-id="e48b6-110">When you monitor two applications that have the same name.</span></span> <span data-ttu-id="e48b6-111">Por ejemplo, si ambas aplicaciones se denominan myapp.exe, una se mostrará como **myapp** y la otra como **myapp#1** en la columna **Instance**.</span><span class="sxs-lookup"><span data-stu-id="e48b6-111">For example, if both applications are named myapp.exe, one will be displayed as **myapp** and the other as **myapp#1** in the **Instance** column.</span></span> <span data-ttu-id="e48b6-112">En este caso, es difícil que un contador de rendimiento coincida con una aplicación determinada.</span><span class="sxs-lookup"><span data-stu-id="e48b6-112">In this case, it is difficult to match a performance counter to a particular application.</span></span> <span data-ttu-id="e48b6-113">No está claro si los datos recopilados para **myapp#1** hacen referencia a la primera myapp.exe o a la segunda.</span><span class="sxs-lookup"><span data-stu-id="e48b6-113">It is not clear whether the data collected for **myapp#1** refers to the first myapp.exe or the second myapp.exe.</span></span>  
  
- <span data-ttu-id="e48b6-114">Cuando una aplicación usa varias instancias de Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="e48b6-114">When an application uses multiple instances of the common language runtime.</span></span> <span data-ttu-id="e48b6-115">El .NET Framework 4 admite escenarios de hospedaje en paralelo en el proceso; es decir, un único proceso o aplicación puede cargar varias instancias del Common Language Runtime.</span><span class="sxs-lookup"><span data-stu-id="e48b6-115">The .NET Framework 4 supports in-process side-by-side hosting scenarios; that is, a single process or application can load multiple instances of the common language runtime.</span></span> <span data-ttu-id="e48b6-116">Si una aplicación denominada myapp.exe carga dos instancias de tiempo de ejecución, se designarán en la columna **Instance** como **myapp** y **myapp#1** de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="e48b6-116">If a single application named myapp.exe loads two runtime instances, by default, they will be designated in the **Instance** column as **myapp** and **myapp#1**.</span></span> <span data-ttu-id="e48b6-117">En este caso, no está claro si **myapp** y **myapp#1** hacen referencia a dos aplicaciones con el mismo nombre, o a la misma aplicación con dos tiempos de ejecución.</span><span class="sxs-lookup"><span data-stu-id="e48b6-117">In this case, it is not clear whether **myapp** and **myapp#1** refer to two applications with the same name, or to the same application with two runtimes.</span></span> <span data-ttu-id="e48b6-118">Si varias aplicaciones con el mismo nombre cargan varios tiempos de ejecución, la ambigüedad es incluso mayor.</span><span class="sxs-lookup"><span data-stu-id="e48b6-118">If multiple applications with the same name load multiple runtimes, the ambiguity is even greater.</span></span>  
  
 <span data-ttu-id="e48b6-119">Puede establecer una clave del Registro para eliminar esta ambigüedad.</span><span class="sxs-lookup"><span data-stu-id="e48b6-119">You can set a registry key to eliminate this ambiguity.</span></span> <span data-ttu-id="e48b6-120">En el caso de las aplicaciones desarrolladas con el .NET Framework 4, este cambio del registro agrega un identificador de proceso seguido de un identificador de instancia en tiempo de ejecución al nombre de la aplicación en la columna **instancia** .</span><span class="sxs-lookup"><span data-stu-id="e48b6-120">For applications developed using the .NET Framework 4, this registry change adds a process identifier followed by a runtime instance identifier to the application name in the **Instance** column.</span></span> <span data-ttu-id="e48b6-121">En *lugar de la aplicación o* *la #1 de aplicación,* la aplicación se identifica ahora como *Application* _ `p` *processID* \_ `r` *runtimeID* en la columna **Instance** .</span><span class="sxs-lookup"><span data-stu-id="e48b6-121">Instead of *application* or *application*#1, the application is now identified as *application* _`p`*processID*\_`r`*runtimeID* in the **Instance** column.</span></span> <span data-ttu-id="e48b6-122">Si una aplicación se desarrolló con una versión anterior del Common Language Runtime, esa instancia se representa como processID *de \_ aplicación*, `p`  siempre que esté instalado el .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="e48b6-122">If an application was developed using a previous version of the common language runtime, that instance is represented as *application\_*`p`*processID* provided that the .NET Framework 4 is installed.</span></span>  
  
## <a name="performance-counters-for-in-process-side-by-side-applications"></a><span data-ttu-id="e48b6-123">Contadores de rendimiento para aplicaciones en paralelo en proceso</span><span class="sxs-lookup"><span data-stu-id="e48b6-123">Performance Counters for In-Process Side-by-Side Applications</span></span>  

 <span data-ttu-id="e48b6-124">Para administrar los contadores de rendimiento para varias versiones de Common Language Runtime que se hospedan en una sola aplicación, debe cambiar una única clave del Registro, como se muestra en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="e48b6-124">To handle performance counters for multiple common language runtime versions that are hosted in a single application, you must change a single registry key setting, as shown in the following table.</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="e48b6-125">Nombre de clave</span><span class="sxs-lookup"><span data-stu-id="e48b6-125">Key name</span></span>|<span data-ttu-id="e48b6-126">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\\.NETFramework\Performance</span><span class="sxs-lookup"><span data-stu-id="e48b6-126">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\\.NETFramework\Performance</span></span>|  
|<span data-ttu-id="e48b6-127">Nombre del valor</span><span class="sxs-lookup"><span data-stu-id="e48b6-127">Value name</span></span>|<span data-ttu-id="e48b6-128">ProcessNameFormat</span><span class="sxs-lookup"><span data-stu-id="e48b6-128">ProcessNameFormat</span></span>|  
|<span data-ttu-id="e48b6-129">Tipo de valor</span><span class="sxs-lookup"><span data-stu-id="e48b6-129">Value type</span></span>|<span data-ttu-id="e48b6-130">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="e48b6-130">REG_DWORD</span></span>|  
|<span data-ttu-id="e48b6-131">Value</span><span class="sxs-lookup"><span data-stu-id="e48b6-131">Value</span></span>|<span data-ttu-id="e48b6-132">2 (0x00000002)</span><span class="sxs-lookup"><span data-stu-id="e48b6-132">2 (0x00000002)</span></span>|
  
 <span data-ttu-id="e48b6-133">Un valor de 0 para `ProcessNameFormat` indica que el comportamiento predeterminado está habilitado; es decir, Perfmon.exe muestra los contadores de rendimiento según cada aplicación.</span><span class="sxs-lookup"><span data-stu-id="e48b6-133">A value of 0 for `ProcessNameFormat` indicates that the default behavior is enabled; that is, Perfmon.exe displays performance counters on a per-application basis.</span></span> <span data-ttu-id="e48b6-134">Cuando este valor se establece en 2, Perfmon.exe anula la ambigüedad de varias versiones de una aplicación y proporciona contadores de rendimiento por tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="e48b6-134">When you set this value to 2, Perfmon.exe disambiguates multiple versions of an application and provides performance counters on a per-runtime basis.</span></span> <span data-ttu-id="e48b6-135">Cualquier otro valor para la clave del Registro `ProcessNameFormat` no es compatible y se reserva para uso en el futuro.</span><span class="sxs-lookup"><span data-stu-id="e48b6-135">Any other value for the `ProcessNameFormat` registry key setting is unsupported and reserved for future use.</span></span>
  
 <span data-ttu-id="e48b6-136">Después de actualizar el valor de la clave del Registro `ProcessNameFormat`, debe reiniciar Perfmon.exe o cualquier otro consumidor de los contadores de rendimiento para que la nueva característica de asignación de nombres de instancia funcione correctamente.</span><span class="sxs-lookup"><span data-stu-id="e48b6-136">After you update the `ProcessNameFormat` registry key setting, you must restart Perfmon.exe or any other consumers of performance counters so that the new instance naming feature works correctly.</span></span>  
  
 <span data-ttu-id="e48b6-137">En el siguiente ejemplo se muestra cómo cambiar el valor `ProcessNameFormat` mediante programación.</span><span class="sxs-lookup"><span data-stu-id="e48b6-137">The following example shows how to change the `ProcessNameFormat` value programmatically.</span></span>  
  
 [!code-csharp[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/cs/regsetting1.cs#1)]
 [!code-vb[Conceptual.PerfCounters.InProSxS#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.perfcounters.inprosxs/vb/regsetting1.vb#1)]  
  
 <span data-ttu-id="e48b6-138">Cuando realiza este cambio en el registro y si .NET Framework 4 o una versión posterior está instalado, Perfmon.exe muestra los nombres de las aplicaciones como *Application* _ `p` *processID*, donde *Application* es el nombre de la aplicación y *processID* es el identificador de proceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="e48b6-138">When you make this registry change, and if .NET Framework 4 or later is installed, Perfmon.exe displays the names of applications as *application* _`p`*processID*, where *application* is the name of the application, and *processID* is the application's process identifier.</span></span> <span data-ttu-id="e48b6-139">Por ejemplo, si una aplicación llamada myapp.exe carga dos instancias del Common Language Runtime, Perfmon.exe puede identificar una instancia como myapp_1416 y la segunda como myapp_3160.</span><span class="sxs-lookup"><span data-stu-id="e48b6-139">For example, if an application named myapp.exe loads two instances of the common language runtime, Perfmon.exe may identify one instance as myapp_1416 and the second as myapp_3160.</span></span>
  
> [!NOTE]
> <span data-ttu-id="e48b6-140">El identificador de proceso elimina la ambigüedad de resolver dos aplicaciones con el mismo nombre que usan versiones anteriores del tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="e48b6-140">The process identifier eliminates the ambiguity of resolving two applications with the same name that use earlier versions of the runtime.</span></span> <span data-ttu-id="e48b6-141">No se necesita un identificador de tiempo de ejecución para las versiones anteriores, dado que las versiones anteriores de Common Language Runtime no admiten escenarios en paralelo.</span><span class="sxs-lookup"><span data-stu-id="e48b6-141">A runtime identifier is not required for previous versions, because previous versions of the common language runtime do not support side-by-side scenarios.</span></span>  
  
 <span data-ttu-id="e48b6-142">Si el .NET Framework 4 o una versión posterior no está presente o se desinstaló, el establecimiento de la clave del registro no tiene ningún efecto.</span><span class="sxs-lookup"><span data-stu-id="e48b6-142">If the .NET Framework 4 or a later version is not present or was uninstalled, setting the registry key has no effect.</span></span> <span data-ttu-id="e48b6-143">Esto significa que dos aplicaciones con el mismo nombre seguirán apareciendo en Perfmon.exe como *aplicación* y *application#1* (por ejemplo, como **myapp** y **myapp#1**).</span><span class="sxs-lookup"><span data-stu-id="e48b6-143">This means that two applications with the same name will continue to appear in Perfmon.exe as *application* and *application#1* (for example, as **myapp** and **myapp#1**).</span></span>
