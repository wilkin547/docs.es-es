---
title: Regasm.exe (Herramienta de registro de ensamblados)
description: Use Regasm.exe, la Herramienta de registro de ensamblados. Lea los metadatos del ensamblado y agregue las entradas necesarias al registro, lo que permite que los clientes COM creen clases .NET.
ms.date: 03/30/2017
helpviewer_keywords:
- Assembly Registration tool
- assemblies [.NET Framework], registering
- Regasm.exe
- registering assemblies
ms.assetid: e190e342-36ef-4651-a0b4-0e8c2c0281cb
ms.openlocfilehash: 14dbaf0e100204718e78292b038bf016b5607bc8
ms.sourcegitcommit: 9c589b25b005b9a7f87327646020eb85c3b6306f
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 03/06/2021
ms.locfileid: "102259195"
---
# <a name="regasmexe-assembly-registration-tool"></a><span data-ttu-id="0e37e-104">Regasm.exe (Herramienta de registro de ensamblados)</span><span class="sxs-lookup"><span data-stu-id="0e37e-104">Regasm.exe (Assembly Registration Tool)</span></span>

<span data-ttu-id="0e37e-105">La herramienta de registro de ensamblados lee los metadatos de un ensamblado y agrega las entradas necesarias al Registro, lo que permite a los clientes COM crear clases de .NET Framework de forma transparente.</span><span class="sxs-lookup"><span data-stu-id="0e37e-105">The Assembly Registration tool reads the metadata within an assembly and adds the necessary entries to the registry, which allows COM clients to create .NET Framework classes transparently.</span></span> <span data-ttu-id="0e37e-106">Una vez registrada una clase, cualquier cliente COM puede usarla como si se tratase de una clase COM.</span><span class="sxs-lookup"><span data-stu-id="0e37e-106">Once a class is registered, any COM client can use it as though the class were a COM class.</span></span> <span data-ttu-id="0e37e-107">La clase se registra una sola vez, cuando se instala el ensamblado.</span><span class="sxs-lookup"><span data-stu-id="0e37e-107">The class is registered only once, when the assembly is installed.</span></span> <span data-ttu-id="0e37e-108">Las instancias de las clases del ensamblado no se pueden crear a partir de COM si no están registradas.</span><span class="sxs-lookup"><span data-stu-id="0e37e-108">Instances of classes within the assembly cannot be created from COM until they are actually registered.</span></span>

<span data-ttu-id="0e37e-109">Para ejecutar la herramienta, use un [shell de línea de comandos para desarrolladores](/visualstudio/ide/reference/command-prompt-powershell).</span><span class="sxs-lookup"><span data-stu-id="0e37e-109">To run the tool, use a [developer command-line shell](/visualstudio/ide/reference/command-prompt-powershell).</span></span>

<span data-ttu-id="0e37e-110">En el símbolo del sistema, escriba lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="0e37e-110">At the command prompt, type the following:</span></span>

## <a name="syntax"></a><span data-ttu-id="0e37e-111">Sintaxis</span><span class="sxs-lookup"><span data-stu-id="0e37e-111">Syntax</span></span>

```console
regasm assemblyFile [options]
```

## <a name="parameters"></a><span data-ttu-id="0e37e-112">Parámetros</span><span class="sxs-lookup"><span data-stu-id="0e37e-112">Parameters</span></span>

|<span data-ttu-id="0e37e-113">Parámetro</span><span class="sxs-lookup"><span data-stu-id="0e37e-113">Parameter</span></span>|<span data-ttu-id="0e37e-114">Descripción</span><span class="sxs-lookup"><span data-stu-id="0e37e-114">Description</span></span>|
|---------------|-----------------|
|<span data-ttu-id="0e37e-115">*assemblyFile*</span><span class="sxs-lookup"><span data-stu-id="0e37e-115">*assemblyFile*</span></span>|<span data-ttu-id="0e37e-116">El ensamblado que se va a registrar con COM.</span><span class="sxs-lookup"><span data-stu-id="0e37e-116">The assembly to be registered with COM.</span></span>|

|<span data-ttu-id="0e37e-117">Opción</span><span class="sxs-lookup"><span data-stu-id="0e37e-117">Option</span></span>|<span data-ttu-id="0e37e-118">Descripción</span><span class="sxs-lookup"><span data-stu-id="0e37e-118">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="0e37e-119">**/codebase**</span><span class="sxs-lookup"><span data-stu-id="0e37e-119">**/codebase**</span></span>|<span data-ttu-id="0e37e-120">Crea una entrada de código base en el Registro.</span><span class="sxs-lookup"><span data-stu-id="0e37e-120">Creates a Codebase entry in the registry.</span></span> <span data-ttu-id="0e37e-121">La entrada de código base especifica la ruta de acceso del archivo de un ensamblado que no está instalado en la caché global de ensamblados.</span><span class="sxs-lookup"><span data-stu-id="0e37e-121">The Codebase entry specifies the file path for an assembly that's not installed in the global assembly cache.</span></span> <span data-ttu-id="0e37e-122">No especifique esta opción si posteriormente va a instalar el ensamblado que va a registrar en la caché global de ensamblados.</span><span class="sxs-lookup"><span data-stu-id="0e37e-122">Don't specify this option if you will subsequently install the assembly that you're registering into the global assembly cache.</span></span> <span data-ttu-id="0e37e-123">El argumento *assemblyFile* especificado con la opción **/codebase** debe ser un [ensamblado con nombre seguro](../../standard/assembly/strong-named.md).</span><span class="sxs-lookup"><span data-stu-id="0e37e-123">The *assemblyFile* argument that you specify with the **/codebase** option must be a [strong-named assembly](../../standard/assembly/strong-named.md).</span></span>|
|<span data-ttu-id="0e37e-124">**/registered**</span><span class="sxs-lookup"><span data-stu-id="0e37e-124">**/registered**</span></span>|<span data-ttu-id="0e37e-125">Especifica que esta herramienta solo hará referencia a las bibliotecas de tipos que ya se hayan registrado.</span><span class="sxs-lookup"><span data-stu-id="0e37e-125">Specifies that this tool will only refer to type libraries that have already been registered.</span></span>|
|<span data-ttu-id="0e37e-126">**/asmpath:directory**</span><span class="sxs-lookup"><span data-stu-id="0e37e-126">**/asmpath:directory**</span></span>|<span data-ttu-id="0e37e-127">Especifica un directorio que contiene las referencias de ensamblado.</span><span class="sxs-lookup"><span data-stu-id="0e37e-127">Specifies a directory containing assembly references.</span></span> <span data-ttu-id="0e37e-128">Se debe usar con la opción **/regfile**.</span><span class="sxs-lookup"><span data-stu-id="0e37e-128">Must be used with the **/regfile** option.</span></span>|
|<span data-ttu-id="0e37e-129">**/nologo**</span><span class="sxs-lookup"><span data-stu-id="0e37e-129">**/nologo**</span></span>|<span data-ttu-id="0e37e-130">Suprime la presentación de la portada de inicio de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="0e37e-130">Suppresses the Microsoft startup banner display.</span></span>|
|<span data-ttu-id="0e37e-131">**/regfile** [ **:** *regFile*]</span><span class="sxs-lookup"><span data-stu-id="0e37e-131">**/regfile** [**:** *regFile*]</span></span>|<span data-ttu-id="0e37e-132">Genera el archivo .reg especificado para el ensamblado, que contiene las entradas del Registro necesarias.</span><span class="sxs-lookup"><span data-stu-id="0e37e-132">Generates the specified .reg file for the assembly, which contains the needed registry entries.</span></span> <span data-ttu-id="0e37e-133">El hecho de especificar esta opción no cambia el Registro.</span><span class="sxs-lookup"><span data-stu-id="0e37e-133">Specifying this option does not change the registry.</span></span> <span data-ttu-id="0e37e-134">No se puede usar esta opción con las opciones **/u** o **/tlb**.</span><span class="sxs-lookup"><span data-stu-id="0e37e-134">You cannot use this option with the **/u** or **/tlb** options.</span></span>|
|<span data-ttu-id="0e37e-135">**/silent** o **/s**</span><span class="sxs-lookup"><span data-stu-id="0e37e-135">**/silent** or **/s**</span></span>|<span data-ttu-id="0e37e-136">Suprime la presentación de mensajes de aprobación.</span><span class="sxs-lookup"><span data-stu-id="0e37e-136">Suppresses the display of success messages.</span></span>|
|<span data-ttu-id="0e37e-137">**/tlb** [ **:** *typeLibFile*]</span><span class="sxs-lookup"><span data-stu-id="0e37e-137">**/tlb** [**:** *typeLibFile*]</span></span>|<span data-ttu-id="0e37e-138">Genera una biblioteca de tipos a partir del ensamblado especificado que contiene definiciones de los tipos accesibles definidos en el ensamblado.</span><span class="sxs-lookup"><span data-stu-id="0e37e-138">Generates a type library from the specified assembly containing definitions of the accessible types defined within the assembly.</span></span>|
|<span data-ttu-id="0e37e-139">**/unregister** o **/u**</span><span class="sxs-lookup"><span data-stu-id="0e37e-139">**/unregister** or **/u**</span></span>|<span data-ttu-id="0e37e-140">Anula el registro de las clases que se pueden crear que se encuentran en *assemblyFile*.</span><span class="sxs-lookup"><span data-stu-id="0e37e-140">Unregisters the creatable classes found in *assemblyFile*.</span></span> <span data-ttu-id="0e37e-141">Cuando se omite esta opción, Regasm.exe registra en el ensamblado las clases que se pueden crear.</span><span class="sxs-lookup"><span data-stu-id="0e37e-141">Omitting this option causes Regasm.exe to register the creatable classes in the assembly.</span></span>|
|<span data-ttu-id="0e37e-142">**/verbose**</span><span class="sxs-lookup"><span data-stu-id="0e37e-142">**/verbose**</span></span>|<span data-ttu-id="0e37e-143">Especifica el modo detallado; cuando se especifica con la opción **/tlb**, muestra una lista de los ensamblados a los que se hace referencia para los que es necesario generar una biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="0e37e-143">Specifies verbose mode; displays a list of any referenced assemblies for which a type library needs to be generated, when specified with the **/tlb** option.</span></span>|
|<span data-ttu-id="0e37e-144">**/?**</span><span class="sxs-lookup"><span data-stu-id="0e37e-144">**/?**</span></span> <span data-ttu-id="0e37e-145">o **/help**</span><span class="sxs-lookup"><span data-stu-id="0e37e-145">or **/help**</span></span>|<span data-ttu-id="0e37e-146">Muestra las opciones y la sintaxis de los comandos para la herramienta.</span><span class="sxs-lookup"><span data-stu-id="0e37e-146">Displays command syntax and options for the tool.</span></span>|

> [!NOTE]
> <span data-ttu-id="0e37e-147">Las opciones de la línea de comandos de Regasm.exe no distinguen entre mayúsculas y minúsculas.</span><span class="sxs-lookup"><span data-stu-id="0e37e-147">The Regasm.exe command-line options are case insensitive.</span></span> <span data-ttu-id="0e37e-148">Por otra parte, basta con proporcionar parte de la opción de forma que se identifique de manera inequívoca.</span><span class="sxs-lookup"><span data-stu-id="0e37e-148">You only need to provide enough of the option to uniquely identify it.</span></span> <span data-ttu-id="0e37e-149">Por ejemplo, **/n** equivale a **/nologo** y **/t:** *outfile.tlb*, a **/tlb:** *outfile.tlb*.</span><span class="sxs-lookup"><span data-stu-id="0e37e-149">For example, **/n** is equivalent to **/nologo** and **/t:** *outfile.tlb* is equivalent to **/tlb:** *outfile.tlb*.</span></span>

## <a name="remarks"></a><span data-ttu-id="0e37e-150">Comentarios</span><span class="sxs-lookup"><span data-stu-id="0e37e-150">Remarks</span></span>

<span data-ttu-id="0e37e-151">Puede usar la opción **/regfile** para generar un archivo .reg que contenga las entradas del Registro en lugar de hacer los cambios en el Registro directamente.</span><span class="sxs-lookup"><span data-stu-id="0e37e-151">You can use the **/regfile** option to generate a .reg file that contains the registry entries instead of making the changes directly to the registry.</span></span> <span data-ttu-id="0e37e-152">El Registro se puede actualizar en un equipo importando el archivo .reg con la herramienta Editor del Registro (Regedit.exe).</span><span class="sxs-lookup"><span data-stu-id="0e37e-152">You can update the registry on a computer by importing the .reg file with the Registry Editor tool (Regedit.exe).</span></span> <span data-ttu-id="0e37e-153">El archivo .reg no contiene actualizaciones del registro que se puedan realizar mediante funciones de registro definidas por el usuario.</span><span class="sxs-lookup"><span data-stu-id="0e37e-153">The .reg file does not contain any registry updates that can be made by user-defined register functions.</span></span> <span data-ttu-id="0e37e-154">La opción **/regfile** solo emite entradas del registro para clases administradas.</span><span class="sxs-lookup"><span data-stu-id="0e37e-154">The **/regfile** option only emits registry entries for managed classes.</span></span> <span data-ttu-id="0e37e-155">Esta opción no emite entradas del Registro para `TypeLibID` ni `InterfaceID`.</span><span class="sxs-lookup"><span data-stu-id="0e37e-155">This option does not emit entries for `TypeLibID`s or `InterfaceID`s.</span></span>

<span data-ttu-id="0e37e-156">Cuando se especifica la opción **/tlb**, Regasm.exe genera y registra una biblioteca de tipos donde se describen los tipos encontrados en el ensamblado.</span><span class="sxs-lookup"><span data-stu-id="0e37e-156">When you specify the **/tlb** option, Regasm.exe generates and registers a type library describing the types found in the assembly.</span></span> <span data-ttu-id="0e37e-157">Regasm.exe coloca las bibliotecas de tipos generadas en el directorio de trabajo actual o en el directorio especificado para el archivo de salida.</span><span class="sxs-lookup"><span data-stu-id="0e37e-157">Regasm.exe places the generated type libraries in the current working directory or the directory specified for the output file.</span></span> <span data-ttu-id="0e37e-158">La generación de una biblioteca de tipos para un ensamblado que hace referencia a otros ensamblados puede provocar la generación de varias bibliotecas de tipos a la vez.</span><span class="sxs-lookup"><span data-stu-id="0e37e-158">Generating a type library for an assembly that references other assemblies may cause several type libraries to be generated at once.</span></span> <span data-ttu-id="0e37e-159">Puede usar la biblioteca de tipos para proporcionar información de tipos para las herramientas de desarrollo como Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0e37e-159">You can use the type library to provide type information to development tools like Visual Studio.</span></span> <span data-ttu-id="0e37e-160">No use la opción **/tlb** si el ensamblado que se va a registrar lo ha generado la herramienta Importador de la biblioteca de tipos ([Tlbimp.exe](tlbimp-exe-type-library-importer.md)).</span><span class="sxs-lookup"><span data-stu-id="0e37e-160">Don't use the **/tlb** option if the assembly you are registering was produced by the Type Library Importer ([Tlbimp.exe](tlbimp-exe-type-library-importer.md)).</span></span> <span data-ttu-id="0e37e-161">No se puede exportar una biblioteca de tipos de un ensamblado que se ha importado desde una biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="0e37e-161">You cannot export a type library from an assembly that was imported from a type library.</span></span> <span data-ttu-id="0e37e-162">El uso de la opción **/tlb** tiene el mismo efecto que el uso de las herramientas Exportador de la biblioteca de tipos ([Tlbexp.exe](tlbexp-exe-type-library-exporter.md)) y Regasm.exe, con la particularidad de que Tlbexp.exe no registra la biblioteca de tipos que genera.</span><span class="sxs-lookup"><span data-stu-id="0e37e-162">Using the **/tlb** option has the same effect as using the Type Library Exporter ([Tlbexp.exe](tlbexp-exe-type-library-exporter.md)) and Regasm.exe, with the exception that Tlbexp.exe does not register the type library it produces.</span></span>  <span data-ttu-id="0e37e-163">Si usa la opción **/tlb** para registrar una biblioteca de tipos, puede usar la opción **/tlb** con la opción **/unregister** para anular el registro de la biblioteca de tipos.</span><span class="sxs-lookup"><span data-stu-id="0e37e-163">If you use the **/tlb** option to register a type library, you can use the **/tlb** option with the **/unregister** option to unregister the type library.</span></span> <span data-ttu-id="0e37e-164">El uso de las dos opciones juntas anulará el registro de la biblioteca de tipos y de las entradas de la interfaz, lo que puede limpiar considerablemente el Registro.</span><span class="sxs-lookup"><span data-stu-id="0e37e-164">Using the two options together will unregister the type library and interface entries, which can clean the registry considerably.</span></span>

<span data-ttu-id="0e37e-165">Al registrar un ensamblado para que lo use COM, Regasm.exe agrega entradas al Registro del equipo local.</span><span class="sxs-lookup"><span data-stu-id="0e37e-165">When you register an assembly for use by COM, Regasm.exe adds entries to the registry on the local computer.</span></span> <span data-ttu-id="0e37e-166">Más concretamente, crea claves del Registro dependientes de la versión que permiten que varias versiones del mismo ensamblado se ejecuten en paralelo en un equipo.</span><span class="sxs-lookup"><span data-stu-id="0e37e-166">More specifically, it creates version-dependent registry keys that allow multiple versions of the same assembly to run side by side on a computer.</span></span> <span data-ttu-id="0e37e-167">Al registrar un ensamblado por primera vez, se crea una clave de nivel superior para el ensamblado y una subclave única para la versión específica.</span><span class="sxs-lookup"><span data-stu-id="0e37e-167">The first time an assembly is registered, one top-level key is created for the assembly, and a unique subkey is created for the specific version.</span></span> <span data-ttu-id="0e37e-168">Cada vez que se registra una nueva versión del ensamblado, Regasm.exe crea una subclave para la nueva versión.</span><span class="sxs-lookup"><span data-stu-id="0e37e-168">Each time you register a new version of the assembly, Regasm.exe creates a subkey for the new version.</span></span>

<span data-ttu-id="0e37e-169">Por ejemplo, imagine un escenario en el que registra el componente administrado myComp.dll, versión 1.0.0.0, para que lo use COM.</span><span class="sxs-lookup"><span data-stu-id="0e37e-169">For example, consider a scenario where you register the managed component, myComp.dll, version 1.0.0.0 for use by COM.</span></span> <span data-ttu-id="0e37e-170">Posteriormente, registra myComp.dll, versión 2.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="0e37e-170">Later, you register myComp.dll, version 2.0.0.0.</span></span> <span data-ttu-id="0e37e-171">Determina que todas las aplicaciones de cliente COM del equipo están usando myComp.dll versión 2.0.0.0 y decide anular el registro de myComponent.dll versión 1.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="0e37e-171">You determine that all COM client applications on the computer are using myComp.dll version 2.0.0.0 and you decide to unregister myComponent.dll version 1.0.0.0.</span></span> <span data-ttu-id="0e37e-172">Este esquema del Registro permite anular el registro de myComp.dll versión 1.0.0.0 porque solo se quita la subclave de la versión 1.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="0e37e-172">This registry scheme allows you to unregister myComp.dll version 1.0.0.0 because only the version 1.0.0.0 subkey is removed.</span></span>

<span data-ttu-id="0e37e-173">Después de registrar un ensamblado mediante Regasm.exe, puede instalarlo en la [caché global de ensamblados](../app-domains/gac.md) para que se pueda activar desde cualquier cliente COM.</span><span class="sxs-lookup"><span data-stu-id="0e37e-173">After registering an assembly using Regasm.exe, you can install it in the [global assembly cache](../app-domains/gac.md) so that it can be activated from any COM client.</span></span> <span data-ttu-id="0e37e-174">Si el ensamblado solo va a activar una única una aplicación, se puede colocar en el directorio de dicha aplicación.</span><span class="sxs-lookup"><span data-stu-id="0e37e-174">If the assembly is only going to be activated by a single application, you can place it in that application's directory.</span></span>

## <a name="examples"></a><span data-ttu-id="0e37e-175">Ejemplos</span><span class="sxs-lookup"><span data-stu-id="0e37e-175">Examples</span></span>

<span data-ttu-id="0e37e-176">El comando siguiente registra todas las clases públicas contenidas en `myTest.dll`.</span><span class="sxs-lookup"><span data-stu-id="0e37e-176">The following command registers all public classes contained in `myTest.dll`.</span></span>

```console
regasm myTest.dll
```

<span data-ttu-id="0e37e-177">El comando siguiente genera el archivo `myTest.reg`, que contiene todas las entradas del Registro necesarias.</span><span class="sxs-lookup"><span data-stu-id="0e37e-177">The following command generates the file `myTest.reg`, which contains all the necessary registry entries.</span></span> <span data-ttu-id="0e37e-178">Este comando no actualiza el Registro.</span><span class="sxs-lookup"><span data-stu-id="0e37e-178">This command does not update the registry.</span></span>

```console
regasm myTest.dll /regfile:myTest.reg
```

<span data-ttu-id="0e37e-179">El comando siguiente registra todas las clases públicas contenidas en `myTest.dll`, y genera y registra la biblioteca de tipos `myTest.tlb`, que contiene definiciones de todos los tipos públicos definidos en `myTest.dll`.</span><span class="sxs-lookup"><span data-stu-id="0e37e-179">The following command registers all public classes contained in `myTest.dll`, and generates and registers the type library `myTest.tlb`, which contains definitions of all the public types defined in `myTest.dll`.</span></span>

```console
regasm myTest.dll /tlb:myTest.tlb
```

## <a name="see-also"></a><span data-ttu-id="0e37e-180">Vea también</span><span class="sxs-lookup"><span data-stu-id="0e37e-180">See also</span></span>

- [<span data-ttu-id="0e37e-181">Herramientas</span><span class="sxs-lookup"><span data-stu-id="0e37e-181">Tools</span></span>](index.md)
- [<span data-ttu-id="0e37e-182">Tlbexp.exe (Exportador de la biblioteca de tipos)</span><span class="sxs-lookup"><span data-stu-id="0e37e-182">Tlbexp.exe (Type Library Exporter)</span></span>](tlbexp-exe-type-library-exporter.md)
- [<span data-ttu-id="0e37e-183">TlbImp.exe (Importador de la biblioteca de tipos)</span><span class="sxs-lookup"><span data-stu-id="0e37e-183">Tlbimp.exe (Type Library Importer)</span></span>](tlbimp-exe-type-library-importer.md)
- [<span data-ttu-id="0e37e-184">Registrar ensamblados con COM</span><span class="sxs-lookup"><span data-stu-id="0e37e-184">Registering Assemblies with COM</span></span>](../interop/registering-assemblies-with-com.md)
- [<span data-ttu-id="0e37e-185">Shells de línea de comandos para desarrolladores</span><span class="sxs-lookup"><span data-stu-id="0e37e-185">Developer command-line shells</span></span>](/visualstudio/ide/reference/command-prompt-powershell)
