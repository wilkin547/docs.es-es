---
title: Arquitectura de Windows Workflow
description: Windows Workflow Foundation encapsula unidades de trabajo como actividades, que se ejecutan en un entorno con control de flujo, control de excepciones y otras características.
ms.date: 03/30/2017
ms.assetid: 1d4c6495-d64a-46d0-896a-3a01fac90aa9
ms.openlocfilehash: 22ebeb7d95342ad6843e0721da8b213ed4a4d9b6
ms.sourcegitcommit: 9a4488a3625866335e83a20da5e9c5286b1f034c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/15/2020
ms.locfileid: "83420141"
---
# <a name="windows-workflow-architecture"></a><span data-ttu-id="d3fab-103">Arquitectura de Windows Workflow</span><span class="sxs-lookup"><span data-stu-id="d3fab-103">Windows Workflow Architecture</span></span>
<span data-ttu-id="d3fab-104">Windows Workflow Foundation (WF) eleva el nivel de abstracción para desarrollar aplicaciones interactivas de ejecución prolongada.</span><span class="sxs-lookup"><span data-stu-id="d3fab-104">Windows Workflow Foundation (WF) raises the abstraction level for developing interactive long-running applications.</span></span> <span data-ttu-id="d3fab-105">Las unidades de trabajo se encapsulan como actividades.</span><span class="sxs-lookup"><span data-stu-id="d3fab-105">Units of work are encapsulated as activities.</span></span> <span data-ttu-id="d3fab-106">Las actividades se ejecutan en un entorno que proporcione los medios para el control de flujo, el control de excepciones, la propagación de errores, la persistencia de los datos de estado, la carga y descarga de flujos de trabajo en progreso de la memoria, el seguimiento y el flujo de la transacción.</span><span class="sxs-lookup"><span data-stu-id="d3fab-106">Activities run in an environment that provides facilities for flow control, exception handling, fault propagation, persistence of state data, loading and unloading of in-progress workflows from memory, tracking, and transaction flow.</span></span>  
  
## <a name="activity-architecture"></a><span data-ttu-id="d3fab-107">Arquitectura de la actividad</span><span class="sxs-lookup"><span data-stu-id="d3fab-107">Activity Architecture</span></span>  
 <span data-ttu-id="d3fab-108">Las actividades se desarrollan como tipos CLR que derivan de <xref:System.Activities.Activity>, <xref:System.Activities.CodeActivity>, <xref:System.Activities.AsyncCodeActivity>, o sus variantes que devuelven un valor, <xref:System.Activities.NativeActivity>, <xref:System.Activities.Activity%601>, <xref:System.Activities.CodeActivity%601>, <xref:System.Activities.AsyncCodeActivity%601> o <xref:System.Activities.NativeActivity%601>.</span><span class="sxs-lookup"><span data-stu-id="d3fab-108">Activities are developed as CLR types that derive from either <xref:System.Activities.Activity>, <xref:System.Activities.CodeActivity>, <xref:System.Activities.AsyncCodeActivity>, or <xref:System.Activities.NativeActivity>, or their variants that return a value, <xref:System.Activities.Activity%601>, <xref:System.Activities.CodeActivity%601>, <xref:System.Activities.AsyncCodeActivity%601>, or <xref:System.Activities.NativeActivity%601>.</span></span> <span data-ttu-id="d3fab-109">Desarrollar actividades que derivan de <xref:System.Activities.Activity> le permite al usuario ensamblar actividades existentes previamente para crear las unidades de trabajo que se ejecutan en el entorno del flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="d3fab-109">Developing activities that derive from <xref:System.Activities.Activity> allows the user to assemble pre-existing activities to quickly create units of work that execute in the workflow environment.</span></span> <span data-ttu-id="d3fab-110"><xref:System.Activities.CodeActivity>, por otro lado, permite crear la lógica de ejecución en código administrado usando principalmente <xref:System.Activities.CodeActivityContext> para el acceso a los argumentos de actividad.</span><span class="sxs-lookup"><span data-stu-id="d3fab-110"><xref:System.Activities.CodeActivity>, on the other hand, enables execution logic to be authored in managed code using <xref:System.Activities.CodeActivityContext> primarily for access to activity arguments.</span></span> <span data-ttu-id="d3fab-111"><xref:System.Activities.AsyncCodeActivity> es similar a <xref:System.Activities.CodeActivity> salvo que puede usarse para implementar tareas asincrónicas.</span><span class="sxs-lookup"><span data-stu-id="d3fab-111"><xref:System.Activities.AsyncCodeActivity> is similar to <xref:System.Activities.CodeActivity> except that it can be used to implement asynchronous tasks.</span></span> <span data-ttu-id="d3fab-112">Desarrollar actividades que derivan de <xref:System.Activities.NativeActivity> permite a los usuarios tener acceso al runtime a través de <xref:System.Activities.NativeActivityContext> para funciones como la programación de elementos secundarios, la creación de marcadores, invocar el trabajo asincrónico, el registro de transacciones y mucho más.</span><span class="sxs-lookup"><span data-stu-id="d3fab-112">Developing activities that derive from <xref:System.Activities.NativeActivity> allows users to access the runtime through the <xref:System.Activities.NativeActivityContext> for functionality like scheduling children, creating bookmarks, invoking asynchronous work, registering transactions, and more.</span></span>  
  
 <span data-ttu-id="d3fab-113">La creación de actividades que derivan de <xref:System.Activities.Activity> es declarativo. Estas actividades se pueden crear en XAML.</span><span class="sxs-lookup"><span data-stu-id="d3fab-113">Authoring activities that derive from <xref:System.Activities.Activity> is declarative and these activities can be authored in XAML.</span></span> <span data-ttu-id="d3fab-114">En el siguiente ejemplo, una actividad llamada `Prompt` se crea usando otras actividades para el cuerpo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="d3fab-114">In the following example, an activity called `Prompt` is created using other activities for the execution body.</span></span>  
  
```xml  
<Activity x:Class='Prompt'  
  xmlns:x='http://schemas.microsoft.com/winfx/2006/xaml'  
    xmlns:z='http://schemas.microsoft.com/netfx/2008/xaml/schema'  
xmlns:my='clr-namespace:XAMLActivityDefinition;assembly=XAMLActivityDefinition'  
xmlns:s="clr-namespace:System;assembly=mscorlib"  
xmlns="http://schemas.microsoft.com/2009/workflow">  
<z:SchemaType.Members>  
    <z:SchemaType.SchemaProperty Name='Text' Type=' InArgument(s:String)' />  
  <z:SchemaType.SchemaProperty Name='Response' Type='OutArgument(s:String)' />  
</z:SchemaType.Members>  
  <Sequence>  
    <my:WriteLine Text='[Text]' />  
    <my:ReadLine BookmarkName='r1' Result='[Response]' />  
  </Sequence>  
</Activity>  
```  
  
## <a name="activity-context"></a><span data-ttu-id="d3fab-115">Contexto de actividad</span><span class="sxs-lookup"><span data-stu-id="d3fab-115">Activity Context</span></span>  
 <span data-ttu-id="d3fab-116"><xref:System.Activities.ActivityContext> es la interfaz del autor de la actividad en el tiempo de ejecución del flujo de trabajo y proporciona acceso a la amplia variedad de características del tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="d3fab-116">The <xref:System.Activities.ActivityContext> is the activity author's interface to the workflow runtime and provides access to the runtime's wealth of features.</span></span> <span data-ttu-id="d3fab-117">En el siguiente ejemplo, se define una actividad que usa el contexto de ejecución para crear un marcador (el mecanismo que permite a una actividad registrar un punto de continuación en su ejecución y que puede reanudarse mediante el paso de datos a la actividad por parte de un host).</span><span class="sxs-lookup"><span data-stu-id="d3fab-117">In the following example, an activity is defined that uses the execution context to create a bookmark (the mechanism that allows an activity to register a continuation point in its execution that can be resumed by a host passing data into the activity).</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#15](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#15)]  
  
## <a name="activity-life-cycle"></a><span data-ttu-id="d3fab-118">Ciclo de vida de la actividad</span><span class="sxs-lookup"><span data-stu-id="d3fab-118">Activity Life Cycle</span></span>  
 <span data-ttu-id="d3fab-119">La instancia de una actividad empieza en el estado <xref:System.Activities.ActivityInstanceState.Executing>.</span><span class="sxs-lookup"><span data-stu-id="d3fab-119">An instance of an activity starts out in the <xref:System.Activities.ActivityInstanceState.Executing> state.</span></span> <span data-ttu-id="d3fab-120">A menos que se encuentren excepciones, permanece en este estado hasta que todas las actividades secundarias se hayan terminado de ejecutar y se hayan completado otros trabajos pendientes (objetos <xref:System.Activities.Bookmark>, por ejemplo). Una vez llegado este punto, cambia al estado <xref:System.Activities.ActivityInstanceState.Closed>.</span><span class="sxs-lookup"><span data-stu-id="d3fab-120">Unless exceptions are encountered, it remains in this state until all child activities are finished executing and any other pending work (<xref:System.Activities.Bookmark> objects, for instance) is completed, at which point it transitions to the <xref:System.Activities.ActivityInstanceState.Closed> state.</span></span> <span data-ttu-id="d3fab-121">El elemento primario de una instancia de actividad puede pedir a un elemento secundario que cancele; si el elemento secundario puede cancelarse, se completa en el estado <xref:System.Activities.ActivityInstanceState.Canceled>.</span><span class="sxs-lookup"><span data-stu-id="d3fab-121">The parent of an activity instance can request a child to cancel; if the child is able to be canceled it completes in the <xref:System.Activities.ActivityInstanceState.Canceled> state.</span></span> <span data-ttu-id="d3fab-122">Si una excepción se produce durante la ejecución, el tiempo en ejecución coloca la actividad <xref:System.Activities.ActivityInstanceState.Faulted> en el estado de error y propaga la excepción a la cadena primaria de actividades.</span><span class="sxs-lookup"><span data-stu-id="d3fab-122">If an exception is thrown during execution, the runtime puts the activity into the <xref:System.Activities.ActivityInstanceState.Faulted> state and propagates the exception up the parent chain of activities.</span></span> <span data-ttu-id="d3fab-123">A continuación se muestran los tres Estados de finalización de una actividad:</span><span class="sxs-lookup"><span data-stu-id="d3fab-123">The following are the three completion states of an activity:</span></span>
  
- <span data-ttu-id="d3fab-124">**Cerrado:** La actividad ha completado su trabajo y ha salido.</span><span class="sxs-lookup"><span data-stu-id="d3fab-124">**Closed:** The activity has completed its work and exited.</span></span>  
  
- <span data-ttu-id="d3fab-125">**Cancelado:** La actividad ha abandonado correctamente su trabajo y ha salido.</span><span class="sxs-lookup"><span data-stu-id="d3fab-125">**Canceled:** The activity has gracefully abandoned its work and exited.</span></span> <span data-ttu-id="d3fab-126">En este estado, el trabajo no se revierte de manera explícita.</span><span class="sxs-lookup"><span data-stu-id="d3fab-126">Work is not explicitly rolled back when this state is entered.</span></span>  
  
- <span data-ttu-id="d3fab-127">Con **errores:** La actividad ha encontrado un error y ha salido sin completar su trabajo.</span><span class="sxs-lookup"><span data-stu-id="d3fab-127">**Faulted:** The activity has encountered an error and has exited without completing its work.</span></span>  
  
 <span data-ttu-id="d3fab-128">Las actividades permanecen en el estado <xref:System.Activities.ActivityInstanceState.Executing> cuando se conservan o descargan.</span><span class="sxs-lookup"><span data-stu-id="d3fab-128">Activities remain in the <xref:System.Activities.ActivityInstanceState.Executing> state when they are persisted or unloaded.</span></span>
