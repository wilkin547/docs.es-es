---
description: 'Más información sobre: procedimientos recomendados de persistencia'
title: Procedimientos recomendados de persistencia
ms.date: 03/30/2017
ms.assetid: 6974c5a4-1af8-4732-ab53-7d694608a3a0
ms.openlocfilehash: 788c025d52e504e7a767a4aa0841ae01a7d3327c
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/06/2021
ms.locfileid: "99787882"
---
# <a name="persistence-best-practices"></a><span data-ttu-id="bb196-103">Procedimientos recomendados de persistencia</span><span class="sxs-lookup"><span data-stu-id="bb196-103">Persistence Best Practices</span></span>

<span data-ttu-id="bb196-104">Este documento trata de los procedimientos recomendados el diseño de flujo de trabajo y de la configuración relacionada con la persistencia del flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="bb196-104">This document covers best practices for workflow design and configuration related to workflow persistence.</span></span>  
  
## <a name="design-and-implementation-of-durable-workflows"></a><span data-ttu-id="bb196-105">Diseño e implementación de flujos de trabajo duraderos</span><span class="sxs-lookup"><span data-stu-id="bb196-105">Design and Implementation of Durable Workflows</span></span>  

 <span data-ttu-id="bb196-106">En general, los flujos de trabajo realizan el trabajo en períodos breves que se intercalan con tiempos durante los que el flujo de trabajo está inactivo porque está esperando un evento.</span><span class="sxs-lookup"><span data-stu-id="bb196-106">In general, workflows perform work in short periods that are interleaved with times during which the workflow is idle because it is waiting for an event.</span></span> <span data-ttu-id="bb196-107">Este evento puede ser varias cosas, como un mensaje o un temporizador de límite.</span><span class="sxs-lookup"><span data-stu-id="bb196-107">This event can be such things as a message or an expiring timer.</span></span> <span data-ttu-id="bb196-108">Para poder descargar la instancia de flujo de trabajo cuando se vuelve inactivo, el host del servicio debe guardar la instancia de flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="bb196-108">To be able to unload the workflow instance when it becomes idle, the service host must persist the workflow instance.</span></span> <span data-ttu-id="bb196-109">Esto solo es posible si la instancia de flujo de trabajo no está en un zona sin persistencia (por ejemplo, esperando a que se complete una transacción complete o una devolución de llamada asincrónica).</span><span class="sxs-lookup"><span data-stu-id="bb196-109">This is possible only if the workflow instance is not in a no-persist zone (for example, waiting for a transaction to complete, or waiting for an asynchronous callback).</span></span> <span data-ttu-id="bb196-110">Para permitir la descarga de una instancia de flujo de trabajo inactiva, el autor del flujo de trabajo solo debería utilizar ámbitos de transacción y actividades asincrónicas para acciones efímeras.</span><span class="sxs-lookup"><span data-stu-id="bb196-110">To allow an idle workflow instance to unload, the workflow author should use transaction scopes and asynchronous activities for short-lived actions only.</span></span> <span data-ttu-id="bb196-111">En particular, el autor debería mantener lo más breves posible las actividades de retraso dentro de estas zonas sin persistencia.</span><span class="sxs-lookup"><span data-stu-id="bb196-111">In particular, the author should keep delay activities within these no-persist zones as short as possible.</span></span>  
  
 <span data-ttu-id="bb196-112">Solo se puede conservar un flujo de trabajo si todos los tipos de datos utilizados por el flujo de trabajo son serializables.</span><span class="sxs-lookup"><span data-stu-id="bb196-112">A workflow can only be persisted if all of the data types used by the workflow are serializable.</span></span> <span data-ttu-id="bb196-113">Además, los tipos personalizados utilizados en los flujos de trabajo persistentes deben ser serializables con <xref:System.Runtime.Serialization.NetDataContractSerializer> para que sean conservados por <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>.</span><span class="sxs-lookup"><span data-stu-id="bb196-113">In addition, custom types used in persisted workflows must be serializable with <xref:System.Runtime.Serialization.NetDataContractSerializer> in order to be persisted by <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>.</span></span>  
  
 <span data-ttu-id="bb196-114">Una instancia de flujo de trabajo no se puede recuperar en caso de un error de host o equipo si no se ha conservado.</span><span class="sxs-lookup"><span data-stu-id="bb196-114">A workflow instance cannot be recovered in case of a host or computer failure if it has not been persisted.</span></span> <span data-ttu-id="bb196-115">En general, recomendamos que conserve una instancia de flujo de trabajo al principio del ciclo de vida del flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="bb196-115">In general, we recommend that you persist a workflow instance early in the workflow’s life cycle.</span></span>  
  
 <span data-ttu-id="bb196-116">Si su flujo de trabajo está ocupado durante mucho tiempo, le recomendamos conservar la instancia de flujo de trabajo con regularidad a lo largo de su período ocupación.</span><span class="sxs-lookup"><span data-stu-id="bb196-116">If your workflow is busy for a long time, we recommend that you persist the workflow instance regularly throughout its busy period.</span></span> <span data-ttu-id="bb196-117">Puede hacer esto agregando las actividades <xref:System.Activities.Statements.Persist> a lo largo de la secuencia de actividades que mantienen ocupada la instancia de flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="bb196-117">You can do this by adding <xref:System.Activities.Statements.Persist> activities throughout the sequence of activities that keep the workflow instance busy.</span></span> <span data-ttu-id="bb196-118">De esta manera, reciclando el dominio de la aplicación, los errores del host o del equipo no hacen que el sistema revierta hasta el inicio del período de ocupación.</span><span class="sxs-lookup"><span data-stu-id="bb196-118">In this manner, application domain recycling, host failures, or computer failures do not cause the system to be rolled back to the start of the busy period.</span></span> <span data-ttu-id="bb196-119">Sea consciente de que agregar las actividades <xref:System.Activities.Statements.Persist> a su flujo de trabajo podría provocar una degradación del rendimiento.</span><span class="sxs-lookup"><span data-stu-id="bb196-119">Be aware that adding <xref:System.Activities.Statements.Persist> activities to your workflow could lead to a degradation of performance.</span></span>  
  
 <span data-ttu-id="bb196-120">Windows Server App Fabric simplifica mucho la configuración y el uso de la persistencia.</span><span class="sxs-lookup"><span data-stu-id="bb196-120">Windows Server App Fabric greatly simplifies the configuration and use of persistence.</span></span> <span data-ttu-id="bb196-121">Para obtener más información, consulte [persistencia de Windows Server App fabric](/previous-versions/appfabric/ee677272(v=azure.10)) .</span><span class="sxs-lookup"><span data-stu-id="bb196-121">For more information, see [Windows Server App Fabric Persistence](/previous-versions/appfabric/ee677272(v=azure.10))</span></span>  
  
## <a name="configuration-of-scalability-parameters"></a><span data-ttu-id="bb196-122">Configuración de los parámetros de escalabilidad</span><span class="sxs-lookup"><span data-stu-id="bb196-122">Configuration of Scalability Parameters</span></span>  

 <span data-ttu-id="bb196-123">Los requisitos de escalabilidad y rendimiento determinan la configuración de los siguientes parámetros:</span><span class="sxs-lookup"><span data-stu-id="bb196-123">Scalability and performance requirements determine the settings of the following parameters:</span></span>  
  
- <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A>  
  
- <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A>  
  
- <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A>  
  
 <span data-ttu-id="bb196-124">Estos parámetros se deberían establecer como sigue, según sea el escenario.</span><span class="sxs-lookup"><span data-stu-id="bb196-124">These parameters should be set as follows, according to the current scenario.</span></span>  
  
### <a name="scenario-a-small-number-of-workflow-instances-that-require-optimal-response-time"></a><span data-ttu-id="bb196-125">Escenario: un número pequeño de instancias de flujo de trabajo que requieren un tiempo de respuesta óptimo</span><span class="sxs-lookup"><span data-stu-id="bb196-125">Scenario: A Small Number of Workflow Instances That Require Optimal Response Time</span></span>  

 <span data-ttu-id="bb196-126">En este escenario, todas las instancias de flujo de trabajo deberían permanecer cargadas cuando se vuelven inactivas.</span><span class="sxs-lookup"><span data-stu-id="bb196-126">In this scenario, all workflow instances should remain loaded when they become idle.</span></span> <span data-ttu-id="bb196-127">Establezca <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> en un valor grande.</span><span class="sxs-lookup"><span data-stu-id="bb196-127">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to a large value.</span></span> <span data-ttu-id="bb196-128">El uso de esta configuración evita que una instancia de flujo de trabajo se mueva entre equipos.</span><span class="sxs-lookup"><span data-stu-id="bb196-128">The use of this setting prevents a workflow instance from moving between computers.</span></span> <span data-ttu-id="bb196-129">Utilice esta configuración solo se se cumplen una o más de las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="bb196-129">Use this setting only if one or more of the following are true:</span></span>  
  
- <span data-ttu-id="bb196-130">Una instancia de flujo de trabajo recibe un mensaje único a lo largo de su duración.</span><span class="sxs-lookup"><span data-stu-id="bb196-130">A workflow instance receives a single message throughout its lifetime.</span></span>  
  
- <span data-ttu-id="bb196-131">Todas las instancias de flujo de trabajo se ejecutan en un solo equipo</span><span class="sxs-lookup"><span data-stu-id="bb196-131">All workflow instances run on a single computer</span></span>  
  
- <span data-ttu-id="bb196-132">El mismo equipo recibe todos los mensajes que son recibidos por una instancia de flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="bb196-132">All messages that are received by a workflow instance are received by the same computer.</span></span>  
  
 <span data-ttu-id="bb196-133">Utilice las actividades <xref:System.Activities.Statements.Persist> o establezca <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> en 0 para habilitar la recuperación de su instancia de flujo de trabajo después de errores en el host de servicio o en el equipo.</span><span class="sxs-lookup"><span data-stu-id="bb196-133">Use <xref:System.Activities.Statements.Persist> activities or set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> to 0 to enable recovery of your workflow instance after service host or computer failures.</span></span>  
  
### <a name="scenario-workflow-instances-are-idle-for-long-periods-of-time"></a><span data-ttu-id="bb196-134">Escenario: las instancias de flujo de trabajo están inactivas durante largos períodos de tiempo</span><span class="sxs-lookup"><span data-stu-id="bb196-134">Scenario: Workflow Instances Are Idle for Long Periods of Time</span></span>  

 <span data-ttu-id="bb196-135">En este escenario, establezca <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> en 0 para liberar los recursos lo antes posible.</span><span class="sxs-lookup"><span data-stu-id="bb196-135">In this scenario, set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 0 to release resources as soon as possible.</span></span>  
  
### <a name="scenario-workflow-instances-receive-multiple-messages-in-a-short-period-of-time"></a><span data-ttu-id="bb196-136">Escenario: las instancias de flujo de trabajo reciben varios mensajes en un período de tiempo corto</span><span class="sxs-lookup"><span data-stu-id="bb196-136">Scenario: Workflow Instances Receive Multiple Messages in a Short Period of Time</span></span>  

 <span data-ttu-id="bb196-137">En este escenario, establezca <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> en 60 segundos si el mismo equipo recibe estos mensajes.</span><span class="sxs-lookup"><span data-stu-id="bb196-137">In this scenario, set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 60 seconds if these messages are received by the same computer.</span></span> <span data-ttu-id="bb196-138">Esto evita una secuencia rápida de descarga y carga de una instancia de flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="bb196-138">This prevents a rapid sequence of unloading and loading of a workflow instance.</span></span> <span data-ttu-id="bb196-139">Esto permite que la instancia no se mantenga demasiado tiempo en memoria.</span><span class="sxs-lookup"><span data-stu-id="bb196-139">This also does not keep the instance in memory for too long.</span></span>  
  
 <span data-ttu-id="bb196-140">Establezca <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> en 0 y <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A> en BasicRetry o AggressiveRetry si estos mensajes pueden ser recibidos por equipos diferentes.</span><span class="sxs-lookup"><span data-stu-id="bb196-140">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 0, and set <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A> to BasicRetry or AggressiveRetry if these messages may be received by different computers.</span></span> <span data-ttu-id="bb196-141">Esto permite que la instancia de flujo de trabajo pueda ser cargada por otro equipo.</span><span class="sxs-lookup"><span data-stu-id="bb196-141">This allows the workflow instance to be loaded by another computer.</span></span>  
  
### <a name="scenario-workflow-uses-delay-activities-with-short-durations"></a><span data-ttu-id="bb196-142">Escenario: el flujo de trabajo utiliza las actividades de retraso con duraciones cortas</span><span class="sxs-lookup"><span data-stu-id="bb196-142">Scenario: Workflow Uses Delay Activities with Short Durations</span></span>  

 <span data-ttu-id="bb196-143">En este escenario, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> sondea regularmente la base de datos de persistencia buscando las instancias que se deberían cargar por una actividad <xref:System.Activities.Statements.Delay> expirada.</span><span class="sxs-lookup"><span data-stu-id="bb196-143">In this scenario, the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> regularly polls the persistence database for instances that should be loaded because of an expired <xref:System.Activities.Statements.Delay> activity.</span></span> <span data-ttu-id="bb196-144">Si <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> encuentra un temporizador que expirará en el intervalo de sondeo siguiente, el Almacén de instancias de flujo de trabajo de SQL acorta el intervalo de sondeo.</span><span class="sxs-lookup"><span data-stu-id="bb196-144">If the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> finds a timer that will expire in the next polling interval, the SQL Workflow Instance Store shortens the polling interval.</span></span> <span data-ttu-id="bb196-145">El siguiente sondeo se producirá después de que el temporizador haya expirado.</span><span class="sxs-lookup"><span data-stu-id="bb196-145">The next poll will then occur right after the timer has expired.</span></span> <span data-ttu-id="bb196-146">De esta manera, el el Almacén de instancias de flujo de trabajo de SQL logra una gran exactitud de temporizadores que se ejecutan durante más tiempo que el intervalo de sondeo, que es establecida por <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span><span class="sxs-lookup"><span data-stu-id="bb196-146">This way, the SQL Workflow Instance Store achieves a high accuracy of timers that run longer than the polling interval, which is set by <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span></span> <span data-ttu-id="bb196-147">Para habilitar el procesamiento oportuno de los retrasos más cortos, la instancia de flujo de trabajo debe permanecer en memoria durante al menos un intervalo de sondeo.</span><span class="sxs-lookup"><span data-stu-id="bb196-147">To enable timely processing of shorter delays, the workflow instance must remain in memory for at least one polling interval.</span></span>  
  
 <span data-ttu-id="bb196-148">Establezca <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> en 0 para escribir la fecha de expiración en la base de datos de persistencia.</span><span class="sxs-lookup"><span data-stu-id="bb196-148">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> to 0 to write the expiration time to the persistence database.</span></span>  
  
 <span data-ttu-id="bb196-149">Establezca <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> para que dure más o igual que <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, para que la instancia se mantenga en memoria por lo menos durante un intervalo de sondeo.</span><span class="sxs-lookup"><span data-stu-id="bb196-149">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to longer than or equal to <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to keep the instance in memory for at least one polling interval.</span></span>  
  
 <span data-ttu-id="bb196-150">No recomendamos reducir <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, porque eso provoca in incremento de la carga en la base de datos de persistencia.</span><span class="sxs-lookup"><span data-stu-id="bb196-150">We do not recommend reducing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> because this leads to an increased load on the persistence database.</span></span> <span data-ttu-id="bb196-151">Cada host de servicio que utiliza <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> sondea la base de datos un vez por cada período de detección.</span><span class="sxs-lookup"><span data-stu-id="bb196-151">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the database one time per detection period.</span></span> <span data-ttu-id="bb196-152">Al establecer <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> en un intervalo de tiempo demasiado pequeño, el rendimiento del sistema se puede reducir si el número de hosts de servicio es grande.</span><span class="sxs-lookup"><span data-stu-id="bb196-152">Setting <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to too small a time interval may cause your system's performance to decrease if the number of service hosts is large.</span></span>  
  
## <a name="configuring-the-sql-workflow-instance-store"></a><span data-ttu-id="bb196-153">Configurar el Almacén de instancias de flujo de trabajo de SQL</span><span class="sxs-lookup"><span data-stu-id="bb196-153">Configuring the SQL Workflow Instance Store</span></span>  

 <span data-ttu-id="bb196-154">El Almacén de instancias de flujo de trabajo de SQL tiene los siguientes parámetros de configuración:</span><span class="sxs-lookup"><span data-stu-id="bb196-154">The SQL Workflow Instance Store has the following configuration parameters:</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceEncodingOption%2A>  
 <span data-ttu-id="bb196-155">Este parámetro da a <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> la instrucción de que comprima el estado de la instancia de flujo de trabajo.</span><span class="sxs-lookup"><span data-stu-id="bb196-155">This parameter instructs the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to compress the workflow instance state.</span></span> <span data-ttu-id="bb196-156">La compresión reduce la cantidad de datos que se almacenan en la base de datos de persistencia y reduce el tráfico de red en caso de que la base de datos de persistencia resida en un servidor de bases de datos dedicado.</span><span class="sxs-lookup"><span data-stu-id="bb196-156">Compression reduces the amount of data that is stored in the persistence database and reduces network traffic in case the persistence database resides on a dedicated database server.</span></span> <span data-ttu-id="bb196-157">Si se utiliza la compresión, los recursos computacionales deben comprimir y extraer el estado de la instancia.</span><span class="sxs-lookup"><span data-stu-id="bb196-157">If compression is used, it requires computational resources to compress and extract the instance state.</span></span> <span data-ttu-id="bb196-158">En la mayoría de los casos, los resultados de la compresión aumentaron el rendimiento.</span><span class="sxs-lookup"><span data-stu-id="bb196-158">In most cases, compression yields increased performance.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceCompletionAction%2A>  
 <span data-ttu-id="bb196-159">Este parámetro le indica a <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> que mantenga o elimine las instancias completadas.</span><span class="sxs-lookup"><span data-stu-id="bb196-159">This parameter instructs the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to either keep or delete completed instances.</span></span> <span data-ttu-id="bb196-160">Mantener las instancias completadas incrementa los requisitos de almacenamiento de bases de datos de persistencia y hace que las tablas sean mayores, lo que aumentan los tiempos de búsqueda en tablas.</span><span class="sxs-lookup"><span data-stu-id="bb196-160">Keeping completed instances increases the persistence database storage requirements and leads to larger tables, which increases table lookup times.</span></span> <span data-ttu-id="bb196-161">A menos que se necesiten instancias instancias para depurar o auditar, es mejor para indicar a <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> que elimine las instancias completadas.</span><span class="sxs-lookup"><span data-stu-id="bb196-161">Unless completed instances are required for debugging or auditing, it is best to instruct the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to delete completed instances.</span></span> <span data-ttu-id="bb196-162">Las instancias eliminadas solo se deberían mantener si el usuario establece un proceso para quitarlas en el futuro.</span><span class="sxs-lookup"><span data-stu-id="bb196-162">Deleted instances should be kept only if the user establishes a process for eventually removing them.</span></span> <span data-ttu-id="bb196-163">Observe que no se pueden reutilizar las claves de correlación mientras la instancia de flujo de trabajo completada resida en el almacén de la instancia.</span><span class="sxs-lookup"><span data-stu-id="bb196-163">Note that correlation keys cannot be reused as long as the completed workflow instance resides in the instance store.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>  
 <span data-ttu-id="bb196-164">Este parámetro define el intervalo máximo con el que <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> sondea la base de datos de persistencia buscando instancias que se deberían cargar cuando una actividad <xref:System.Activities.Statements.Delay> expira.</span><span class="sxs-lookup"><span data-stu-id="bb196-164">This parameter defines the maximum interval with which the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the persistence database for instances that should be loaded when a <xref:System.Activities.Statements.Delay> activity expires.</span></span> <span data-ttu-id="bb196-165">Si <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> encuentra un temporizador que expirará en el intervalo de sondeo siguiente, acorta el intervalo de sondeo para que el siguiente sondeo se produzca después de que el temporizador haya expirado.</span><span class="sxs-lookup"><span data-stu-id="bb196-165">If the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> finds a timer that will expire in the next polling interval, it shortens the polling interval so that the next poll will occur right after the timer has expired.</span></span> <span data-ttu-id="bb196-166">De esta manera, el Almacén de instancias de flujo de trabajo de SQL logra una gran exactitud de los temporizadores que se ejecutan más tiempo que <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span><span class="sxs-lookup"><span data-stu-id="bb196-166">This way, the SQL Workflow Instance Store achieves a high accuracy of timers that run longer than <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span></span>  
  
 <span data-ttu-id="bb196-167">No recomendamos reducir <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, porque provoca in incremento de la carga en la base de datos de persistencia.</span><span class="sxs-lookup"><span data-stu-id="bb196-167">We do not recommend reducing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, because this leads to an increased load on the persistence database.</span></span> <span data-ttu-id="bb196-168">Cada host de servicio que utiliza <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> sondea la base de datos un vez por cada período de detección.</span><span class="sxs-lookup"><span data-stu-id="bb196-168">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the database one time per detection period.</span></span> <span data-ttu-id="bb196-169">Al establecer <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> en un intervalo de tiempo demasiado pequeño, el rendimiento del sistema se puede reducir si el número de hosts de servicio es grande.</span><span class="sxs-lookup"><span data-stu-id="bb196-169">Setting <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to too small an interval may cause your system's performance to decrease if the number of service hosts is large.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>  
 <span data-ttu-id="bb196-170">Este parámetro define el intervalo con el que el host renueva su bloqueo en la base de datos de persistencia.</span><span class="sxs-lookup"><span data-stu-id="bb196-170">This parameter defines the interval with which the host renews its lock in the persistence database.</span></span> <span data-ttu-id="bb196-171">Acortar este intervalo habilitará una recuperación más rápida de las instancias de flujo de trabajo en caso de error de un host o equipo.</span><span class="sxs-lookup"><span data-stu-id="bb196-171">Shortening this interval will enable a quicker recovery of the workflow instances in case a host or computer fails.</span></span> <span data-ttu-id="bb196-172">Por otro lado, un período de renovación de bloqueo corto aumenta la carga en la base de datos de persistencia.</span><span class="sxs-lookup"><span data-stu-id="bb196-172">On the other hand, a short lock renewal period increases the load on the persistence database.</span></span> <span data-ttu-id="bb196-173">Cada host de servicio que utiliza <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> actualizará sus bloqueos en la base de datos una vez por cada período de renovación.</span><span class="sxs-lookup"><span data-stu-id="bb196-173">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> will update its locks in the database one time per renewal period.</span></span> <span data-ttu-id="bb196-174">Si un equipo ejecuta muchos hosts de servicio, asegúrese de que la carga producida por la renovación del bloqueo no disminuya el rendimiento del sistema.</span><span class="sxs-lookup"><span data-stu-id="bb196-174">If a computer runs many service hosts, make sure that the load caused by lock renewal does not decrease your system's performance.</span></span> <span data-ttu-id="bb196-175">Si lo hace, considere un incremento de <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>.</span><span class="sxs-lookup"><span data-stu-id="bb196-175">If it does, consider increasing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A>  
 <span data-ttu-id="bb196-176">Si está habilitado, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> reintenta cargar una instancia bloqueada durante los 30 segundos siguientes.</span><span class="sxs-lookup"><span data-stu-id="bb196-176">If enabled, the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> retries to load a locked instance for the next 30 seconds.</span></span> <span data-ttu-id="bb196-177">Establezca <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> en BasicRetry o AggressiveRetry si el flujo de trabajo recibe varios mensajes en un tiempo corto y estos mensajes los reciben equipos diferentes.</span><span class="sxs-lookup"><span data-stu-id="bb196-177">Set <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> to BasicRetry or AggressiveRetry if the workflow receives multiple messages in a short time, and these messages are received by different computers.</span></span>  
  
 <span data-ttu-id="bb196-178">Dado que el mecanismo de reintento de carga no introduce ninguna sobrecarga de rendimiento mientras  los reintentos de carga no se realicen, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> debería estar siempre habilitado.</span><span class="sxs-lookup"><span data-stu-id="bb196-178">Because the load retry mechanism does not introduce any performance overhead as long as load retries are not tried, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> should always be enabled.</span></span>
