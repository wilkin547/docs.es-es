---
title: "Optimizar el rendimiento: Presentación y diseño"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- layout [WPF], optimizing performance
- design considerations [WPF]
- layout pass [WPF]
ms.assetid: 005f4cda-a849-448b-916b-38d14d9a96fe
caps.latest.revision: "8"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 13763e0487314fdbe7ab6fcb8b7b8711715e7a6e
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/21/2017
---
# <a name="optimizing-performance-layout-and-design"></a><span data-ttu-id="add3c-102">Optimizar el rendimiento: Presentación y diseño</span><span class="sxs-lookup"><span data-stu-id="add3c-102">Optimizing Performance: Layout and Design</span></span>
<span data-ttu-id="add3c-103">El diseño de su aplicación [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] puede afectar a su rendimiento si se crea una sobrecarga innecesaria al calcular el diseño y validar las referencias de objeto.</span><span class="sxs-lookup"><span data-stu-id="add3c-103">The design of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application can impact its performance by creating unnecessary overhead in calculating layout and validating object references.</span></span> <span data-ttu-id="add3c-104">La construcción de objetos, especialmente en tiempo de ejecución, puede afectar a las características de rendimiento de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="add3c-104">The construction of objects, particularly at run time, can affect the performance characteristics of your application.</span></span>  
  
 <span data-ttu-id="add3c-105">En este tema se proporcionan recomendaciones de rendimiento para estas áreas.</span><span class="sxs-lookup"><span data-stu-id="add3c-105">This topic provides performance recommendations in these areas.</span></span>  
  
## <a name="layout"></a><span data-ttu-id="add3c-106">Diseño</span><span class="sxs-lookup"><span data-stu-id="add3c-106">Layout</span></span>  
 <span data-ttu-id="add3c-107">El término "fase de diseño" describe el proceso de medir y organizar los miembros de un <xref:System.Windows.Controls.Panel>-derivados de la colección de elementos secundarios y, a continuación, dibujar ellos en la pantalla del objeto.</span><span class="sxs-lookup"><span data-stu-id="add3c-107">The term "layout pass" describes the process of measuring and arranging the members of a <xref:System.Windows.Controls.Panel>-derived object's collection of children, and then drawing them onscreen.</span></span> <span data-ttu-id="add3c-108">El pase de diseño es un proceso matemáticamente intensivo: cuanto mayor sea el número de elementos secundarios de la colección, mayor es el número de cálculos necesarios.</span><span class="sxs-lookup"><span data-stu-id="add3c-108">The layout pass is a mathematically-intensive process—the larger the number of children in the collection, the greater the number of calculations required.</span></span> <span data-ttu-id="add3c-109">Por ejemplo, cada vez que un elemento secundario <xref:System.Windows.UIElement> objeto de la colección cambia de posición, tiene la posibilidad de activar un nuevo paso por el sistema de diseño.</span><span class="sxs-lookup"><span data-stu-id="add3c-109">For example, each time a child <xref:System.Windows.UIElement> object in the collection changes its position, it has the potential to trigger a new pass by the layout system.</span></span> <span data-ttu-id="add3c-110">Debido a la estrecha relación entre las características del objeto y el comportamiento de diseño, es importante conocer el tipo de eventos que puede invocar el sistema de diseño.</span><span class="sxs-lookup"><span data-stu-id="add3c-110">Because of the close relationship between object characteristics and layout behavior, it's important to understand the type of events that can invoke the layout system.</span></span> <span data-ttu-id="add3c-111">La aplicación funcionará mejor si se reduce tanto como sea posible cualquier invocación innecesaria del pase de diseño.</span><span class="sxs-lookup"><span data-stu-id="add3c-111">Your application will perform better by reducing as much as possible any unnecessary invocations of the layout pass.</span></span>  
  
 <span data-ttu-id="add3c-112">El sistema de diseño completa dos pases por cada miembro secundario de una colección: un pase de medición y un pase de organización.</span><span class="sxs-lookup"><span data-stu-id="add3c-112">The layout system completes two passes for each child member in a collection: a measure pass, and an arrange pass.</span></span> <span data-ttu-id="add3c-113">Cada objeto secundario proporciona su propia implementación invalidada de la <xref:System.Windows.UIElement.Measure%2A> y <xref:System.Windows.UIElement.Arrange%2A> métodos para proporcionar su propio comportamiento de diseño concreto.</span><span class="sxs-lookup"><span data-stu-id="add3c-113">Each child object provides its own overridden implementation of the <xref:System.Windows.UIElement.Measure%2A> and <xref:System.Windows.UIElement.Arrange%2A> methods in order to provide its own specific layout behavior.</span></span> <span data-ttu-id="add3c-114">En su forma más simple, el diseño es un sistema recursivo que permite dibujar y situar un elemento, así como cambiar su tamaño en pantalla.</span><span class="sxs-lookup"><span data-stu-id="add3c-114">At its simplest, layout is a recursive system that leads to an element being sized, positioned, and drawn onscreen.</span></span>  
  
-   <span data-ttu-id="add3c-115">Un elemento secundario <xref:System.Windows.UIElement> objeto comienza el proceso de diseño por tener primero sus propiedades principales medidos.</span><span class="sxs-lookup"><span data-stu-id="add3c-115">A child <xref:System.Windows.UIElement> object begins the layout process by first having its core properties measured.</span></span>  
  
-   <span data-ttu-id="add3c-116">El objeto <xref:System.Windows.FrameworkElement> propiedades que están relacionadas con el tamaño, como <xref:System.Windows.FrameworkElement.Width%2A>, <xref:System.Windows.FrameworkElement.Height%2A>, y <xref:System.Windows.FrameworkElement.Margin%2A>, se evalúan.</span><span class="sxs-lookup"><span data-stu-id="add3c-116">The object's <xref:System.Windows.FrameworkElement> properties that are related to size, such as <xref:System.Windows.FrameworkElement.Width%2A>, <xref:System.Windows.FrameworkElement.Height%2A>, and <xref:System.Windows.FrameworkElement.Margin%2A>, are evaluated.</span></span>  
  
-   <span data-ttu-id="add3c-117"><xref:System.Windows.Controls.Panel>-se aplica la lógica concreta, como la <xref:System.Windows.Controls.DockPanel.Dock%2A> propiedad de la <xref:System.Windows.Controls.DockPanel>, o la <xref:System.Windows.Controls.StackPanel.Orientation%2A> propiedad de la <xref:System.Windows.Controls.StackPanel>.</span><span class="sxs-lookup"><span data-stu-id="add3c-117"><xref:System.Windows.Controls.Panel>-specific logic is applied, such as the <xref:System.Windows.Controls.DockPanel.Dock%2A> property of the <xref:System.Windows.Controls.DockPanel>, or the <xref:System.Windows.Controls.StackPanel.Orientation%2A> property of the <xref:System.Windows.Controls.StackPanel>.</span></span>  
  
-   <span data-ttu-id="add3c-118">El contenido se organiza o se sitúa después de haberse medido todos los objetos secundarios.</span><span class="sxs-lookup"><span data-stu-id="add3c-118">Content is arranged, or positioned, after all child objects have been measured.</span></span>  
  
-   <span data-ttu-id="add3c-119">La colección de objetos secundarios se dibuja en la pantalla.</span><span class="sxs-lookup"><span data-stu-id="add3c-119">The collection of child objects is drawn to the screen.</span></span>  
  
 <span data-ttu-id="add3c-120">Se vuelve a invocar el proceso de pase de diseño si se produce alguna de las siguientes acciones:</span><span class="sxs-lookup"><span data-stu-id="add3c-120">The layout pass process is invoked again if any of the following actions occur:</span></span>  
  
-   <span data-ttu-id="add3c-121">Un objeto secundario se agrega a la colección.</span><span class="sxs-lookup"><span data-stu-id="add3c-121">A child object is added to the collection.</span></span>  
  
-   <span data-ttu-id="add3c-122">Un <xref:System.Windows.FrameworkElement.LayoutTransform%2A> se aplica a los objetos secundarios.</span><span class="sxs-lookup"><span data-stu-id="add3c-122">A <xref:System.Windows.FrameworkElement.LayoutTransform%2A> is applied to the child object.</span></span>  
  
-   <span data-ttu-id="add3c-123">El <xref:System.Windows.UIElement.UpdateLayout%2A> se llama el método del objeto secundario.</span><span class="sxs-lookup"><span data-stu-id="add3c-123">The <xref:System.Windows.UIElement.UpdateLayout%2A> method is called for the child object.</span></span>  
  
-   <span data-ttu-id="add3c-124">Cuando se produce un cambio en el valor de una propiedad de dependencia que se marca con metadatos que afectan a los pases de medición o de organización.</span><span class="sxs-lookup"><span data-stu-id="add3c-124">When a change occurs to the value of a dependency property that is marked with metadata affecting the measure or arrange passes.</span></span>  
  
### <a name="use-the-most-efficient-panel-where-possible"></a><span data-ttu-id="add3c-125">Usar el panel más eficaz cuando sea posible</span><span class="sxs-lookup"><span data-stu-id="add3c-125">Use the Most Efficient Panel where Possible</span></span>  
 <span data-ttu-id="add3c-126">La complejidad del proceso de diseño se basa directamente en el comportamiento del diseño de la <xref:System.Windows.Controls.Panel>-elementos usas derivados.</span><span class="sxs-lookup"><span data-stu-id="add3c-126">The complexity of the layout process is directly based on the layout behavior of the <xref:System.Windows.Controls.Panel>-derived elements you use.</span></span> <span data-ttu-id="add3c-127">Por ejemplo, un <xref:System.Windows.Controls.Grid> o <xref:System.Windows.Controls.StackPanel> control proporciona mucha más funcionalidad que un <xref:System.Windows.Controls.Canvas> control.</span><span class="sxs-lookup"><span data-stu-id="add3c-127">For example, a <xref:System.Windows.Controls.Grid> or <xref:System.Windows.Controls.StackPanel> control provides much more functionality than a <xref:System.Windows.Controls.Canvas> control.</span></span> <span data-ttu-id="add3c-128">El precio de este mayor aumento de funcionalidad es el mayor aumento de los costos de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="add3c-128">The price for this greater increase in functionality is a greater increase in performance costs.</span></span> <span data-ttu-id="add3c-129">Sin embargo, si no necesita la funcionalidad que un <xref:System.Windows.Controls.Grid> proporciona control, debe utilizar las alternativas menos costosas, como un <xref:System.Windows.Controls.Canvas> o un panel personalizado.</span><span class="sxs-lookup"><span data-stu-id="add3c-129">However, if you do not require the functionality that a <xref:System.Windows.Controls.Grid> control provides, you should use the less costly alternatives, such as a <xref:System.Windows.Controls.Canvas> or a custom panel.</span></span>  
  
 <span data-ttu-id="add3c-130">Para más información, consulte [Información general sobre elementos Panel](../../../../docs/framework/wpf/controls/panels-overview.md).</span><span class="sxs-lookup"><span data-stu-id="add3c-130">For more information, see [Panels Overview](../../../../docs/framework/wpf/controls/panels-overview.md).</span></span>  
  
### <a name="update-rather-than-replace-a-rendertransform"></a><span data-ttu-id="add3c-131">Actualizar en lugar de reemplazar una propiedad RenderTransform</span><span class="sxs-lookup"><span data-stu-id="add3c-131">Update Rather than Replace a RenderTransform</span></span>  
 <span data-ttu-id="add3c-132">Es posible que pueda actualizar una <xref:System.Windows.Media.Transform> en lugar de reemplazarlo como el valor de un <xref:System.Windows.UIElement.RenderTransform%2A> propiedad.</span><span class="sxs-lookup"><span data-stu-id="add3c-132">You may be able to update a <xref:System.Windows.Media.Transform> rather than replacing it as the value of a <xref:System.Windows.UIElement.RenderTransform%2A> property.</span></span> <span data-ttu-id="add3c-133">Esto es especialmente cierto en escenarios que implican animación.</span><span class="sxs-lookup"><span data-stu-id="add3c-133">This is particularly true in scenarios that involve animation.</span></span> <span data-ttu-id="add3c-134">Si actualiza una existente <xref:System.Windows.Media.Transform>, evite iniciar un cálculo de diseño innecesarios.</span><span class="sxs-lookup"><span data-stu-id="add3c-134">By updating an existing <xref:System.Windows.Media.Transform>, you avoid initiating an unnecessary layout calculation.</span></span>  
  
### <a name="build-your-tree-top-down"></a><span data-ttu-id="add3c-135">Compilar el árbol de arriba a abajo</span><span class="sxs-lookup"><span data-stu-id="add3c-135">Build Your Tree Top-Down</span></span>  
 <span data-ttu-id="add3c-136">Cuando se agrega o se quita un nodo del árbol lógico, se generan invalidaciones de propiedades en el elemento principal del nodo y en todos sus elementos secundarios.</span><span class="sxs-lookup"><span data-stu-id="add3c-136">When a node is added or removed from the logical tree, property invalidations are raised on the node's parent and all its children.</span></span> <span data-ttu-id="add3c-137">Como resultado, siempre debe seguir un patrón de compilación de arriba a abajo para evitar el costo de invalidaciones innecesarias en los nodos que ya están validados.</span><span class="sxs-lookup"><span data-stu-id="add3c-137">As a result, a top-down construction pattern should always be followed to avoid the cost of unnecessary invalidations on nodes that have already been validated.</span></span> <span data-ttu-id="add3c-138">En la tabla siguiente muestra la diferencia en velocidad de ejecución entre la compilación de un árbol de arriba a abajo, en lugar de abajo arriba, donde el árbol tiene 150 niveles de profundidad con una sola <xref:System.Windows.Controls.TextBlock> y <xref:System.Windows.Controls.DockPanel> en cada nivel.</span><span class="sxs-lookup"><span data-stu-id="add3c-138">The following table shows the difference in execution speed between building a tree top-down versus bottom-up, where the tree is 150 levels deep with a single <xref:System.Windows.Controls.TextBlock> and <xref:System.Windows.Controls.DockPanel> at each level.</span></span>  
  
|<span data-ttu-id="add3c-139">**Acción**</span><span class="sxs-lookup"><span data-stu-id="add3c-139">**Action**</span></span>|<span data-ttu-id="add3c-140">**Compilación del árbol (en ms)**</span><span class="sxs-lookup"><span data-stu-id="add3c-140">**Tree building (in ms)**</span></span>|<span data-ttu-id="add3c-141">**Representar: incluye la compilación del árbol (en ms)**</span><span class="sxs-lookup"><span data-stu-id="add3c-141">**Render—includes tree building (in ms)**</span></span>|  
|----------------|---------------------------------|-------------------------------------------------|  
|<span data-ttu-id="add3c-142">De abajo a arriba</span><span class="sxs-lookup"><span data-stu-id="add3c-142">Bottom-up</span></span>|<span data-ttu-id="add3c-143">366</span><span class="sxs-lookup"><span data-stu-id="add3c-143">366</span></span>|<span data-ttu-id="add3c-144">454</span><span class="sxs-lookup"><span data-stu-id="add3c-144">454</span></span>|  
|<span data-ttu-id="add3c-145">De arriba a abajo</span><span class="sxs-lookup"><span data-stu-id="add3c-145">Top-down</span></span>|<span data-ttu-id="add3c-146">11</span><span class="sxs-lookup"><span data-stu-id="add3c-146">11</span></span>|<span data-ttu-id="add3c-147">96</span><span class="sxs-lookup"><span data-stu-id="add3c-147">96</span></span>|  
  
 <span data-ttu-id="add3c-148">En el siguiente ejemplo de código se muestra cómo crear un árbol de arriba a abajo.</span><span class="sxs-lookup"><span data-stu-id="add3c-148">The following code example demonstrates how to create a tree top down.</span></span>  
  
 [!code-csharp[Performance#PerformanceSnippet1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Window1.xaml.cs#performancesnippet1)]
 [!code-vb[Performance#PerformanceSnippet1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/Performance/visualbasic/window1.xaml.vb#performancesnippet1)]  
  
 <span data-ttu-id="add3c-149">Para más información acerca del árbol lógico, consulte [Árboles en WPF](../../../../docs/framework/wpf/advanced/trees-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="add3c-149">For more information on the logical tree, see [Trees in WPF](../../../../docs/framework/wpf/advanced/trees-in-wpf.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="add3c-150">Vea también</span><span class="sxs-lookup"><span data-stu-id="add3c-150">See Also</span></span>  
 [<span data-ttu-id="add3c-151">Optimizar WPF: Rendimiento de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="add3c-151">Optimizing WPF Application Performance</span></span>](../../../../docs/framework/wpf/advanced/optimizing-wpf-application-performance.md)  
 [<span data-ttu-id="add3c-152">Planear para mejorar el rendimiento de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="add3c-152">Planning for Application Performance</span></span>](../../../../docs/framework/wpf/advanced/planning-for-application-performance.md)  
 [<span data-ttu-id="add3c-153">Aprovechar el hardware</span><span class="sxs-lookup"><span data-stu-id="add3c-153">Taking Advantage of Hardware</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-taking-advantage-of-hardware.md)  
 [<span data-ttu-id="add3c-154">Imágenes y gráficos 2D</span><span class="sxs-lookup"><span data-stu-id="add3c-154">2D Graphics and Imaging</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-2d-graphics-and-imaging.md)  
 [<span data-ttu-id="add3c-155">Comportamiento de objetos</span><span class="sxs-lookup"><span data-stu-id="add3c-155">Object Behavior</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-object-behavior.md)  
 [<span data-ttu-id="add3c-156">Recursos de la aplicación</span><span class="sxs-lookup"><span data-stu-id="add3c-156">Application Resources</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-application-resources.md)  
 [<span data-ttu-id="add3c-157">Text</span><span class="sxs-lookup"><span data-stu-id="add3c-157">Text</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-text.md)  
 [<span data-ttu-id="add3c-158">Enlace de datos</span><span class="sxs-lookup"><span data-stu-id="add3c-158">Data Binding</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-data-binding.md)  
 [<span data-ttu-id="add3c-159">Otras recomendaciones de rendimiento</span><span class="sxs-lookup"><span data-stu-id="add3c-159">Other Performance Recommendations</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-other-recommendations.md)  
 [<span data-ttu-id="add3c-160">Diseño</span><span class="sxs-lookup"><span data-stu-id="add3c-160">Layout</span></span>](../../../../docs/framework/wpf/advanced/layout.md)
