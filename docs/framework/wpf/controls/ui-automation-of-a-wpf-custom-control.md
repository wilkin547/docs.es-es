---
title: Automatización de la interfaz de usuario de un control personalizado de WPF
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- custom controls [WPF], applying UI automation
- accessibility [WPF], applying to custom controls
- custom controls [WPF], improving accessibility
- UI Automation [WPF], using with custom controls
ms.assetid: 47b310fc-fbd5-4ce2-a606-22d04c6d4911
ms.openlocfilehash: 96107c287003cc5fca2eb0eaa86f0f1f32b7d65e
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/23/2019
ms.locfileid: "54523706"
---
# <a name="ui-automation-of-a-wpf-custom-control"></a><span data-ttu-id="c2f3f-102">Automatización de la interfaz de usuario de un control personalizado de WPF</span><span class="sxs-lookup"><span data-stu-id="c2f3f-102">UI Automation of a WPF Custom Control</span></span>
[!INCLUDE[TLA#tla_uiautomation](../../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="c2f3f-103">proporciona una única interfaz generalizada que los clientes de automatización pueden utilizar para examinar o utilizar las interfaces de usuario de una variedad de plataformas y entornos.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-103">provides a single, generalized interface that automation clients can use to examine or operate the user interfaces of a variety of platforms and frameworks.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="c2f3f-104">permite al código de control de calidad (prueba) y a las aplicaciones de accesibilidad, tales como lectores de pantalla, examinar los elementos de la interfaz de usuario y simular la interacción del usuario con ellos desde otro código.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-104">enables both quality-assurance (test) code and accessibility applications such as screen readers to examine user-interface elements and simulate user interaction with them from other code.</span></span> <span data-ttu-id="c2f3f-105">Para más información acerca de [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] en todas las plataformas, consulte Accesibilidad.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-105">For information about [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] across all platforms, see Accessibility.</span></span>  
  
 <span data-ttu-id="c2f3f-106">En este tema se describe cómo implementar un proveedor de automatización de la interfaz de usuario del lado servidor para un control personalizado que se ejecuta en una aplicación de WPF.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-106">This topic describes how to implement a server-side UI Automation provider for a custom control that runs in a WPF application.</span></span> <span data-ttu-id="c2f3f-107">WPF admite [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] mediante un árbol de objetos de automatización del mismo nivel que se corresponde con el árbol de elementos de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-107">WPF supports [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] through a tree of peer automation objects that parallels the tree of user interface elements.</span></span> <span data-ttu-id="c2f3f-108">El código de prueba y las aplicaciones que proporcionan características de accesibilidad pueden usar objetos de automatización del mismo nivel directamente (para código en proceso) o mediante la interfaz generalizada proporcionada por [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c2f3f-108">Test code and applications that provide accessibility features can use automation peer objects directly (for in-process code) or through the generalized interface provided by [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>  
  
 
  
<a name="AutomationPeerClasses"></a>   
## <a name="automation-peer-classes"></a><span data-ttu-id="c2f3f-109">Clases de automatización del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="c2f3f-109">Automation Peer Classes</span></span>  
 <span data-ttu-id="c2f3f-110">Controles de WPF admiten [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] a través de un árbol de clases del mismo nivel que se derivan de <xref:System.Windows.Automation.Peers.AutomationPeer>.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-110">WPF controls support [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] through a tree of peer classes that derive from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="c2f3f-111">Por convención, los nombres de clase del mismo nivel empiezan por el nombre de clase del control y terminan por "AutomationPeer".</span><span class="sxs-lookup"><span data-stu-id="c2f3f-111">By convention, peer class names begin with the control class name and end with "AutomationPeer".</span></span> <span data-ttu-id="c2f3f-112">Por ejemplo, <xref:System.Windows.Automation.Peers.ButtonAutomationPeer> es la clase del mismo nivel para el <xref:System.Windows.Controls.Button> clase del control.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-112">For example, <xref:System.Windows.Automation.Peers.ButtonAutomationPeer> is the peer class for the <xref:System.Windows.Controls.Button> control class.</span></span> <span data-ttu-id="c2f3f-113">Las clases del mismo nivel equivalen a los tipos de control de [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)], pero son específicas de los elementos de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c2f3f-113">The peer classes are roughly equivalent to [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] control types but are specific to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elements.</span></span> <span data-ttu-id="c2f3f-114">El código de automatización que tiene acceso a las aplicaciones de WPF mediante la interfaz [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] no utiliza directamente elementos de automatización del mismo nivel; sin embargo, el código de automatización en el mismo espacio de proceso puede utilizar directamente elementos de automatización del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-114">Automation code that accesses WPF applications through the [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] interface does not use automation peers directly, but automation code in the same process space can use automation peers directly.</span></span>  
  
<a name="BuiltInAutomationPeerClasses"></a>   
## <a name="built-in-automation-peer-classes"></a><span data-ttu-id="c2f3f-115">Clases de automatización del mismo nivel integradas</span><span class="sxs-lookup"><span data-stu-id="c2f3f-115">Built-in Automation Peer Classes</span></span>  
 <span data-ttu-id="c2f3f-116">Los elementos implementan una clase de automatización del mismo nivel si aceptan la actividad de la interfaz de usuario o si contienen la información necesaria para los usuarios de aplicaciones de lector de pantalla.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-116">Elements implement an automation peer class if they accept interface activity from the user, or if they contain information needed by users of screen-reader applications.</span></span> <span data-ttu-id="c2f3f-117">No todos los elementos visuales de WPF tienen elementos de automatización del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-117">Not all WPF visual elements have automation peers.</span></span> <span data-ttu-id="c2f3f-118">Ejemplos de clases que implementan la automatización del mismo nivel son <xref:System.Windows.Controls.Button>, <xref:System.Windows.Controls.TextBox>, y <xref:System.Windows.Controls.Label>.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-118">Examples of classes that implement automation peers are <xref:System.Windows.Controls.Button>, <xref:System.Windows.Controls.TextBox>, and <xref:System.Windows.Controls.Label>.</span></span> <span data-ttu-id="c2f3f-119">Ejemplos de clases que implementan la automatización del mismo nivel son clases que derivan de <xref:System.Windows.Controls.Decorator>, tales como <xref:System.Windows.Controls.Border>y las clases basadas en <xref:System.Windows.Controls.Panel>, tales como <xref:System.Windows.Controls.Grid> y <xref:System.Windows.Controls.Canvas>.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-119">Examples of classes that do not implement automation peers are classes that derive from <xref:System.Windows.Controls.Decorator>, such as <xref:System.Windows.Controls.Border>, and classes based on <xref:System.Windows.Controls.Panel>, such as <xref:System.Windows.Controls.Grid> and <xref:System.Windows.Controls.Canvas>.</span></span>  
  
 <span data-ttu-id="c2f3f-120">La base de <xref:System.Windows.Controls.Control> clase no tiene una clase del mismo nivel correspondiente.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-120">The base <xref:System.Windows.Controls.Control> class does not have a corresponding peer class.</span></span> <span data-ttu-id="c2f3f-121">Si necesita una clase del mismo nivel para que coincida con un control personalizado que se deriva de <xref:System.Windows.Controls.Control>, debe derivar la clase del mismo nivel personalizada desde <xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer>.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-121">If you need a peer class to correspond to a custom control that derives from <xref:System.Windows.Controls.Control>, you should derive the custom peer class from <xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer>.</span></span>  
  
<a name="SecurityConsiderations"></a>   
## <a name="security-considerations-for-derived-peers"></a><span data-ttu-id="c2f3f-122">Consideraciones de seguridad para elementos del mismo nivel derivados</span><span class="sxs-lookup"><span data-stu-id="c2f3f-122">Security Considerations for Derived Peers</span></span>  
 <span data-ttu-id="c2f3f-123">Los elementos de automatización del mismo nivel deben ejecutarse en un entorno de confianza parcial.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-123">Automation peers must run in a partial-trust environment.</span></span> <span data-ttu-id="c2f3f-124">El código del ensamblado UIAutomationClient no está configurado para ejecutarse en un entorno de confianza parcial y el código de automatización del mismo nivel no debe hacer referencia a dicho ensamblado.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-124">Code in the UIAutomationClient assembly is not configured to run in a partial-trust environment, and automation peer code should not reference that assembly.</span></span> <span data-ttu-id="c2f3f-125">En su lugar, debe usar las clases del ensamblado UIAutomationTypes.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-125">Instead, you should use the classes in the UIAutomationTypes assembly.</span></span> <span data-ttu-id="c2f3f-126">Por ejemplo, se debe utilizar el <xref:System.Windows.Automation.AutomationElementIdentifiers> clase del ensamblado UIAutomationTypes, que corresponde a la <xref:System.Windows.Automation.AutomationElement> clase del ensamblado UIAutomationClient.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-126">For example, you should use the <xref:System.Windows.Automation.AutomationElementIdentifiers> class from the UIAutomationTypes assembly, which corresponds to the <xref:System.Windows.Automation.AutomationElement> class in the UIAutomationClient assembly.</span></span> <span data-ttu-id="c2f3f-127">Es seguro hacer referencia al ensamblado UIAutomationTypes en el código de automatización del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-127">It is safe to reference the UIAutomationTypes assembly in automation peer code.</span></span>  
  
<a name="PeerNavigation"></a>   
## <a name="peer-navigation"></a><span data-ttu-id="c2f3f-128">Navegación entre elementos del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="c2f3f-128">Peer Navigation</span></span>  
 <span data-ttu-id="c2f3f-129">Después de encontrar una automatización del mismo nivel, el código en proceso puede navegar el árbol de elementos mediante una llamada del objeto <xref:System.Windows.Automation.Peers.AutomationPeer.GetChildren%2A> y <xref:System.Windows.Automation.Peers.AutomationPeer.GetParent%2A> métodos.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-129">After locating an automation peer, in-process code can navigate the peer tree by calling the object's <xref:System.Windows.Automation.Peers.AutomationPeer.GetChildren%2A> and <xref:System.Windows.Automation.Peers.AutomationPeer.GetParent%2A> methods.</span></span> <span data-ttu-id="c2f3f-130">Navegación entre [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elementos dentro de un control es compatible con la implementación del mismo nivel de la <xref:System.Windows.Automation.Peers.AutomationPeer.GetChildrenCore%2A> método.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-130">Navigation among [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elements within a control is supported by the peer's implementation of the <xref:System.Windows.Automation.Peers.AutomationPeer.GetChildrenCore%2A> method.</span></span> <span data-ttu-id="c2f3f-131">El sistema de automatización de la interfaz de usuario llama a este método para crear un árbol de subelementos incluidos dentro de un control; por ejemplo, los elementos de lista de un cuadro de lista.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-131">The UI Automation system calls this method to build up a tree of subelements contained within a control; for example, list items in a list box.</span></span> <span data-ttu-id="c2f3f-132">El valor predeterminado <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A?displayProperty=nameWithType> método recorre el árbol visual de elementos para generar el árbol de automatización del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-132">The default <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A?displayProperty=nameWithType> method traverses the visual tree of elements to build the tree of automation peers.</span></span> <span data-ttu-id="c2f3f-133">Los controles personalizados invalidan este método para exponer los elementos secundarios a los clientes de automatización, y devuelven aquellos elementos de automatización del mismo nivel que transmiten información o permiten la interacción del usuario.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-133">Custom controls override this method to expose children elements to automation clients, returning the automation peers of elements that convey information or allow user interaction.</span></span>  
  
<a name="Customizations"></a>   
## <a name="customizations-in-a-derived-peer"></a><span data-ttu-id="c2f3f-134">Personalizaciones en un elemento del mismo nivel derivado</span><span class="sxs-lookup"><span data-stu-id="c2f3f-134">Customizations in a Derived Peer</span></span>  
 <span data-ttu-id="c2f3f-135">Todas las clases que derivan de <xref:System.Windows.UIElement> y <xref:System.Windows.ContentElement> contienen el método virtual protegido <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A>.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-135">All classes that derive from <xref:System.Windows.UIElement> and <xref:System.Windows.ContentElement> contain the protected virtual method <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A>.</span></span> <span data-ttu-id="c2f3f-136">Las llamadas WPF <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> para obtener el objeto de automatización del mismo nivel para cada control.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-136">WPF calls <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> to get the automation peer object for each control.</span></span> <span data-ttu-id="c2f3f-137">El código de automatización puede utilizar el elemento del mismo nivel para obtener información sobre las características y funciones de un control, y simular el uso interactivo.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-137">Automation code can use the peer to get information about a control’s characteristics and features and to simulate interactive use.</span></span> <span data-ttu-id="c2f3f-138">Un control personalizado que admite la automatización debe invalidar <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> y devolver una instancia de una clase que deriva de <xref:System.Windows.Automation.Peers.AutomationPeer>.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-138">A custom control that supports automation must override <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> and return an instance of a class that derives from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="c2f3f-139">Por ejemplo, si un control personalizado se deriva de la <xref:System.Windows.Controls.Primitives.ButtonBase> clase y, a continuación, el objeto devuelto por <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> debe derivar de <xref:System.Windows.Automation.Peers.ButtonBaseAutomationPeer>.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-139">For example, if a custom control derives from the <xref:System.Windows.Controls.Primitives.ButtonBase> class, then the object returned by <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> should derive from <xref:System.Windows.Automation.Peers.ButtonBaseAutomationPeer>.</span></span>  
  
 <span data-ttu-id="c2f3f-140">Al implementar un control personalizado, se deben invalidar los métodos "Core" de la clase base de automatización del mismo nivel, que describen el comportamiento único y específico del control personalizado.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-140">When implementing a custom control, you must override the "Core" methods from the base automation peer class that describe behavior unique and specific to your custom control.</span></span>  
  
### <a name="override-oncreateautomationpeer"></a><span data-ttu-id="c2f3f-141">Invalidar OnCreateAutomationPeer</span><span class="sxs-lookup"><span data-stu-id="c2f3f-141">Override OnCreateAutomationPeer</span></span>  
 <span data-ttu-id="c2f3f-142">Invalidar el <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> método para el control personalizado para que devuelva el objeto de proveedor, que debe derivar directa o indirectamente de <xref:System.Windows.Automation.Peers.AutomationPeer>.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-142">Override the <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> method for your custom control so that it returns your provider object, which must derive directly or indirectly from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span>  
  
### <a name="override-getpattern"></a><span data-ttu-id="c2f3f-143">Invalidar GetPattern</span><span class="sxs-lookup"><span data-stu-id="c2f3f-143">Override GetPattern</span></span>  
 <span data-ttu-id="c2f3f-144">Los elementos de automatización del mismo nivel simplifican algunos aspectos de la implementación de proveedores de [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] del lado servidor; sin embargo, los elementos de automatización del mismo nivel de un control personalizado deben controlar las interfaces de patrón.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-144">Automation peers simplify some implementation aspects of server-side [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] providers, but custom control automation peers must still handle pattern interfaces.</span></span> <span data-ttu-id="c2f3f-145">Al igual que los proveedores que no son de WPF, elementos del mismo nivel admiten patrones de control al proporcionar implementaciones de interfaces en el <xref:System.Windows.Automation.Provider?displayProperty=nameWithType> espacio de nombres, como <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-145">Like non-WPF providers, peers support control patterns by providing implementations of interfaces in the <xref:System.Windows.Automation.Provider?displayProperty=nameWithType> namespace, such as <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span></span> <span data-ttu-id="c2f3f-146">Las interfaces de patrón de control pueden implementarlas el propio elemento del mismo nivel u otro objeto.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-146">The control pattern interfaces can be implemented by the peer itself or by another object.</span></span> <span data-ttu-id="c2f3f-147">Implementación del mismo nivel de <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> devuelve el objeto que admite el patrón especificado.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-147">The peer's implementation of <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> returns the object that supports the specified pattern.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="c2f3f-148">el código llama a la <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> método y especifica un <xref:System.Windows.Automation.Peers.PatternInterface> valor de enumeración.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-148">code calls the <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> method and specifies a <xref:System.Windows.Automation.Peers.PatternInterface> enumeration value.</span></span> <span data-ttu-id="c2f3f-149">El reemplazo de <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> debe devolver el objeto que implementa el patrón especificado.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-149">Your override of <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> should return the object that implements the specified pattern.</span></span> <span data-ttu-id="c2f3f-150">Si el control no tiene una implementación personalizada de un patrón, puede llamar a implementación del tipo base <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> para recuperar su implementación o null si no se admite el patrón para este tipo de control.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-150">If your control does not have a custom implementation of a pattern, you can call the base type's implementation of <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> to retrieve either its implementation or null if the pattern is not supported for this control type.</span></span> <span data-ttu-id="c2f3f-151">Por ejemplo, un control NumericUpDown personalizado puede establecerse en un valor dentro de un intervalo, por lo que su [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] punto implementaría el <xref:System.Windows.Automation.Provider.IRangeValueProvider> interfaz.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-151">For example, a custom NumericUpDown control can be set to a value within a range, so its [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] peer would implement the <xref:System.Windows.Automation.Provider.IRangeValueProvider> interface.</span></span> <span data-ttu-id="c2f3f-152">El ejemplo siguiente se muestra cómo el interlocutor <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> método se invalida para responder a un <xref:System.Windows.Automation.Peers.PatternInterface.RangeValue?displayProperty=nameWithType> valor.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-152">The following example shows how the peer's <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> method is overridden to respond to a <xref:System.Windows.Automation.Peers.PatternInterface.RangeValue?displayProperty=nameWithType> value.</span></span>  
  
 [!code-csharp[CustomControlNumericUpDown#GetPattern](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp/CustomControlLibrary/NumericUpDown.cs#getpattern)]
 [!code-vb[CustomControlNumericUpDown#GetPattern](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic/customcontrollibrary/numericupdown.vb#getpattern)]  
  
 <span data-ttu-id="c2f3f-153">Un <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> método también puede especificar un subelemento como proveedor del patrón.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-153">A <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> method can also specify a subelement as a pattern provider.</span></span> <span data-ttu-id="c2f3f-154">El siguiente código muestra cómo <xref:System.Windows.Controls.ItemsControl> transfiere el control al mismo nivel de su texto interno del patrón de desplazamiento <xref:System.Windows.Controls.ScrollViewer> control.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-154">The following code shows how <xref:System.Windows.Controls.ItemsControl> transfers scroll pattern handling to the peer of its internal <xref:System.Windows.Controls.ScrollViewer> control.</span></span>  
  
```csharp  
public override object GetPattern(PatternInterface patternInterface)  
{  
    if (patternInterface == PatternInterface.Scroll)  
    {  
        ItemsControl owner = (ItemsControl) base.Owner;  
  
        // ScrollHost is internal to the ItemsControl class  
        if (owner.ScrollHost != null)  
        {  
            AutomationPeer peer = UIElementAutomationPeer.CreatePeerForElement(owner.ScrollHost);  
            if ((peer != null) && (peer is IScrollProvider))  
            {  
                peer.EventsSource = this;  
                return (IScrollProvider) peer;  
            }  
        }  
    }  
    return base.GetPattern(patternInterface);  
}  
```  
  
```vb  
Public Class Class1  
    Public Overrides Function GetPattern(ByVal patternInterface__1 As PatternInterface) As Object  
        If patternInterface1 = PatternInterface.Scroll Then  
            Dim owner As ItemsControl = DirectCast(MyBase.Owner, ItemsControl)  
  
            ' ScrollHost is internal to the ItemsControl class  
            If owner.ScrollHost IsNot Nothing Then  
                Dim peer As AutomationPeer = UIElementAutomationPeer.CreatePeerForElement(owner.ScrollHost)  
                If (peer IsNot Nothing) AndAlso (TypeOf peer Is IScrollProvider) Then  
                    peer.EventsSource = Me  
                    Return DirectCast(peer, IScrollProvider)  
                End If  
            End If  
        End If  
        Return MyBase.GetPattern(patternInterface1)  
    End Function  
End Class  
```  
  
 <span data-ttu-id="c2f3f-155">Para especificar un subelemento para el control del patrón, este código obtiene el objeto del subelemento, crea un elemento del mismo nivel mediante el uso de la <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.CreatePeerForElement%2A> método, Establece el <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A> propiedad del mismo nivel nuevo al mismo nivel actual y devuelve la nueva del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-155">To specify a subelement for pattern handling, this code gets the subelement object, creates a peer by using the <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.CreatePeerForElement%2A> method, sets the <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A> property of the new peer to the current peer, and returns the new peer.</span></span> <span data-ttu-id="c2f3f-156">Establecer <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A> en un subelemento impide que el subelemento que aparece en el árbol de automatización del mismo nivel y todos los eventos provocados por el subelemento como que se origina en el control especificado en <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-156">Setting <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A> on a subelement prevents the subelement from appearing in the automation peer tree and designates all events raised by the subelement as originating from the control specified in <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A>.</span></span> <span data-ttu-id="c2f3f-157">El <xref:System.Windows.Controls.ScrollViewer> control no aparece en el árbol de automatización y los eventos de desplazamiento que genera parecerán originarse en el <xref:System.Windows.Controls.ItemsControl> objeto.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-157">The <xref:System.Windows.Controls.ScrollViewer> control does not appear in the automation tree, and scrolling events that it generates appear to originate from the <xref:System.Windows.Controls.ItemsControl> object.</span></span>  
  
### <a name="override-core-methods"></a><span data-ttu-id="c2f3f-158">Invalidar métodos "Core"</span><span class="sxs-lookup"><span data-stu-id="c2f3f-158">Override "Core" Methods</span></span>  
 <span data-ttu-id="c2f3f-159">Para obtener información sobre el control, el código de automatización llama a métodos públicos de la clase del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-159">Automation code gets information about your control by calling public methods of the peer class.</span></span> <span data-ttu-id="c2f3f-160">Para proporcionar información sobre el control, invalide los métodos cuyo nombre termina con "Core" en caso de que la implementación del control sea diferente de la que proporciona la clase base de automatización del mismo nivel.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-160">To provide information about your control, override each method whose name ends with "Core" when your control implementation differs from that of that provided by the base automation peer class.</span></span> <span data-ttu-id="c2f3f-161">Como mínimo, el control debe implementar la <xref:System.Windows.Automation.Peers.AutomationPeer.GetClassNameCore%2A> y <xref:System.Windows.Automation.Peers.AutomationPeer.GetAutomationControlTypeCore%2A> métodos, como se muestra en el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-161">At a minimum, your control must implement the <xref:System.Windows.Automation.Peers.AutomationPeer.GetClassNameCore%2A> and <xref:System.Windows.Automation.Peers.AutomationPeer.GetAutomationControlTypeCore%2A> methods, as shown in the following example.</span></span>  
  
 [!code-csharp[CustomControlNumericUpDown#CoreOverrides](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp/CustomControlLibrary/NumericUpDown.cs#coreoverrides)]
 [!code-vb[CustomControlNumericUpDown#CoreOverrides](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic/customcontrollibrary/numericupdown.vb#coreoverrides)]  
  
 <span data-ttu-id="c2f3f-162">La implementación de <xref:System.Windows.Automation.Peers.AutomationPeer.GetAutomationControlTypeCore%2A> describe el control devolviendo un <xref:System.Windows.Automation.ControlType> valor.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-162">Your implementation of <xref:System.Windows.Automation.Peers.AutomationPeer.GetAutomationControlTypeCore%2A> describes your control by returning a <xref:System.Windows.Automation.ControlType> value.</span></span> <span data-ttu-id="c2f3f-163">Aunque puede devolver <xref:System.Windows.Automation.ControlType.Custom?displayProperty=nameWithType>, debe devolver uno de los tipos de control más específicos si describe con precisión su control.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-163">Although you can return <xref:System.Windows.Automation.ControlType.Custom?displayProperty=nameWithType>, you should return one of the more specific control types if it accurately describes your control.</span></span> <span data-ttu-id="c2f3f-164">Un valor devuelto de <xref:System.Windows.Automation.ControlType.Custom?displayProperty=nameWithType> requiere trabajo adicional para el proveedor implemente [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)], y [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] productos de cliente son no pueden prever la estructura de control, interacción con el teclado y patrones de control posibles.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-164">A return value of <xref:System.Windows.Automation.ControlType.Custom?displayProperty=nameWithType> requires extra work for the provider to implement [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)], and [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] client products are unable to anticipate the control structure, keyboard interaction, and possible control patterns.</span></span>  
  
 <span data-ttu-id="c2f3f-165">Implemente el <xref:System.Windows.Automation.Peers.AutomationPeer.IsContentElementCore%2A> y <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> métodos para indicar si el control contiene datos o desempeña una función interactiva en la interfaz de usuario (o ambos).</span><span class="sxs-lookup"><span data-stu-id="c2f3f-165">Implement the <xref:System.Windows.Automation.Peers.AutomationPeer.IsContentElementCore%2A> and <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> methods to indicate whether your control contains data content or fulfills an interactive role in the user interface (or both).</span></span> <span data-ttu-id="c2f3f-166">De forma predeterminada, ambos métodos devuelven `true`.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-166">By default, both methods return `true`.</span></span> <span data-ttu-id="c2f3f-167">Esta configuración aumenta la facilidad de uso de herramientas de automatización, como lectores de pantalla, que pueden utilizar estos métodos para filtrar el árbol de automatización.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-167">These settings improve the usability of automation tools such as screen readers, which may use these methods to filter the automation tree.</span></span> <span data-ttu-id="c2f3f-168">Si su <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> control a un subelemento del mismo nivel, el subelemento del mismo nivel del método transferencias patrón <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> método puede devolver false para ocultar el subelemento del mismo nivel del árbol de automatización.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-168">If your <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> method transfers pattern handling to a subelement peer, the subelement peer's <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> method can return false to hide the subelement peer from the automation tree.</span></span> <span data-ttu-id="c2f3f-169">Por ejemplo, el desplazamiento en un <xref:System.Windows.Controls.ListBox> se controla mediante un <xref:System.Windows.Controls.ScrollViewer>y la automatización del mismo nivel para <xref:System.Windows.Automation.Peers.PatternInterface.Scroll?displayProperty=nameWithType> devuelto por la <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> método de la <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> que está asociado con el <xref:System.Windows.Automation.Peers.ListBoxAutomationPeer>. Por lo tanto, el <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> método de la <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> devuelve `false`, de modo que el <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> no aparece en el árbol de automatización.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-169">For example, scrolling in a <xref:System.Windows.Controls.ListBox> is handled by a <xref:System.Windows.Controls.ScrollViewer>, and the automation peer for <xref:System.Windows.Automation.Peers.PatternInterface.Scroll?displayProperty=nameWithType> is returned by the <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> method of the <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> that is associated with the <xref:System.Windows.Automation.Peers.ListBoxAutomationPeer>.Therefore, the <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> method of the <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> returns `false`, so that the <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> does not appear in the automation tree.</span></span>  
  
 <span data-ttu-id="c2f3f-170">El elemento de automatización del mismo nivel debe proporcionar los valores predeterminados adecuados para el control.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-170">Your automation peer should provide appropriate default values for your control.</span></span> <span data-ttu-id="c2f3f-171">Tenga en cuenta que XAML que hace referencia al control puede invalidar las implementaciones del mismo nivel de métodos core mediante la inclusión <xref:System.Windows.Automation.AutomationProperties> atributos.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-171">Note that XAML that references your control can override your peer implementations of core methods by including <xref:System.Windows.Automation.AutomationProperties> attributes.</span></span> <span data-ttu-id="c2f3f-172">Por ejemplo, el código XAML siguiente crea un botón que tiene dos propiedades personalizadas [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c2f3f-172">For example, the following XAML creates a button that has two customized [!INCLUDE[TLA2#tla_uiautomation](../../../../includes/tla2sharptla-uiautomation-md.md)] properties.</span></span>  
  
```xaml  
<Button AutomationProperties.Name="Special"   
    AutomationProperties.HelpText="This is a special button."/>  
```  
  
### <a name="implement-pattern-providers"></a><span data-ttu-id="c2f3f-173">Implementar proveedores de patrón</span><span class="sxs-lookup"><span data-stu-id="c2f3f-173">Implement Pattern Providers</span></span>  
 <span data-ttu-id="c2f3f-174">Las interfaces implementadas por un proveedor personalizado se declaran explícitamente si el elemento propietario deriva directamente de <xref:System.Windows.Controls.Control>.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-174">The interfaces implemented by a custom provider are explicitly declared if the owning element derives directly from <xref:System.Windows.Controls.Control>.</span></span> <span data-ttu-id="c2f3f-175">Por ejemplo, el código siguiente declara un elemento del mismo nivel para un <xref:System.Windows.Controls.Control> que implementa un valor de intervalo.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-175">For example, the following code declares a peer for a <xref:System.Windows.Controls.Control> that implements a range value.</span></span>  
  
```csharp  
public class RangePeer1 : FrameworkElementAutomationPeer, IRangeValueProvider { }  
```  
  
```vb  
Public Class RangePeer1  
    Inherits FrameworkElementAutomationPeer  
    Implements IRangeValueProvider  
End Class  
```  
  
 <span data-ttu-id="c2f3f-176">Si el control propietario deriva de un tipo específico de control, como <xref:System.Windows.Controls.Primitives.RangeBase>, el mismo nivel se puede derivar de una clase con el del mismo nivel derivada equivalente.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-176">If the owning control derives from a specific type of control such as <xref:System.Windows.Controls.Primitives.RangeBase>, the peer can be derived from an equivalent derived peer class.</span></span> <span data-ttu-id="c2f3f-177">En este caso, el mismo nivel se derivaría de <xref:System.Windows.Automation.Peers.RangeBaseAutomationPeer>, que proporciona una implementación base de <xref:System.Windows.Automation.Provider.IRangeValueProvider>.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-177">In this case, the peer would derive from <xref:System.Windows.Automation.Peers.RangeBaseAutomationPeer>, which supplies a base implementation of <xref:System.Windows.Automation.Provider.IRangeValueProvider>.</span></span> <span data-ttu-id="c2f3f-178">El código siguiente muestra la declaración de un elemento del mismo nivel como este.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-178">The following code shows the declaration of such a peer.</span></span>  
  
```csharp  
public class RangePeer2 : RangeBaseAutomationPeer { }  
```  
  
```vb  
Public Class RangePeer2  
    Inherits RangeBaseAutomationPeer  
End Class  
```  
  
 <span data-ttu-id="c2f3f-179">Para ver una implementación de ejemplo, consulte [NumericUpDown Custom Control with Theme and UI Automation Support Sample](https://go.microsoft.com/fwlink/?LinkID=160025) (Ejemplo de un control personalizado NumericUpDown y compatibilidad para Automatización de la interfaz de usuario).</span><span class="sxs-lookup"><span data-stu-id="c2f3f-179">For an example implementation, see [NumericUpDown Custom Control with Theme and UI Automation Support Sample](https://go.microsoft.com/fwlink/?LinkID=160025).</span></span>  
  
### <a name="raise-events"></a><span data-ttu-id="c2f3f-180">Generar eventos</span><span class="sxs-lookup"><span data-stu-id="c2f3f-180">Raise Events</span></span>  
 <span data-ttu-id="c2f3f-181">Los clientes de automatización pueden suscribirse a eventos de automatización.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-181">Automation clients can subscribe to automation events.</span></span> <span data-ttu-id="c2f3f-182">Controles personalizados deben notificar los cambios para controlar el estado mediante una llamada a la <xref:System.Windows.Automation.Peers.AutomationPeer.RaiseAutomationEvent%2A> método.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-182">Custom controls must report changes to control state by calling the <xref:System.Windows.Automation.Peers.AutomationPeer.RaiseAutomationEvent%2A> method.</span></span> <span data-ttu-id="c2f3f-183">De forma similar, cuando cambia un valor de propiedad, llame a la <xref:System.Windows.Automation.Peers.AutomationPeer.RaisePropertyChangedEvent%2A> método.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-183">Similarly, when a property value changes, call the <xref:System.Windows.Automation.Peers.AutomationPeer.RaisePropertyChangedEvent%2A> method.</span></span> <span data-ttu-id="c2f3f-184">El código siguiente muestra cómo obtener el objeto del mismo nivel desde el código del control, y cómo llamar a un método para generar un evento.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-184">The following code shows how to get the peer object from within the control code and call a method to raise an event.</span></span> <span data-ttu-id="c2f3f-185">Como optimización, el código determina si hay agentes de escucha para este tipo de evento.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-185">As an optimization, the code determines if there are any listeners for this event type.</span></span> <span data-ttu-id="c2f3f-186">Generar el evento únicamente cuando hay agentes de escucha evita una sobrecarga innecesaria y ayuda a que el control siga respondiendo.</span><span class="sxs-lookup"><span data-stu-id="c2f3f-186">Raising the event only when there are listeners avoids unnecessary overhead and helps the control remain responsive.</span></span>  
  
 [!code-csharp[CustomControlNumericUpDown#RaiseEventFromControl](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp/CustomControlLibrary/NumericUpDown.cs#raiseeventfromcontrol)]
 [!code-vb[CustomControlNumericUpDown#RaiseEventFromControl](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic/customcontrollibrary/numericupdown.vb#raiseeventfromcontrol)]  
  
## <a name="see-also"></a><span data-ttu-id="c2f3f-187">Vea también</span><span class="sxs-lookup"><span data-stu-id="c2f3f-187">See also</span></span>
- [<span data-ttu-id="c2f3f-188">Información general sobre la Automatización de la interfaz de usuario</span><span class="sxs-lookup"><span data-stu-id="c2f3f-188">UI Automation Overview</span></span>](../../../../docs/framework/ui-automation/ui-automation-overview.md)
- [<span data-ttu-id="c2f3f-189">NumericUpDown Custom Control with Theme and UI Automation Support Sample</span><span class="sxs-lookup"><span data-stu-id="c2f3f-189">NumericUpDown Custom Control with Theme and UI Automation Support Sample</span></span>](https://go.microsoft.com/fwlink/?LinkID=160025)
- [<span data-ttu-id="c2f3f-190">Implementación del proveedor de automatización de la interfaz de usuario en el servidor</span><span class="sxs-lookup"><span data-stu-id="c2f3f-190">Server-Side UI Automation Provider Implementation</span></span>](../../../../docs/framework/ui-automation/server-side-ui-automation-provider-implementation.md)
