---
title: Problemas de seguridad en la emisión de la reflexión
ms.date: 03/30/2017
helpviewer_keywords:
- partially trusted code
- emitting dynamic assemblies, security
- reflection emit, security
- reflection emit, partial trust scenarios
- partial trust,emitting dynamic methods
- anonymously hosted dynamic methods [.NET Framework]
- emitting dynamic assemblies,partial trust scenarios
- dynamic assemblies, security
ms.assetid: 0f8bf8fa-b993-478f-87ab-1a1a7976d298
ms.openlocfilehash: d1b6994f7ee9efa9f6472deffb2f3d869606e182
ms.sourcegitcommit: 62285ec11fa8e8424bab00511a90760c60e63c95
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 04/20/2020
ms.locfileid: "81644197"
---
# <a name="security-issues-in-reflection-emit"></a><span data-ttu-id="0c516-102">Problemas de seguridad en la emisión de la reflexión</span><span class="sxs-lookup"><span data-stu-id="0c516-102">Security Issues in Reflection Emit</span></span>
<span data-ttu-id="0c516-103">.NET Framework proporciona tres maneras para emitir Lenguaje Intermedio de Microsoft (MSIL), cada una con sus propios problemas de seguridad:</span><span class="sxs-lookup"><span data-stu-id="0c516-103">The .NET Framework provides three ways to emit Microsoft intermediate language (MSIL), each with its own security issues:</span></span>  
  
- [<span data-ttu-id="0c516-104">Ensamblados dinámicos</span><span class="sxs-lookup"><span data-stu-id="0c516-104">Dynamic assemblies</span></span>](#Dynamic_Assemblies)  
  
- [<span data-ttu-id="0c516-105">Métodos dinámicos hospedados de forma anónima</span><span class="sxs-lookup"><span data-stu-id="0c516-105">Anonymously hosted dynamic methods</span></span>](#Anonymously_Hosted_Dynamic_Methods)  
  
- [<span data-ttu-id="0c516-106">Métodos dinámicos asociados a ensamblados existentes</span><span class="sxs-lookup"><span data-stu-id="0c516-106">Dynamic methods associated with existing assemblies</span></span>](#Dynamic_Methods_Associated_with_Existing_Assemblies)  
  
 <span data-ttu-id="0c516-107">Independientemente de la manera en que se genere código dinámico, la ejecución del código generado exige todos los permisos requeridos por los tipos y métodos que usa el código generado.</span><span class="sxs-lookup"><span data-stu-id="0c516-107">Regardless of the way you generate dynamic code, executing the generated code requires all the permissions that are required by the types and methods the generated code uses.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0c516-108">Los permisos necesarios para la reflexión en código y la emisión de código han cambiado en las sucesivas versiones de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="0c516-108">The permissions that are required for reflecting on code and emitting code have changed with succeeding releases of the .NET Framework.</span></span> <span data-ttu-id="0c516-109">Vea el apartado [Información de versión](#Version_Information) más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="0c516-109">See [Version Information](#Version_Information), later in this topic.</span></span>  
  
<a name="Dynamic_Assemblies"></a>
## <a name="dynamic-assemblies"></a><span data-ttu-id="0c516-110">Ensamblados dinámicos</span><span class="sxs-lookup"><span data-stu-id="0c516-110">Dynamic Assemblies</span></span>  
 <span data-ttu-id="0c516-111">Los ensamblados dinámicos se crean mediante sobrecargas del método <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0c516-111">Dynamic assemblies are created by using overloads of the <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="0c516-112">La mayoría de las sobrecargas de este método quedaron obsoletas en .NET Framework 4 debido a la eliminación de la directiva de seguridad de toda la máquina.</span><span class="sxs-lookup"><span data-stu-id="0c516-112">Most overloads of this method are deprecated in the .NET Framework 4, because of the elimination of machine-wide security policy.</span></span> <span data-ttu-id="0c516-113">(Vea [Security Changes](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes) (Cambios de seguridad)). Las sobrecargas restantes se pueden ejecutar con cualquier código, independientemente del nivel de confianza.</span><span class="sxs-lookup"><span data-stu-id="0c516-113">(See [Security Changes](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes).) The remaining overloads can be executed by any code, regardless of trust level.</span></span> <span data-ttu-id="0c516-114">Estas sobrecargas se dividen en dos grupos: las que especifican una lista de atributos que se aplican al ensamblado dinámico cuando este se crea y las que no lo hacen.</span><span class="sxs-lookup"><span data-stu-id="0c516-114">These overloads fall into two groups: those that specify a list of attributes to apply to the dynamic assembly when it is created, and those that do not.</span></span> <span data-ttu-id="0c516-115">Si no se especifica el modelo de transparencia para el ensamblado durante su creación, mediante la aplicación del atributo <xref:System.Security.SecurityRulesAttribute>, el modelo de transparencia se hereda del ensamblado emisor.</span><span class="sxs-lookup"><span data-stu-id="0c516-115">If you do not specify the transparency model for the assembly, by applying the <xref:System.Security.SecurityRulesAttribute> attribute when you create it, the transparency model is inherited from the emitting assembly.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0c516-116">Los atributos que se aplican al ensamblado dinámico después de crearlo —mediante el método <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A>— no serán efectivos hasta que el ensamblado se guarde en el disco y se vuelva a cargar en la memoria.</span><span class="sxs-lookup"><span data-stu-id="0c516-116">Attributes that you apply to the dynamic assembly after it is created, by using the <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A> method, do not take effect until the assembly has been saved to disk and loaded into memory again.</span></span>  
  
 <span data-ttu-id="0c516-117">El código de un ensamblado dinámico puede tener acceso a los tipos visibles y a los miembros de otros ensamblados.</span><span class="sxs-lookup"><span data-stu-id="0c516-117">Code in a dynamic assembly can access visible types and members in other assemblies.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0c516-118">Los ensamblados dinámicos no usan las marcas <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> y <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> que permiten a los métodos dinámicos tener acceso a los tipos y miembros.</span><span class="sxs-lookup"><span data-stu-id="0c516-118">Dynamic assemblies do not use the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> and <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flags that allow dynamic methods to access nonpublic types and members.</span></span>  
  
 <span data-ttu-id="0c516-119">Los ensamblados dinámicos transitorios se crean en la memoria y nunca se guardan en el disco, por lo que no requieren ningún permiso de acceso de archivo.</span><span class="sxs-lookup"><span data-stu-id="0c516-119">Transient dynamic assemblies are created in memory and never saved to disk, so they require no file access permissions.</span></span> <span data-ttu-id="0c516-120">Guardar un ensamblado dinámico en el disco requiere <xref:System.Security.Permissions.FileIOPermission> con las marcas apropiadas.</span><span class="sxs-lookup"><span data-stu-id="0c516-120">Saving a dynamic assembly to disk requires <xref:System.Security.Permissions.FileIOPermission> with the appropriate flags.</span></span>  
  
### <a name="generating-dynamic-assemblies-from-partially-trusted-code"></a><span data-ttu-id="0c516-121">Generación de ensamblados dinámicos a partir de código de confianza parcial</span><span class="sxs-lookup"><span data-stu-id="0c516-121">Generating Dynamic Assemblies from Partially Trusted Code</span></span>  
 <span data-ttu-id="0c516-122">Tenga en cuenta las condiciones en las que un ensamblado con permisos de Internet puede generar un ensamblado dinámico transitorio y ejecutar su código:</span><span class="sxs-lookup"><span data-stu-id="0c516-122">Consider the conditions in which an assembly with Internet permissions can generate a transient dynamic assembly and execute its code:</span></span>  
  
- <span data-ttu-id="0c516-123">El ensamblado dinámico solo usa miembros y tipos públicos de otros ensamblados.</span><span class="sxs-lookup"><span data-stu-id="0c516-123">The dynamic assembly uses only public types and members of other assemblies.</span></span>  
  
- <span data-ttu-id="0c516-124">Los permisos exigidos por esos tipos y miembros se incluyen en el conjunto de permisos del ensamblado de confianza parcial.</span><span class="sxs-lookup"><span data-stu-id="0c516-124">The permissions demanded by those types and members are included in the grant set of the partially trusted assembly.</span></span>  
  
- <span data-ttu-id="0c516-125">El ensamblado no se guarda en el disco.</span><span class="sxs-lookup"><span data-stu-id="0c516-125">The assembly is not saved to disk.</span></span>  
  
- <span data-ttu-id="0c516-126">Los símbolos de depuración no se generan.</span><span class="sxs-lookup"><span data-stu-id="0c516-126">Debug symbols are not generated.</span></span> <span data-ttu-id="0c516-127">(Los conjuntos de permisos `Internet` y `LocalIntranet` no incluyen los permisos necesarios).</span><span class="sxs-lookup"><span data-stu-id="0c516-127">(`Internet` and `LocalIntranet` permission sets do not include the necessary permissions.)</span></span>  
  
<a name="Anonymously_Hosted_Dynamic_Methods"></a>
## <a name="anonymously-hosted-dynamic-methods"></a><span data-ttu-id="0c516-128">Métodos dinámicos hospedados de forma anónima</span><span class="sxs-lookup"><span data-stu-id="0c516-128">Anonymously Hosted Dynamic Methods</span></span>  
 <span data-ttu-id="0c516-129">Los métodos dinámicos hospedados de forma anónima se crean mediante los dos constructores <xref:System.Reflection.Emit.DynamicMethod> que no especifican un tipo o módulo asociado, <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> y <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span><span class="sxs-lookup"><span data-stu-id="0c516-129">Anonymously hosted dynamic methods are created by using the two <xref:System.Reflection.Emit.DynamicMethod> constructors that do not specify an associated type or module, <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> and <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span></span> <span data-ttu-id="0c516-130">Estos constructores colocan los métodos dinámicos en un ensamblado proporcionado por el sistema, de plena confianza y seguridad transparente.</span><span class="sxs-lookup"><span data-stu-id="0c516-130">These constructors place the dynamic methods in a system-provided, fully trusted, security-transparent assembly.</span></span> <span data-ttu-id="0c516-131">No se requieren permisos para usar estos constructores o emitir código para los métodos dinámicos.</span><span class="sxs-lookup"><span data-stu-id="0c516-131">No permissions are required to use these constructors or to emit code for the dynamic methods.</span></span>  
  
 <span data-ttu-id="0c516-132">En su lugar, cuando se crea un método dinámico hospedado de forma anónima, se captura la pila de llamadas.</span><span class="sxs-lookup"><span data-stu-id="0c516-132">Instead, when an anonymously hosted dynamic method is created, the call stack is captured.</span></span> <span data-ttu-id="0c516-133">Cuando se construye el método, las peticiones de seguridad se realizan en la pila de llamadas capturadas.</span><span class="sxs-lookup"><span data-stu-id="0c516-133">When the method is constructed, security demands are made against the captured call stack.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0c516-134">Desde el punto de vista conceptual, las peticiones se hacen durante la construcción del método.</span><span class="sxs-lookup"><span data-stu-id="0c516-134">Conceptually, demands are made during the construction of the method.</span></span> <span data-ttu-id="0c516-135">Es decir, las peticiones se pueden realizar al emitirse cada instrucción MSIL.</span><span class="sxs-lookup"><span data-stu-id="0c516-135">That is, demands could be made as each MSIL instruction is emitted.</span></span> <span data-ttu-id="0c516-136">En la implementación actual, todas las solicitudes se realizan cuando se llama al método <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType> o cuando se invoca el compilador Just-In-Time (JIT), si el método se invoca sin llamar a <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span><span class="sxs-lookup"><span data-stu-id="0c516-136">In the current implementation, all demands are made when the <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType> method is called or when the just-in-time (JIT) compiler is invoked, if the method is invoked without calling <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span></span>  
  
 <span data-ttu-id="0c516-137">Si el dominio de aplicación lo permite, los métodos dinámicos hospedados de forma anónima pueden omitir las comprobaciones de visibilidad de JIT, con la restricción siguiente: Los tipos y miembros no públicos a los que accede un método dinámico hospedado de forma anónima deben estar en ensamblados cuyos conjuntos de permisos sean iguales (o sean subconjuntos) al conjunto de permisos de la pila de llamadas emisora.</span><span class="sxs-lookup"><span data-stu-id="0c516-137">If the application domain permits it, anonymously hosted dynamic methods can skip JIT visibility checks, subject to the following restriction: The nonpublic types and members accessed by an anonymously hosted dynamic method must be in assemblies whose grant sets are equal to, or subsets of, the grant set of the emitting call stack.</span></span> <span data-ttu-id="0c516-138">Esta capacidad restringida para omitir las comprobaciones de visibilidad JIT está habilitada si el dominio de aplicación concede <xref:System.Security.Permissions.ReflectionPermission> con la marca <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0c516-138">This restricted ability to skip JIT visibility checks is enabled if the application domain grants <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="0c516-139">Si su método usa solo tipos y miembros públicos, no se requieren permisos durante la construcción.</span><span class="sxs-lookup"><span data-stu-id="0c516-139">If your method uses only public types and members, no permissions are required during construction.</span></span>  
  
- <span data-ttu-id="0c516-140">Si especifica que las comprobaciones de visibilidad JIT deben omitirse, la petición que se realiza cuando se construye el método incluye <xref:System.Security.Permissions.ReflectionPermission> con la marca <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> y el conjunto de permisos del ensamblado que contiene el miembro no público al que se tiene acceso.</span><span class="sxs-lookup"><span data-stu-id="0c516-140">If you specify that JIT visibility checks should be skipped, the demand that is made when the method is constructed includes <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag and the grant set of the assembly that contains the nonpublic member that is being accessed.</span></span>  
  
 <span data-ttu-id="0c516-141">Dado que se tiene en cuenta el conjunto de permisos del miembro no público, el código de confianza parcial al que se le ha concedido <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> no puede elevar sus privilegios mediante la ejecución de miembros no públicos de ensamblados de confianza.</span><span class="sxs-lookup"><span data-stu-id="0c516-141">Because the grant set of the nonpublic member is taken into consideration, partially trusted code that has been granted <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> cannot elevate its privileges by executing nonpublic members of trusted assemblies.</span></span>  
  
 <span data-ttu-id="0c516-142">Como con cualquier otro código emitido, la ejecución del método dinámico requiere los permisos exigidos por los métodos que usa el método dinámico.</span><span class="sxs-lookup"><span data-stu-id="0c516-142">As with any other emitted code, executing the dynamic method requires whatever permissions are demanded by the methods the dynamic method uses.</span></span>  
  
 <span data-ttu-id="0c516-143">El ensamblado de sistema que hospeda los métodos dinámicos hospedados de forma anónima usa el modelo de transparencia <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType>, que es el que se utilizaba en .NET Framework antes de la versión .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="0c516-143">The system assembly that hosts anonymously-hosted dynamic methods uses the <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType> transparency model, which is the transparency model that was used in the .NET Framework before the .NET Framework 4.</span></span>  
  
 <span data-ttu-id="0c516-144">Para obtener más información, vea la clase <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="0c516-144">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-anonymously-hosted-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="0c516-145">Generación de métodos dinámicos hospedados de forma anónima a partir de código de confianza parcial</span><span class="sxs-lookup"><span data-stu-id="0c516-145">Generating Anonymously Hosted Dynamic Methods from Partially Trusted Code</span></span>  
 <span data-ttu-id="0c516-146">Tenga en cuenta las condiciones en las que un ensamblado con permisos de Internet puede generar un método dinámico hospedado de forma anónima y ejecutarlo:</span><span class="sxs-lookup"><span data-stu-id="0c516-146">Consider the conditions in which an assembly with Internet permissions can generate an anonymously hosted dynamic method and execute it:</span></span>  
  
- <span data-ttu-id="0c516-147">El método dinámico solo usa miembros y tipos públicos.</span><span class="sxs-lookup"><span data-stu-id="0c516-147">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="0c516-148">Si su conjunto de permisos incluye <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, puede usar los tipos y miembros no públicos de cualquier ensamblado cuyo conjunto de permisos sea igual al conjunto de permisos (o un subconjunto del mismo) del ensamblado emisor.</span><span class="sxs-lookup"><span data-stu-id="0c516-148">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, it can use nonpublic types and members of any assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
- <span data-ttu-id="0c516-149">Los permisos requeridos por todos los tipos y miembros usados por el método dinámico se incluyen en el conjunto de permisos del ensamblado de confianza parcial.</span><span class="sxs-lookup"><span data-stu-id="0c516-149">The permissions that are required by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0c516-150">Los métodos dinámicos no admiten símbolos de depuración.</span><span class="sxs-lookup"><span data-stu-id="0c516-150">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Dynamic_Methods_Associated_with_Existing_Assemblies"></a>
## <a name="dynamic-methods-associated-with-existing-assemblies"></a><span data-ttu-id="0c516-151">Métodos dinámicos asociados a ensamblados existentes</span><span class="sxs-lookup"><span data-stu-id="0c516-151">Dynamic Methods Associated with Existing Assemblies</span></span>  
 <span data-ttu-id="0c516-152">Para asociar un método dinámico con un tipo o módulo en un ensamblado existente, use cualquiera de los constructores <xref:System.Reflection.Emit.DynamicMethod> que especifican el tipo o módulo asociado.</span><span class="sxs-lookup"><span data-stu-id="0c516-152">To associate a dynamic method with a type or module in an existing assembly, use any of the <xref:System.Reflection.Emit.DynamicMethod> constructors that specify the associated type or module.</span></span> <span data-ttu-id="0c516-153">Los permisos necesarios para llamar a estos constructores varían, ya que al asociar un método dinámico con un tipo o módulo existente, el método dinámico obtiene acceso a los miembros y tipos no públicos:</span><span class="sxs-lookup"><span data-stu-id="0c516-153">The permissions that are required to call these constructors vary, because associating a dynamic method with an existing type or module gives the dynamic method access to nonpublic types and members:</span></span>  
  
- <span data-ttu-id="0c516-154">Un método dinámico que está asociado a un tipo tiene acceso a todos los miembros de ese tipo, incluso a los miembros privados, y a todos los tipos y miembros internos del ensamblado que contiene el tipo asociado.</span><span class="sxs-lookup"><span data-stu-id="0c516-154">A dynamic method that is associated with a type has access to all members of that type, even private members, and to all internal types and members in the assembly that contains the associated type.</span></span>  
  
- <span data-ttu-id="0c516-155">Un método dinámico que está asociado a un módulo tiene acceso a todos los tipos y miembros `internal` (`Friend` en Visual Basic, `assembly` en los metadatos de Common Language Runtime) del módulo.</span><span class="sxs-lookup"><span data-stu-id="0c516-155">A dynamic method that is associated with a module has access to all the `internal` types and members (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the module.</span></span>  
  
 <span data-ttu-id="0c516-156">Además, se puede usar un constructor que especifique la capacidad de omitir las comprobaciones de visibilidad del compilador JIT.</span><span class="sxs-lookup"><span data-stu-id="0c516-156">In addition, you can use a constructor that specifies the ability to skip the visibility checks of the JIT compiler.</span></span> <span data-ttu-id="0c516-157">De este modo, el método dinámico obtiene acceso a todos los tipos y miembros de todos los ensamblados, con independencia del nivel de acceso.</span><span class="sxs-lookup"><span data-stu-id="0c516-157">Doing so gives your dynamic method access to all types and members in all assemblies, regardless of access level.</span></span>  
  
 <span data-ttu-id="0c516-158">Los permisos exigidos por el constructor dependen del nivel de acceso que decida conceder al método dinámico:</span><span class="sxs-lookup"><span data-stu-id="0c516-158">The permissions demanded by the constructor depend on how much access you decide to give your dynamic method:</span></span>  
  
- <span data-ttu-id="0c516-159">Si su método solo usa miembros y tipos públicos y lo asocia con su propio tipo o su propio módulo, no se requiere ningún permiso.</span><span class="sxs-lookup"><span data-stu-id="0c516-159">If your method uses only public types and members, and you associate it with your own type or your own module, no permissions are required.</span></span>  
  
- <span data-ttu-id="0c516-160">Si especifica que se deben omitir las comprobaciones de visibilidad JIT, el constructor exige <xref:System.Security.Permissions.ReflectionPermission> con la marca <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0c516-160">If you specify that JIT visibility checks should be skipped, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="0c516-161">Si asocia el método dinámico con otro tipo, incluso de su propio ensamblado, el constructor exige <xref:System.Security.Permissions.ReflectionPermission> con la marca <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> y <xref:System.Security.Permissions.SecurityPermission> con la marca <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0c516-161">If you associate the dynamic method with another type, even another type in your own assembly, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag and <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="0c516-162">Si asocia el método dinámico con un tipo o módulo de otro ensamblado, el constructor exige dos cosas: <xref:System.Security.Permissions.ReflectionPermission> con la marca <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> y el conjunto de permisos del ensamblado que contiene el otro módulo.</span><span class="sxs-lookup"><span data-stu-id="0c516-162">If you associate the dynamic method with a type or module in another assembly, the constructor demands two things: <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag, and the grant set of the assembly that contains the other module.</span></span> <span data-ttu-id="0c516-163">Es decir, la pila de llamadas debe incluir todos los permisos del conjunto de permisos del módulo de destino, además de <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0c516-163">That is, your call stack must include all the permissions in the grant set of the target module, plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="0c516-164">Por motivos de compatibilidad con versiones anteriores, si se produce un error en la petición del conjunto de permisos más <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, el constructor exige <xref:System.Security.Permissions.SecurityPermission> con la marca <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0c516-164">For backward compatibility, if the demand for the target grant set plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> fails, the constructor demands <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
 <span data-ttu-id="0c516-165">Aunque los elementos de esta lista se describen en términos del conjunto de permisos concedidos del ensamblado emisor, recuerde que las peticiones se realizan en la pila de llamadas completa, incluido el límite del dominio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="0c516-165">Although the items in this list are described in terms of the grant set of the emitting assembly, remember that the demands are made against the full call stack, including the application domain boundary.</span></span>  
  
 <span data-ttu-id="0c516-166">Para obtener más información, vea la clase <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="0c516-166">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="0c516-167">Generación de métodos dinámicos a partir de código de confianza parcial</span><span class="sxs-lookup"><span data-stu-id="0c516-167">Generating Dynamic Methods from Partially Trusted Code</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0c516-168">La manera recomendada para generar métodos dinámicos a partir de código de confianza parcial es usar [métodos dinámicos hospedados de forma anónima](#Anonymously_Hosted_Dynamic_Methods).</span><span class="sxs-lookup"><span data-stu-id="0c516-168">The recommended way to generate dynamic methods from partially trusted code is to use [anonymously hosted dynamic methods](#Anonymously_Hosted_Dynamic_Methods).</span></span>  
  
 <span data-ttu-id="0c516-169">Tenga en cuenta las condiciones en las que un ensamblado con permisos de Internet puede generar un método dinámico y ejecutarlo:</span><span class="sxs-lookup"><span data-stu-id="0c516-169">Consider the conditions in which an assembly with Internet permissions can generate a dynamic method and execute it:</span></span>  
  
- <span data-ttu-id="0c516-170">El método dinámico está asociado con el módulo o el tipo que lo emite, o su conjunto de permisos incluye <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> y está asociado con un módulo de un ensamblado cuyo conjunto de permisos es igual al conjunto de permisos del ensamblado emisor (o un subconjunto del mismo).</span><span class="sxs-lookup"><span data-stu-id="0c516-170">Either the dynamic method is associated with the module or type that emits it, or its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
- <span data-ttu-id="0c516-171">El método dinámico solo usa miembros y tipos públicos.</span><span class="sxs-lookup"><span data-stu-id="0c516-171">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="0c516-172">Si su conjunto de permisos incluye <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> y está asociado con un módulo de un ensamblado cuyo conjunto de permisos es igual al conjunto de permisos del ensamblado emisor (o un subconjunto del mismo), puede usar tipos y miembros marcados `internal` (`Friend` en Visual Basic, `assembly` en los metadatos de Common Language Runtime) en el módulo asociado.</span><span class="sxs-lookup"><span data-stu-id="0c516-172">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly, it can use types and members marked `internal` (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the associated module.</span></span>  
  
- <span data-ttu-id="0c516-173">Los permisos exigidos por todos los tipos y miembros usados por el método dinámico se incluyen en el conjunto de permisos del ensamblado de confianza parcial.</span><span class="sxs-lookup"><span data-stu-id="0c516-173">The permissions demanded by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
- <span data-ttu-id="0c516-174">El método dinámico no omite las comprobaciones de visibilidad JIT.</span><span class="sxs-lookup"><span data-stu-id="0c516-174">The dynamic method does not skip JIT visibility checks.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0c516-175">Los métodos dinámicos no admiten símbolos de depuración.</span><span class="sxs-lookup"><span data-stu-id="0c516-175">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Version_Information"></a>
## <a name="version-information"></a><span data-ttu-id="0c516-176">Información de versión</span><span class="sxs-lookup"><span data-stu-id="0c516-176">Version Information</span></span>  
 <span data-ttu-id="0c516-177">A partir de .NET Framework 4, se elimina la directiva de seguridad de todo el equipo y la transparencia en seguridad se convierte en el mecanismo de cumplimiento predeterminado.</span><span class="sxs-lookup"><span data-stu-id="0c516-177">Starting with the .NET Framework 4, machine-wide security policy is eliminated and security transparency becomes the default enforcement mechanism.</span></span> <span data-ttu-id="0c516-178">Vea [Security Changes](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes) (Cambios de seguridad).</span><span class="sxs-lookup"><span data-stu-id="0c516-178">See [Security Changes](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes).</span></span>  
  
 <span data-ttu-id="0c516-179">A partir de .NET Framework 2.0 Service Pack 1, ya no es obligatorio usar <xref:System.Security.Permissions.ReflectionPermission> con la marca <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> al emitir ensamblados y métodos dinámicos.</span><span class="sxs-lookup"><span data-stu-id="0c516-179">Starting with the .NET Framework 2.0 Service Pack 1, <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is no longer required when emitting dynamic assemblies and dynamic methods.</span></span> <span data-ttu-id="0c516-180">Esta marca es necesaria en todas las versiones anteriores de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="0c516-180">This flag is required in all earlier versions of the .NET Framework.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="0c516-181"><xref:System.Security.Permissions.ReflectionPermission> con la marca <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> se incluye de forma predeterminada en los conjuntos de permisos `FullTrust` y `LocalIntranet`, pero no en el conjunto de permisos `Internet`.</span><span class="sxs-lookup"><span data-stu-id="0c516-181"><xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is included by default in the `FullTrust` and `LocalIntranet` named permission sets, but not in the `Internet` permission set.</span></span> <span data-ttu-id="0c516-182">Por consiguiente, en versiones anteriores de .NET Framework se puede usar una biblioteca con permisos de Internet, pero solo si ejecuta un <xref:System.Security.PermissionSet.Assert%2A> para <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>.</span><span class="sxs-lookup"><span data-stu-id="0c516-182">Therefore, in earlier versions of the .NET Framework, a library can be used with Internet permissions only if it executes an <xref:System.Security.PermissionSet.Assert%2A> for <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>.</span></span> <span data-ttu-id="0c516-183">Estas bibliotecas requieren una revisión cuidadosa de la seguridad porque los errores de codificación pueden provocar vulnerabilidades de seguridad.</span><span class="sxs-lookup"><span data-stu-id="0c516-183">Such libraries require careful security review because coding errors could result in security holes.</span></span> <span data-ttu-id="0c516-184">.NET Framework 2.0 SP1 permite emitir código en escenarios de confianza parcial sin emitir ninguna petición de seguridad, porque la generación de código no es en sí una operación que requiera privilegios.</span><span class="sxs-lookup"><span data-stu-id="0c516-184">The .NET Framework 2.0 SP1 allows code to be emitted in partial trust scenarios without issuing any security demands, because generating code is not inherently a privileged operation.</span></span> <span data-ttu-id="0c516-185">Es decir, el código generado no tiene más permisos que el ensamblado que lo emite.</span><span class="sxs-lookup"><span data-stu-id="0c516-185">That is, the generated code has no more permissions than the assembly that emits it.</span></span> <span data-ttu-id="0c516-186">Esto permite que las bibliotecas que emiten código sean transparentes en seguridad y elimina la necesidad de declarar <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, lo que simplifica la tarea de escribir una biblioteca segura.</span><span class="sxs-lookup"><span data-stu-id="0c516-186">This allows libraries that emit code to be security transparent and removes the need to assert <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, which simplifies the task of writing a secure library.</span></span>  
  
 <span data-ttu-id="0c516-187">Además, .NET Framework 2.0 SP1 presenta la marca <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> para el acceso a los tipos y miembros no públicos desde métodos dinámicos de confianza parcial.</span><span class="sxs-lookup"><span data-stu-id="0c516-187">In addition, the .NET Framework 2.0 SP1 introduces the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag for accessing nonpublic types and members from partially trusted dynamic methods.</span></span> <span data-ttu-id="0c516-188">Las versiones anteriores de .NET Framework requieren la marca <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> para los métodos dinámicos que acceden a tipos y miembros no públicos; es un permiso que nunca debe concederse al código de confianza parcial.</span><span class="sxs-lookup"><span data-stu-id="0c516-188">Earlier versions of the .NET Framework require the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag for dynamic methods that access nonpublic types and members; this is a permission that should never be granted to partially trusted code.</span></span>  
  
 <span data-ttu-id="0c516-189">Por último, .NET Framework 2.0 SP1 presenta métodos hospedados de forma anónima.</span><span class="sxs-lookup"><span data-stu-id="0c516-189">Finally, the .NET Framework 2.0 SP1 introduces anonymously hosted methods.</span></span>  
  
### <a name="obtaining-information-on-types-and-members"></a><span data-ttu-id="0c516-190">Obtener información sobre tipos y miembros</span><span class="sxs-lookup"><span data-stu-id="0c516-190">Obtaining Information on Types and Members</span></span>  
 <span data-ttu-id="0c516-191">A partir de .NET Framework 2.0, no se requieren permisos para obtener información sobre tipos y miembros no públicos.</span><span class="sxs-lookup"><span data-stu-id="0c516-191">Starting with the .NET Framework 2.0, no permissions are required to obtain information about nonpublic types and members.</span></span> <span data-ttu-id="0c516-192">A fin de obtener la información necesaria para emitir métodos dinámicos, se usa la reflexión.</span><span class="sxs-lookup"><span data-stu-id="0c516-192">Reflection is used to obtain information needed to emit dynamic methods.</span></span> <span data-ttu-id="0c516-193">Por ejemplo, los objetos <xref:System.Reflection.MethodInfo> se usan para emitir llamadas a métodos.</span><span class="sxs-lookup"><span data-stu-id="0c516-193">For example, <xref:System.Reflection.MethodInfo> objects are used to emit method calls.</span></span> <span data-ttu-id="0c516-194">Las versiones anteriores de .NET Framework requieren <xref:System.Security.Permissions.ReflectionPermission> con la marca <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0c516-194">Earlier versions of the .NET Framework require <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType> flag.</span></span> <span data-ttu-id="0c516-195">Para obtener más información, vea el artículo sobre [consideraciones de seguridad sobre la reflexión](security-considerations-for-reflection.md).</span><span class="sxs-lookup"><span data-stu-id="0c516-195">For more information, see [Security Considerations for Reflection](security-considerations-for-reflection.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0c516-196">Vea también</span><span class="sxs-lookup"><span data-stu-id="0c516-196">See also</span></span>

- [<span data-ttu-id="0c516-197">Consideraciones de seguridad sobre la reflexión</span><span class="sxs-lookup"><span data-stu-id="0c516-197">Security Considerations for Reflection</span></span>](security-considerations-for-reflection.md)
- [<span data-ttu-id="0c516-198">Emitir métodos y ensamblados dinámicos</span><span class="sxs-lookup"><span data-stu-id="0c516-198">Emitting Dynamic Methods and Assemblies</span></span>](emitting-dynamic-methods-and-assemblies.md)
