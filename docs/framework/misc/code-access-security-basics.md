---
title: Conceptos básicos sobre la seguridad de acceso del código
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- security [.NET Framework], code access security
ms.assetid: 4eaa6535-d9fe-41a1-91d8-b437cfc16921
ms.openlocfilehash: 352fa41cb9d3136f853b068d0101a6dcab5dfd7c
ms.sourcegitcommit: 62285ec11fa8e8424bab00511a90760c60e63c95
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/20/2020
ms.locfileid: "81645773"
---
# <a name="code-access-security-basics"></a><span data-ttu-id="d31af-102">Conceptos básicos sobre la seguridad de acceso del código</span><span class="sxs-lookup"><span data-stu-id="d31af-102">Code Access Security Basics</span></span>

[!INCLUDE[net_security_note](../../../includes/net-security-note-md.md)]

<span data-ttu-id="d31af-103">Todas las aplicaciones que tengan como destino Common Language Runtime (es decir, todas las aplicaciones administradas) deben interactuar con el sistema de seguridad del runtime.</span><span class="sxs-lookup"><span data-stu-id="d31af-103">Every application that targets the common language runtime (that is, every managed application) must interact with the runtime's security system.</span></span> <span data-ttu-id="d31af-104">Cuando se carga una aplicación administrada, su host le concede automáticamente un conjunto de permisos.</span><span class="sxs-lookup"><span data-stu-id="d31af-104">When a managed application is loaded, its host automatically grants it a set of permissions.</span></span> <span data-ttu-id="d31af-105">Estos permisos están determinados por la configuración de seguridad local del host o por el espacio aislado en el que se encuentra la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d31af-105">These permissions are determined by the host's local security settings or by the sandbox the application is in.</span></span> <span data-ttu-id="d31af-106">En función de estos permisos, la aplicación se ejecutará correctamente o generará una excepción de seguridad.</span><span class="sxs-lookup"><span data-stu-id="d31af-106">Depending on these permissions, the application either runs properly or generates a security exception.</span></span>

<span data-ttu-id="d31af-107">El host predeterminado para las aplicaciones de escritorio permite que el código se ejecute con plena confianza.</span><span class="sxs-lookup"><span data-stu-id="d31af-107">The default host for desktop applications allows code to run in full trust.</span></span> <span data-ttu-id="d31af-108">Por lo tanto, si la aplicación tiene como destino el escritorio, tendrá un conjunto de permisos no restringido.</span><span class="sxs-lookup"><span data-stu-id="d31af-108">Therefore, if your application targets the desktop, it has an unrestricted permission set.</span></span> <span data-ttu-id="d31af-109">Otros hosts o espacios aislados proporcionan un conjunto de permisos limitado para las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="d31af-109">Other hosts or sandboxes provide a limited permission set for applications.</span></span> <span data-ttu-id="d31af-110">Dado que el conjunto de permisos puede cambiar de un host a otro, deberá diseñar la aplicación para que tan solo use los permisos que permite el host de destino.</span><span class="sxs-lookup"><span data-stu-id="d31af-110">Because the permission set can change from host to host, you must design your application to use only the permissions that your target host allows.</span></span>

<span data-ttu-id="d31af-111">Debe estar familiarizado con los siguientes conceptos de seguridad de acceso del código para escribir aplicaciones eficaces que tengan como destino Common Language Runtime:</span><span class="sxs-lookup"><span data-stu-id="d31af-111">You must be familiar with the following code access security concepts in order to write effective applications that target the common language runtime:</span></span>

- <span data-ttu-id="d31af-112">**Código con seguridad de tipos:** el código con seguridad de tipos es código que tiene acceso a tipos solo de formas bien definidas y permitidas.</span><span class="sxs-lookup"><span data-stu-id="d31af-112">**Type-safe code**: Type-safe code is code that accesses types only in well-defined, allowable ways.</span></span> <span data-ttu-id="d31af-113">Por ejemplo, dada una referencia de objeto válido, el código con seguridad de tipos puede tener acceso a la memoria en desplazamientos fijos que se corresponden con miembros de campo reales.</span><span class="sxs-lookup"><span data-stu-id="d31af-113">For example, given a valid object reference, type-safe code can access memory at fixed offsets that correspond to actual field members.</span></span> <span data-ttu-id="d31af-114">El código no tiene seguridad de tipos si tiene acceso a la memoria en desplazamientos arbitrarios fuera del intervalo de memoria que pertenece a esos campos del objeto expuestos públicamente.</span><span class="sxs-lookup"><span data-stu-id="d31af-114">If the code accesses memory at arbitrary offsets outside the range of memory that belongs to that object's publicly exposed fields, it is not type-safe.</span></span> <span data-ttu-id="d31af-115">Para que el código pueda beneficiarse de la seguridad de acceso del código, use un compilador que genere código con seguridad de tipos comprobable.</span><span class="sxs-lookup"><span data-stu-id="d31af-115">To enable code to benefit from code access security, you must use a compiler that generates verifiably type-safe code.</span></span> <span data-ttu-id="d31af-116">Para obtener más información, vea la sección Escribir código seguro de tipo [verificable](#typesafe_code) más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="d31af-116">For more information, see the [Writing Verifiably Type-Safe Code](#typesafe_code) section later in this topic.</span></span>

- <span data-ttu-id="d31af-117">**Sintaxis imperativa y declarativa:** el código destinado a Common Language Runtime puede interactuar con el sistema de seguridad solicitando permisos, exigiendo que los llamadores tengan permisos especificados y reemplazando ciertas configuraciones de seguridad (dados suficientes privilegios).</span><span class="sxs-lookup"><span data-stu-id="d31af-117">**Imperative and declarative syntax**: Code that targets the common language runtime can interact with the security system by requesting permissions, demanding that callers have specified permissions, and overriding certain security settings (given enough privileges).</span></span> <span data-ttu-id="d31af-118">Para interactuar mediante programación con el sistema de seguridad de .NET Framework se usan dos formas de sintaxis: sintaxis declarativa y la sintaxis imperativa.</span><span class="sxs-lookup"><span data-stu-id="d31af-118">You use two forms of syntax to programmatically interact with the .NET Framework security system: declarative syntax and imperative syntax.</span></span> <span data-ttu-id="d31af-119">Las llamadas declarativas se realizan mediante atributos y las llamadas imperativas se realizan con nuevas instancias de clases dentro del código.</span><span class="sxs-lookup"><span data-stu-id="d31af-119">Declarative calls are performed using attributes; imperative calls are performed using new instances of classes within your code.</span></span> <span data-ttu-id="d31af-120">Hay llamadas que solo se pueden realizar de manera imperativa, otras solo de forma declarativa y algunas se pueden realizar de ambas maneras.</span><span class="sxs-lookup"><span data-stu-id="d31af-120">Some calls can be performed only imperatively, others can be performed only declaratively, and some calls can be performed in either manner.</span></span>

- <span data-ttu-id="d31af-121">**Bibliotecas de clases seguras:** una biblioteca de clases segura utiliza demandas de seguridad para garantizar que los llamadores de la biblioteca tengan permiso para tener acceso a los recursos que expone la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="d31af-121">**Secure class libraries**: A secure class library uses security demands to ensure that the library's callers have permission to access the resources that the library exposes.</span></span> <span data-ttu-id="d31af-122">Por ejemplo, una biblioteca de clases segura podría tener un método para crear archivos que requiera que los llamadores tengan permisos para crear archivos.</span><span class="sxs-lookup"><span data-stu-id="d31af-122">For example, a secure class library might have a method for creating files that would demand that its callers have permissions to create files.</span></span> <span data-ttu-id="d31af-123">.NET Framework consta de bibliotecas de clases seguras.</span><span class="sxs-lookup"><span data-stu-id="d31af-123">The .NET Framework consists of secure class libraries.</span></span> <span data-ttu-id="d31af-124">Debe tener en cuenta los permisos necesarios para el acceso a cualquier biblioteca que use el código.</span><span class="sxs-lookup"><span data-stu-id="d31af-124">You should be aware of the permissions required to access any library that your code uses.</span></span> <span data-ttu-id="d31af-125">Para obtener más información, consulte la sección Uso de bibliotecas de [clases seguras](#secure_library) más adelante en este tema.</span><span class="sxs-lookup"><span data-stu-id="d31af-125">For more information, see the [Using Secure Class Libraries](#secure_library) section later in this topic.</span></span>

- <span data-ttu-id="d31af-126">**Código transparente:** a partir de .NET Framework 4, además de identificar permisos específicos, también debe determinar si el código debe ejecutarse como transparente para la seguridad.</span><span class="sxs-lookup"><span data-stu-id="d31af-126">**Transparent code**: Starting with the .NET Framework 4, in addition to identifying specific permissions, you must also determine whether your code should run as security-transparent.</span></span> <span data-ttu-id="d31af-127">El código transparente en seguridad no puede llamar a tipos o miembros que se identifican como críticos para la seguridad.</span><span class="sxs-lookup"><span data-stu-id="d31af-127">Security-transparent code cannot call types or members that are identified as security-critical.</span></span> <span data-ttu-id="d31af-128">Esta regla se aplica a las aplicaciones de plena confianza y a las de confianza parcial.</span><span class="sxs-lookup"><span data-stu-id="d31af-128">This rule applies to full-trust applications as well as partially trusted applications.</span></span> <span data-ttu-id="d31af-129">Para obtener más información, consulte [Código transparente](security-transparent-code.md)de seguridad .</span><span class="sxs-lookup"><span data-stu-id="d31af-129">For more information, see [Security-Transparent Code](security-transparent-code.md).</span></span>

<a name="typesafe_code"></a>

## <a name="writing-verifiably-type-safe-code"></a><span data-ttu-id="d31af-130">Escritura de código con seguridad de tipos comprobable</span><span class="sxs-lookup"><span data-stu-id="d31af-130">Writing Verifiably Type-Safe Code</span></span>

<span data-ttu-id="d31af-131">La compilación Just-In-Time (JIT) ejecuta un proceso de comprobación que examina el código e intenta determinar si el código tiene seguridad de tipos.</span><span class="sxs-lookup"><span data-stu-id="d31af-131">Just-in-time (JIT) compilation performs a verification process that examines code and tries to determine whether the code is type-safe.</span></span> <span data-ttu-id="d31af-132">El código que se ha demostrado durante la verificación es seguro para tipos se denomina código con seguridad *de tipos verificable.*</span><span class="sxs-lookup"><span data-stu-id="d31af-132">Code that is proven during verification to be type-safe is called *verifiably type-safe code*.</span></span> <span data-ttu-id="d31af-133">Es posible que el código tenga seguridad de tipos aunque no se pueda comprobar que sea así debido a las limitaciones del proceso de comprobación o del compilador.</span><span class="sxs-lookup"><span data-stu-id="d31af-133">Code can be type-safe, yet might not be verifiably type-safe because of the limitations of the verification process or of the compiler.</span></span> <span data-ttu-id="d31af-134">No todos los lenguajes tienen seguridad de tipos y algunos compiladores de lenguaje, como Microsoft Visual C++, no pueden generar código administrado con seguridad de tipos comprobable.</span><span class="sxs-lookup"><span data-stu-id="d31af-134">Not all languages are type-safe, and some language compilers, such as Microsoft Visual C++, cannot generate verifiably type-safe managed code.</span></span> <span data-ttu-id="d31af-135">Para determinar si su compilador de lenguaje genera código con seguridad de tipos comprobable, consulte la documentación del compilador.</span><span class="sxs-lookup"><span data-stu-id="d31af-135">To determine whether the language compiler you use generates verifiably type-safe code, consult the compiler's documentation.</span></span> <span data-ttu-id="d31af-136">Si usa un compilador de lenguaje que genera código con seguridad de tipos verificable solo cuando evita determinadas construcciones de lenguaje, es posible que desee usar la [herramienta PEVerify](../tools/peverify-exe-peverify-tool.md) para determinar si el código es seguro para tipos.</span><span class="sxs-lookup"><span data-stu-id="d31af-136">If you use a language compiler that generates verifiably type-safe code only when you avoid certain language constructs, you might want to use the [PEVerify tool](../tools/peverify-exe-peverify-tool.md) to determine whether your code is verifiably type-safe.</span></span>

<span data-ttu-id="d31af-137">El código sin seguridad de tipos comprobable puede intentar ejecutarse si la directiva de seguridad permite al código omitir esta comprobación.</span><span class="sxs-lookup"><span data-stu-id="d31af-137">Code that is not verifiably type-safe can attempt to execute if security policy allows the code to bypass verification.</span></span> <span data-ttu-id="d31af-138">Sin embargo, dado que la seguridad de tipos es una parte esencial del mecanismo de runtime para aislar los ensamblados, la seguridad no se puede aplicar de forma confiable si el código infringe las reglas de seguridad de tipos.</span><span class="sxs-lookup"><span data-stu-id="d31af-138">However, because type safety is an essential part of the runtime's mechanism for isolating assemblies, security cannot be reliably enforced if code violates the rules of type safety.</span></span> <span data-ttu-id="d31af-139">De forma predeterminada, el código sin seguridad de tipos solo se puede ejecutar si se origina desde el equipo local.</span><span class="sxs-lookup"><span data-stu-id="d31af-139">By default, code that is not type-safe is allowed to run only if it originates from the local computer.</span></span> <span data-ttu-id="d31af-140">Por lo tanto, el código móvil debe tener seguridad de tipos.</span><span class="sxs-lookup"><span data-stu-id="d31af-140">Therefore, mobile code should be type-safe.</span></span>

<a name="secure_library"></a>

## <a name="using-secure-class-libraries"></a><span data-ttu-id="d31af-141">Uso de bibliotecas de clases seguras</span><span class="sxs-lookup"><span data-stu-id="d31af-141">Using Secure Class Libraries</span></span>

<span data-ttu-id="d31af-142">Si el código solicita y se le conceden los permisos requeridos por la biblioteca de clases, se le permitirá tener acceso a la biblioteca y los recursos que expone la biblioteca estarán protegidos frente a accesos no autorizados.</span><span class="sxs-lookup"><span data-stu-id="d31af-142">If your code requests and is granted the permissions required by the class library, it will be allowed to access the library and the resources that the library exposes will be protected from unauthorized access.</span></span> <span data-ttu-id="d31af-143">Si el código no tiene los permisos adecuados, no podrá tener acceso a la biblioteca de clases y el código malintencionado no podrá usar el código para obtener acceso indirectamente a los recursos protegidos.</span><span class="sxs-lookup"><span data-stu-id="d31af-143">If your code does not have the appropriate permissions, it will not be allowed to access the class library, and malicious code will not be able to use your code to indirectly access protected resources.</span></span> <span data-ttu-id="d31af-144">El resto de código que llame a su código también deber tener permiso de acceso a la biblioteca.</span><span class="sxs-lookup"><span data-stu-id="d31af-144">Other code that calls your code must also have permission to access the library.</span></span> <span data-ttu-id="d31af-145">Si no es así, su código tampoco podrá ejecutarse.</span><span class="sxs-lookup"><span data-stu-id="d31af-145">If it does not, your code will be restricted from running as well.</span></span>

<span data-ttu-id="d31af-146">Seguridad de acceso del código no elimina la posibilidad de que se produzcan errores humanos al escribir código.</span><span class="sxs-lookup"><span data-stu-id="d31af-146">Code access security does not eliminate the possibility of human error in writing code.</span></span> <span data-ttu-id="d31af-147">Sin embargo, si la aplicación usa bibliotecas de clases seguras para obtener acceso a recursos protegidos, se reduce el riesgo de seguridad para el código de la aplicación, ya que las bibliotecas de clases se examinan detenidamente para detectar posibles problemas de seguridad.</span><span class="sxs-lookup"><span data-stu-id="d31af-147">However, if your application uses secure class libraries to access protected resources, the security risk for application code is decreased, because class libraries are closely scrutinized for potential security problems.</span></span>

## <a name="declarative-security"></a><span data-ttu-id="d31af-148">Seguridad declarativa</span><span class="sxs-lookup"><span data-stu-id="d31af-148">Declarative Security</span></span>

<span data-ttu-id="d31af-149">La sintaxis de seguridad declarativa utiliza [atributos](../../standard/attributes/index.md) para colocar información de seguridad en los [metadatos](../../standard/metadata-and-self-describing-components.md) del código.</span><span class="sxs-lookup"><span data-stu-id="d31af-149">Declarative security syntax uses [attributes](../../standard/attributes/index.md) to place security information into the [metadata](../../standard/metadata-and-self-describing-components.md) of your code.</span></span> <span data-ttu-id="d31af-150">Los atributos se pueden colocar en el nivel de ensamblado, clase o miembro para indicar el tipo de solicitud, petición o invalidación que desea usar.</span><span class="sxs-lookup"><span data-stu-id="d31af-150">Attributes can be placed at the assembly, class, or member level, to indicate the type of request, demand, or override you want to use.</span></span> <span data-ttu-id="d31af-151">Las solicitudes se usan en aplicaciones destinadas a Common Language Runtime para informar al sistema de seguridad de runtime sobre los permisos que la aplicación necesita o no desea.</span><span class="sxs-lookup"><span data-stu-id="d31af-151">Requests are used in applications that target the common language runtime to inform the runtime security system about the permissions that your application needs or does not want.</span></span> <span data-ttu-id="d31af-152">Las peticiones e invalidaciones se usan en las bibliotecas para ayudar a proteger los recursos de los llamadores o para invalidar el comportamiento de seguridad predeterminado.</span><span class="sxs-lookup"><span data-stu-id="d31af-152">Demands and overrides are used in libraries to help protect resources from callers or to override default security behavior.</span></span>

> [!NOTE]
> <span data-ttu-id="d31af-153">En .NET Framework 4, se han producido cambios importantes en el modelo de seguridad y la terminología de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="d31af-153">In the .NET Framework 4, there have been important changes to the .NET Framework security model and terminology.</span></span> <span data-ttu-id="d31af-154">Para obtener más información acerca de estos cambios, vea [Cambios](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes)de seguridad .</span><span class="sxs-lookup"><span data-stu-id="d31af-154">For more information about these changes, see [Security Changes](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes).</span></span>

<span data-ttu-id="d31af-155">Para usar llamadas de seguridad declarativas, debe inicializar los datos de estado del objeto de permiso para que represente la forma concreta del permiso necesario.</span><span class="sxs-lookup"><span data-stu-id="d31af-155">In order to use declarative security calls, you must initialize the state data of the permission object so that it represents the particular form of permission you need.</span></span> <span data-ttu-id="d31af-156">Cada permiso integrado tiene un atributo al que se pasa una enumeración <xref:System.Security.Permissions.SecurityAction> para describir el tipo de operación de seguridad que se desea realizar.</span><span class="sxs-lookup"><span data-stu-id="d31af-156">Every built-in permission has an attribute that is passed a <xref:System.Security.Permissions.SecurityAction> enumeration to describe the type of security operation you want to perform.</span></span> <span data-ttu-id="d31af-157">Sin embargo, los permisos también aceptan parámetros propios exclusivos.</span><span class="sxs-lookup"><span data-stu-id="d31af-157">However, permissions also accept their own parameters that are exclusive to them.</span></span>

<span data-ttu-id="d31af-158">El siguiente fragmento de código muestra la sintaxis declarativa para solicitar que los llamadores del código tengan un permiso personalizado denominado `MyPermission`.</span><span class="sxs-lookup"><span data-stu-id="d31af-158">The following code fragment shows declarative syntax for requesting that your code's callers have a custom permission called `MyPermission`.</span></span> <span data-ttu-id="d31af-159">Este permiso es un permiso personalizado hipotético y no existe en .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="d31af-159">This permission is a hypothetical custom permission and does not exist in the .NET Framework.</span></span> <span data-ttu-id="d31af-160">En este ejemplo, la llamada declarativa se coloca directamente antes de la definición de clase, lo que especifica que este permiso se aplica en el nivel de clase.</span><span class="sxs-lookup"><span data-stu-id="d31af-160">In this example, the declarative call is placed directly before the class definition, specifying that this permission be applied to the class level.</span></span> <span data-ttu-id="d31af-161">El atributo se pasa una estructura **SecurityAction.Demand** para especificar que los llamadores deben tener este permiso para ejecutarse.</span><span class="sxs-lookup"><span data-stu-id="d31af-161">The attribute is passed a **SecurityAction.Demand** structure to specify that callers must have this permission in order to run.</span></span>

```vb
<MyPermission(SecurityAction.Demand, Unrestricted = True)> Public Class MyClass1

   Public Sub New()
      'The constructor is protected by the security call.
   End Sub

   Public Sub MyMethod()
      'This method is protected by the security call.
   End Sub

   Public Sub YourMethod()
      'This method is protected by the security call.
   End Sub
End Class
```

```csharp
[MyPermission(SecurityAction.Demand, Unrestricted = true)]
public class MyClass
{
   public MyClass()
   {
      //The constructor is protected by the security call.
   }

   public void MyMethod()
   {
      //This method is protected by the security call.
   }

   public void YourMethod()
   {
      //This method is protected by the security call.
   }
}
```

## <a name="imperative-security"></a><span data-ttu-id="d31af-162">Seguridad imperativa</span><span class="sxs-lookup"><span data-stu-id="d31af-162">Imperative Security</span></span>

<span data-ttu-id="d31af-163">La sintaxis de seguridad imperativa emite una llamada de seguridad mediante la creación de una nueva instancia del objeto de permiso que se desea invocar.</span><span class="sxs-lookup"><span data-stu-id="d31af-163">Imperative security syntax issues a security call by creating a new instance of the permission object you want to invoke.</span></span> <span data-ttu-id="d31af-164">La sintaxis imperativa se puede usar para realizar peticiones e invalidaciones, pero no solicitudes.</span><span class="sxs-lookup"><span data-stu-id="d31af-164">You can use imperative syntax to perform demands and overrides, but not requests.</span></span>

<span data-ttu-id="d31af-165">Antes de realizar la llamada de seguridad, debe inicializar los datos de estado del objeto de permiso para que represente la forma concreta del permiso necesario.</span><span class="sxs-lookup"><span data-stu-id="d31af-165">Before you make the security call, you must initialize the state data of the permission object so that it represents the particular form of the permission you need.</span></span> <span data-ttu-id="d31af-166">Por ejemplo, al <xref:System.Security.Permissions.FileIOPermission> crear un objeto, puede usar el constructor para inicializar el objeto **FileIOPermission** de modo que represente el acceso sin restricciones a todos los archivos o ningún acceso a los archivos.</span><span class="sxs-lookup"><span data-stu-id="d31af-166">For example, when creating a <xref:System.Security.Permissions.FileIOPermission> object, you can use the constructor to initialize the **FileIOPermission** object so that it represents either unrestricted access to all files or no access to files.</span></span> <span data-ttu-id="d31af-167">O bien, puede usar un objeto **FileIOPermission** diferente, pasando parámetros que indican el tipo de acceso que desea que represente el objeto (es decir, leer, anexar o escribir) y qué archivos desea que proteja el objeto.</span><span class="sxs-lookup"><span data-stu-id="d31af-167">Or, you can use a different **FileIOPermission** object, passing parameters that indicate the type of access you want the object to represent (that is, read, append, or write) and what files you want the object to protect.</span></span>

<span data-ttu-id="d31af-168">Además de usar la sintaxis de seguridad imperativa para invocar un solo objeto de seguridad, puede usarlo para inicializar un grupo de permisos de un conjunto de permisos.</span><span class="sxs-lookup"><span data-stu-id="d31af-168">In addition to using imperative security syntax to invoke a single security object, you can use it to initialize a group of permissions in a permission set.</span></span> <span data-ttu-id="d31af-169">Por ejemplo, esta técnica es la única manera de realizar de forma fiable llamadas de [aserción](using-the-assert-method.md) en varios permisos en un método.</span><span class="sxs-lookup"><span data-stu-id="d31af-169">For example, this technique is the only way to reliably perform [assert](using-the-assert-method.md) calls on multiple permissions in one method.</span></span> <span data-ttu-id="d31af-170">Use las clases <xref:System.Security.PermissionSet> y <xref:System.Security.NamedPermissionSet> para crear un grupo de permisos y, a continuación, llame al método apropiado para invocar la llamada de seguridad deseada.</span><span class="sxs-lookup"><span data-stu-id="d31af-170">Use the <xref:System.Security.PermissionSet> and <xref:System.Security.NamedPermissionSet> classes to create a group of permissions and then call the appropriate method to invoke the desired security call.</span></span>

<span data-ttu-id="d31af-171">La sintaxis imperativa se puede usar para realizar peticiones e invalidaciones, pero no solicitudes.</span><span class="sxs-lookup"><span data-stu-id="d31af-171">You can use imperative syntax to perform demands and overrides, but not requests.</span></span> <span data-ttu-id="d31af-172">Cuando la información que necesita para inicializar el estado de permiso solo se revela en tiempo de ejecución, puede usar la sintaxis imperativa para las peticiones e invalidaciones en lugar de la sintaxis declarativa.</span><span class="sxs-lookup"><span data-stu-id="d31af-172">You might use imperative syntax for demands and overrides instead of declarative syntax when information that you need in order to initialize the permission state becomes known only at run time.</span></span> <span data-ttu-id="d31af-173">Por ejemplo, si desea asegurarse de que los llamadores tienen permiso para leer un archivo determinado, pero no conoce el nombre de ese archivo hasta el tiempo de ejecución, use una petición imperativa.</span><span class="sxs-lookup"><span data-stu-id="d31af-173">For example, if you want to ensure that callers have permission to read a certain file, but you do not know the name of that file until run time, use an imperative demand.</span></span> <span data-ttu-id="d31af-174">También puede usar comprobaciones imperativas en lugar de comprobaciones declarativas cuando necesita determinar en tiempo de ejecución si una condición se mantiene y, en función del resultado de la prueba, realizar una petición de seguridad (o no).</span><span class="sxs-lookup"><span data-stu-id="d31af-174">You might also choose to use imperative checks instead of declarative checks when you need to determine at run time whether a condition holds and, based on the result of the test, make a security demand (or not).</span></span>

<span data-ttu-id="d31af-175">El siguiente fragmento de código muestra la sintaxis imperativa para solicitar que los llamadores del código tengan un permiso personalizado denominado `MyPermission`.</span><span class="sxs-lookup"><span data-stu-id="d31af-175">The following code fragment shows imperative syntax for requesting that your code's callers have a custom permission called `MyPermission`.</span></span> <span data-ttu-id="d31af-176">Este permiso es un permiso personalizado hipotético y no existe en .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="d31af-176">This permission is a hypothetical custom permission and does not exist in the .NET Framework.</span></span> <span data-ttu-id="d31af-177">Una nueva instancia de `MyPermission` se crea en `MyMethod`, protegiendo solo este método con la llamada de seguridad.</span><span class="sxs-lookup"><span data-stu-id="d31af-177">A new instance of `MyPermission` is created in `MyMethod`, guarding only this method with the security call.</span></span>

```vb
Public Class MyClass1

   Public Sub New()

   End Sub

   Public Sub MyMethod()
      'MyPermission is demanded using imperative syntax.
      Dim Perm As New MyPermission()
      Perm.Demand()
      'This method is protected by the security call.
   End Sub

   Public Sub YourMethod()
      'YourMethod 'This method is not protected by the security call.
   End Sub
End Class
```

```csharp
public class MyClass {
   public MyClass(){

   }

   public void MyMethod() {
       //MyPermission is demanded using imperative syntax.
       MyPermission Perm = new MyPermission();
       Perm.Demand();
       //This method is protected by the security call.
   }

   public void YourMethod() {
       //This method is not protected by the security call.
   }
}
```

## <a name="using-managed-wrapper-classes"></a><span data-ttu-id="d31af-178">Utilizar clases contenedoras administradas</span><span class="sxs-lookup"><span data-stu-id="d31af-178">Using Managed Wrapper Classes</span></span>

<span data-ttu-id="d31af-179">La mayoría de las aplicaciones y los componentes (excepto las bibliotecas seguras) no deben llamar directamente a código no administrado.</span><span class="sxs-lookup"><span data-stu-id="d31af-179">Most applications and components (except secure libraries) should not directly call unmanaged code.</span></span> <span data-ttu-id="d31af-180">Hay varias razones para ello.</span><span class="sxs-lookup"><span data-stu-id="d31af-180">There are several reasons for this.</span></span> <span data-ttu-id="d31af-181">Si el código llama directamente a código no administrado, no podrá ejecutarse en muchas circunstancias porque el código debe disponer de un alto nivel de confianza para llamar a código nativo.</span><span class="sxs-lookup"><span data-stu-id="d31af-181">If code calls unmanaged code directly, it will not be allowed to run in many circumstances because code must be granted a high level of trust to call native code.</span></span> <span data-ttu-id="d31af-182">Si se modifica la directiva para permitir que esa aplicación se ejecute, ello podrá debilitar significativamente la seguridad del sistema, dando libertad a la aplicación para que realice prácticamente cualquier operación.</span><span class="sxs-lookup"><span data-stu-id="d31af-182">If policy is modified to allow such an application to run, it can significantly weaken the security of the system, leaving the application free to perform almost any operation.</span></span>

<span data-ttu-id="d31af-183">Además, el código que tiene permiso de acceso a código no administrado probablemente puede realizar casi cualquier operación mediante una llamada a una API no administrada.</span><span class="sxs-lookup"><span data-stu-id="d31af-183">Additionally, code that has permission to access unmanaged code can probably perform almost any operation by calling into an unmanaged API.</span></span> <span data-ttu-id="d31af-184">Por ejemplo, el código que tiene permiso <xref:System.Security.Permissions.FileIOPermission> para llamar a código no administrado no necesita tener acceso a un archivo; puede llamar directamente a una API de archivo no administrada (Win32), omitiendo la API de archivo administrado que requiere **FileIOPermission**.</span><span class="sxs-lookup"><span data-stu-id="d31af-184">For example, code that has permission to call unmanaged code does not need <xref:System.Security.Permissions.FileIOPermission> to access a file; it can just call an unmanaged (Win32) file API directly, bypassing the managed file API that requires **FileIOPermission**.</span></span> <span data-ttu-id="d31af-185">Si el código administrado tiene permiso para llamar a código no administrado y llama directamente al código no administrado, el sistema de seguridad no podrá imponer restricciones de seguridad de manera confiable, ya que el runtime no puede aplicar dichas restricciones al código no administrado.</span><span class="sxs-lookup"><span data-stu-id="d31af-185">If managed code has permission to call into unmanaged code and does call directly into unmanaged code, the security system will be unable to reliably enforce security restrictions, since the runtime cannot enforce such restrictions on unmanaged code.</span></span>

<span data-ttu-id="d31af-186">Si desea que la aplicación realice una operación que requiere el acceso a código no administrado, deberá hacerlo a través de una clase administrada de confianza que encapsule la funcionalidad necesaria (si esta clase existe).</span><span class="sxs-lookup"><span data-stu-id="d31af-186">If you want your application to perform an operation that requires accessing unmanaged code, it should do so through a trusted managed class that wraps the required functionality (if such a class exists).</span></span> <span data-ttu-id="d31af-187">No cree una clase contenedora usted mismo si ya existe una en la biblioteca de clases seguras.</span><span class="sxs-lookup"><span data-stu-id="d31af-187">Do not create a wrapper class yourself if one already exists in a secure class library.</span></span> <span data-ttu-id="d31af-188">La clase contenedora, que debe tener un alto grado de confianza que le permita realizar la llamada a código no administrado, es responsable de exigir que sus llamadores tengan los permisos adecuados.</span><span class="sxs-lookup"><span data-stu-id="d31af-188">The wrapper class, which must be granted a high degree of trust to be allowed to make the call into unmanaged code, is responsible for demanding that its callers have the appropriate permissions.</span></span> <span data-ttu-id="d31af-189">Si usa la clase contenedora, el código solo necesita solicitar y recibir los permisos que requiere la clase contenedora.</span><span class="sxs-lookup"><span data-stu-id="d31af-189">If you use the wrapper class, your code only needs to request and be granted the permissions that the wrapper class demands.</span></span>

## <a name="see-also"></a><span data-ttu-id="d31af-190">Consulte también</span><span class="sxs-lookup"><span data-stu-id="d31af-190">See also</span></span>

- <xref:System.Security.PermissionSet>
- <xref:System.Security.Permissions.FileIOPermission>
- <xref:System.Security.NamedPermissionSet>
- <xref:System.Security.Permissions.SecurityAction>
- [<span data-ttu-id="d31af-191">Assert</span><span class="sxs-lookup"><span data-stu-id="d31af-191">Assert</span></span>](using-the-assert-method.md)
- [<span data-ttu-id="d31af-192">Seguridad de acceso al código</span><span class="sxs-lookup"><span data-stu-id="d31af-192">Code Access Security</span></span>](code-access-security.md)
- [<span data-ttu-id="d31af-193">Conceptos básicos sobre la seguridad de acceso del código</span><span class="sxs-lookup"><span data-stu-id="d31af-193">Code Access Security Basics</span></span>](code-access-security-basics.md)
- [<span data-ttu-id="d31af-194">Atributos</span><span class="sxs-lookup"><span data-stu-id="d31af-194">Attributes</span></span>](../../standard/attributes/index.md)
- [<span data-ttu-id="d31af-195">Metadatos y componentes autodescriptivos</span><span class="sxs-lookup"><span data-stu-id="d31af-195">Metadata and Self-Describing Components</span></span>](../../standard/metadata-and-self-describing-components.md)
