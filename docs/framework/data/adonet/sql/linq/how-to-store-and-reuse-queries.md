---
description: 'Más información acerca de cómo: almacenar y reutilizar consultas'
title: Procedimiento para almacenar y reutilizar consultas
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: a012bd79-1809-45e3-adea-0229532396cc
ms.openlocfilehash: a9c467cc9b2e39e6bd7616c6439d02c67f43d7c2
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/06/2021
ms.locfileid: "99738824"
---
# <a name="how-to-store-and-reuse-queries"></a><span data-ttu-id="45007-103">Procedimiento para almacenar y reutilizar consultas</span><span class="sxs-lookup"><span data-stu-id="45007-103">How to: Store and Reuse Queries</span></span>

<span data-ttu-id="45007-104">Cuando una aplicación ejecuta muchas veces consultas que tienen una estructura similar, a menudo se mejora el rendimiento si se compila la consulta una vez y se ejecuta varias veces con parámetros diferentes.</span><span class="sxs-lookup"><span data-stu-id="45007-104">When you have an application that executes structurally similar queries many times, you can often increase performance by compiling the query one time and executing it several times with different parameters.</span></span> <span data-ttu-id="45007-105">Por ejemplo, una aplicación podría tener que recuperar todos los clientes que están en una ciudad determinada, que es especificada por el usuario en un formulario en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="45007-105">For example, an application might have to retrieve all the customers who are in a particular city, where the city is specified at runtime by the user in a form.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="45007-106">admite el uso de *consultas compiladas* para este propósito.</span><span class="sxs-lookup"><span data-stu-id="45007-106">supports the use of *compiled queries* for this purpose.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="45007-107">Este patrón de utilización representa el uso más común de las consultas compiladas,</span><span class="sxs-lookup"><span data-stu-id="45007-107">This pattern of usage represents the most common use for compiled queries.</span></span> <span data-ttu-id="45007-108">pero también son posibles otros enfoques.</span><span class="sxs-lookup"><span data-stu-id="45007-108">Other approaches are possible.</span></span> <span data-ttu-id="45007-109">Por ejemplo, las consultas compiladas se pueden almacenar como miembros estáticos en una clase parcial que extiende el código generado por el diseñador.</span><span class="sxs-lookup"><span data-stu-id="45007-109">For example, compiled queries can be stored as static members on a partial class that extends the code generated by the designer.</span></span>  
  
## <a name="example"></a><span data-ttu-id="45007-110">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="45007-110">Example</span></span>  

 <span data-ttu-id="45007-111">En muchos escenarios podrían reutilizarse las consultas entre límites de subprocesos.</span><span class="sxs-lookup"><span data-stu-id="45007-111">In many scenarios you might want to reuse the queries across thread boundaries.</span></span> <span data-ttu-id="45007-112">En tales casos, almacenar las consultas compiladas en variables estáticas es particularmente eficaz.</span><span class="sxs-lookup"><span data-stu-id="45007-112">In such cases, storing the compiled queries in static variables is especially effective.</span></span> <span data-ttu-id="45007-113">En el ejemplo de código siguiente se da por supuesto que hay una clase `Queries` diseñada para almacenar las consultas compiladas y que hay una clase Northwind que representa un objeto <xref:System.Data.Linq.DataContext> fuertemente tipado.</span><span class="sxs-lookup"><span data-stu-id="45007-113">The following code example assumes a `Queries` class designed to store compiled queries, and assumes a Northwind class that represents a strongly typed <xref:System.Data.Linq.DataContext>.</span></span>  
  
 [!code-csharp[DLinqQuerying#6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#6)]
 [!code-vb[DLinqQuerying#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#6)]  
  
 [!code-csharp[DLinqQuerying#7](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#7)]
 [!code-vb[DLinqQuerying#7](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#7)]  
  
## <a name="example"></a><span data-ttu-id="45007-114">Ejemplo</span><span class="sxs-lookup"><span data-stu-id="45007-114">Example</span></span>  

 <span data-ttu-id="45007-115">Actualmente no se pueden almacenar (en variables estáticas) consultas que devuelven un *tipo anónimo*, porque el tipo no tiene ningún nombre que proporcionar como argumento genérico.</span><span class="sxs-lookup"><span data-stu-id="45007-115">You cannot currently store (in static variables) queries that return an *anonymous type*, because type has no name to provide as a generic argument.</span></span> <span data-ttu-id="45007-116">En el ejemplo siguiente se muestra cómo se puede solucionar el problema creando un tipo que pueda representar el resultado y, a continuación, cómo se utiliza como argumento genérico.</span><span class="sxs-lookup"><span data-stu-id="45007-116">The following example shows how you can work around the issue by creating a type that can represent the result, and then use it as a generic argument.</span></span>  
  
 [!code-csharp[DLinqQuerying#8](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#8)]
 [!code-vb[DLinqQuerying#8](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#8)]  
  
## <a name="see-also"></a><span data-ttu-id="45007-117">Vea también</span><span class="sxs-lookup"><span data-stu-id="45007-117">See also</span></span>

- <xref:System.Data.Linq.CompiledQuery>
- [<span data-ttu-id="45007-118">Conceptos sobre consultas</span><span class="sxs-lookup"><span data-stu-id="45007-118">Query Concepts</span></span>](query-concepts.md)
- [<span data-ttu-id="45007-119">Consultar la base de datos</span><span class="sxs-lookup"><span data-stu-id="45007-119">Querying the Database</span></span>](querying-the-database.md)
