---
description: 'Más información acerca de: SQL Server Express de instancias de usuario'
title: Instancias de usuario de SQL Server Express
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 00c12376-cb26-4317-86ad-e6e9c089be57
ms.openlocfilehash: 8579dee5c31a2b63156db72df6cc109beb843f08
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/06/2021
ms.locfileid: "99767278"
---
# <a name="sql-server-express-user-instances"></a><span data-ttu-id="3f36f-103">Instancias de usuario de SQL Server Express</span><span class="sxs-lookup"><span data-stu-id="3f36f-103">SQL Server Express User Instances</span></span>

<span data-ttu-id="3f36f-104">Microsoft SQL Server Express Edition (SQL Server Express) incorpora una nueva característica de instancia de usuario, que solo está disponible cuando se usa el proveedor de datos .NET Framework para SQL Server (`SqlClient`).</span><span class="sxs-lookup"><span data-stu-id="3f36f-104">Microsoft SQL Server Express Edition (SQL Server Express) supports the user instance feature, which is only available when using the .NET Framework Data Provider for SQL Server (`SqlClient`).</span></span> <span data-ttu-id="3f36f-105">Una instancia de usuario es una instancia independiente del motor de base de datos de SQL Server Express generada por una instancia primaria.</span><span class="sxs-lookup"><span data-stu-id="3f36f-105">A user instance is a separate instance of the SQL Server Express Database Engine that is generated by a parent instance.</span></span> <span data-ttu-id="3f36f-106">Las instancias de usuario permiten a los usuarios que no son administradores de sus equipos locales adjuntar bases de datos de SQL Server Express y conectarse a ellas.</span><span class="sxs-lookup"><span data-stu-id="3f36f-106">User instances allow users who are not administrators on their local computers to attach and connect to SQL Server Express databases.</span></span> <span data-ttu-id="3f36f-107">Cada instancia se ejecuta en el contexto de seguridad del usuario individual, en un modelo de una instancia por usuario.</span><span class="sxs-lookup"><span data-stu-id="3f36f-107">Each instance runs under the security context of the individual user, on a one-instance-per-user basis.</span></span>  
  
## <a name="user-instance-capabilities"></a><span data-ttu-id="3f36f-108">Funcionalidades de las instancias de usuario</span><span class="sxs-lookup"><span data-stu-id="3f36f-108">User Instance Capabilities</span></span>  

 <span data-ttu-id="3f36f-109">Las instancias de usuario son útiles para los usuarios que ejecutan Windows con una cuenta de usuario con privilegios mínimos (LUA).</span><span class="sxs-lookup"><span data-stu-id="3f36f-109">User instances are useful for users who are running Windows under a least-privilege user account (LUA).</span></span> <span data-ttu-id="3f36f-110">Cada usuario tiene SQL Server privilegios de administrador del sistema ( `sysadmin` ) en la instancia que se ejecuta en su equipo sin necesidad de ejecutarse también como administrador de Windows.</span><span class="sxs-lookup"><span data-stu-id="3f36f-110">Each user has SQL Server system administrator (`sysadmin`) privileges over the instance running on their computer without needing to run as a Windows administrator as well.</span></span> <span data-ttu-id="3f36f-111">El software que se ejecuta en una instancia de usuario con permisos limitados no puede realizar cambios en todo el sistema porque la instancia de SQL Server Express se está ejecutando bajo la cuenta de Windows del usuario que no es de administrador, no como servicio.</span><span class="sxs-lookup"><span data-stu-id="3f36f-111">Software executing on a user instance with limited permissions cannot make system-wide changes because the instance of SQL Server Express is running under the non-administrator Windows account of the user, not as a service.</span></span> <span data-ttu-id="3f36f-112">Cada instancia de usuario está aislada de la instancia principal y de las demás instancias de usuario que se ejecutan en el mismo equipo.</span><span class="sxs-lookup"><span data-stu-id="3f36f-112">Each user instance is isolated from its parent instance and from any other user instances running on the same computer.</span></span> <span data-ttu-id="3f36f-113">Las bases de datos que se ejecutan en una instancia de usuario se abren solo en modo de usuario único, y no es posible que varios usuarios se conecten a las bases de datos que se ejecutan en una instancia de usuario.</span><span class="sxs-lookup"><span data-stu-id="3f36f-113">Databases running on a user instance are opened in single-user mode only, and it is not possible for multiple users to connect to databases running on a user instance.</span></span> <span data-ttu-id="3f36f-114">La replicación y las consultas distribuidas también están deshabilitadas para las instancias de usuario.</span><span class="sxs-lookup"><span data-stu-id="3f36f-114">Replication and distributed queries are also disabled for user instances.</span></span>
  
> [!NOTE]
> <span data-ttu-id="3f36f-115">Las instancias de usuario no son necesarias para los usuarios que ya son administradores en sus propios equipos o para escenarios que implican a varios usuarios de base de datos.</span><span class="sxs-lookup"><span data-stu-id="3f36f-115">User instances are not needed for users who are already administrators on their own computers, or for scenarios involving multiple database users.</span></span>  
  
## <a name="enabling-user-instances"></a><span data-ttu-id="3f36f-116">Habilitar instancias de usuario</span><span class="sxs-lookup"><span data-stu-id="3f36f-116">Enabling User Instances</span></span>  

 <span data-ttu-id="3f36f-117">Para generar instancias de usuario, debe estar ejecutándose una instancia primaria de SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="3f36f-117">To generate user instances, a parent instance of SQL Server Express must be running.</span></span> <span data-ttu-id="3f36f-118">Las instancias de usuario se habilitan de forma predeterminada cuando se instala SQL Server Express y un administrador del sistema pueden habilitarlas o deshabilitarlas de forma explícita si ejecuta el procedimiento almacenado del sistema **sp_configure** en la instancia principal.</span><span class="sxs-lookup"><span data-stu-id="3f36f-118">User instances are enabled by default when SQL Server Express is installed, and they can be explicitly enabled or disabled by a system administrator executing the **sp_configure** system stored procedure on the parent instance.</span></span>  
  
```sql  
-- Enable user instances.  
sp_configure 'user instances enabled','1'
  
-- Disable user instances.  
sp_configure 'user instances enabled','0'  
```  
  
 <span data-ttu-id="3f36f-119">El protocolo de red para las instancias de usuario debe ser el de canalizaciones con nombre locales.</span><span class="sxs-lookup"><span data-stu-id="3f36f-119">The network protocol for user instances must be local Named Pipes.</span></span> <span data-ttu-id="3f36f-120">No se puede iniciar una instancia de usuario en una instancia remota de SQL Server, y no se permiten inicios de sesión de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="3f36f-120">A user instance cannot be started on a remote instance of SQL Server, and SQL Server logins are not allowed.</span></span>  
  
## <a name="connecting-to-a-user-instance"></a><span data-ttu-id="3f36f-121">Conectarse a una instancia de usuario</span><span class="sxs-lookup"><span data-stu-id="3f36f-121">Connecting to a User Instance</span></span>  

 <span data-ttu-id="3f36f-122">Las palabras clave `User Instance` y `AttachDBFilename`<xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> permiten a <xref:System.Data.SqlClient.SqlConnection> conectarse a una instancia de usuario.</span><span class="sxs-lookup"><span data-stu-id="3f36f-122">The `User Instance` and `AttachDBFilename`<xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> keywords allow a <xref:System.Data.SqlClient.SqlConnection> to connect to a user instance.</span></span> <span data-ttu-id="3f36f-123">Las instancias de usuario también se admiten en las propiedades <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` y `AttachDBFilename`.</span><span class="sxs-lookup"><span data-stu-id="3f36f-123">User instances are also supported by the <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` and `AttachDBFilename` properties.</span></span>  
  
 <span data-ttu-id="3f36f-124">Tenga en cuenta lo siguiente sobre la cadena de conexión de ejemplo que se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="3f36f-124">Note the following about the sample connection string shown below:</span></span>  
  
- <span data-ttu-id="3f36f-125">La palabra clave `Data Source` hace referencia a la instancia primaria de SQL Server Express que genera la instancia de usuario.</span><span class="sxs-lookup"><span data-stu-id="3f36f-125">The `Data Source` keyword refers to the parent instance of SQL Server Express that is generating the user instance.</span></span> <span data-ttu-id="3f36f-126">La instancia predeterminada es .\sqlexpress.</span><span class="sxs-lookup"><span data-stu-id="3f36f-126">The default instance is .\sqlexpress.</span></span>  
  
- <span data-ttu-id="3f36f-127">`Integrated Security` se establece en `true`.</span><span class="sxs-lookup"><span data-stu-id="3f36f-127">`Integrated Security` is set to `true`.</span></span> <span data-ttu-id="3f36f-128">Para conectarse a una instancia de usuario, se requiere la autenticación de Windows. No se admiten los inicios de sesión de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="3f36f-128">To connect to a user instance, Windows Authentication is required; SQL Server logins are not supported.</span></span>  
  
- <span data-ttu-id="3f36f-129">La propiedad `User Instance` se establece en `true`, lo cual invoca una instancia de usuario.</span><span class="sxs-lookup"><span data-stu-id="3f36f-129">The `User Instance` is set to `true`, which invokes a user instance.</span></span> <span data-ttu-id="3f36f-130">(El valor predeterminado es `false`).</span><span class="sxs-lookup"><span data-stu-id="3f36f-130">(The default is `false`.)</span></span>  
  
- <span data-ttu-id="3f36f-131">La palabra clave de cadena de conexión `AttachDbFileName` se utiliza para adjuntar el archivo de base de datos principal (.mdf), que debe incluir el nombre completo de la ruta de acceso.</span><span class="sxs-lookup"><span data-stu-id="3f36f-131">The `AttachDbFileName` connection string keyword is used to attach the primary database file (.mdf), which must include the full path name.</span></span> <span data-ttu-id="3f36f-132">`AttachDbFileName` también se corresponde con las claves "propiedades extendidas" y "nombre de archivo inicial" dentro de una cadena de conexión de <xref:System.Data.SqlClient.SqlConnection>.</span><span class="sxs-lookup"><span data-stu-id="3f36f-132">`AttachDbFileName` also corresponds to the "extended properties" and "initial file name" keys within a <xref:System.Data.SqlClient.SqlConnection> connection string.</span></span>  
  
- <span data-ttu-id="3f36f-133">La cadena de sustitución de `|DataDirectory|` entre los símbolos de canalización hace referencia al directorio de datos de la aplicación que abre la conexión y proporciona una ruta de acceso relativa que indica la ubicación de los archivos de registro y la base de datos .mdf y.ldf.</span><span class="sxs-lookup"><span data-stu-id="3f36f-133">The `|DataDirectory|` substitution string enclosed in the pipe symbols refers to the data directory of the application opening the connection and provides a relative path indicating the location of the .mdf and .ldf database and log files.</span></span> <span data-ttu-id="3f36f-134">Si desea ubicar estos archivos en otro lugar, debe proporcionar la ruta de acceso completa a los archivos.</span><span class="sxs-lookup"><span data-stu-id="3f36f-134">If you want to locate these files elsewhere, you must provide the full path to the files.</span></span>  
  
```text
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;AttachDBFilename=|DataDirectory|\InstanceDB.mdf;  
Initial Catalog=InstanceDB;  
```  
  
> [!NOTE]
> <span data-ttu-id="3f36f-135">También puede usar las propiedades <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> y <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> para crear una cadena de conexión en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="3f36f-135">You can also use the <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> and <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> properties to build a connection string at run time.</span></span>  
  
### <a name="using-the-124datadirectory124-substitution-string"></a><span data-ttu-id="3f36f-136">Usar la cadena de sustitución &#124;&#124; de DataDirectory</span><span class="sxs-lookup"><span data-stu-id="3f36f-136">Using the &#124;DataDirectory&#124; Substitution String</span></span>  

 <span data-ttu-id="3f36f-137">`AttachDbFileName` se amplió en ADO.NET 2.0 con la incorporación de la cadena de sustitución `|DataDirectory|` (entre barras verticales).</span><span class="sxs-lookup"><span data-stu-id="3f36f-137">`AttachDbFileName` was extended in ADO.NET 2.0 with the introduction of the `|DataDirectory|` (enclosed in pipe symbols) substitution string.</span></span> <span data-ttu-id="3f36f-138">`DataDirectory` se usa junto con `AttachDbFileName` para indicar una ruta de acceso relativa a un archivo de datos, lo que permite a los desarrolladores crear cadenas de conexión basadas en una ruta relativa al origen de datos en lugar de tener que especificar la ruta completa.</span><span class="sxs-lookup"><span data-stu-id="3f36f-138">`DataDirectory` is used in conjunction with `AttachDbFileName` to indicate a relative path to a data file, allowing developers to create connection strings that are based on a relative path to the data source instead of being required to specify a full path.</span></span>  
  
 <span data-ttu-id="3f36f-139">La ubicación física a la que apunta `DataDirectory` depende del tipo de aplicación.</span><span class="sxs-lookup"><span data-stu-id="3f36f-139">The physical location that `DataDirectory` points to depends on the type of application.</span></span> <span data-ttu-id="3f36f-140">En este ejemplo, el archivo Northwind.mdf que se va a adjuntar se encuentra en la carpeta \app_data de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3f36f-140">In this example, the Northwind.mdf file to be attached is located in the application's \app_data folder.</span></span>  
  
```text
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;  
AttachDBFilename=|DataDirectory|\app_data\Northwind.mdf;  
Initial Catalog=Northwind;  
```  
  
 <span data-ttu-id="3f36f-141">Cuando se utiliza `DataDirectory`, la ruta de acceso del archivo resultante no puede ser superior en la estructura de directorios que el directorio al que apunta la cadena de sustitución.</span><span class="sxs-lookup"><span data-stu-id="3f36f-141">When `DataDirectory` is used, the resulting file path cannot be higher in the directory structure than the directory pointed to by the substitution string.</span></span> <span data-ttu-id="3f36f-142">Por ejemplo, si la propiedad `DataDirectory` totalmente expandida es C:\AppDirectory\app_data, la cadena de conexión de ejemplo que se muestra arriba funciona porque está por debajo de c:\AppDirectory.</span><span class="sxs-lookup"><span data-stu-id="3f36f-142">For example, if the fully expanded `DataDirectory` is C:\AppDirectory\app_data, then the sample connection string shown above works because it is below c:\AppDirectory.</span></span> <span data-ttu-id="3f36f-143">Pero si se intenta especificar `DataDirectory` como `|DataDirectory|\..\data`, se produce un error porque \data no es un subdirectorio de \AppDirectory.</span><span class="sxs-lookup"><span data-stu-id="3f36f-143">However, attempting to specify `DataDirectory` as `|DataDirectory|\..\data` will result in an error because \data is not a subdirectory of \AppDirectory.</span></span>  
  
 <span data-ttu-id="3f36f-144">Si la cadena de conexión tiene una cadena de sustitución con formato incorrecto, se producirá <xref:System.ArgumentException>.</span><span class="sxs-lookup"><span data-stu-id="3f36f-144">If the connection string has an improperly formatted substitution string, an <xref:System.ArgumentException> will be thrown.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3f36f-145"><xref:System.Data.SqlClient> resuelve las cadenas de sustitución en rutas de acceso completas en el sistema de archivos del equipo local.</span><span class="sxs-lookup"><span data-stu-id="3f36f-145"><xref:System.Data.SqlClient> resolves the substitution strings into full paths against the local computer file system.</span></span> <span data-ttu-id="3f36f-146">Por lo tanto, no se admiten los nombres de ruta de acceso UNC, HTTP y de servidor remoto.</span><span class="sxs-lookup"><span data-stu-id="3f36f-146">Therefore, remote server, HTTP, and UNC path names are not supported.</span></span> <span data-ttu-id="3f36f-147">Se produce una excepción cuando se abre la conexión si el servidor no se encuentra en el equipo local.</span><span class="sxs-lookup"><span data-stu-id="3f36f-147">An exception is thrown when the connection is opened if the server is not located on the local computer.</span></span>  
  
 <span data-ttu-id="3f36f-148">Cuando se abre <xref:System.Data.SqlClient.SqlConnection>, se redirige desde la instancia de SQL Server Express predeterminada a una instancia iniciada en el entorno de ejecución que se ejecuta en la cuenta del autor de llamada.</span><span class="sxs-lookup"><span data-stu-id="3f36f-148">When the <xref:System.Data.SqlClient.SqlConnection> is opened, it is redirected from the default SQL Server Express instance to a run-time initiated instance running under the caller's account.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3f36f-149">Puede que sea necesario aumentar el valor de <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A>, ya que las instancias de usuario pueden tardar más tiempo en cargarse que las instancias normales.</span><span class="sxs-lookup"><span data-stu-id="3f36f-149">It may be necessary to increase the <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A> value since user instances may take longer to load than regular instances.</span></span>  
  
 <span data-ttu-id="3f36f-150">El fragmento de código siguiente se abre una nueva propiedad `SqlConnection`, se muestra la cadena de conexión en la ventana de la consola y, a continuación, se cierra la conexión al cerrar el bloque de código `using`.</span><span class="sxs-lookup"><span data-stu-id="3f36f-150">The following code fragment opens a new `SqlConnection`, displays the connection string in the console window, and then closes the connection when exiting the `using` code block.</span></span>  
  
```vb  
Private Sub OpenSqlConnection()  
    ' Retrieve the connection string.  
    Dim connectionString As String = GetConnectionString()  
  
    Using connection As New SqlConnection(connectionString)  
        connection.Open()  
        Console.WriteLine("ConnectionString: {0}", _  
           connection.ConnectionString)  
    End Using  
End Sub  
```  
  
```csharp  
private static void OpenSqlConnection()  
{  
    // Retrieve the connection string.  
    string connectionString = GetConnectionString();  
  
    using (SqlConnection connection =
        new SqlConnection(connectionString))  
    {  
        connection.Open();  
        Console.WriteLine("ConnectionString: {0}",
             connection.ConnectionString);  
    }  
}  
```  
  
> [!NOTE]
> <span data-ttu-id="3f36f-151">Las instancias de usuario no se admiten en el código de Common Language Runtime (CLR) que se ejecuta dentro de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="3f36f-151">User instances are not supported in common language runtime (CLR) code that is running inside of SQL Server.</span></span> <span data-ttu-id="3f36f-152">Se produce <xref:System.InvalidOperationException> si se llama a `Open` en una propiedad <xref:System.Data.SqlClient.SqlConnection> que tiene `User Instance=true` en la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="3f36f-152">An <xref:System.InvalidOperationException> is thrown if `Open` is called on a <xref:System.Data.SqlClient.SqlConnection> that has `User Instance=true` in the connection string.</span></span>  
  
## <a name="lifetime-of-a-user-instance-connection"></a><span data-ttu-id="3f36f-153">Duración de la conexión a una instancia de usuario</span><span class="sxs-lookup"><span data-stu-id="3f36f-153">Lifetime of a User Instance Connection</span></span>  

 <span data-ttu-id="3f36f-154">A diferencia de las versiones de SQL Server que se ejecutan como un servicio, no es necesario iniciar y detener manualmente las instancias de SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="3f36f-154">Unlike versions of SQL Server that run as a service, SQL Server Express instances do not need to be manually started and stopped.</span></span> <span data-ttu-id="3f36f-155">Cada vez que un usuario inicia sesión y se conecta a una instancia de usuario, la instancia de usuario se inicia si aún no se está ejecutando.</span><span class="sxs-lookup"><span data-stu-id="3f36f-155">Each time a user logs in and connects to a user instance, the user instance is started if it is not already running.</span></span> <span data-ttu-id="3f36f-156">Las bases de datos de instancia de usuario tienen la opción `AutoClose` establecida de modo que la base de datos se cierre automáticamente después de un período de inactividad.</span><span class="sxs-lookup"><span data-stu-id="3f36f-156">User instance databases have the `AutoClose` option set so that the database is automatically shut down after a period of inactivity.</span></span> <span data-ttu-id="3f36f-157">El proceso Sqlservr.exe que se inicia se mantiene en ejecución durante un período de tiempo de espera limitado después de cerrarse la última conexión a la instancia, por lo que no es necesario reiniciarlo si se abre otra conexión antes de que expire el tiempo de espera.</span><span class="sxs-lookup"><span data-stu-id="3f36f-157">The sqlservr.exe process that is started is kept running for a limited time-out period after the last connection to the instance is closed, so it does not need to be restarted if another connection is opened before the time-out has expired.</span></span> <span data-ttu-id="3f36f-158">La instancia de usuario se cierra automáticamente si no se abre ninguna conexión nueva antes de que haya expirado el período de tiempo de espera.</span><span class="sxs-lookup"><span data-stu-id="3f36f-158">The user instance automatically shuts down if no new connection opens before that time-out period has expired.</span></span> <span data-ttu-id="3f36f-159">Un administrador del sistema en la instancia principal puede establecer la duración del período de espera de una instancia de usuario mediante **sp_configure** para cambiar la opción **user instance timeout**.</span><span class="sxs-lookup"><span data-stu-id="3f36f-159">A system administrator on the parent instance can set the duration of the time-out period for a user instance by using **sp_configure** to change the **user instance timeout** option.</span></span> <span data-ttu-id="3f36f-160">El valor predeterminado es 60 minutos.</span><span class="sxs-lookup"><span data-stu-id="3f36f-160">The default is 60 minutes.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3f36f-161">Si se usa `Min Pool Size` en la cadena de conexión con un valor mayor que cero, el agrupador de conexiones mantendrá siempre algunas conexiones abiertas y la instancia de usuario no se cerrará automáticamente.</span><span class="sxs-lookup"><span data-stu-id="3f36f-161">If `Min Pool Size` is used in the connection string with a value greater than zero, the connection pooler will always maintain a few opened connections, and the user instance will not automatically shut down.</span></span>  
  
## <a name="how-user-instances-work"></a><span data-ttu-id="3f36f-162">Cómo funcionan las instancias de usuario</span><span class="sxs-lookup"><span data-stu-id="3f36f-162">How User Instances Work</span></span>  

 <span data-ttu-id="3f36f-163">La primera vez que se genera una instancia de usuario para cada usuario, las bases de datos del sistema **master** y **msdb** se copian desde la carpeta Template Data en una ruta de acceso en el directorio del repositorio de datos de aplicación local del usuario para que las use exclusivamente la instancia de usuario.</span><span class="sxs-lookup"><span data-stu-id="3f36f-163">The first time a user instance is generated for each user, the **master** and **msdb** system databases are copied from the Template Data folder to a path under the user's local application data repository directory for exclusive use by the user instance.</span></span> <span data-ttu-id="3f36f-164">La ruta de acceso es normalmente `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span><span class="sxs-lookup"><span data-stu-id="3f36f-164">This path is typically `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span></span> <span data-ttu-id="3f36f-165">Cuando se inicia una instancia de usuario, también se escriben en este directorio el registro **tempdb** y los archivos de seguimiento.</span><span class="sxs-lookup"><span data-stu-id="3f36f-165">When a user instance starts up, the **tempdb**, log, and trace files are also written to this directory.</span></span> <span data-ttu-id="3f36f-166">Se genera un nombre para la instancia, que se garantiza que sea único para cada usuario.</span><span class="sxs-lookup"><span data-stu-id="3f36f-166">A name is generated for the instance, which is guaranteed to be unique for each user.</span></span>  
  
 <span data-ttu-id="3f36f-167">De forma predeterminada, a todos los miembros del grupo Windows Builtin\Users se les conceden permisos para conectarse en la instancia local, así como permisos de lectura y ejecución en los archivos binarios de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="3f36f-167">By default all members of the Windows Builtin\Users group are granted permissions to connect on the local instance as well as read and execute permissions on the SQL Server binaries.</span></span> <span data-ttu-id="3f36f-168">Una vez comprobadas las credenciales del usuario que realiza la llamada y hospeda la instancia de usuario, ese usuario se convierte en `sysadmin` en esa instancia.</span><span class="sxs-lookup"><span data-stu-id="3f36f-168">Once the credentials of the calling user hosting the user instance have been verified, that user becomes the `sysadmin` on that instance.</span></span> <span data-ttu-id="3f36f-169">Solo la memoria compartida está habilitada para las instancias de usuario, lo que significa que solo se pueden realizar operaciones en el equipo local.</span><span class="sxs-lookup"><span data-stu-id="3f36f-169">Only shared memory is enabled for user instances, which means that only operations on the local machine are possible.</span></span>  
  
 <span data-ttu-id="3f36f-170">A los usuarios se les deben conceder permisos de lectura y escritura en los archivos .mdf y. ldf especificados en la cadena de conexión.</span><span class="sxs-lookup"><span data-stu-id="3f36f-170">Users must be granted both read and write permissions on the .mdf and .ldf files specified in the connection string.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="3f36f-171">Los archivos .mdf y. ldf representan los archivos de base de datos y de registro, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="3f36f-171">The .mdf and .ldf files represent the database and log files, respectively.</span></span> <span data-ttu-id="3f36f-172">Estos dos archivos son conjuntos coincidentes, por lo que se debe tener cuidado durante las operaciones de copia de seguridad y restauración.</span><span class="sxs-lookup"><span data-stu-id="3f36f-172">These two files are a matched set, so care must be taken during backup and restore operations.</span></span> <span data-ttu-id="3f36f-173">El archivo de base de datos contiene información acerca de la versión exacta del archivo de registro y la base de datos no se abrirá si está unida a un archivo de registro incorrecto.</span><span class="sxs-lookup"><span data-stu-id="3f36f-173">The database file contains information about the exact version of the log file, and the database will not open if it is coupled with the wrong log file.</span></span>  
  
 <span data-ttu-id="3f36f-174">Para evitar daños en los datos, se abre una base de datos en la instancia de usuario con acceso exclusivo.</span><span class="sxs-lookup"><span data-stu-id="3f36f-174">To avoid data corruption, a database in the user instance is opened with exclusive access.</span></span> <span data-ttu-id="3f36f-175">Si dos instancias de usuario diferentes comparten la misma base de datos en el mismo equipo, el usuario de la primera instancia debe cerrar la base de datos para que se pueda abrir en una segunda instancia.</span><span class="sxs-lookup"><span data-stu-id="3f36f-175">If two different user instances share the same database on the same computer, the user on the first instance must close the database before it can be opened in a second instance.</span></span>  
  
## <a name="user-instance-scenarios"></a><span data-ttu-id="3f36f-176">Escenarios de instancias de usuario</span><span class="sxs-lookup"><span data-stu-id="3f36f-176">User Instance Scenarios</span></span>  

 <span data-ttu-id="3f36f-177">Las instancias de usuario proporcionan a los desarrolladores de aplicaciones de base de datos un almacén de datos de SQL Server que no depende de que los desarrolladores tengan cuentas administrativas en sus equipos de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="3f36f-177">User instances provide developers of database applications with a SQL Server data store that does not depend on developers having administrative accounts on their development computers.</span></span> <span data-ttu-id="3f36f-178">Las instancias de usuario se basan en el modelo Access/Jet, donde la aplicación de base de datos simplemente se conecta a un archivo y el usuario tiene permisos totales en todos los objetos de la base de datos sin necesidad de la intervención de un administrador del sistema para conceder permisos.</span><span class="sxs-lookup"><span data-stu-id="3f36f-178">User instances are based on the Access/Jet model, where the database application simply connects to a file, and the user automatically has full permissions on all of the database objects without needing the intervention of a system administrator to grant permissions.</span></span> <span data-ttu-id="3f36f-179">Está pensado para funcionar en situaciones en las que el usuario se ejecuta con una cuenta de usuario con privilegios mínimos (LUA) y no tiene privilegios administrativos en el servidor o en el equipo local, pero tiene que crear objetos y aplicaciones de base de datos.</span><span class="sxs-lookup"><span data-stu-id="3f36f-179">It is intended to work in situations where the user is running under a least-privilege user account (LUA) and does not have administrative privileges on the server or local machine, yet needs to create database objects and applications.</span></span> <span data-ttu-id="3f36f-180">Las instancias de usuario permiten a los usuarios crear instancias en el entorno de ejecución que se ejecutan en el propio contexto de seguridad del usuario y no en el contexto de seguridad de un servicio de sistema con más privilegios.</span><span class="sxs-lookup"><span data-stu-id="3f36f-180">User instances allow users to create instances at run time that run under the user's own security context, and not in the security context of a more privileged system service.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="3f36f-181">Las instancias de usuario solo se deben usar en escenarios en los que todas las aplicaciones que la usan sean de plena confianza.</span><span class="sxs-lookup"><span data-stu-id="3f36f-181">User instances should only be used in scenarios where all the applications using it are fully trusted.</span></span>  
  
 <span data-ttu-id="3f36f-182">Entre los escenarios de instancias de usuario están los siguientes:</span><span class="sxs-lookup"><span data-stu-id="3f36f-182">User instance scenarios include:</span></span>  
  
- <span data-ttu-id="3f36f-183">Cualquier aplicación de usuario único en la que no es necesario compartir datos.</span><span class="sxs-lookup"><span data-stu-id="3f36f-183">Any single-user application where sharing data is not required.</span></span>  
  
- <span data-ttu-id="3f36f-184">Implementación ClickOnce.</span><span class="sxs-lookup"><span data-stu-id="3f36f-184">ClickOnce deployment.</span></span> <span data-ttu-id="3f36f-185">Si .NET Framework 2,0 (o posterior) y SQL Server Express ya están instalados en el equipo de destino, los usuarios que no son administradores pueden instalar y usar el paquete de instalación descargado como resultado de una acción ClickOnce.</span><span class="sxs-lookup"><span data-stu-id="3f36f-185">If .NET Framework 2.0 (or later) and SQL Server Express are already installed on the target computer, the installation package downloaded as a result of a ClickOnce action can be installed and used by non-administrator users.</span></span> <span data-ttu-id="3f36f-186">Tenga en cuenta que un administrador debe instalar SQL Server Express si forma parte de la configuración.</span><span class="sxs-lookup"><span data-stu-id="3f36f-186">Note that an administrator must install SQL Server Express if that is part of the setup.</span></span> <span data-ttu-id="3f36f-187">Para obtener más información, consulte [Implementación de ClickOnce para formularios Windows Forms](/dotnet/desktop/winforms/clickonce-deployment-for-windows-forms).</span><span class="sxs-lookup"><span data-stu-id="3f36f-187">For more information, see [ClickOnce Deployment for Windows Forms](/dotnet/desktop/winforms/clickonce-deployment-for-windows-forms).</span></span>
  
- <span data-ttu-id="3f36f-188">Hospedaje de ASP.NET dedicado mediante la autenticación de Windows.</span><span class="sxs-lookup"><span data-stu-id="3f36f-188">Dedicated ASP.NET hosting using Windows Authentication.</span></span> <span data-ttu-id="3f36f-189">Una única instancia de SQL Server Express se puede hospedar en una intranet.</span><span class="sxs-lookup"><span data-stu-id="3f36f-189">A single SQL Server Express instance can be hosted on an intranet.</span></span> <span data-ttu-id="3f36f-190">La aplicación se conecta mediante la cuenta de Windows ASPNET, no mediante la suplantación.</span><span class="sxs-lookup"><span data-stu-id="3f36f-190">The application connects using the ASPNET Windows account, not by using impersonation.</span></span> <span data-ttu-id="3f36f-191">Las instancias de usuario no deben usarse para escenarios de hospedaje compartido o de terceros en los que todas las aplicaciones compartan la misma instancia de usuario y ya no permanezcan aisladas entre sí.</span><span class="sxs-lookup"><span data-stu-id="3f36f-191">User instances should not be used for third-party or shared hosting scenarios where all applications would share the same user instance and would no longer remain isolated from each other.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3f36f-192">Vea también</span><span class="sxs-lookup"><span data-stu-id="3f36f-192">See also</span></span>

- [<span data-ttu-id="3f36f-193">SQL Server y ADO.NET</span><span class="sxs-lookup"><span data-stu-id="3f36f-193">SQL Server and ADO.NET</span></span>](index.md)
- [<span data-ttu-id="3f36f-194">Cadenas de conexión</span><span class="sxs-lookup"><span data-stu-id="3f36f-194">Connection Strings</span></span>](../connection-strings.md)
- [<span data-ttu-id="3f36f-195">Conectarse a un origen de datos</span><span class="sxs-lookup"><span data-stu-id="3f36f-195">Connecting to a Data Source</span></span>](../connecting-to-a-data-source.md)
- [<span data-ttu-id="3f36f-196">Información general de ADO.NET</span><span class="sxs-lookup"><span data-stu-id="3f36f-196">ADO.NET Overview</span></span>](../ado-net-overview.md)
