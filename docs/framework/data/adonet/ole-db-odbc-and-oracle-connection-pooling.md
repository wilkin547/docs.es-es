---
title: Agrupación de conexiones de OLE DB, ODBC y Oracle
ms.date: 03/30/2017
ms.assetid: 2bd83b1e-3ea9-43c4-bade-d9cdb9bbbb04
ms.openlocfilehash: 0ff3cbd89482645ff8d52e3144f1a82fd05d8013
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 09/24/2020
ms.locfileid: "91150692"
---
# <a name="ole-db-odbc-and-oracle-connection-pooling"></a><span data-ttu-id="2dc4b-102">Agrupación de conexiones de OLE DB, ODBC y Oracle</span><span class="sxs-lookup"><span data-stu-id="2dc4b-102">OLE DB, ODBC, and Oracle connection pooling</span></span>

<span data-ttu-id="2dc4b-103">La agrupación de conexiones puede mejorar de forma considerable el rendimiento y la escalabilidad de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-103">Pooling connections can significantly enhance the performance and scalability of your application.</span></span> <span data-ttu-id="2dc4b-104">En esta sección se describe la agrupación de conexiones para los proveedores de datos de .NET Framework para OLE DB, ODBC y Oracle.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-104">This section discusses connection pooling for the .NET Framework data providers for OLE DB, ODBC, and Oracle.</span></span>

## <a name="oledb"></a><span data-ttu-id="2dc4b-105">OleDb</span><span class="sxs-lookup"><span data-stu-id="2dc4b-105">OleDb</span></span>

<span data-ttu-id="2dc4b-106">El proveedor de datos .NET Framework para OLE DB agrupa automáticamente las conexiones mediante la agrupación de sesiones OLE DB.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-106">The .NET Framework Data Provider for OLE DB automatically pools connections using OLE DB session pooling.</span></span> <span data-ttu-id="2dc4b-107">Se pueden utilizar argumentos de cadena de conexión para habilitar o deshabilitar servicios OLE DB, incluida la agrupación.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-107">Connection string arguments can be used to enable or disable OLE DB services including pooling.</span></span> <span data-ttu-id="2dc4b-108">Por ejemplo, la siguiente cadena de conexión deshabilita la agrupación de sesiones OLE DB y la inscripción automática de transacciones.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-108">For example, the following connection string disables OLE DB session pooling and automatic transaction enlistment.</span></span>

```csharp
Provider=SQLOLEDB;OLE DB Services=-4;Data Source=localhost;Integrated Security=SSPI;
```

 <span data-ttu-id="2dc4b-109">Se recomienda cerrar siempre o eliminar una conexión cuando termine de utilizarla, para que la conexión pueda regresar al grupo.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-109">We recommend that you always close or dispose of a connection when you are finished using it in order to return the connection to the pool.</span></span> <span data-ttu-id="2dc4b-110">Es posible que las conexiones que no se cierran explícitamente no puedan regresar al grupo.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-110">Connections that are not explicitly closed may not get returned to the pool.</span></span> <span data-ttu-id="2dc4b-111">Por ejemplo, una conexión que se ha salido del ámbito pero que no se ha cerrado explícitamente solo se devolverá al grupo de conexión si se ha alcanzado el tamaño máximo del grupo y la conexión aún es válida.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-111">For example, a connection that has gone out of scope but that has not been explicitly closed will only be returned to the connection pool if the maximum pool size has been reached and the connection is still valid.</span></span>

 <span data-ttu-id="2dc4b-112">Para obtener más información sobre OLE DB la agrupación de sesiones o de recursos, y cómo deshabilitar la agrupación invalidando los valores predeterminados del servicio de proveedor de OLE DB, consulte la [Guía del programador de OLE DB](/previous-versions/windows/desktop/ms713643(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="2dc4b-112">For more information about OLE DB session or resource pooling, as well as how to disable pooling by overriding OLE DB provider service defaults, see the [OLE DB Programmer's Guide](/previous-versions/windows/desktop/ms713643(v=vs.85)).</span></span>

## <a name="odbc"></a><span data-ttu-id="2dc4b-113">ODBC</span><span class="sxs-lookup"><span data-stu-id="2dc4b-113">ODBC</span></span>

 <span data-ttu-id="2dc4b-114">La agrupación de conexiones para el proveedor de datos .NET Framework para ODBC se administra a través del Administrador de controladores ODBC que se utiliza en la conexión, y que no está influido por dicho proveedor.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-114">Connection pooling for the .NET Framework Data Provider for ODBC is managed by the ODBC Driver Manager that is used for the connection, and is not affected by the .NET Framework Data Provider for ODBC.</span></span>

 <span data-ttu-id="2dc4b-115">Para habilitar o deshabilitar la agrupación de conexiones, abra el **Administrador de orígenes de datos ODBC** en la carpeta Herramientas administrativas del panel de control.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-115">To enable or disable connection pooling, open **ODBC Data Source Administrator** in the Administrative Tools folder of Control Panel.</span></span> <span data-ttu-id="2dc4b-116">La pestaña **agrupación de conexiones** permite especificar parámetros de agrupación de conexiones para cada controlador ODBC instalado.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-116">The **Connection Pooling** tab allows you to specify connection pooling parameters for each ODBC driver installed.</span></span> <span data-ttu-id="2dc4b-117">Los cambios en la agrupación de conexiones para un controlador ODBC específico afectan a todas las aplicaciones que utilizan ese controlador ODBC.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-117">Connection pooling changes for a specific ODBC driver affect all applications that use that ODBC driver.</span></span>

## <a name="oracleclient"></a><span data-ttu-id="2dc4b-118">OracleClient</span><span class="sxs-lookup"><span data-stu-id="2dc4b-118">OracleClient</span></span>

 <span data-ttu-id="2dc4b-119">El proveedor de datos .NET Framework para Oracle ofrece agrupación automática de conexiones para la aplicación cliente de ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-119">The .NET Framework Data Provider for Oracle provides connection pooling automatically for your ADO.NET client application.</span></span> <span data-ttu-id="2dc4b-120">También puede suministrar varios modificadores de cadena de conexión para controlar el comportamiento de agrupación de conexiones (vea "Control de la agrupación de conexiones con palabras clave de cadena de conexión", más adelante en este tema).</span><span class="sxs-lookup"><span data-stu-id="2dc4b-120">You can also supply several connection string modifiers to control connection pooling behavior (see "Controlling Connection Pooling with Connection String Keywords," later in this topic).</span></span>

### <a name="create-and-assign-pools"></a><span data-ttu-id="2dc4b-121">Crear y asignar grupos</span><span class="sxs-lookup"><span data-stu-id="2dc4b-121">Create and assign pools</span></span>

 <span data-ttu-id="2dc4b-122">Cuando se abre una conexión, se crea un grupo de conexión basado en un algoritmo de coincidencia exacta que asocia el grupo con la cadena de conexión de la conexión.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-122">When a connection is opened, a connection pool is created based on an exact matching algorithm that associates the pool with the connection string in the connection.</span></span> <span data-ttu-id="2dc4b-123">Cada grupo de conexión se asocia con una cadena de conexión distinta.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-123">Each connection pool is associated with a distinct connection string.</span></span> <span data-ttu-id="2dc4b-124">Si se abre una nueva conexión y la cadena de conexión no coincide exactamente con un grupo existente, se crea un nuevo grupo.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-124">When a new connection is opened, if the connection string is not an exact match to an existing pool, a new pool is created.</span></span>

 <span data-ttu-id="2dc4b-125">Una vez creados, los grupos de conexión no se destruyen hasta que finaliza el proceso activo.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-125">Once created, connection pools are not destroyed until the active process ends.</span></span> <span data-ttu-id="2dc4b-126">Mantener grupos inactivos o vacíos consume muy pocos recursos del sistema.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-126">Maintaining inactive or empty pools uses very few system resources.</span></span>

### <a name="connection-addition"></a><span data-ttu-id="2dc4b-127">Adición de conexiones</span><span class="sxs-lookup"><span data-stu-id="2dc4b-127">Connection Addition</span></span>

 <span data-ttu-id="2dc4b-128">Para cada cadena de conexión única se crea un grupo de conexión.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-128">A connection pool is created for each unique connection string.</span></span> <span data-ttu-id="2dc4b-129">Cuando se crea un grupo, se crean y agregan al grupo varios objetos de conexión y se satisface así el requisito de tamaño mínimo del grupo.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-129">When a pool is created, multiple connection objects are created and added to the pool so that the minimum pool size requirement is satisfied.</span></span> <span data-ttu-id="2dc4b-130">Las conexiones se agregan al grupo cuando es necesario, hasta el tamaño máximo del grupo.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-130">Connections are added to the pool as needed, up to the maximum pool size.</span></span>

 <span data-ttu-id="2dc4b-131">Cuando se solicita un objeto <xref:System.Data.OracleClient.OracleConnection>, se obtiene del grupo si se encuentra disponible una conexión que se pueda utilizar.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-131">When an <xref:System.Data.OracleClient.OracleConnection> object is requested, it is obtained from the pool if a usable connection is available.</span></span> <span data-ttu-id="2dc4b-132">Una conexión de este tipo debe estar sin utilizar en ese momento, tener un contexto de transacción coincidente o no estar asociada con ningún contexto de transacción, y tener un vínculo válido al servidor.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-132">To be usable, the connection must currently be unused, have a matching transaction context or not be associated with any transaction context, and have a valid link to the server.</span></span>

 <span data-ttu-id="2dc4b-133">Si se ha alcanzado el tamaño máximo del grupo y no hay disponible ninguna conexión que se pueda utilizar, la solicitud se pone en la cola.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-133">If the maximum pool size has been reached and no usable connection is available, the request is queued.</span></span> <span data-ttu-id="2dc4b-134">El concentrador de conexión satisface estas solicitudes al reasignar las conexiones conforme se liberan de nuevo en el grupo, lo cual ocurre</span><span class="sxs-lookup"><span data-stu-id="2dc4b-134">The connection pooler satisfies these requests by reallocating connections as they are released back into the pool.</span></span> <span data-ttu-id="2dc4b-135">y se liberan de nuevo en el grupo cuando se cierran o eliminan.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-135">Connections are released back into the pool when they are closed or disposed.</span></span>

### <a name="connection-removal"></a><span data-ttu-id="2dc4b-136">Eliminación de conexiones</span><span class="sxs-lookup"><span data-stu-id="2dc4b-136">Connection Removal</span></span>

 <span data-ttu-id="2dc4b-137">El agrupador de conexiones quita una conexión del grupo después de que haya estado inactiva durante un período de tiempo prolongado o si el concentrador detecta que se ha roto la conexión con el servidor.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-137">The connection pooler removes a connection from the pool after it has been idle for an extended period of time or if the pooler detects that the connection with the server has been severed.</span></span> <span data-ttu-id="2dc4b-138">Esto solo se puede detectar después de intentar comunicarse con el servidor.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-138">This can be detected only after attempting to communicate with the server.</span></span> <span data-ttu-id="2dc4b-139">Si se encuentra que una conexión ya no está conectada al servidor, se marca como no válida.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-139">If a connection is found that is no longer connected to the server, it is marked as invalid.</span></span> <span data-ttu-id="2dc4b-140">El concentrador de conexión analiza periódicamente los grupos en busca de objetos que se han liberado en el grupo y marcado como no válidos.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-140">The connection pooler periodically scans connection pools looking for objects that have been released to the pool and are marked as invalid.</span></span> <span data-ttu-id="2dc4b-141">Luego, estas conexiones se quitan de forma permanente.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-141">These connections are then permanently removed.</span></span>

 <span data-ttu-id="2dc4b-142">Si existe una conexión a un servidor que ha desaparecido, se puede extraer del grupo si el concentrador de conexión no ha detectado la conexión rota y la ha marcado como no válida.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-142">If a connection exists to a server that has disappeared, this connection can be drawn from the pool if the connection pooler has not detected the severed connection and marked it as invalid.</span></span> <span data-ttu-id="2dc4b-143">Cuando esto se produce, se genera una excepción.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-143">When this occurs, an exception is generated.</span></span> <span data-ttu-id="2dc4b-144">No obstante, aun así deberá cerrar la conexión para liberarla de nuevo en el grupo.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-144">However, you must still close the connection in order to release it back into the pool.</span></span>

 <span data-ttu-id="2dc4b-145">No llame a `Close` o a `Dispose` en un objeto `Connection`, un objeto `DataReader` o cualquier otro objeto administrado en el método `Finalize` de la clase.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-145">Do not call `Close` or `Dispose` on a `Connection`, a `DataReader`, or any other managed object in the `Finalize` method of your class.</span></span> <span data-ttu-id="2dc4b-146">En un finalizador, libere solo los recursos no administrados que pertenezcan directamente a su clase.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-146">In a finalizer, only release unmanaged resources that your class owns directly.</span></span> <span data-ttu-id="2dc4b-147">Si la clase no dispone de recursos no administrados, no incluya un método `Finalize` en la definición de clase.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-147">If your class does not own any unmanaged resources, do not include a `Finalize` method in your class definition.</span></span> <span data-ttu-id="2dc4b-148">Para obtener más información, consulte recolección de [elementos no utilizados](../../../standard/garbage-collection/index.md).</span><span class="sxs-lookup"><span data-stu-id="2dc4b-148">For more information, see [Garbage Collection](../../../standard/garbage-collection/index.md).</span></span>

### <a name="transaction-support"></a><span data-ttu-id="2dc4b-149">Compatibilidad con transacciones</span><span class="sxs-lookup"><span data-stu-id="2dc4b-149">Transaction Support</span></span>

 <span data-ttu-id="2dc4b-150">Las conexiones se extraen del grupo y se asignan en función del contexto de transacción.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-150">Connections are drawn from the pool and assigned based on transaction context.</span></span> <span data-ttu-id="2dc4b-151">Es necesario que el subproceso solicitante y la conexión asignada coincidan.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-151">The context of the requesting thread and the assigned connection must match.</span></span> <span data-ttu-id="2dc4b-152">Por lo tanto, cada grupo de conexiones se subdivide en conexiones sin contexto de transacción asociado y en *N* subdivisiones, cada una de las cuales contiene conexiones con un contexto de transacción determinado.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-152">Therefore, each connection pool is subdivided into connections with no associated transaction context and into *N* subdivisions that each contain connections with a particular transaction context.</span></span>

 <span data-ttu-id="2dc4b-153">Cuando se cierra una conexión, se libera de nuevo en el grupo y en la subdivisión adecuada en función de su contexto de transacción.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-153">When a connection is closed, it is released back into the pool and into the appropriate subdivision based on its transaction context.</span></span> <span data-ttu-id="2dc4b-154">Por lo tanto, puede cerrar la conexión sin generar un error, incluso aunque aún haya pendiente una transacción distribuida.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-154">Therefore, you can close the connection without generating an error, even though a distributed transaction is still pending.</span></span> <span data-ttu-id="2dc4b-155">Esto le permite confirmar o anular la transacción distribuida más adelante.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-155">This allows you to commit or abort the distributed transaction at a later time.</span></span>

### <a name="control-connection-pooling-with-connection-string-keywords"></a><span data-ttu-id="2dc4b-156">Controlar la agrupación de conexiones con palabras clave de cadena de conexión</span><span class="sxs-lookup"><span data-stu-id="2dc4b-156">Control Connection Pooling with Connection String Keywords</span></span>

 <span data-ttu-id="2dc4b-157">La propiedad <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> del objeto <xref:System.Data.OracleClient.OracleConnection> admite pares clave-valor de cadena de conexión que se pueden utilizar para ajustar el comportamiento de la lógica de agrupación de conexiones.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-157">The <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> property of the <xref:System.Data.OracleClient.OracleConnection> object supports connection string key/value pairs that can be used to adjust the behavior of the connection pooling logic.</span></span>

 <span data-ttu-id="2dc4b-158">En la siguiente tabla se describen los valores <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> que puede utilizar para ajustar el comportamiento de agrupación de conexiones.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-158">The following table describes the <xref:System.Data.OracleClient.OracleConnection.ConnectionString%2A> values you can use to adjust connection pooling behavior.</span></span>

|<span data-ttu-id="2dc4b-159">Nombre</span><span class="sxs-lookup"><span data-stu-id="2dc4b-159">Name</span></span>|<span data-ttu-id="2dc4b-160">Valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="2dc4b-160">Default</span></span>|<span data-ttu-id="2dc4b-161">Descripción</span><span class="sxs-lookup"><span data-stu-id="2dc4b-161">Description</span></span>|
|----------|-------------|-----------------|
|`Connection Lifetime`|<span data-ttu-id="2dc4b-162">0</span><span class="sxs-lookup"><span data-stu-id="2dc4b-162">0</span></span>|<span data-ttu-id="2dc4b-163">Cuando una conexión se devuelve al grupo, su hora de creación se compara con la hora actual y, si ese marco temporal (en segundos) supera el valor especificado por `Connection Lifetime`, la conexión se destruye.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-163">When a connection is returned to the pool, its creation time is compared with the current time, and the connection is destroyed if that time span (in seconds) exceeds the value specified by `Connection Lifetime`.</span></span> <span data-ttu-id="2dc4b-164">Esto resulta de utilidad en configuraciones agrupadas para forzar el equilibrio de carga entre un servidor en ejecución y uno que acaba de conectarse.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-164">This is useful in clustered configurations to force load balancing between a running server and a server just brought online.</span></span><br /><br /> <span data-ttu-id="2dc4b-165">Un valor de cero (0) hará que las conexiones agrupadas tengan el tiempo de espera máximo.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-165">A value of zero (0) will cause pooled connections to have the maximum time-out.</span></span>|
|`Enlist`|<span data-ttu-id="2dc4b-166">'true'</span><span class="sxs-lookup"><span data-stu-id="2dc4b-166">'true'</span></span>|<span data-ttu-id="2dc4b-167">Cuando es `true`, el concentrador inscribe automáticamente la conexión en el contexto de transacción actual del subproceso de creación, si existe un contexto de transacción.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-167">When `true`, the pooler automatically enlists the connection in the current transaction context of the creation thread if a transaction context exists.</span></span>|
|`Max Pool Size`|<span data-ttu-id="2dc4b-168">100</span><span class="sxs-lookup"><span data-stu-id="2dc4b-168">100</span></span>|<span data-ttu-id="2dc4b-169">El número máximo de conexiones permitido en el grupo.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-169">The maximum number of connections allowed in the pool.</span></span>|
|`Min Pool Size`|<span data-ttu-id="2dc4b-170">0</span><span class="sxs-lookup"><span data-stu-id="2dc4b-170">0</span></span>|<span data-ttu-id="2dc4b-171">El número mínimo de conexiones mantenido en el grupo.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-171">The minimum number of connections maintained in the pool.</span></span>|
|`Pooling`|<span data-ttu-id="2dc4b-172">'true'</span><span class="sxs-lookup"><span data-stu-id="2dc4b-172">'true'</span></span>|<span data-ttu-id="2dc4b-173">Cuando es `true`, la conexión se extrae del grupo adecuado o, si es necesario, se crea y agrega al grupo correcto.</span><span class="sxs-lookup"><span data-stu-id="2dc4b-173">When `true`, the connection is drawn from the appropriate pool, or if necessary, created and added to the appropriate pool.</span></span>|

## <a name="see-also"></a><span data-ttu-id="2dc4b-174">Vea también</span><span class="sxs-lookup"><span data-stu-id="2dc4b-174">See also</span></span>

- [<span data-ttu-id="2dc4b-175">Agrupar conexiones</span><span class="sxs-lookup"><span data-stu-id="2dc4b-175">Connection Pooling</span></span>](connection-pooling.md)
- [<span data-ttu-id="2dc4b-176">Contadores de rendimiento</span><span class="sxs-lookup"><span data-stu-id="2dc4b-176">Performance Counters</span></span>](performance-counters.md)
- [<span data-ttu-id="2dc4b-177">Información general de ADO.NET</span><span class="sxs-lookup"><span data-stu-id="2dc4b-177">ADO.NET Overview</span></span>](ado-net-overview.md)
