---
title: Trabajar con datos binarios (Data Services de WCF)
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework-oob
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, binary data
- WCF Data Services, streams
ms.assetid: aeccc45c-d5c5-4671-ad63-a492ac8043ac
caps.latest.revision: "7"
author: Erikre
ms.author: erikre
manager: erikre
ms.openlocfilehash: 2ed6e20e899ce151f91c370bdf9553a7ace23c9a
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/21/2017
---
# <a name="working-with-binary-data-wcf-data-services"></a><span data-ttu-id="18782-102">Trabajar con datos binarios (Data Services de WCF)</span><span class="sxs-lookup"><span data-stu-id="18782-102">Working with Binary Data (WCF Data Services)</span></span>
<span data-ttu-id="18782-103">El [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] biblioteca de cliente le permite recuperar y actualizar los datos binarios de un [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] la fuente en una de las maneras siguientes:</span><span class="sxs-lookup"><span data-stu-id="18782-103">The [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client library enables you to retrieve and update binary data from an [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] feed in one of the following ways:</span></span>  
  
-   <span data-ttu-id="18782-104">Como una propiedad del tipo primitivo de una entidad.</span><span class="sxs-lookup"><span data-stu-id="18782-104">As a primitive type property of an entity.</span></span> <span data-ttu-id="18782-105">Este es el método recomendado para trabajar con objetos de datos binarios pequeños que se pueden cargar con facilidad en la memoria.</span><span class="sxs-lookup"><span data-stu-id="18782-105">This is the recommended method for working with small binary data objects that can be easily loaded into memory.</span></span> <span data-ttu-id="18782-106">En este caso, la propiedad binaria es una propiedad de entidad expuesta por el modelo de datos y el servicio de datos serializa los datos binarios como XML codificado binario de base 64 en el mensaje de respuesta.</span><span class="sxs-lookup"><span data-stu-id="18782-106">In this case, the binary property is an entity property exposed by the data model, and the data service serializes the binary data as base-64 binary encoded XML in the response message.</span></span>  
  
-   <span data-ttu-id="18782-107">Como flujo de recursos binarios independiente.</span><span class="sxs-lookup"><span data-stu-id="18782-107">As a separate binary resource stream.</span></span> <span data-ttu-id="18782-108">Este es el método recomendado para obtener acceso y cambiar datos de objetos binarios grandes (BLOB) que pueden representar una foto, un vídeo o cualquier otro tipo de datos codificados binarios.</span><span class="sxs-lookup"><span data-stu-id="18782-108">This is the recommended method for accessing and changing binary large object (BLOB) data that may represent a photo, video, or any other type of binary encoded data.</span></span>  
  
 [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]<span data-ttu-id="18782-109">implementa la transmisión por secuencias de datos binarios mediante HTTP, como se define en el [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="18782-109"> implements the streaming of binary data by using HTTP as defined in the [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)].</span></span> <span data-ttu-id="18782-110">En este mecanismo, datos binarios se tratan como un recurso multimedia que es independiente de pero relacionadas con una entidad, que se denomina una entrada de vínculo multimedia.</span><span class="sxs-lookup"><span data-stu-id="18782-110">In this mechanism, binary data is treated as a media resource that is separate from but related to an entity, which is called a media link entry.</span></span> <span data-ttu-id="18782-111">Para obtener más información, consulte [proveedor de transmisión por secuencias](../../../../docs/framework/data/wcf/streaming-provider-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="18782-111">For more information, see [Streaming Provider](../../../../docs/framework/data/wcf/streaming-provider-wcf-data-services.md).</span></span>  
  
> [!TIP]
>  <span data-ttu-id="18782-112">Para obtener un ejemplo paso a paso de cómo crear un [!INCLUDE[avalon1](../../../../includes/avalon1-md.md)] aplicación cliente que descarga archivos de imagen binarios de un [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] servicio que almacene fotos, vea la entrada [datos servicios de transmisión por secuencias proveedor serie-parte 2: obtener acceso a un medio Flujo de recursos desde el cliente](http://go.microsoft.com/fwlink/?LinkId=201637).</span><span class="sxs-lookup"><span data-stu-id="18782-112">For a step-by-step example of how to create a [!INCLUDE[avalon1](../../../../includes/avalon1-md.md)] client application that downloads binary image files from an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] service that stores photos, see the post [Data Services Streaming Provider Series-Part 2: Accessing a Media Resource Stream from the Client](http://go.microsoft.com/fwlink/?LinkId=201637).</span></span> <span data-ttu-id="18782-113">Para descargar el código de ejemplo para el servicio de datos de fotografía de secuencia incluido en la entrada de blog, vea la [ejemplo de servicio de datos de fotografía de transmisión por secuencias](http://go.microsoft.com/fwlink/?LinkId=198988) en MSDN Code Gallery.</span><span class="sxs-lookup"><span data-stu-id="18782-113">To download the sample code for the stream photo data service featured in the blog post, see the [Streaming Photo Data Service Sample](http://go.microsoft.com/fwlink/?LinkId=198988) in MSDN Code Gallery.</span></span>  
  
## <a name="entity-metadata"></a><span data-ttu-id="18782-114">Metadatos de entidad</span><span class="sxs-lookup"><span data-stu-id="18782-114">Entity Metadata</span></span>  
 <span data-ttu-id="18782-115">Una entidad que tenga un flujo de recursos multimedia relacionado se indica en los metadatos del servicio de datos mediante el atributo `HasStream` aplicado a un tipo de entidad que sea la entrada de vínculo multimedia.</span><span class="sxs-lookup"><span data-stu-id="18782-115">An entity that has a related media resource stream is indicated in the data service metadata by the `HasStream` attribute applied to an entity type that is the media link entry.</span></span> <span data-ttu-id="18782-116">En el ejemplo siguiente, la `PhotoInfo` entidad es una entrada de vínculo multimedia que tiene un recurso multimedia relacionado, indicado por la `HasStream` atributo.</span><span class="sxs-lookup"><span data-stu-id="18782-116">In the following example, the `PhotoInfo` entity is a media link entry that has a related media resource, indicated by the `HasStream` attribute.</span></span>  
  
 [!code-xml[Astoria Photo Streaming Service#HasStream](../../../../samples/snippets/xml/VS_Snippets_Misc/astoria photo streaming service/xml/photodata.edmx#hasstream)]  
  
 <span data-ttu-id="18782-117">En el resto de los ejemplos de este tema se muestra cómo acceder y cambiar el flujo de recursos multimedia.</span><span class="sxs-lookup"><span data-stu-id="18782-117">The remaining examples in this topic show how to access and change the media resource stream.</span></span> <span data-ttu-id="18782-118">Para obtener un ejemplo completo de cómo consumir un flujo de recursos multimedia en una aplicación de cliente de .NET Framework mediante el [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] biblioteca de cliente, vea la entrada [obtiene acceso a un flujo de recursos multimedia desde el cliente](http://go.microsoft.com/fwlink/?LinkID=201637).</span><span class="sxs-lookup"><span data-stu-id="18782-118">For a complete example of how to consume a media resource stream in a .NET Framework client application by using the [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client library, see the post [Accessing a Media Resource Stream from the Client](http://go.microsoft.com/fwlink/?LinkID=201637).</span></span>  
  
## <a name="accessing-the-binary-resource-stream"></a><span data-ttu-id="18782-119">Acceder al flujo de recursos binarios</span><span class="sxs-lookup"><span data-stu-id="18782-119">Accessing the Binary Resource Stream</span></span>  
 <span data-ttu-id="18782-120">La biblioteca cliente de [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] proporciona métodos para acceder a flujos de recursos binarios desde un servicio de datos basado en [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="18782-120">The [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] client library provides methods for accessing binary resource streams from an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]-based data service.</span></span> <span data-ttu-id="18782-121">Cuando se descarga un recurso multimedia, puede usar el URI de dicho recurso u obtener un flujo binario que contenga los datos del propio recurso multimedia.</span><span class="sxs-lookup"><span data-stu-id="18782-121">When downloading a media resource, you can either use the URI of the media resource or you can get a binary stream that contains the media resource data itself.</span></span> <span data-ttu-id="18782-122">También puede cargar los datos del recurso multimedia como flujo binario.</span><span class="sxs-lookup"><span data-stu-id="18782-122">You can also upload media resource data as a binary stream.</span></span>  
  
> [!TIP]
>  <span data-ttu-id="18782-123">Para obtener un ejemplo paso a paso de cómo crear un [!INCLUDE[avalon1](../../../../includes/avalon1-md.md)] aplicación cliente que descarga archivos de imagen binarios de un [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] servicio que almacene fotos, vea la entrada [datos servicios de transmisión por secuencias proveedor serie-parte 2: obtener acceso a un medio Flujo de recursos desde el cliente](http://go.microsoft.com/fwlink/?LinkId=201637).</span><span class="sxs-lookup"><span data-stu-id="18782-123">For a step-by-step example of how to create a [!INCLUDE[avalon1](../../../../includes/avalon1-md.md)] client application that downloads binary image files from an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] service that stores photos, see the post [Data Services Streaming Provider Series-Part 2: Accessing a Media Resource Stream from the Client](http://go.microsoft.com/fwlink/?LinkId=201637).</span></span> <span data-ttu-id="18782-124">Para descargar el código de ejemplo para el servicio de datos de fotografía de secuencia incluido en la entrada de blog, vea la [ejemplo de servicio de datos de fotografía de transmisión por secuencias](http://go.microsoft.com/fwlink/?LinkId=198988) en MSDN Code Gallery.</span><span class="sxs-lookup"><span data-stu-id="18782-124">To download the sample code for the stream photo data service featured in the blog post, see the [Streaming Photo Data Service Sample](http://go.microsoft.com/fwlink/?LinkId=198988) in MSDN Code Gallery.</span></span>  
  
### <a name="getting-the-uri-of-the-binary-stream"></a><span data-ttu-id="18782-125">Obtener el URI del flujo binario</span><span class="sxs-lookup"><span data-stu-id="18782-125">Getting the URI of the Binary Stream</span></span>  
 <span data-ttu-id="18782-126">Cuando se recuperan ciertos tipos de recursos multimedia, como imágenes y otros archivos multimedia, suele ser más fácil usar el URI del recurso multimedia de la aplicación que administrar el propio flujo de datos binarios.</span><span class="sxs-lookup"><span data-stu-id="18782-126">When retrieving certain types of media resources, such as images and other media files, it is often easier to use the URI of the media resource in your application than handling the binary data stream itself.</span></span> <span data-ttu-id="18782-127">Para obtener el URI de un flujo de recursos asociado con una entrada de vínculo multimedia determinada, debe llamar al método <xref:System.Data.Services.Client.DataServiceContext.GetReadStreamUri%2A> de la instancia de la clase <xref:System.Data.Services.Client.DataServiceContext> que esté realizando el seguimiento de la entidad.</span><span class="sxs-lookup"><span data-stu-id="18782-127">To get the URI of a resource stream associated with a give media link entry, you must call the <xref:System.Data.Services.Client.DataServiceContext.GetReadStreamUri%2A> method on the <xref:System.Data.Services.Client.DataServiceContext> instance that is tracking the entity.</span></span> <span data-ttu-id="18782-128">En el ejemplo siguiente se muestra cómo llamar al método <xref:System.Data.Services.Client.DataServiceContext.GetReadStreamUri%2A> para obtener el URI de un flujo de recursos multimedia que se use con el fin de crear una nueva imagen en el cliente:</span><span class="sxs-lookup"><span data-stu-id="18782-128">The following example shows how to call the <xref:System.Data.Services.Client.DataServiceContext.GetReadStreamUri%2A> method to get the URI of a media resource stream that is used to create a new image on the client:</span></span>  
  
 [!code-csharp[Astoria Photo Streaming Client#GetReadStreamUri](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria photo streaming client/cs/photowindow.xaml.cs#getreadstreamuri)]
 [!code-vb[Astoria Photo Streaming Client#GetReadStreamUri](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria photo streaming client/vb/photowindow.xaml.vb#getreadstreamuri)]  
  
### <a name="downloading-the-binary-resource-stream"></a><span data-ttu-id="18782-129">Descargar el flujo de recursos binarios</span><span class="sxs-lookup"><span data-stu-id="18782-129">Downloading the Binary Resource Stream</span></span>  
 <span data-ttu-id="18782-130">Al recuperar un flujo de recursos multimedia, es necesario llamar al método <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> de la instancia de la clase <xref:System.Data.Services.Client.DataServiceContext> que esté realizando el seguimiento de la entrada de vínculo multimedia.</span><span class="sxs-lookup"><span data-stu-id="18782-130">When retrieving a binary resource stream, you must call the <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> method on the <xref:System.Data.Services.Client.DataServiceContext> instance that is tracking the media link entry.</span></span> <span data-ttu-id="18782-131">Este método envía una solicitud al servicio de datos que devuelve un objeto <xref:System.Data.Services.Client.DataServiceStreamResponse>, que tiene una referencia al flujo que contiene el recurso.</span><span class="sxs-lookup"><span data-stu-id="18782-131">This method sends a request to the data service that returns a <xref:System.Data.Services.Client.DataServiceStreamResponse> object, which has a reference to the stream that contains the resource.</span></span> <span data-ttu-id="18782-132">Use este método cuando la aplicación necesite el recurso binario como clase <xref:System.IO.Stream>.</span><span class="sxs-lookup"><span data-stu-id="18782-132">Use this method when your application requires the binary resource as a <xref:System.IO.Stream>.</span></span> <span data-ttu-id="18782-133">En el ejemplo siguiente se muestra cómo llamar al método <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> para recuperar un flujo que se use con el fin de crear una nueva imagen en el cliente:</span><span class="sxs-lookup"><span data-stu-id="18782-133">The following example shows how to call the <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> method to retrieve a stream that is used to create a new image on the client:</span></span>  
  
 [!code-csharp[Astoria Streaming Client#GetReadStreamClient](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria streaming client/cs/customerphotowindow.xaml.cs#getreadstreamclient)]
 [!code-vb[Astoria Streaming Client#GetReadStreamClient](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria streaming client/vb/customerphotowindow.xaml.vb#getreadstreamclient)]  
  
> [!NOTE]
>  <span data-ttu-id="18782-134">El servicio de datos no establece el encabezado de longitud de contenido del mensaje de respuesta que contiene el flujo binario.</span><span class="sxs-lookup"><span data-stu-id="18782-134">The Content-Length header in the response message that contains the binary steam is not set by the data service.</span></span> <span data-ttu-id="18782-135">Este valor puede no reflejar la longitud real del flujo de datos binarios.</span><span class="sxs-lookup"><span data-stu-id="18782-135">This value may not reflect the actual length of the binary data stream.</span></span>  
  
### <a name="uploading-a-media-resource-as-a-stream"></a><span data-ttu-id="18782-136">Cargar un recurso multimedia como flujo</span><span class="sxs-lookup"><span data-stu-id="18782-136">Uploading a Media Resource as a Stream</span></span>  
 <span data-ttu-id="18782-137">Para insertar o actualizar un recurso multimedia, llame al método <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> de la instancia de la clase <xref:System.Data.Services.Client.DataServiceContext> que esté realizando el seguimiento de la entidad.</span><span class="sxs-lookup"><span data-stu-id="18782-137">To insert or update a media resource, call the <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> method on the <xref:System.Data.Services.Client.DataServiceContext> instance that is tracking the entity.</span></span> <span data-ttu-id="18782-138">Este método envía una solicitud al servicio de datos que contiene el recurso multimedia leído desde el flujo proporcionado.</span><span class="sxs-lookup"><span data-stu-id="18782-138">This method sends a request to the data service that contains the media resource read from the supplied stream.</span></span> <span data-ttu-id="18782-139">En el siguiente ejemplo se muestra cómo llamar al método <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> para enviar una imagen al servicio de datos:</span><span class="sxs-lookup"><span data-stu-id="18782-139">The following example shows how to call the <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> method to send an image to the data service:</span></span>  
  
 [!code-csharp[Astoria Photo Streaming Client#SetSaveStream](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria photo streaming client/cs/photodetailswindow.xaml.cs#setsavestream)]
 [!code-vb[Astoria Photo Streaming Client#SetSaveStream](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria photo streaming client/vb/photodetailswindow.xaml.vb#setsavestream)]  
  
 <span data-ttu-id="18782-140">En este ejemplo, se llama al método <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> proporcionando un valor `true` para el parámetro `closeStream`.</span><span class="sxs-lookup"><span data-stu-id="18782-140">In this example, the <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> method is called by supplying a value of `true` for the `closeStream` parameter.</span></span> <span data-ttu-id="18782-141">De esta forma, se garantiza que la clase <xref:System.Data.Services.Client.DataServiceContext> cierre el flujo una vez cargados los datos binarios en el servicio de datos.</span><span class="sxs-lookup"><span data-stu-id="18782-141">This guarantees that the <xref:System.Data.Services.Client.DataServiceContext> closes the stream after the binary data is uploaded to the data service.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="18782-142">Cuando llame al método <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A>, el flujo no se envía al servicio de datos hasta que se llame al método <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A>.</span><span class="sxs-lookup"><span data-stu-id="18782-142">When you call <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A>, the stream is not sent to the data service until <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> is called.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="18782-143">Vea también</span><span class="sxs-lookup"><span data-stu-id="18782-143">See Also</span></span>  
 [<span data-ttu-id="18782-144">Biblioteca cliente de Servicios de datos de WCF</span><span class="sxs-lookup"><span data-stu-id="18782-144">WCF Data Services Client Library</span></span>](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)  
 [<span data-ttu-id="18782-145">Enlazar datos a controles</span><span class="sxs-lookup"><span data-stu-id="18782-145">Binding Data to Controls</span></span>](../../../../docs/framework/data/wcf/binding-data-to-controls-wcf-data-services.md)
