---
title: Cargar contenido diferido (Data Services de WCF)
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework-oob
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, client library
- WCF Data Services, deferred content
- WCF Data Services, loading data
ms.assetid: 32f9b588-c832-44c4-a7e0-fcce635df59a
caps.latest.revision: "2"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 599b420dee2e1d19c85a078ac358a9249ca055ed
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/02/2017
---
# <a name="loading-deferred-content-wcf-data-services"></a><span data-ttu-id="a06df-102">Cargar contenido diferido (Data Services de WCF)</span><span class="sxs-lookup"><span data-stu-id="a06df-102">Loading Deferred Content (WCF Data Services)</span></span>
<span data-ttu-id="a06df-103">De forma predeterminada, [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] limita la cantidad de datos que devuelve una consulta.</span><span class="sxs-lookup"><span data-stu-id="a06df-103">By default, [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] limits the amount of data that a query returns.</span></span> <span data-ttu-id="a06df-104">Sin embargo, es posible cargar explícitamente datos adicionales, incluidos los datos de la respuesta paginados, las entidades relacionadas y los flujos de datos binarios, del servicio de datos cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="a06df-104">However, you can explicitly load additional data, including related entities, paged response data, and binary data streams, from the data service when it is needed.</span></span> <span data-ttu-id="a06df-105">En este tema se describe cómo cargar dicho contenido aplazado en una aplicación.</span><span class="sxs-lookup"><span data-stu-id="a06df-105">This topic describes how to load such deferred content into your application.</span></span>  
  
## <a name="related-entities"></a><span data-ttu-id="a06df-106">Entidades relacionadas</span><span class="sxs-lookup"><span data-stu-id="a06df-106">Related Entities</span></span>  
 <span data-ttu-id="a06df-107">Cuando se ejecuta una consulta, solo se devuelven las entidades pertenecientes al conjunto de entidades direccionado.</span><span class="sxs-lookup"><span data-stu-id="a06df-107">When you execute a query, only entities in the addressed entity set are returned.</span></span> <span data-ttu-id="a06df-108">Por ejemplo, cuando una consulta al servicio de datos Northwind devuelve entidades `Customers`, no se devuelven de forma predeterminada las entidades `Orders` relacionadas aunque haya una relación entre `Customers` y `Orders`.</span><span class="sxs-lookup"><span data-stu-id="a06df-108">For example, when a query against the Northwind data service returns `Customers` entities, by default the related `Orders` entities are not returned, even though there is a relationship between `Customers` and `Orders`.</span></span> <span data-ttu-id="a06df-109">Además, cuando está habilitada la paginación en el servicio de datos, debe cargar explícitamente las páginas de datos subsiguientes del servicio.</span><span class="sxs-lookup"><span data-stu-id="a06df-109">Also, when paging is enabled in the data service, you must explicitly load subsequent data pages from the service.</span></span> <span data-ttu-id="a06df-110">Hay dos maneras de cargar las entidades relacionadas:</span><span class="sxs-lookup"><span data-stu-id="a06df-110">There are two ways to load related entities:</span></span>  
  
-   <span data-ttu-id="a06df-111">**Carga diligente**: puede usar el `$expand` opción de consulta para solicitar que la consulta devuelva entidades que estén relacionadas mediante una asociación con la entidad que establece la consulta solicitada.</span><span class="sxs-lookup"><span data-stu-id="a06df-111">**Eager loading**: You can use the `$expand` query option to request that the query return entities that are related by an association to the entity set that the query requested.</span></span> <span data-ttu-id="a06df-112">Utilice el método <xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A> en <xref:System.Data.Services.Client.DataServiceQuery%601> para agregar la opción `$expand` a la consulta que se envía al servicio de datos.</span><span class="sxs-lookup"><span data-stu-id="a06df-112">Use the <xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A> method on the <xref:System.Data.Services.Client.DataServiceQuery%601> to add the `$expand` option to the query that is sent to the data service.</span></span> <span data-ttu-id="a06df-113">Puede solicitar varios conjuntos de entidades relacionados separándolos mediante comas, como muestra el ejemplo siguiente.</span><span class="sxs-lookup"><span data-stu-id="a06df-113">You can request multiple related entity sets by separating them by a comma, as in the following example.</span></span> <span data-ttu-id="a06df-114">Todas las entidades solicitadas por la consulta se devuelven en una única respuesta.</span><span class="sxs-lookup"><span data-stu-id="a06df-114">All entities requested by the query are returned in a single response.</span></span> <span data-ttu-id="a06df-115">En el ejemplo siguiente se devuelve `Order_Details` y `Customers` junto con el conjunto de entidades `Orders`:</span><span class="sxs-lookup"><span data-stu-id="a06df-115">The following example returns `Order_Details` and `Customers` together with the `Orders` entity set:</span></span>  
  
     [!code-csharp[Astoria Northwind Client#ExpandOrderDetailsSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#expandorderdetailsspecific)]
     [!code-vb[Astoria Northwind Client#ExpandOrderDetailsSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#expandorderdetailsspecific)]  
  
     [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]<span data-ttu-id="a06df-116"> limita a 12 el número de conjuntos de entidades que se pueden incluir en una única consulta utilizando la opción de consulta `$expand`.</span><span class="sxs-lookup"><span data-stu-id="a06df-116"> limits to 12 the number of entity sets that can be included in a single query by using the `$expand` query option.</span></span>  
  
-   <span data-ttu-id="a06df-117">**Carga explícita**: puede llamar a la <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> método en el <xref:System.Data.Services.Client.DataServiceContext> instancia cargar explícitamente las entidades relacionadas.</span><span class="sxs-lookup"><span data-stu-id="a06df-117">**Explicit loading**: You can call the <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> method on the <xref:System.Data.Services.Client.DataServiceContext> instance to explicitly load related entities.</span></span> <span data-ttu-id="a06df-118">Cada llamada al método <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> crea una solicitud independiente al servicio de datos.</span><span class="sxs-lookup"><span data-stu-id="a06df-118">Each call to the <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> method creates a separate request to the data service.</span></span> <span data-ttu-id="a06df-119">En el ejemplo siguiente se carga explícitamente `Order_Details` para una entidad `Orders`:</span><span class="sxs-lookup"><span data-stu-id="a06df-119">The following example explicitly loads `Order_Details` for an `Orders` entity:</span></span>  
  
     [!code-csharp[Astoria Northwind Client#LoadRelatedOrderDetailsSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#loadrelatedorderdetailsspecific)]
     [!code-vb[Astoria Northwind Client#LoadRelatedOrderDetailsSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#loadrelatedorderdetailsspecific)]  
  
 <span data-ttu-id="a06df-120">Al considerar qué opción se debe usar, observe que hay una correlación entre el número de solicitudes al servicio de datos y la cantidad de datos devueltos en una sola respuesta.</span><span class="sxs-lookup"><span data-stu-id="a06df-120">When you consider which option to use, realize that there is a tradeoff between the number of requests to the data service and the amount of data that is returned in a single response.</span></span> <span data-ttu-id="a06df-121">Use la carga diligente cuando su aplicación requiera objetos asociados y desee evitar la latencia agregada de las solicitudes adicionales para recuperarlos explícitamente.</span><span class="sxs-lookup"><span data-stu-id="a06df-121">Use eager loading when your application requires associated objects and you want to avoid the added latency of additional requests to explicitly retrieve them.</span></span> <span data-ttu-id="a06df-122">Sin embargo, si hay casos en que la aplicación solo necesita los datos para determinadas instancias de entidades relacionadas, debería plantearse cargar explícitamente esas entidades llamando al método <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A>.</span><span class="sxs-lookup"><span data-stu-id="a06df-122">However, if there are cases when the application only needs the data for specific related entity instances, you should consider explicitly loading those entities by calling the <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> method.</span></span> <span data-ttu-id="a06df-123">Para obtener más información, consulte [Cómo: las entidades relacionadas de carga](../../../../docs/framework/data/wcf/how-to-load-related-entities-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="a06df-123">For more information, see [How to: Load Related Entities](../../../../docs/framework/data/wcf/how-to-load-related-entities-wcf-data-services.md).</span></span>  
  
## <a name="paged-content"></a><span data-ttu-id="a06df-124">Contenido paginado</span><span class="sxs-lookup"><span data-stu-id="a06df-124">Paged Content</span></span>  
 <span data-ttu-id="a06df-125">Si la paginación está habilitada en el servicio de datos, la configuración del servicio de datos limita el número de entradas de la fuente que devuelve el servicio de datos.</span><span class="sxs-lookup"><span data-stu-id="a06df-125">When paging is enabled in the data service, the number of entries in the feed that the data service returns is limited by the configuration of the data service.</span></span> <span data-ttu-id="a06df-126">Los límites de página pueden establecerse por separado para cada conjunto de entidades.</span><span class="sxs-lookup"><span data-stu-id="a06df-126">Page limits can be set separately for each entity set.</span></span> <span data-ttu-id="a06df-127">Para obtener más información, consulte [configurar el servicio de datos](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="a06df-127">For more information, see [Configuring the Data Service](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span></span> <span data-ttu-id="a06df-128">Si está habilitada la paginación, la última entrada de la fuente contiene un vínculo a la página de datos siguiente.</span><span class="sxs-lookup"><span data-stu-id="a06df-128">When paging is enabled, the final entry in the feed contains a link to the next page of data.</span></span> <span data-ttu-id="a06df-129">Este vínculo está contenido en un objeto <xref:System.Data.Services.Client.DataServiceQueryContinuation%601>.</span><span class="sxs-lookup"><span data-stu-id="a06df-129">This link is contained in a <xref:System.Data.Services.Client.DataServiceQueryContinuation%601> object.</span></span> <span data-ttu-id="a06df-130">El URI a la página de datos siguiente se obtiene llamando al método <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> del objeto <xref:System.Data.Services.Client.QueryOperationResponse%601> que se obtiene cuando se ejecuta <xref:System.Data.Services.Client.DataServiceQuery%601>.</span><span class="sxs-lookup"><span data-stu-id="a06df-130">You obtain the URI to the next page of data by calling the <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> method on the <xref:System.Data.Services.Client.QueryOperationResponse%601> returned when the <xref:System.Data.Services.Client.DataServiceQuery%601> is executed.</span></span> <span data-ttu-id="a06df-131">A continuación, el objeto <xref:System.Data.Services.Client.DataServiceQueryContinuation%601> devuelto se usa para cargar la página de resultados siguiente.</span><span class="sxs-lookup"><span data-stu-id="a06df-131">The returned <xref:System.Data.Services.Client.DataServiceQueryContinuation%601> object is then used to load the next page of results.</span></span> <span data-ttu-id="a06df-132">Debe enumerar los resultados de la consulta antes de llamar al método <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A>.</span><span class="sxs-lookup"><span data-stu-id="a06df-132">You must enumerate the query result before you call the <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> method.</span></span> <span data-ttu-id="a06df-133">Considere la posibilidad de usar un bucle `do…while` para enumerar el resultado de la consulta primero y, a continuación, comprobar el valor de un vínculo siguiente `non-null`.</span><span class="sxs-lookup"><span data-stu-id="a06df-133">Consider using a `do…while` loop to first enumerate the query result and then check for a `non-null` next link value.</span></span> <span data-ttu-id="a06df-134">Cuando el método <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> devuelve `null` (`Nothing` en Visual Basic), no hay ninguna página de resultados adicional para la consulta original.</span><span class="sxs-lookup"><span data-stu-id="a06df-134">When the <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> method returns `null` (`Nothing` in Visual Basic), there are no additional result pages for the original query.</span></span> <span data-ttu-id="a06df-135">En el ejemplo siguiente se muestra un bucle `do…while` que carga los datos del cliente paginados del servicio de datos de ejemplo Northwind.</span><span class="sxs-lookup"><span data-stu-id="a06df-135">The following example shows a `do…while` loop that loads paged customer data from the Northwind sample data service.</span></span>  
  
 [!code-csharp[Astoria Northwind Client#LoadNextLink](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#loadnextlink)]
 [!code-vb[Astoria Northwind Client#LoadNextLink](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#loadnextlink)]  
  
 <span data-ttu-id="a06df-136">Cuando una consulta solicita que se devuelvan las entidades relacionadas en una respuesta única junto con el conjunto de entidades solicitado, los límites de paginación pueden afectar a las fuentes anidadas que están incluidas alineadas con la respuesta.</span><span class="sxs-lookup"><span data-stu-id="a06df-136">When a query requests that related entities are returned in a single response together with the requested entity set, paging limits may affect nested feeds that are included inline with the response.</span></span> <span data-ttu-id="a06df-137">Por ejemplo, cuando se establece un límite de paginación en el servicio de datos de ejemplo Northwind para el conjunto de entidades `Customers`, también puede establecerse un límite de paginación independiente para el conjunto de entidades `Orders` relacionado, como en el ejemplo siguiente del archivo Northwind.svc.cs que define el servicio de datos de ejemplo Northwind.</span><span class="sxs-lookup"><span data-stu-id="a06df-137">For example, when a paging limit is set in the Northwind sample data service for the `Customers` entity set, an independent paging limit can also be set for the related `Orders` entity set, as in the following example from the Northwind.svc.cs file that defines the Northwind sample data service.</span></span>  
  
 [!code-csharp[Astoria Northwind Service#DataServiceConfigPaging](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind service/cs/northwind.svc.cs#dataserviceconfigpaging)]
 [!code-vb[Astoria Northwind Service#DataServiceConfigPaging](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind service/vb/northwind.svc.vb#dataserviceconfigpaging)]  
  
 <span data-ttu-id="a06df-138">En este caso, debe implementar la paginación para las dos fuentes de entidades, la de nivel superior, `Customers`, y las anidadas, `Orders`.</span><span class="sxs-lookup"><span data-stu-id="a06df-138">In this case, you must implement paging for both the top-level `Customers` and the nested `Orders` entity feeds.</span></span> <span data-ttu-id="a06df-139">En el ejemplo siguiente se muestra el bucle `while` que se usa para cargar las páginas de las entidades `Orders` relacionadas con una entidad `Customers` seleccionada.</span><span class="sxs-lookup"><span data-stu-id="a06df-139">The following example shows the `while` loop used to load pages of `Orders` entities related to a selected `Customers` entity.</span></span>  
  
 [!code-csharp[Astoria Northwind Client#LoadNextOrdersLink](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind client/cs/source.cs#loadnextorderslink)]
 [!code-vb[Astoria Northwind Client#LoadNextOrdersLink](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind client/vb/source.vb#loadnextorderslink)]  
  
 <span data-ttu-id="a06df-140">Para obtener más información, consulte [Cómo: resultados paginados de carga](../../../../docs/framework/data/wcf/how-to-load-paged-results-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="a06df-140">For more information, see [How to: Load Paged Results](../../../../docs/framework/data/wcf/how-to-load-paged-results-wcf-data-services.md).</span></span>  
  
## <a name="binary-data-streams"></a><span data-ttu-id="a06df-141">Flujos de datos binarios</span><span class="sxs-lookup"><span data-stu-id="a06df-141">Binary Data Streams</span></span>  
 [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]<span data-ttu-id="a06df-142"> le permite tener acceso a datos de objetos binarios grandes (BLOB) en forma de flujo de datos.</span><span class="sxs-lookup"><span data-stu-id="a06df-142"> enables you to access binary large object (BLOB) data as a data stream.</span></span> <span data-ttu-id="a06df-143">La transmisión por secuencias aplaza la carga de datos binarios hasta que se necesita, y el cliente puede procesar estos datos más eficazmente.</span><span class="sxs-lookup"><span data-stu-id="a06df-143">Streaming defers the loading of binary data until it is needed, and the client can more efficiently process this data.</span></span> <span data-ttu-id="a06df-144">Para aprovecharse de esta funcionalidad, el servicio de datos debe implementar el proveedor <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span><span class="sxs-lookup"><span data-stu-id="a06df-144">In order to take advantage of this functionality, the data service must implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> provider.</span></span> <span data-ttu-id="a06df-145">Para obtener más información, consulte [proveedor de transmisión por secuencias](../../../../docs/framework/data/wcf/streaming-provider-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="a06df-145">For more information, see [Streaming Provider](../../../../docs/framework/data/wcf/streaming-provider-wcf-data-services.md).</span></span> <span data-ttu-id="a06df-146">Cuando está habilitada la transmisión por secuencias, los tipos de entidad se devuelven sin los datos binarios relacionados.</span><span class="sxs-lookup"><span data-stu-id="a06df-146">When streaming is enabled, entity types are returned without the related binary data.</span></span> <span data-ttu-id="a06df-147">En este caso, debe usar el <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> método de la <xref:System.Data.Services.Client.DataServiceContext> clase para tener acceso a la secuencia de datos para los datos binarios del servicio.</span><span class="sxs-lookup"><span data-stu-id="a06df-147">In this case, you must use the <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> method of the <xref:System.Data.Services.Client.DataServiceContext> class to access the data stream for the binary data from the service.</span></span> <span data-ttu-id="a06df-148">De igual forma, use el método <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> para agregar o cambiar los datos binarios de una entidad como un flujo.</span><span class="sxs-lookup"><span data-stu-id="a06df-148">Similarly, use the <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> method to add or change binary data for an entity as a stream.</span></span> <span data-ttu-id="a06df-149">Para obtener más información, consulte [trabajar con datos binarios](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="a06df-149">For more information, see [Working with Binary Data](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a06df-150">Vea también</span><span class="sxs-lookup"><span data-stu-id="a06df-150">See Also</span></span>  
 [<span data-ttu-id="a06df-151">Biblioteca cliente de Servicios de datos de WCF</span><span class="sxs-lookup"><span data-stu-id="a06df-151">WCF Data Services Client Library</span></span>](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)  
 [<span data-ttu-id="a06df-152">Consultar el servicio de datos</span><span class="sxs-lookup"><span data-stu-id="a06df-152">Querying the Data Service</span></span>](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)
