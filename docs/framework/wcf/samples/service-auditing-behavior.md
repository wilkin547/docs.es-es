---
title: Comportamiento de auditoría de servicio
ms.date: 03/30/2017
ms.assetid: 59bf0cda-e496-4418-a3a1-2f0f6e85f8ce
ms.openlocfilehash: ae7ed2059b491a71de9c806e78f1fb784da197fa
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/26/2020
ms.locfileid: "96262572"
---
# <a name="service-auditing-behavior"></a><span data-ttu-id="95c8f-102">Comportamiento de auditoría de servicio</span><span class="sxs-lookup"><span data-stu-id="95c8f-102">Service Auditing Behavior</span></span>

<span data-ttu-id="95c8f-103">Este ejemplo muestra cómo utilizar <xref:System.ServiceModel.Description.ServiceSecurityAuditBehavior> para habilitar la auditoría de eventos de seguridad durante las operaciones de servicio.</span><span class="sxs-lookup"><span data-stu-id="95c8f-103">This sample demonstrates how to use the <xref:System.ServiceModel.Description.ServiceSecurityAuditBehavior> to enable auditing of security events during service operations.</span></span> <span data-ttu-id="95c8f-104">Este ejemplo se basa en el [Introducción](getting-started-sample.md).</span><span class="sxs-lookup"><span data-stu-id="95c8f-104">This sample is based on the [Getting Started](getting-started-sample.md).</span></span> <span data-ttu-id="95c8f-105">El servicio y el cliente se han configurado con [\<wsHttpBinding>](../../configure-apps/file-schema/wcf/wshttpbinding.md) .</span><span class="sxs-lookup"><span data-stu-id="95c8f-105">The service and client have been configured using the [\<wsHttpBinding>](../../configure-apps/file-schema/wcf/wshttpbinding.md).</span></span> <span data-ttu-id="95c8f-106">El `mode` atributo de [\<security>](../../configure-apps/file-schema/wcf/security-of-custombinding.md) se ha establecido en `Message` y se ha `clientCredentialType` establecido en `Windows` .</span><span class="sxs-lookup"><span data-stu-id="95c8f-106">The `mode` attribute of the [\<security>](../../configure-apps/file-schema/wcf/security-of-custombinding.md) has been set to `Message` and `clientCredentialType` has been set to `Windows`.</span></span> <span data-ttu-id="95c8f-107">En este ejemplo, el cliente es una aplicación de consola (.exe) y los Servicios de Internet Information Server (IIS) hospedan el servicio.</span><span class="sxs-lookup"><span data-stu-id="95c8f-107">In this sample, the client is a console application (.exe) and the service is hosted by Internet Information Services (IIS).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="95c8f-108">El procedimiento de instalación y las instrucciones de compilación de este ejemplo se encuentran al final de este tema.</span><span class="sxs-lookup"><span data-stu-id="95c8f-108">The setup procedure and build instructions for this sample are located at the end of this topic.</span></span>  
  
 <span data-ttu-id="95c8f-109">El archivo de configuración de servicio utiliza el elemento `serviceSecurityAudit` para configurar la auditoría.</span><span class="sxs-lookup"><span data-stu-id="95c8f-109">The service configuration file uses the `serviceSecurityAudit` element to configure auditing.</span></span>  
  
```xml  
<behaviors>  
  <serviceBehaviors>  
    <behavior name="CalculatorServiceBehavior">  
      ...  
<!-- serviceSecurityAudit allows specification of audit location   
     and whether to audit success, failure or both. This service   
     logs success and failure of messageAuthentication   
     to the default location -->  
     <serviceSecurityAudit auditLogLocation ="Default" messageAuthenticationAuditLevel = "SuccessOrFailure" />  
    </behavior>  
  </serviceBehaviors>  
</behaviors>  
```  
  
 <span data-ttu-id="95c8f-110">Al ejecutar el ejemplo, las solicitudes y respuestas de la operación se muestran en la ventana de la consola del cliente.</span><span class="sxs-lookup"><span data-stu-id="95c8f-110">When you run the sample, the operation requests and responses are displayed in the client console window.</span></span> <span data-ttu-id="95c8f-111">Presione ENTRAR en la ventana de la consola para cerrar el cliente.</span><span class="sxs-lookup"><span data-stu-id="95c8f-111">Press ENTER in the console window to shut down the client.</span></span>  
  
 <span data-ttu-id="95c8f-112">Los registros de auditoría resultantes se pueden ver al ejecutar el Visor de eventos.</span><span class="sxs-lookup"><span data-stu-id="95c8f-112">The resulting audit logs can be seen by running the Event Viewer.</span></span> <span data-ttu-id="95c8f-113">De forma predeterminada, en Windows XP los eventos de auditoría se pueden ver en el registro de aplicaciones, mientras que en Windows Server 2003 y Windows Vista, los eventos de auditoría se pueden ver en el registro de seguridad.</span><span class="sxs-lookup"><span data-stu-id="95c8f-113">By default, on Windows XP the audit events can be seen in the Application Log while on Windows Server 2003 and Windows Vista, the audit events can be seen in the Security Log.</span></span> <span data-ttu-id="95c8f-114">En Windows Server 2008 y Windows 7, los eventos de auditoría se pueden ver en los registros de aplicaciones y servicios.</span><span class="sxs-lookup"><span data-stu-id="95c8f-114">On Windows Server 2008 and Windows 7, the audit events can be seen in the Applications and Services logs.</span></span> <span data-ttu-id="95c8f-115">La ubicación de los eventos de auditoría se puede especificar estableciendo el `auditLogLocation` atributo en "Application" o "Security".</span><span class="sxs-lookup"><span data-stu-id="95c8f-115">The location of audit events can be specified by setting the `auditLogLocation` attribute to "Application" or "Security".</span></span> <span data-ttu-id="95c8f-116">Para obtener más información, consulte [Cómo: auditar eventos de seguridad](../feature-details/how-to-audit-wcf-security-events.md).</span><span class="sxs-lookup"><span data-stu-id="95c8f-116">For more information, see [How to: Audit Security Events](../feature-details/how-to-audit-wcf-security-events.md).</span></span> <span data-ttu-id="95c8f-117">Si los eventos se escriben en el registro de seguridad, se debe establecer LocalSecurityPolicy-> habilitar el acceso a objetos para "Success" y "Failure".</span><span class="sxs-lookup"><span data-stu-id="95c8f-117">If the events are written in the Security Log the LocalSecurityPolicy-> Enable Object Access should be set for "Success" and "Failure".</span></span>  
  
 <span data-ttu-id="95c8f-118">Al examinar el registro de eventos, el origen de los eventos de auditoría es "ServiceModel Audit 3.0.0.0".</span><span class="sxs-lookup"><span data-stu-id="95c8f-118">When looking at the event log, the source of the audit events is "ServiceModel Audit 3.0.0.0".</span></span> <span data-ttu-id="95c8f-119">Los registros de auditoría de autenticación de mensajes tienen una categoría de "MessageAuthentication", mientras que los registros de auditoría de autorización de servicio tienen una categoría de "ServiceAuthorization".</span><span class="sxs-lookup"><span data-stu-id="95c8f-119">Message authentication audit records have a category of "MessageAuthentication" while service authorization audit records have a category of "ServiceAuthorization".</span></span>  
  
 <span data-ttu-id="95c8f-120">Los eventos de auditoría de autenticación de mensajes incluyen si el mensaje se manipuló, si el mensaje ha expirado y si el cliente se puede autenticar en el servicio.</span><span class="sxs-lookup"><span data-stu-id="95c8f-120">Message authentication audit events cover whether the message was tampered with, whether the message has expired, and whether the client can authenticate to the service.</span></span> <span data-ttu-id="95c8f-121">Proporcionan información sobre si la autenticación fue correcta o no, así como la identidad del cliente, y el extremo al que se envió el mensaje, junto con la acción asociada al mensaje.</span><span class="sxs-lookup"><span data-stu-id="95c8f-121">They provide information about whether the authentication succeeded or failed along with the identity of the client, and the endpoint the message was sent to along with the action associated with the message.</span></span>  
  
 <span data-ttu-id="95c8f-122">Los eventos de auditoría de autorización de servicio incluyen la decisión de la autorización realizada por un administrador de autorización del servicio.</span><span class="sxs-lookup"><span data-stu-id="95c8f-122">Service authorization audit events cover the authorization decision made by a service authorization manager.</span></span> <span data-ttu-id="95c8f-123">Proporcionan información sobre si la autorización tuvo éxito o no, así como la identidad del cliente, el extremo al que se envió el mensaje, la acción asociada al mensaje, el identificador del contexto de autorización que generó el mensaje entrante y el tipo del administrador de autorización que tomó la decisión sobre el acceso.</span><span class="sxs-lookup"><span data-stu-id="95c8f-123">They provide information about whether authorization succeeded or failed along with the identity of the client, the endpoint the message was sent to, the action associated with the message, the identifier of the authorization context that was generated from the incoming message, and the type of the authorization manager that made the access decision.</span></span>  
  
### <a name="to-set-up-build-and-run-the-sample"></a><span data-ttu-id="95c8f-124">Configurar, compilar y ejecutar el ejemplo</span><span class="sxs-lookup"><span data-stu-id="95c8f-124">To set up, build, and run the sample</span></span>  
  
1. <span data-ttu-id="95c8f-125">Asegúrese de que ha realizado el [procedimiento de instalación única para los ejemplos de Windows Communication Foundation](one-time-setup-procedure-for-the-wcf-samples.md).</span><span class="sxs-lookup"><span data-stu-id="95c8f-125">Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](one-time-setup-procedure-for-the-wcf-samples.md).</span></span>  
  
2. <span data-ttu-id="95c8f-126">Para compilar el código C# o Visual Basic .NET Edition de la solución, siga las instrucciones de [Building the Windows Communication Foundation Samples](building-the-samples.md).</span><span class="sxs-lookup"><span data-stu-id="95c8f-126">To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](building-the-samples.md).</span></span>  
  
3. <span data-ttu-id="95c8f-127">Para ejecutar el ejemplo en una configuración de equipos única o cruzada, siga las instrucciones de [ejecución de los ejemplos de Windows Communication Foundation](running-the-samples.md).</span><span class="sxs-lookup"><span data-stu-id="95c8f-127">To run the sample in a single- or cross-computer configuration, follow the instructions in [Running the Windows Communication Foundation Samples](running-the-samples.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="95c8f-128">Vea también</span><span class="sxs-lookup"><span data-stu-id="95c8f-128">See also</span></span>

- [<span data-ttu-id="95c8f-129">Auditoría</span><span class="sxs-lookup"><span data-stu-id="95c8f-129">Auditing</span></span>](../feature-details/auditing-security-events.md)
- [<span data-ttu-id="95c8f-130">Procedimiento para auditar eventos de seguridad</span><span class="sxs-lookup"><span data-stu-id="95c8f-130">How to: Audit Security Events</span></span>](../feature-details/how-to-audit-wcf-security-events.md)
