---
description: 'Más información sobre: propagación de ID. de actividad'
title: Propagación de ID de actividad
ms.date: 03/30/2017
ms.assetid: cd1c1ae5-cc8a-4f51-90c9-f7b476bcfe70
ms.openlocfilehash: d407af04304298bcc04a7aa4264eb6fc46563d3a
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/06/2021
ms.locfileid: "99770903"
---
# <a name="activity-id-propagation"></a><span data-ttu-id="ea147-103">Propagación de ID de actividad</span><span class="sxs-lookup"><span data-stu-id="ea147-103">Activity ID Propagation</span></span>

<span data-ttu-id="ea147-104">La propagación se produce cuando el seguimiento de la actividad ServiceModel está habilitada (propagación de ServiceModel) o deshabilitada (propagación de actividad entre usuarios).</span><span class="sxs-lookup"><span data-stu-id="ea147-104">Propagation happens when ServiceModel activity tracing is enabled (ServiceModel propagation) or disabled (User-to-User activity propagation).</span></span>  
  
## <a name="servicemodel-activity-tracing-is-enabled"></a><span data-ttu-id="ea147-105">Seguimiento de actividad ServiceModel está habilitado</span><span class="sxs-lookup"><span data-stu-id="ea147-105">ServiceModel Activity Tracing is Enabled</span></span>  

 <span data-ttu-id="ea147-106">Si ServiceModel ActivityTracing está habilitado, se produce la propagación entre las actividades ProcessAction.</span><span class="sxs-lookup"><span data-stu-id="ea147-106">If ServiceModel ActivityTracing is enabled, propagation happens between ProcessAction activities.</span></span>  
  
### <a name="server"></a><span data-ttu-id="ea147-107">Servidor</span><span class="sxs-lookup"><span data-stu-id="ea147-107">Server</span></span>  

 <span data-ttu-id="ea147-108">Cuando el `propagateActivity` atributo se establece en `true` tanto en el cliente como en el servidor, el identificador de la `ProcessAction` actividad en el servidor es idéntico al identificador del encabezado del mensaje propagado `ActivityId` .</span><span class="sxs-lookup"><span data-stu-id="ea147-108">When the `propagateActivity` attribute is set to `true` on both the client and server, the ID of the `ProcessAction` activity in the server is identical to the ID in the propagated `ActivityId` message header.</span></span>  
  
 <span data-ttu-id="ea147-109">Cuando no hay ningún `ActivityId` encabezado en el mensaje (es decir, `propagateActivity` = `false` en el cliente) o cuando se encuentra `propagateActivity` = `false` en el servidor, el servidor genera un nuevo ID. de actividad.</span><span class="sxs-lookup"><span data-stu-id="ea147-109">When no `ActivityId` header is present in the message (that is, `propagateActivity`=`false` on the client), or when `propagateActivity`=`false` on the server, the server generates a new activity ID.</span></span>  
  
### <a name="client"></a><span data-ttu-id="ea147-110">Cliente</span><span class="sxs-lookup"><span data-stu-id="ea147-110">Client</span></span>  

 <span data-ttu-id="ea147-111">Si el cliente es un subproceso único de forma sincrónica, el cliente no tiene en cuenta los valores de `propagateActivity` del cliente o servidor.</span><span class="sxs-lookup"><span data-stu-id="ea147-111">If the client is synchronously single threaded, the client disregards any settings of `propagateActivity` at the client or server.</span></span> <span data-ttu-id="ea147-112">En su lugar, la respuesta se administra en la actividad de solicitud.</span><span class="sxs-lookup"><span data-stu-id="ea147-112">Instead, the response is handled in the request activity.</span></span> <span data-ttu-id="ea147-113">Si el cliente es un multiproceso asincrónico o sincrónico, `propagateActivity` = `true` en el cliente, y hay un encabezado de ID. de actividad en el mensaje enviado por el servidor, el cliente recupera el ID. de actividad del mensaje y transfiere a la actividad procesar acción que contiene el identificador de actividad propagado.</span><span class="sxs-lookup"><span data-stu-id="ea147-113">If the client is asynchronous or synchronous multithreaded, `propagateActivity`=`true` in the client, and there is an activity ID header in the message sent by the server, the client retrieves the activity ID from the message, and transfers to the Process Action activity that contains the propagated activity ID.</span></span> <span data-ttu-id="ea147-114">De lo contrario, el cliente se transfiere de la actividad de procesamiento de mensajes a una nueva actividad de acción de procesos.</span><span class="sxs-lookup"><span data-stu-id="ea147-114">Otherwise, the client transfers from Process Message activity to a new Process Action activity.</span></span> <span data-ttu-id="ea147-115">Se realiza esta transferencia adicional a una nueva actividad de procesamiento de acción por coherencia.</span><span class="sxs-lookup"><span data-stu-id="ea147-115">This extra transfer to a new Process Action activity is done for consistency.</span></span> <span data-ttu-id="ea147-116">Dentro de esta actividad, el cliente recupera el id. de actividad de la actividad BeginCall del contexto del subproceso local, cuando se asigna el subproceso para procesamiento del mensaje de respuesta.</span><span class="sxs-lookup"><span data-stu-id="ea147-116">Inside this activity, the client retrieves the activity ID of the BeginCall activity from the local thread context, when the thread is allocated for response message processing.</span></span> <span data-ttu-id="ea147-117">Se transfiere, a continuación, a la actividad inicial de procesamiento de acción.</span><span class="sxs-lookup"><span data-stu-id="ea147-117">It then transfers to the initial Process Action activity.</span></span>  
  
 <span data-ttu-id="ea147-118">Si el cliente es dúplex, el cliente actúa como servidor al recibir el mensaje.</span><span class="sxs-lookup"><span data-stu-id="ea147-118">If the client is duplex, the client acts as server on receiving the message.</span></span>  
  
### <a name="propagation-in-fault-messages"></a><span data-ttu-id="ea147-119">Propagación en mensajes de error</span><span class="sxs-lookup"><span data-stu-id="ea147-119">Propagation in Fault Messages</span></span>  

 <span data-ttu-id="ea147-120">No hay ninguna diferencia a la hora de administrar mensajes válidos y mensajes de error.</span><span class="sxs-lookup"><span data-stu-id="ea147-120">There is no difference in handling valid and fault messages.</span></span> <span data-ttu-id="ea147-121">Si `propagateActivity` = `true` es, el ID. de actividad agregado a los encabezados de mensaje de error de SOAP es idéntico a la actividad de ambiente.</span><span class="sxs-lookup"><span data-stu-id="ea147-121">If `propagateActivity`=`true`, the activity ID added to the SOAP fault message headers is identical to the ambient activity.</span></span>  
  
## <a name="servicemodel-activity-tracing-is-disabled"></a><span data-ttu-id="ea147-122">El seguimiento de actividad ServiceModel está deshabilitad</span><span class="sxs-lookup"><span data-stu-id="ea147-122">ServiceModel Activity Tracing is Disabled</span></span>  

 <span data-ttu-id="ea147-123">Si ServiceModel ActivityTracing está deshabilitado, la propagación se produce directamente entre las actividades de código de usuario sin pasar por las actividades ServiceModel.</span><span class="sxs-lookup"><span data-stu-id="ea147-123">If ServiceModel ActivityTracing is disabled, propagation occurs between user code activities directly without going through ServiceModel activities.</span></span> <span data-ttu-id="ea147-124">Un id. de actividad definido por el usuario también se propaga a través del encabezado de id. de actividad de mensaje. </span><span class="sxs-lookup"><span data-stu-id="ea147-124">A user-defined activity ID is also propagated through the message activity ID header.</span></span>  
  
 <span data-ttu-id="ea147-125">Si `propagateActivity` = `true` y `ActivityTracing` = `off` para un agente de escucha de seguimiento de ServiceModel (independientemente de si el seguimiento está habilitado en ServiceModel), ocurre lo siguiente en el cliente o el servidor:</span><span class="sxs-lookup"><span data-stu-id="ea147-125">If `propagateActivity`=`true` and `ActivityTracing`=`off` for a ServiceModel trace listener (regardless of whether tracing is enabled on ServiceModel), the following happen on either the client or server:</span></span>  
  
- <span data-ttu-id="ea147-126">En la solicitud de operación o respuesta de envío, el id. de actividad en TLS se propaga fuera del código de usuario hasta que se forma un mensaje.</span><span class="sxs-lookup"><span data-stu-id="ea147-126">On operation request or sending response, the activity ID in TLS is propagated out of user code until a message is formed.</span></span> <span data-ttu-id="ea147-127">También se inserta en el mensaje un encabezado de id. de actividad antes de enviarse.</span><span class="sxs-lookup"><span data-stu-id="ea147-127">An activity ID header is also inserted into the message before it is sent.</span></span>  
  
- <span data-ttu-id="ea147-128">Al recibir la solicitud o recibir la respuesta, el id. de actividad se recupera del encabezado del mensaje en cuanto se cree el objeto de mensaje recibido.</span><span class="sxs-lookup"><span data-stu-id="ea147-128">On receiving request or receiving response, the activity ID is retrieved from the message header as soon as the received message object is created.</span></span> <span data-ttu-id="ea147-129">Se propaga el id. de actividad en TLS en cuanto el mensaje desaparece del ámbito hasta que se alcance el código de usuario.</span><span class="sxs-lookup"><span data-stu-id="ea147-129">The activity ID in TLS is propagated as soon as the message disappears from scope until user code is reached.</span></span>  
  
 <span data-ttu-id="ea147-130">Estas acciones garantizan que los seguimientos del usuario aparecerán en la misma actividad si la propagación está activada.</span><span class="sxs-lookup"><span data-stu-id="ea147-130">These actions guarantee that user traces will appear in the same activity if propagation is on.</span></span> <span data-ttu-id="ea147-131">Sin embargo, no hay garantía en seguimientos de ServiceModel.</span><span class="sxs-lookup"><span data-stu-id="ea147-131">However, it makes no guarantee on ServiceModel traces.</span></span> <span data-ttu-id="ea147-132">Los seguimientos de ServiceModel se producen en una actividad de código de usuario si se ejecuta el procesamiento de esos seguimientos en el mismo subproceso donde se estableció la actividad de código de usuario.</span><span class="sxs-lookup"><span data-stu-id="ea147-132">ServiceModel traces occur in a user code activity only if the processing of those traces is executed on the same thread where the user code activity was set.</span></span>  
  
 <span data-ttu-id="ea147-133">En general, los seguimientos de ServiceModel se puede observar en los lugares siguientes:</span><span class="sxs-lookup"><span data-stu-id="ea147-133">In general, ServiceModel traces can be observed in the following places:</span></span>  
  
- <span data-ttu-id="ea147-134">Si el seguimiento de ServiceModel está deshabilitado, todos los seguimientos emitidos aparecen en actividades de usuario.</span><span class="sxs-lookup"><span data-stu-id="ea147-134">If ServiceModel tracing is disabled, all emitted traces appear in user activities.</span></span> <span data-ttu-id="ea147-135">Si la propagación está habilitada en el servidor y cliente, estos seguimientos estarán en la misma actividad.</span><span class="sxs-lookup"><span data-stu-id="ea147-135">If propagation is enabled at both the server and client, these traces will be in the same activity.</span></span>  
  
- <span data-ttu-id="ea147-136">Si el seguimiento de ServiceModel está habilitado, pero ActivityTracing está deshabilitado, los seguimientos del usuario aparecen en la misma actividad si la propagación está habilitada en ambos.</span><span class="sxs-lookup"><span data-stu-id="ea147-136">If ServiceModel tracing is enabled, but ActivityTracing is disabled, user traces appear in the same activity if propagation is enabled on both ends.</span></span> <span data-ttu-id="ea147-137">Los seguimientos de ServiceModel aparecen en la actividad predeterminada 0000, a menos que se produzcan en el mismo subproceso que el procesamiento de código de usuario donde se establece la actividad inicialmente.</span><span class="sxs-lookup"><span data-stu-id="ea147-137">ServiceModel traces appear in the default 0000 activity, unless they occur in the same thread as the user code processing where the activity is initially set.</span></span>  
  
- <span data-ttu-id="ea147-138">Si están habilitados ambos seguimientos de ServiceModel y ActivityTracing, los seguimientos del usuario aparecen en actividades definidas por el usuario y los seguimientos de ServiceModel aparecen en actividades definidas por ServiceModel.</span><span class="sxs-lookup"><span data-stu-id="ea147-138">If both ServiceModel tracing and ActivityTracing are enabled, user traces appear in user-defined activities, and ServiceModel traces appear in ServiceModel-defined activities.</span></span> <span data-ttu-id="ea147-139">La propagación se produce en el nivel de ServiceModel.</span><span class="sxs-lookup"><span data-stu-id="ea147-139">Propagation happens at ServiceModel level.</span></span>
