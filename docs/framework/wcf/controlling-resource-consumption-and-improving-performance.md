---
title: Control del consumo de recursos y mejora del rendimiento
ms.date: 03/30/2017
ms.assetid: 9a829669-5f76-4c88-80ec-92d0c62c0660
ms.openlocfilehash: 16d6f29235455ff30e115b7aff3425412bc7ba6a
ms.sourcegitcommit: 32a575bf4adccc901f00e264f92b759ced633379
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/04/2019
ms.locfileid: "74802260"
---
# <a name="controlling-resource-consumption-and-improving-performance"></a><span data-ttu-id="2a79d-102">Control del consumo de recursos y mejora del rendimiento</span><span class="sxs-lookup"><span data-stu-id="2a79d-102">Controlling Resource Consumption and Improving Performance</span></span>
<span data-ttu-id="2a79d-103">En este tema se describen las distintas propiedades de las distintas áreas de la arquitectura Windows Communication Foundation (WCF) que funcionan para controlar el consumo de recursos y afectar a las métricas de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="2a79d-103">This topic describes various properties in different areas of the Windows Communication Foundation (WCF) architecture that work to control resource consumption and affect performance metrics.</span></span>

## <a name="properties-that-constrain-resource-consumption-in-wcf"></a><span data-ttu-id="2a79d-104">Propiedades que restringen el consumo de recursos en WCF</span><span class="sxs-lookup"><span data-stu-id="2a79d-104">Properties that Constrain Resource Consumption in WCF</span></span>
 <span data-ttu-id="2a79d-105">Windows Communication Foundation (WCF) aplica restricciones en determinados tipos de procesos, ya sea con fines de seguridad o de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="2a79d-105">Windows Communication Foundation (WCF) applies constraints on certain types of processes for either security or performance purposes.</span></span> <span data-ttu-id="2a79d-106">Estas restricciones adquieren dos formas básicas: cuotas y aceleradores.</span><span class="sxs-lookup"><span data-stu-id="2a79d-106">These constraints come in two main forms, either quotas and throttles.</span></span> <span data-ttu-id="2a79d-107">Las *cuotas* son límites cuando se alcanza o se supera el desencadenamiento de una excepción inmediata en algún punto del sistema.</span><span class="sxs-lookup"><span data-stu-id="2a79d-107">*Quotas* are limits that when reached or exceeded trigger an immediate exception at some point in the system.</span></span> <span data-ttu-id="2a79d-108">Las *limitaciones* son límites que no provocan inmediatamente que se produzca una excepción.</span><span class="sxs-lookup"><span data-stu-id="2a79d-108">*Throttles* are limits that do not immediately cause an exception to be thrown.</span></span> <span data-ttu-id="2a79d-109">En su lugar, cuando se alcanza el límite del acelerador, el procesamiento continúa pero dentro de los límites establecidos por ese valor.</span><span class="sxs-lookup"><span data-stu-id="2a79d-109">Instead, when a throttle limit is reached, processing continues but within the limits set by that throttle value.</span></span> <span data-ttu-id="2a79d-110">Este procesamiento limitado puede activar una excepción en otra parte, pero esto depende de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="2a79d-110">This limited processing might trigger an exception elsewhere, but this depends upon the application.</span></span>

 <span data-ttu-id="2a79d-111">Además de la distinción entre cuotas y aceleradores, algunas propiedades de restricción se encuentran en el nivel de serialización, algunas en el nivel de transporte y algunas en el nivel de aplicación.</span><span class="sxs-lookup"><span data-stu-id="2a79d-111">In addition to the distinction between quotas and throttles, some constraining properties are located at the serialization level, some at the transport level, and some at the application level.</span></span> <span data-ttu-id="2a79d-112">Por ejemplo, la cuota <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>, que implementan todos los elementos de enlace de transporte proporcionados por el sistema, está establecida de forma predeterminada en 65.536 bytes para impedir que los clientes malintencionados emprendan ataques de denegación de servicio contra un servicio provocando el consumo excesivo de memoria.</span><span class="sxs-lookup"><span data-stu-id="2a79d-112">For example, the quota <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>, which is implemented by all system-supplied transport binding elements, is set to 65,536 bytes by default to hinder malicious clients from engaging in denial-of-service attacks against a service by causing excessive memory consumption.</span></span> <span data-ttu-id="2a79d-113">(Normalmente, puede aumentar el rendimiento bajando este valor.)</span><span class="sxs-lookup"><span data-stu-id="2a79d-113">(Typically, you can increase performance by lowering this value.)</span></span>

 <span data-ttu-id="2a79d-114">Un ejemplo de una cuota de la serialización es la propiedad <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType>, que especifica el número máximo de objetos que el serializador serializa o deserializa en una única llamada al método <xref:System.Runtime.Serialization.DataContractSerializer.ReadObject%2A>.</span><span class="sxs-lookup"><span data-stu-id="2a79d-114">An example of a serialization quota is the <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property, which specifies the maximum number of objects that the serializer serializes or deserializes in a single <xref:System.Runtime.Serialization.DataContractSerializer.ReadObject%2A> method call.</span></span> <span data-ttu-id="2a79d-115">Un ejemplo de un acelerador en el nivel de aplicación es la propiedad <xref:System.ServiceModel.Dispatcher.ServiceThrottle.MaxConcurrentSessions%2A?displayProperty=nameWithType>, que de forma predeterminada restringe el número de conexiones de canal con sesión simultáneas a 10.</span><span class="sxs-lookup"><span data-stu-id="2a79d-115">An example of an application-level throttle is the <xref:System.ServiceModel.Dispatcher.ServiceThrottle.MaxConcurrentSessions%2A?displayProperty=nameWithType> property, which by default restricts the number of concurrent sessionful channel connections to 10.</span></span> <span data-ttu-id="2a79d-116">(A diferencia de las cuotas, si se alcanza este valor de acelerador, la aplicación continúa con el procesamiento pero no acepta nuevos canales con sesión, lo que significa que los nuevos clientes no se pueden conectar hasta que uno de los otros canales con sesión haya finalizado.)</span><span class="sxs-lookup"><span data-stu-id="2a79d-116">(Unlike the quotas, if this throttle value is reached, the application continues processing but accepts no new sessionful channels, which means that new clients cannot connect until one of the other sessionful channels is ended.)</span></span>

 <span data-ttu-id="2a79d-117">Estos controles están diseñados para proporcionar una mitigación rápida contra ciertos tipos de ataques o para mejorar métrica de rendimiento tal como el consumo de memoria, el tiempo de inicio, etc.</span><span class="sxs-lookup"><span data-stu-id="2a79d-117">These controls are designed to provide an out-of-the-box mitigation against certain types of attacks or to improve performance metrics such as memory footprint, start-up time, and so on.</span></span> <span data-ttu-id="2a79d-118">Sin embargo, dependiendo de la aplicación, estos controles pueden impedir el rendimiento de la aplicación del servicio o evitar que la aplicación funcione.</span><span class="sxs-lookup"><span data-stu-id="2a79d-118">However, depending on the application, these controls can impede service application performance or prevent the application from working at all.</span></span> <span data-ttu-id="2a79d-119">Por ejemplo, una aplicación diseñada para transmitir secuencias de vídeo puede superar con facilidad la propiedad <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType> predeterminada.</span><span class="sxs-lookup"><span data-stu-id="2a79d-119">For example, an application designed to stream video can easily exceed the default <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="2a79d-120">En este tema se proporciona información general sobre los distintos controles que se aplican a las aplicaciones en todos los niveles de WCF, se describen varias maneras de obtener más información sobre si un valor de configuración está obstaculizando la aplicación y se describen las formas de corregir diversos problemas.</span><span class="sxs-lookup"><span data-stu-id="2a79d-120">This topic provides an overview of the various controls applied to applications at all levels of WCF, describes various ways to obtain more information about whether a setting is hindering your application, and describes ways to correct various problems.</span></span> <span data-ttu-id="2a79d-121">La mayoría de los aceleradores y algunas cuotas están disponibles en el nivel de aplicación, incluso cuando la propiedad base es una serialización o una restricción de transporte.</span><span class="sxs-lookup"><span data-stu-id="2a79d-121">Most throttles and some quotas are available at the application level, even when the base property is a serialization or transport constraint.</span></span> <span data-ttu-id="2a79d-122">Por ejemplo, puede establecer la propiedad <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> utilizando la propiedad <xref:System.ServiceModel.ServiceBehaviorAttribute.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> en la clase de servicio.</span><span class="sxs-lookup"><span data-stu-id="2a79d-122">For example, you can set the <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property using the <xref:System.ServiceModel.ServiceBehaviorAttribute.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property on the service class.</span></span>

> [!NOTE]
> <span data-ttu-id="2a79d-123">Si tiene un problema determinado, primero debe leer la guía de [Inicio rápido de solución de problemas de WCF](wcf-troubleshooting-quickstart.md) para ver si el problema (y una solución) aparece en la lista.</span><span class="sxs-lookup"><span data-stu-id="2a79d-123">If you have a particular problem, you should first read the [WCF Troubleshooting Quickstart](wcf-troubleshooting-quickstart.md) to see whether your problem (and a solution) is listed there.</span></span>

 <span data-ttu-id="2a79d-124">Las propiedades que restringen los procesos de serialización se enumeran en [consideraciones de seguridad para los datos](./feature-details/security-considerations-for-data.md).</span><span class="sxs-lookup"><span data-stu-id="2a79d-124">Properties that restrict serialization processes are listed in [Security Considerations for Data](./feature-details/security-considerations-for-data.md).</span></span> <span data-ttu-id="2a79d-125">Las propiedades que restringen el consumo de recursos relacionados con los transportes se enumeran en [cuotas de transporte](./feature-details/transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="2a79d-125">Properties that restrict the consumption of resources related to transports are listed in [Transport Quotas](./feature-details/transport-quotas.md).</span></span> <span data-ttu-id="2a79d-126">Las propiedades que restringen el consumo de recursos en el nivel de aplicación son los miembros de la clase <xref:System.ServiceModel.Dispatcher.ServiceThrottle>.</span><span class="sxs-lookup"><span data-stu-id="2a79d-126">Properties that restrict the consumption of resources at the application layer are the members of the <xref:System.ServiceModel.Dispatcher.ServiceThrottle> class.</span></span>

## <a name="detecting-application-and-performance-issues-related-to-quota-settings"></a><span data-ttu-id="2a79d-127">Detectar la aplicación y los problemas de rendimiento relacionados con los valores de cuota</span><span class="sxs-lookup"><span data-stu-id="2a79d-127">Detecting Application and Performance Issues Related to Quota Settings</span></span>
 <span data-ttu-id="2a79d-128">Los valores predeterminados de los valores anteriores se han elegido para habilitar la funcionalidad de la aplicación básica en una amplia gama de tipos de aplicación proporcionando al mismo tiempo protección básica contra los problemas de seguridad comunes.</span><span class="sxs-lookup"><span data-stu-id="2a79d-128">The defaults of the preceding values have been chosen to enable basic application functionality across a wide range of application types while providing basic protection against common security issues.</span></span> <span data-ttu-id="2a79d-129">Sin embargo, los diseños de las diferentes aplicaciones pueden superar uno o más valores de acelerador aunque por otro lado la aplicación sea segura y funcione como se ha diseñado.</span><span class="sxs-lookup"><span data-stu-id="2a79d-129">However, different application designs might exceed one or more throttle settings although the application otherwise is secure and would work as designed.</span></span> <span data-ttu-id="2a79d-130">En estos casos, debe identificar qué valores de acelerador se superan y en qué nivel, y decidir la acción adecuada para aumentar el rendimiento de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="2a79d-130">In these cases, you must identify which throttle values are being exceeded and at what level, and decide on the appropriate course of action to increase application throughput.</span></span>

 <span data-ttu-id="2a79d-131">Normalmente, al escribir la aplicación y depurarla, establece la propiedad <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> en `true` en el archivo de configuración o mediante programación.</span><span class="sxs-lookup"><span data-stu-id="2a79d-131">Typically, when writing the application and debugging it, you set the <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property to `true` in the configuration file or programmatically.</span></span> <span data-ttu-id="2a79d-132">Esto indica a WCF que devuelva los seguimientos de la pila de excepciones de servicio a la aplicación cliente para su visualización.</span><span class="sxs-lookup"><span data-stu-id="2a79d-132">This instructs WCF to return service exception stack traces to the client application for viewing.</span></span> <span data-ttu-id="2a79d-133">Esta característica crea informes de la mayoría de las excepciones en el nivel de aplicación de manera que se muestran qué valores de cuota podrían estar implicados, si ése es el problema.</span><span class="sxs-lookup"><span data-stu-id="2a79d-133">This feature reports most application-level exceptions in such a way as to display which quota settings might be involved, if that is the problem.</span></span>

 <span data-ttu-id="2a79d-134">En tiempo de ejecución se producen algunas excepciones bajo el nivel de aplicación visible y no se devuelven por medio de este mecanismo ni pueden controlarse mediante una implementación <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType> personalizada.</span><span class="sxs-lookup"><span data-stu-id="2a79d-134">Some exceptions happen at run time below the visibility of the application layer and are not returned using this mechanism, and they might not be handled by a custom <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType> implementation.</span></span> <span data-ttu-id="2a79d-135">Si está en un entorno de desarrollo como Microsoft Visual Studio, la mayoría de estas excepciones se muestran automáticamente.</span><span class="sxs-lookup"><span data-stu-id="2a79d-135">If you are in a development environment like Microsoft Visual Studio, most of these exceptions are displayed automatically.</span></span> <span data-ttu-id="2a79d-136">Sin embargo, algunas excepciones se pueden enmascarar según la configuración del entorno de desarrollo, como [solo mi código](/visualstudio/debugger/just-my-code) Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="2a79d-136">However, some exceptions can be masked by development environment settings such as [Just My Code](/visualstudio/debugger/just-my-code) Visual Studio.</span></span>

 <span data-ttu-id="2a79d-137">Independientemente de las capacidades del entorno de desarrollo, puede usar las capacidades del seguimiento de WCF y del registro de mensajes para depurar todas las excepciones y optimizar el rendimiento de las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="2a79d-137">Regardless of the capabilities of your development environment, you can use capabilities of WCF tracing and message logging to debug all exceptions and tune the performance of your applications.</span></span> <span data-ttu-id="2a79d-138">Para obtener más información, consulte [uso del seguimiento para solucionar problemas de la aplicación](./diagnostics/tracing/using-tracing-to-troubleshoot-your-application.md).</span><span class="sxs-lookup"><span data-stu-id="2a79d-138">For more information, see [Using Tracing to Troubleshoot Your Application](./diagnostics/tracing/using-tracing-to-troubleshoot-your-application.md).</span></span>

## <a name="performance-issues-and-xmlserializer"></a><span data-ttu-id="2a79d-139">Problemas de rendimiento y XmlSerializer</span><span class="sxs-lookup"><span data-stu-id="2a79d-139">Performance Issues and XmlSerializer</span></span>
 <span data-ttu-id="2a79d-140">Los servicios y las aplicaciones cliente que usan tipos de datos que son serializables mediante <xref:System.Xml.Serialization.XmlSerializer> generan y compilan el código de serialización de los tipos de datos en tiempo de ejecución, lo que se puede traducir en un rendimiento de inicio lento.</span><span class="sxs-lookup"><span data-stu-id="2a79d-140">Services and client applications that use data types that are serializable using the <xref:System.Xml.Serialization.XmlSerializer> generate and compile serialization code for those data types at run time, which can result in slow start-up performance.</span></span>

> [!NOTE]
> <span data-ttu-id="2a79d-141">El código de serialización generado previamente solo puede usarse en aplicaciones cliente, no en servicios.</span><span class="sxs-lookup"><span data-stu-id="2a79d-141">Pre-generated serialization code can be used only in client applications and not in services.</span></span>

 <span data-ttu-id="2a79d-142">La [herramienta de utilidad de metadatos de ServiceModel (SvcUtil. exe)](servicemodel-metadata-utility-tool-svcutil-exe.md) puede mejorar el rendimiento de inicio de estas aplicaciones mediante la generación del código de serialización necesario a partir de los ensamblados compilados para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="2a79d-142">The [ServiceModel Metadata Utility Tool (Svcutil.exe)](servicemodel-metadata-utility-tool-svcutil-exe.md) can improve start-up performance for these applications by generating the necessary serialization code from the compiled assemblies for the application.</span></span> <span data-ttu-id="2a79d-143">Para obtener más información, vea [Cómo: mejorar el tiempo de inicio de las aplicaciones cliente WCF mediante XmlSerializer](./feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).</span><span class="sxs-lookup"><span data-stu-id="2a79d-143">For more information, see [How to: Improve the Startup Time of WCF Client Applications using the XmlSerializer](./feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).</span></span>

## <a name="performance-issues-when-hosting-wcf-services-under-aspnet"></a><span data-ttu-id="2a79d-144">Problemas de rendimiento al hospedar los servicios WCF bajo ASP.NET</span><span class="sxs-lookup"><span data-stu-id="2a79d-144">Performance Issues When Hosting WCF Services Under ASP.NET</span></span>

<span data-ttu-id="2a79d-145">Cuando un servicio WCF se hospeda bajo IIS y ASP.NET, la configuración de IIS y ASP.NET puede afectar al rendimiento y al consumo de memoria del servicio WCF.</span><span class="sxs-lookup"><span data-stu-id="2a79d-145">When a WCF service is hosted under IIS and ASP.NET, the configuration settings of IIS and ASP.NET can affect the throughput and memory footprint of the WCF service.</span></span>  <span data-ttu-id="2a79d-146">Para obtener más información sobre el rendimiento de ASP.NET, vea [mejorar el rendimiento de ASP.net](https://docs.microsoft.com/previous-versions/msp-n-p/ff647787(v=pandp.10)).</span><span class="sxs-lookup"><span data-stu-id="2a79d-146">For more information about ASP.NET performance, see [Improving ASP.NET Performance](https://docs.microsoft.com/previous-versions/msp-n-p/ff647787(v=pandp.10)).</span></span> <span data-ttu-id="2a79d-147">Una configuración que quizá pueda tener consecuencias imprevistas es la propiedad <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A>, que es una propiedad de la clase <xref:System.Web.Configuration.ProcessModelSection>.</span><span class="sxs-lookup"><span data-stu-id="2a79d-147">One setting that might have unintended consequences is <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A>, which is a property of the <xref:System.Web.Configuration.ProcessModelSection>.</span></span> <span data-ttu-id="2a79d-148">Si la aplicación tiene un número fijo o pequeño de clientes, al establecer <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A> en 2 se podría observar un aumento del rendimiento en un equipo con varios procesadores que tenga un uso de CPU próximo al 100%.</span><span class="sxs-lookup"><span data-stu-id="2a79d-148">If your application has a fixed or small number of clients, setting <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A> to 2 might provide a throughput boost on a multiprocessor machine that has a CPU utilization close to 100%.</span></span> <span data-ttu-id="2a79d-149">Esta mejora del rendimiento tiene su precio: aumentará también el consumo de memoria, lo que podría disminuir la escalabilidad.</span><span class="sxs-lookup"><span data-stu-id="2a79d-149">This increase in performance comes with a cost: it will also cause an increase in memory usage, which could reduce scalability.</span></span>

## <a name="see-also"></a><span data-ttu-id="2a79d-150">Vea también</span><span class="sxs-lookup"><span data-stu-id="2a79d-150">See also</span></span>

- [<span data-ttu-id="2a79d-151">Administración y diagnóstico</span><span class="sxs-lookup"><span data-stu-id="2a79d-151">Administration and Diagnostics</span></span>](./diagnostics/index.md)
- [<span data-ttu-id="2a79d-152">Grandes datos y streaming</span><span class="sxs-lookup"><span data-stu-id="2a79d-152">Large Data and Streaming</span></span>](./feature-details/large-data-and-streaming.md)
