---
description: Más información acerca de cómo elegir un patrón de intercambio de mensajes
title: Elección de un patrón de intercambio de mensajes
ms.date: 03/30/2017
ms.assetid: 0f502ca1-6a8e-4607-ba15-59198c0e6146
ms.openlocfilehash: c452a65e4d4108123deaab93be9bd825127eba70
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/06/2021
ms.locfileid: "99685860"
---
# <a name="choosing-a-message-exchange-pattern"></a><span data-ttu-id="fe905-103">Elección de un patrón de intercambio de mensajes</span><span class="sxs-lookup"><span data-stu-id="fe905-103">Choosing a Message Exchange Pattern</span></span>

<span data-ttu-id="fe905-104">El primer paso para escribir un transporte personalizado es decidir qué *patrones de intercambio de mensajes* (o MEP) son necesarios para el canal que está desarrollando.</span><span class="sxs-lookup"><span data-stu-id="fe905-104">The first step in writing a custom transport is to decide which *message exchange patterns* (or MEPs) are required for the channel you are developing.</span></span> <span data-ttu-id="fe905-105">Este tema describe las opciones disponibles y trata sobre los distintos requisitos.</span><span class="sxs-lookup"><span data-stu-id="fe905-105">This topic describes the options available and discusses the various requirements.</span></span> <span data-ttu-id="fe905-106">Esta es la primera tarea en la lista de tareas de desarrollo de canales que se describe en [desarrollar canales](developing-channels.md).</span><span class="sxs-lookup"><span data-stu-id="fe905-106">This is the first task in the channel development task list described in [Developing Channels](developing-channels.md).</span></span>  
  
## <a name="six-message-exchange-patterns"></a><span data-ttu-id="fe905-107">Seis patrones de intercambio de mensajes</span><span class="sxs-lookup"><span data-stu-id="fe905-107">Six Message Exchange Patterns</span></span>  

 <span data-ttu-id="fe905-108">Hay tres MEP entre los que elegir:</span><span class="sxs-lookup"><span data-stu-id="fe905-108">There are three MEPs to choose from:</span></span>  
  
- <span data-ttu-id="fe905-109">Datagrama (<xref:System.ServiceModel.Channels.IInputChannel> y <xref:System.ServiceModel.Channels.IOutputChannel>)</span><span class="sxs-lookup"><span data-stu-id="fe905-109">Datagram (<xref:System.ServiceModel.Channels.IInputChannel> and <xref:System.ServiceModel.Channels.IOutputChannel>)</span></span>  
  
     <span data-ttu-id="fe905-110">Cuando se usa un MEP de datagrama, un cliente envía un mensaje mediante un *desencadenador y olvidó* Exchange.</span><span class="sxs-lookup"><span data-stu-id="fe905-110">When using a datagram MEP, a client sends a message using a *fire and forget* exchange.</span></span> <span data-ttu-id="fe905-111">Un intercambio de este tipo es uno que exige una confirmación fuera de banda de entrega correcta.</span><span class="sxs-lookup"><span data-stu-id="fe905-111">A fire and forget exchange is one that requires out-of-band confirmation of successful delivery.</span></span> <span data-ttu-id="fe905-112">El mensaje se podría perderse por el camino y no llegar nunca al servicio.</span><span class="sxs-lookup"><span data-stu-id="fe905-112">The message might be lost in transit and never reach the service.</span></span> <span data-ttu-id="fe905-113">Si la operación de envío se completa correctamente en la parte del cliente, no garantiza que el extremo remoto haya recibido el mensaje.</span><span class="sxs-lookup"><span data-stu-id="fe905-113">If the send operation completes successfully at the client end, it does not guarantee that the remote endpoint has received the message.</span></span> <span data-ttu-id="fe905-114">El datagrama es un bloque de creación fundamental para la mensajería, ya que puede crear sus propios protocolos encima de él, incluidos protocolos confiables y seguros.</span><span class="sxs-lookup"><span data-stu-id="fe905-114">The datagram is a fundamental building block for messaging, as you can build your own protocols on top of it—including reliable protocols and secure protocols.</span></span> <span data-ttu-id="fe905-115">Los canales de datagrama del cliente implementan la interfaz <xref:System.ServiceModel.Channels.IOutputChannel> y los del servicio, la interfaz <xref:System.ServiceModel.Channels.IInputChannel>.</span><span class="sxs-lookup"><span data-stu-id="fe905-115">Client datagram channels implement the <xref:System.ServiceModel.Channels.IOutputChannel> interface and service datagram channels implement the <xref:System.ServiceModel.Channels.IInputChannel> interface.</span></span>  
  
- <span data-ttu-id="fe905-116">Solicitud-respuesta (<xref:System.ServiceModel.Channels.IRequestChannel> y <xref:System.ServiceModel.Channels.IReplyChannel>)</span><span class="sxs-lookup"><span data-stu-id="fe905-116">Request-Response (<xref:System.ServiceModel.Channels.IRequestChannel> and <xref:System.ServiceModel.Channels.IReplyChannel>)</span></span>  
  
     <span data-ttu-id="fe905-117">En este MEP, un mensaje se envía y se recibe una respuesta.</span><span class="sxs-lookup"><span data-stu-id="fe905-117">In this MEP, a message is sent, and a reply is received.</span></span> <span data-ttu-id="fe905-118">El patrón está compuesto de los pares solicitud-respuesta.</span><span class="sxs-lookup"><span data-stu-id="fe905-118">The pattern consists of request-response pairs.</span></span> <span data-ttu-id="fe905-119">Los ejemplos de llamadas de solicitud-respuesta son llamadas a procedimientos remotos (RPC) y solicitudes GET del explorador.</span><span class="sxs-lookup"><span data-stu-id="fe905-119">Examples of request-response calls are remote procedure calls (RPC) and browser GET requests.</span></span> <span data-ttu-id="fe905-120">Este patrón también se conoce como dúplex medio.</span><span class="sxs-lookup"><span data-stu-id="fe905-120">This pattern is also known as half-duplex.</span></span> <span data-ttu-id="fe905-121">En este MEP, los canales de cliente implementan <xref:System.ServiceModel.Channels.IRequestChannel> y los canales de servicio <xref:System.ServiceModel.Channels.IReplyChannel>.</span><span class="sxs-lookup"><span data-stu-id="fe905-121">In this MEP, client channels implement <xref:System.ServiceModel.Channels.IRequestChannel> and service channels implement <xref:System.ServiceModel.Channels.IReplyChannel>.</span></span>  
  
- <span data-ttu-id="fe905-122">Dúplex (<xref:System.ServiceModel.Channels.IDuplexChannel>)</span><span class="sxs-lookup"><span data-stu-id="fe905-122">Duplex (<xref:System.ServiceModel.Channels.IDuplexChannel>)</span></span>  
  
     <span data-ttu-id="fe905-123">El MEP dúplex permite que un cliente envíe un número arbitrario de mensajes y que se reciban en cualquier orden.</span><span class="sxs-lookup"><span data-stu-id="fe905-123">The duplex MEP allows an arbitrary number of messages to be sent by a client and received in any order.</span></span> <span data-ttu-id="fe905-124">El MEP de dúplex es como una conversación telefónica, donde cada palabra que se pronuncia es un mensaje.</span><span class="sxs-lookup"><span data-stu-id="fe905-124">The duplex MEP is like a phone conversation, where each word being spoken is a message.</span></span> <span data-ttu-id="fe905-125">Dado que ambos lados pueden enviar y recibir en este MEP, la interfaz implementada por los canales de servicio y cliente es <xref:System.ServiceModel.Channels.IDuplexChannel>.</span><span class="sxs-lookup"><span data-stu-id="fe905-125">Because both sides can send and receive in this MEP, the interface implemented by the client and service channels is <xref:System.ServiceModel.Channels.IDuplexChannel>.</span></span>  
  
 <span data-ttu-id="fe905-126">![Elección de un patrón de intercambio de mensajes](./media/wcfc-basicthreemepsc.gif "wcfc_BasicThreeMEPsc")</span><span class="sxs-lookup"><span data-stu-id="fe905-126">![Choosing a message exchange pattern](./media/wcfc-basicthreemepsc.gif "wcfc_BasicThreeMEPsc")</span></span>  
<span data-ttu-id="fe905-127">Los tres patrones de intercambio de mensajes básicos.</span><span class="sxs-lookup"><span data-stu-id="fe905-127">The three basic message exchange patterns.</span></span> <span data-ttu-id="fe905-128">De arriba abajo: datagrama, solicitud-respuesta y dúplex.</span><span class="sxs-lookup"><span data-stu-id="fe905-128">Top to bottom: datagram, request-response, and duplex.</span></span>  
  
 <span data-ttu-id="fe905-129">Cada uno de estos MEP también puede admitir *sesiones*.</span><span class="sxs-lookup"><span data-stu-id="fe905-129">Each of these MEPs can also support *sessions*.</span></span> <span data-ttu-id="fe905-130">Una sesión (e implementación de <xref:System.ServiceModel.Channels.ISessionChannel%601?displayProperty=nameWithType> de tipo <xref:System.ServiceModel.Channels.ISession?displayProperty=nameWithType>) pone en correlación todos los mensajes enviados y recibidos en un canal.</span><span class="sxs-lookup"><span data-stu-id="fe905-130">A session (and implementation of <xref:System.ServiceModel.Channels.ISessionChannel%601?displayProperty=nameWithType> of type <xref:System.ServiceModel.Channels.ISession?displayProperty=nameWithType>) correlates all messages sent and received on a channel.</span></span> <span data-ttu-id="fe905-131">El patrón de solicitud-respuesta es una sesión autónoma de dos mensajes, ya que la solicitud y la respuesta se ponen en correlación.</span><span class="sxs-lookup"><span data-stu-id="fe905-131">The request-response pattern is a stand-alone two-message session, as the request and reply are correlated.</span></span> <span data-ttu-id="fe905-132">Por el contrario, el patrón de solicitud-respuesta que admite las sesiones implica que se ponen en correlación todos los pares de solicitud/respuesta en ese canal entre sí.</span><span class="sxs-lookup"><span data-stu-id="fe905-132">In contrast, the request-response pattern that supports sessions implies that all request/response pairs on that channel are correlated with each other.</span></span> <span data-ttu-id="fe905-133">Esto le da un total de seis MEP entre los que elegir:</span><span class="sxs-lookup"><span data-stu-id="fe905-133">This gives you a total of six MEPs to choose from:</span></span>  
  
- <span data-ttu-id="fe905-134">Datagrama</span><span class="sxs-lookup"><span data-stu-id="fe905-134">Datagram</span></span>  
  
- <span data-ttu-id="fe905-135">Solicitud-respuesta</span><span class="sxs-lookup"><span data-stu-id="fe905-135">Request-response</span></span>  
  
- <span data-ttu-id="fe905-136">Dúplex</span><span class="sxs-lookup"><span data-stu-id="fe905-136">Duplex</span></span>  
  
- <span data-ttu-id="fe905-137">Datagrama con sesiones</span><span class="sxs-lookup"><span data-stu-id="fe905-137">Datagram with sessions</span></span>  
  
- <span data-ttu-id="fe905-138">Solicitud-respuesta con sesiones</span><span class="sxs-lookup"><span data-stu-id="fe905-138">Request-response with sessions</span></span>  
  
- <span data-ttu-id="fe905-139">Dúplex con sesiones</span><span class="sxs-lookup"><span data-stu-id="fe905-139">Duplex with sessions</span></span>  
  
> [!NOTE]
> <span data-ttu-id="fe905-140">En el caso del transporte de UDP, el único MEP que se admite es el datagrama, ya que UDP es en sí mismo un protocolo de tipo desencadenar y omitir.</span><span class="sxs-lookup"><span data-stu-id="fe905-140">For the UDP transport, the only MEP that is supported is datagram, because UDP is inherently a fire and forget protocol.</span></span>  
  
## <a name="sessions-and-sessionful-channels"></a><span data-ttu-id="fe905-141">Sesiones y canales con sesiones</span><span class="sxs-lookup"><span data-stu-id="fe905-141">Sessions and Sessionful Channels</span></span>  

 <span data-ttu-id="fe905-142">En el mundo de red, hay protocolos orientado a la conexión (por ejemplo, TCP) y protocolos sin conexión (por ejemplo, UDP).</span><span class="sxs-lookup"><span data-stu-id="fe905-142">In the networking world, there are connection-oriented protocols (for example, TCP) and connection-less protocols (for example, UDP).</span></span> <span data-ttu-id="fe905-143">WCF usa el término sesión para indicar una abstracción lógica similar a la de una conexión.</span><span class="sxs-lookup"><span data-stu-id="fe905-143">WCF uses the term session to mean a connection-like logical abstraction.</span></span> <span data-ttu-id="fe905-144">Los protocolos WCF con sesión son similares a los protocolos de red orientados a la conexión y los protocolos WCF sin sesión son similares a los protocolos de red sin sesión.</span><span class="sxs-lookup"><span data-stu-id="fe905-144">Sessionful WCF protocols are similar to connection-oriented network protocols and sessionless WCF protocols are similar to connection-less network protocols.</span></span>  
  
 <span data-ttu-id="fe905-145">En el modelo de objetos de canal, cada sesión lógica se manifiesta como una instancia de un canal con sesión.</span><span class="sxs-lookup"><span data-stu-id="fe905-145">In the channel object model, each logical session manifests as an instance of a sessionful channel.</span></span> <span data-ttu-id="fe905-146">Por consiguiente, cada nueva sesión creada por el cliente y aceptada en el servicio se corresponde con un nuevo canal con sesión en cada lado.</span><span class="sxs-lookup"><span data-stu-id="fe905-146">Therefore every new session created by the client, and accepted on the service, corresponds to a new sessionful channel on each side.</span></span> <span data-ttu-id="fe905-147">El siguiente diagrama muestra, en la parte superior, la estructura de los canales sin sesión y, en la parte inferior, la estructura de los canales con sesión.</span><span class="sxs-lookup"><span data-stu-id="fe905-147">The following diagram shows, on the top, the structure of sessionless channels, and on the bottom, the structure of sessionful channels.</span></span>  
  
 <span data-ttu-id="fe905-148">![Elección de un patrón de intercambio de mensajes](./media/wcfc-sessionandsessionlesschannelsc.gif "wcfc_SessionAndSessionlessChannelsc")</span><span class="sxs-lookup"><span data-stu-id="fe905-148">![Choosing a message exchange pattern](./media/wcfc-sessionandsessionlesschannelsc.gif "wcfc_SessionAndSessionlessChannelsc")</span></span>  
  
 <span data-ttu-id="fe905-149">Un cliente crea un nuevo canal con sesión y envía un mensaje.</span><span class="sxs-lookup"><span data-stu-id="fe905-149">A client creates a new sessionful channel and sends a message.</span></span> <span data-ttu-id="fe905-150">En el lado del servicio, el agente de escucha del canal recibe este mensaje y detecta que pertenece a una nueva sesión de manera que crea un nuevo canal con sesión y lo une a la aplicación (en respuesta a la aplicación que llama a AcceptChannel en el agente de escucha del canal).</span><span class="sxs-lookup"><span data-stu-id="fe905-150">On the service side, the channel listener receives this message and detects that it belongs to a new session so it creates a new sessionful channel and hands it to the application (in response to the application calling AcceptChannel on the channel listener).</span></span> <span data-ttu-id="fe905-151">La aplicación recibe a continuación este mensaje y todos los mensajes subsiguientes enviados en la misma sesión a través del mismo canal con sesión.</span><span class="sxs-lookup"><span data-stu-id="fe905-151">The application then receives this message and all subsequent messages sent in the same session through the same sessionful channel.</span></span>  
  
 <span data-ttu-id="fe905-152">Otro cliente (o el mismo cliente) crea un nuevo canal con sesión y envía un mensaje.</span><span class="sxs-lookup"><span data-stu-id="fe905-152">Another client (or the same client) creates a new sessionful and sends a message.</span></span> <span data-ttu-id="fe905-153">El agente de escucha del canal detecta que este mensaje está en una nueva sesión y crea un nuevo canal con sesión. El proceso se repite.</span><span class="sxs-lookup"><span data-stu-id="fe905-153">The channel listener detects this message is in a new session and creates a new sessionful channel and the process repeats.</span></span>  
  
 <span data-ttu-id="fe905-154">Sin las sesiones, no hay ninguna correlación entre los canales y ellas.</span><span class="sxs-lookup"><span data-stu-id="fe905-154">Without sessions, there is no correlation between channels and sessions.</span></span> <span data-ttu-id="fe905-155">Por consiguiente, un agente de escucha del canal crea solo un canal a través del cual se entregarán los mensajes recibidos a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="fe905-155">Therefore a channel listener creates only one channel through which all received messages are delivered to the application.</span></span> <span data-ttu-id="fe905-156">Tampoco hay un orden de mensajes porque no hay sesión dentro de la cual mantener el orden de los mensajes.</span><span class="sxs-lookup"><span data-stu-id="fe905-156">There is also no message ordering because there is no session within which to maintain message order.</span></span> <span data-ttu-id="fe905-157">La parte superior del gráfico anterior muestra un intercambio de mensajes sin sesión.</span><span class="sxs-lookup"><span data-stu-id="fe905-157">The top portion of the preceding graphic illustrates a sessionless message exchange.</span></span>  
  
## <a name="starting-and-terminating-sessions"></a><span data-ttu-id="fe905-158">Inicio y finalización de sesiones</span><span class="sxs-lookup"><span data-stu-id="fe905-158">Starting and Terminating Sessions</span></span>  

 <span data-ttu-id="fe905-159">Para iniciar las sesiones en el cliente basta con crear un canal con sesión nuevo.</span><span class="sxs-lookup"><span data-stu-id="fe905-159">Sessions are started on the client by simply creating a new sessionful channel.</span></span> <span data-ttu-id="fe905-160">Se inician en el servicio cuando recibe un mensaje que se envió en una nueva sesión.</span><span class="sxs-lookup"><span data-stu-id="fe905-160">They are started on the service when the service receives a message that was sent in a new session.</span></span> <span data-ttu-id="fe905-161">Igualmente, las sesiones se finalizan cerrando o anulando un canal con sesión.</span><span class="sxs-lookup"><span data-stu-id="fe905-161">Likewise, sessions are terminated by closing or aborting a sessionful channel.</span></span>  
  
 <span data-ttu-id="fe905-162">La excepción a esto es <xref:System.ServiceModel.Channels.IDuplexSessionChannel> que se utiliza para enviar y recibir los mensajes en un patrón de comunicación con sesión dúplex.</span><span class="sxs-lookup"><span data-stu-id="fe905-162">The exception to this is <xref:System.ServiceModel.Channels.IDuplexSessionChannel> which is used for both sending and receiving messages in a duplex, sessionful communication pattern.</span></span> <span data-ttu-id="fe905-163">Es posible que un lado desee dejar de enviar los mensajes pero continuar recibiéndolos. Por tanto, cuando se use <xref:System.ServiceModel.Channels.IDuplexSessionChannel>, habrá un mecanismo que le permitirá cerrar la sesión de salida que indicará que no enviará más mensajes pero que mantendrá la sesión de entrada abierta lo que le permitirá continuar recibiendo mensajes.</span><span class="sxs-lookup"><span data-stu-id="fe905-163">It is possible that one side will want to stop sending messages but continue to receive messages therefore when using <xref:System.ServiceModel.Channels.IDuplexSessionChannel> there is a mechanism that lets you close the output session indicating you will not send any more messages but keep the input session opened allowing you to continue to receive messages.</span></span>  
  
 <span data-ttu-id="fe905-164">En general, las sesiones se cierran en el lado de salida y no en el de entrada.</span><span class="sxs-lookup"><span data-stu-id="fe905-164">In general, sessions are closed on the outgoing side and not on the incoming side.</span></span> <span data-ttu-id="fe905-165">Es decir, los canales de salida con sesión pueden cerrarse, cerrando con ello la sesión.</span><span class="sxs-lookup"><span data-stu-id="fe905-165">That is, sessionful output channels can be closed, thereby cleanly terminating the session.</span></span> <span data-ttu-id="fe905-166">Cerrar un canal de salida con sesión provoca que el canal de entrada con sesión correspondiente devuelva el valor null a la aplicación que esté llamando a <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> en <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span><span class="sxs-lookup"><span data-stu-id="fe905-166">Closing a sessionful output channel causes the corresponding sessionful input channel to return null to the application calling <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> on the <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span></span>  
  
 <span data-ttu-id="fe905-167">Sin embargo, los canales de entrada con sesión no deberían estar cerrados a menos que <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> en <xref:System.ServiceModel.Channels.IDuplexSessionChannel> devuelva el valor null, indicando que la sesión ya está cerrada.</span><span class="sxs-lookup"><span data-stu-id="fe905-167">However sessionful input channels should not be closed unless <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> on the <xref:System.ServiceModel.Channels.IDuplexSessionChannel> returns null, indicating that the session is already closed.</span></span> <span data-ttu-id="fe905-168">Si <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> en <xref:System.ServiceModel.Channels.IDuplexSessionChannel> no ha devuelto el valor null, cerrar un canal de entrada con sesión puede producir una excepción porque puede recibir mensajes inesperados al cerrarse.</span><span class="sxs-lookup"><span data-stu-id="fe905-168">If <xref:System.ServiceModel.Channels.IInputChannel.Receive%2A?displayProperty=nameWithType> on the <xref:System.ServiceModel.Channels.IDuplexSessionChannel> has not returned null, closing a sessionful input channel may throw an exception because it may receive unexpected messages while closing.</span></span> <span data-ttu-id="fe905-169">Si un receptor desea finalizar una sesión antes de que el remitente lo haga, debería llamar a <xref:System.ServiceModel.ICommunicationObject.Abort%2A> en el canal de entrada, lo que terminaría la sesión bruscamente.</span><span class="sxs-lookup"><span data-stu-id="fe905-169">If a receiver wishes to terminate a session before the sender does, it should call <xref:System.ServiceModel.ICommunicationObject.Abort%2A> on the input channel, which abruptly terminates the session.</span></span>  
  
## <a name="writing-sessionful-channels"></a><span data-ttu-id="fe905-170">Creación de canales con sesión</span><span class="sxs-lookup"><span data-stu-id="fe905-170">Writing Sessionful Channels</span></span>  

 <span data-ttu-id="fe905-171">Como autor del canal con sesión, hay algunas cosas que el canal deberá hacer para proporcionar sesiones.</span><span class="sxs-lookup"><span data-stu-id="fe905-171">As a sessionful channel author, there are a few things your channel must do to provide sessions.</span></span> <span data-ttu-id="fe905-172">En el lado del envío, el canal tendrá que:</span><span class="sxs-lookup"><span data-stu-id="fe905-172">On the send side, your channel needs to:</span></span>  
  
- <span data-ttu-id="fe905-173">Para cada canal nuevo, crear una sesión nueva y asociarla a un identificador de sesión nuevo que sea una cadena única.</span><span class="sxs-lookup"><span data-stu-id="fe905-173">For each new channel, create a new session and associate it with a new session id which is a unique string.</span></span> <span data-ttu-id="fe905-174">U obtener una nueva sesión a partir del canal con sesión debajo de usted en la pila.</span><span class="sxs-lookup"><span data-stu-id="fe905-174">Or obtain a new session from the sessionful channel below you in the stack.</span></span>  
  
- <span data-ttu-id="fe905-175">Para cada mensaje enviado utilizando este canal, si el canal creó la sesión (lo contrario a obtenerla de la capa debajo de usted), tendrá que asociar el mensaje con la sesión.</span><span class="sxs-lookup"><span data-stu-id="fe905-175">For each message sent using this channel, if your channel created the session (as opposed to obtaining it from the layer below you), you need to associate the message with the session.</span></span> <span data-ttu-id="fe905-176">Para los canales de protocolo, esto se realiza normalmente añadiendo un encabezado SOAP.</span><span class="sxs-lookup"><span data-stu-id="fe905-176">For protocol channels, this is typically done by adding a SOAP header.</span></span> <span data-ttu-id="fe905-177">En el caso de los canales de transporte, esto se hace normalmente creando una nueva conexión de transporte o agregando la información de sesión al protocolo de tramas.</span><span class="sxs-lookup"><span data-stu-id="fe905-177">For transport channels, this is typically done by creating a new transport connection or adding session information to the framing protocol.</span></span>  
  
- <span data-ttu-id="fe905-178">Para cada mensaje enviado mediante este canal, necesita proporcionar las garantías de entrega mencionadas anteriormente.</span><span class="sxs-lookup"><span data-stu-id="fe905-178">For each message sent using this channel, you need to provide the delivery guarantees mentioned above.</span></span> <span data-ttu-id="fe905-179">Si está confiando en el canal situado debajo de usted para proporcionar la sesión, ese canal también proporcionará las garantías de la entrega.</span><span class="sxs-lookup"><span data-stu-id="fe905-179">If you are relying on the channel below you to provide the session, that channel will also provide the delivery guarantees.</span></span> <span data-ttu-id="fe905-180">Si está proporcionando la sesión usted mismo, necesita implementar esas garantías como parte del protocolo.</span><span class="sxs-lookup"><span data-stu-id="fe905-180">If you’re providing the session yourself, you need to implement those guarantees as part of your protocol.</span></span> <span data-ttu-id="fe905-181">En general, si está escribiendo un canal de protocolo que supone WCF en ambos lados, es posible que necesite el transporte de TCP o el canal de mensajería confiable y confíe en cualquier de ellos para proporcionar una sesión.</span><span class="sxs-lookup"><span data-stu-id="fe905-181">In general, if you are writing a protocol channel that assumes WCF on both sides you may require the TCP transport or the Reliable Messaging channel and rely on either one to provide a session.</span></span>  
  
- <span data-ttu-id="fe905-182">Cuando se llama a <xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType> en su canal, realice el trabajo necesario para cerrar la sesión mediante el tiempo de espera especificado o el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="fe905-182">When <xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType> is called on your channel, perform the necessary work to close the session using either the specified timeout or the default one.</span></span> <span data-ttu-id="fe905-183">Esto puede ser tan simple como llamar a <xref:System.ServiceModel.ICommunicationObject.Close%2A> en el canal debajo de usted (si acabara de obtener una sesión de él) o enviar un mensaje SOAP especial o cerrar una conexión de transporte.</span><span class="sxs-lookup"><span data-stu-id="fe905-183">This can be as simple as calling <xref:System.ServiceModel.ICommunicationObject.Close%2A> on the channel below you (if you just obtained the session from it) or sending a special SOAP message or closing a transport connection.</span></span>  
  
- <span data-ttu-id="fe905-184">Cuando se llama a <xref:System.ServiceModel.ICommunicationObject.Abort%2A> en su canal, finalice la sesión bruscamente sin realizar E/S.</span><span class="sxs-lookup"><span data-stu-id="fe905-184">When <xref:System.ServiceModel.ICommunicationObject.Abort%2A> is called on your channel, terminate the session abruptly without performing I/O.</span></span> <span data-ttu-id="fe905-185">Esto puede significar no hacer nada o puede suponer interrumpir la conexión de red o algún otro recurso.</span><span class="sxs-lookup"><span data-stu-id="fe905-185">This may mean doing nothing or may involve aborting a network connection or some other resource.</span></span>  
  
 <span data-ttu-id="fe905-186">En el lado de recepción, el canal tendrá que:</span><span class="sxs-lookup"><span data-stu-id="fe905-186">On the receive side, your channel needs to:</span></span>  
  
- <span data-ttu-id="fe905-187">Para cada mensaje entrante, el agente de escucha debe detectar la sesión a la que pertenece.</span><span class="sxs-lookup"><span data-stu-id="fe905-187">For each incoming message, the channel listener must detect the session it belongs to.</span></span> <span data-ttu-id="fe905-188">Si éste es el primer mensaje en la sesión, el agente de escucha del canal debe crear un nuevo canal y devolverlo desde la llamada a <xref:System.ServiceModel.Channels.IChannelListener%601.AcceptChannel%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="fe905-188">If this is the first message in the session, the channel listener must create a new channel and return it from the call to <xref:System.ServiceModel.Channels.IChannelListener%601.AcceptChannel%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="fe905-189">De lo contrario, el agente de escucha del canal debe buscar el canal existente que corresponde a la sesión y entregar el mensaje a través de ese canal.</span><span class="sxs-lookup"><span data-stu-id="fe905-189">Otherwise the channel listener must find the existing channel that corresponds to the session and deliver the message through that channel.</span></span>  
  
- <span data-ttu-id="fe905-190">Si su canal proporciona la sesión (junto con las garantías de la entrega necesarias), es posible que se pida al lado de recepción que realice algunas acciones como volver a ordenar los mensajes y enviar confirmaciones.</span><span class="sxs-lookup"><span data-stu-id="fe905-190">If your channel is providing the session (along with the required delivery guarantees) the receive side may be required to perform some actions such as re-order messages or send acknowledgements.</span></span>  
  
- <span data-ttu-id="fe905-191">Cuando se llama a <xref:System.ServiceModel.ICommunicationObject.Close%2A> en su canal, realice el trabajo necesario para cerrar la sesión mediante el tiempo de espera especificado o el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="fe905-191">When <xref:System.ServiceModel.ICommunicationObject.Close%2A> is called on your channel, perform the necessary work to close the session either the specified timeout or the default one.</span></span> <span data-ttu-id="fe905-192">Esto podría producir excepciones si el canal recibe un mensaje mientras espera que el tiempo de espera esté a punto de agotarse.</span><span class="sxs-lookup"><span data-stu-id="fe905-192">This could result in exceptions if the channel receives a message while waiting for the close timeout to expire.</span></span> <span data-ttu-id="fe905-193">Esto se debe a que el canal estará en estado de cierre cuando reciba un mensaje por lo que se producirá una.</span><span class="sxs-lookup"><span data-stu-id="fe905-193">That’s because the channel will be in the Closing state when it receives a message so it would throw.</span></span>  
  
- <span data-ttu-id="fe905-194">Cuando se llama a <xref:System.ServiceModel.ICommunicationObject.Abort%2A> en su canal, finalice la sesión bruscamente sin realizar E/S.</span><span class="sxs-lookup"><span data-stu-id="fe905-194">When <xref:System.ServiceModel.ICommunicationObject.Abort%2A> is called on your channel, terminate the session abruptly without performing I/O.</span></span> <span data-ttu-id="fe905-195">De nuevo, esto puede significar no hacer nada o puede suponer interrumpir la conexión de red o algún otro recurso.</span><span class="sxs-lookup"><span data-stu-id="fe905-195">Again, this may mean doing nothing or may involve aborting a network connection or some other resource.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fe905-196">Vea también</span><span class="sxs-lookup"><span data-stu-id="fe905-196">See also</span></span>

- [<span data-ttu-id="fe905-197">Información general del modelo de canales</span><span class="sxs-lookup"><span data-stu-id="fe905-197">Channel Model Overview</span></span>](channel-model-overview.md)
