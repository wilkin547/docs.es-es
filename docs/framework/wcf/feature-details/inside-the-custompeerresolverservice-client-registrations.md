---
description: 'Más información sobre: dentro de CustomPeerResolverService: registros de cliente'
title: 'Dentro de CustomPeerResolverService: registros de cliente'
ms.date: 03/30/2017
ms.assetid: 40236953-a916-4236-84a6-928859e1331a
ms.openlocfilehash: 2cc0706fc473985cf6572e6ee5387a26366bc2c8
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/06/2021
ms.locfileid: "99802845"
---
# <a name="inside-the-custompeerresolverservice-client-registrations"></a><span data-ttu-id="344c7-103">Dentro de CustomPeerResolverService: registros de cliente</span><span class="sxs-lookup"><span data-stu-id="344c7-103">Inside the CustomPeerResolverService: Client Registrations</span></span>

<span data-ttu-id="344c7-104">Cada nodo de la malla publica su información de punto de conexión en el servicio de resolución a través de la función `Register`.</span><span class="sxs-lookup"><span data-stu-id="344c7-104">Each node in the mesh publishes its endpoint information to the resolver service through the `Register` function.</span></span> <span data-ttu-id="344c7-105">El servicio de resolución almacena esta información como un registro.</span><span class="sxs-lookup"><span data-stu-id="344c7-105">The resolver service stores this information as a registration record.</span></span> <span data-ttu-id="344c7-106">Este registro contiene un identificador único (RegistrationID) e información de punto de conexión (PeerNodeAddress) para el nodo.</span><span class="sxs-lookup"><span data-stu-id="344c7-106">This record contains a unique identifier (RegistrationID) and endpoint information (PeerNodeAddress) for the node.</span></span>  
  
## <a name="stale-records-and-expiration-time"></a><span data-ttu-id="344c7-107">Registros obsoletos y tiempo de expiración</span><span class="sxs-lookup"><span data-stu-id="344c7-107">Stale Records and Expiration Time</span></span>  

 <span data-ttu-id="344c7-108">Lo ideal es que, cuando un nodo deja la malla, llame a la función `Unregister`, que hace que el servicio de resolución quite la entrada de registro.</span><span class="sxs-lookup"><span data-stu-id="344c7-108">Ideally, when a node leaves the mesh, it will call the `Unregister` function, which causes the resolver service to remove the registration entry.</span></span> <span data-ttu-id="344c7-109">A veces, los nodos se cierran o dejan de estar accesibles antes de llamar a `Unregister`, dejando un registro obsoleto.</span><span class="sxs-lookup"><span data-stu-id="344c7-109">Sometimes, nodes shut down or become inaccessible before calling `Unregister`, leaving behind a stale registration record.</span></span>  
  
 <span data-ttu-id="344c7-110">Los registros obsoletos del servicio de resolución pueden producir errores de conexión.</span><span class="sxs-lookup"><span data-stu-id="344c7-110">Stale records in your resolver service can cause failed connections.</span></span> <span data-ttu-id="344c7-111">Si un nodo que intenta conectar con una malla recibe información de conexión obsoleta del servicio de resolución, puede tardar mucho más tiempo en unirse a la malla correctamente.</span><span class="sxs-lookup"><span data-stu-id="344c7-111">If a node trying to connect to a mesh receives stale connection information from the resolver service, it can take longer to successfully join the mesh.</span></span> <span data-ttu-id="344c7-112">Los registros obsoletos también consumen memoria.</span><span class="sxs-lookup"><span data-stu-id="344c7-112">Stale records also take up memory.</span></span> <span data-ttu-id="344c7-113">Si no se dispone de un proceso de limpieza eficaz, la memoria caché utilizada para almacenar los registros podría desbordarse y bloquear el servicio de resolución.</span><span class="sxs-lookup"><span data-stu-id="344c7-113">Without an efficient clean up process, the cache used to store registrations could eventually overflow and crash the resolver service.</span></span>  
  
 <span data-ttu-id="344c7-114"><xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> marca cada registro con un tiempo de expiración (DateTime) y almacena esa información como parte del registro.</span><span class="sxs-lookup"><span data-stu-id="344c7-114">The <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> marks each record with an expiration time (DateTime), and stores that information as part of the record.</span></span> <span data-ttu-id="344c7-115">El servicio utiliza el tiempo de expiración para identificar los registros obsoletos.</span><span class="sxs-lookup"><span data-stu-id="344c7-115">The service uses the expiration time to identify stale records.</span></span> <span data-ttu-id="344c7-116">Las implementaciones personalizadas deberían hacer algo similar.</span><span class="sxs-lookup"><span data-stu-id="344c7-116">Custom implementations should do something similar.</span></span>  
  
## <a name="refreshinterval-and-cleanupinterval"></a><span data-ttu-id="344c7-117">RefreshInterval y CleanupInterval</span><span class="sxs-lookup"><span data-stu-id="344c7-117">RefreshInterval and CleanupInterval</span></span>  

 <span data-ttu-id="344c7-118">La propiedad `RefreshInterval` de <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> define el tiempo durante el cual los registros siguen siendo válidos en la tabla de búsqueda del registro del servicio.</span><span class="sxs-lookup"><span data-stu-id="344c7-118">The `RefreshInterval` property of the <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> defines how long registration records remain valid in the service's registration lookup table.</span></span> <span data-ttu-id="344c7-119">Cuando ha transcurrido el tiempo indicado en esta propiedad para un registro determinado, ese registro se vuelve obsoleto y se marca para su eliminación.</span><span class="sxs-lookup"><span data-stu-id="344c7-119">When the amount of time supplied to this property has passed for a given record, that record becomes stale and is marked for deletion.</span></span>  
  
 <span data-ttu-id="344c7-120">La propiedad `CleanupInterval` de <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> indica al servicio con qué frecuencia debe buscar y eliminar los registros obsoletos.</span><span class="sxs-lookup"><span data-stu-id="344c7-120">The `CleanupInterval` property of the <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> tells the service how often to search for and delete stale registration records.</span></span> <span data-ttu-id="344c7-121">`CleanupInterval` se debería establecer en un valor mayor o igual que el valor de `RefreshInterval` establecido en el servicio.</span><span class="sxs-lookup"><span data-stu-id="344c7-121">The `CleanupInterval` should be set to a time greater than or equal to the `RefreshInterval` set on the service.</span></span>  
  
 <span data-ttu-id="344c7-122">Para implementar su propio servicio de resolución, necesita escribir una función de mantenimiento para quitar los registros obsoletos.</span><span class="sxs-lookup"><span data-stu-id="344c7-122">To implement your own resolver service, you need to write a maintenance function to remove stale registration records.</span></span> <span data-ttu-id="344c7-123">Existen varias formas de hacerlo:</span><span class="sxs-lookup"><span data-stu-id="344c7-123">There are several ways to do this:</span></span>  
  
- <span data-ttu-id="344c7-124">**Mantenimiento periódico**: establezca un temporizador para que se desactive periódicamente y recorra el almacén de datos para eliminar los registros antiguos.</span><span class="sxs-lookup"><span data-stu-id="344c7-124">**Periodic maintenance**: Set a timer to go off periodically, and go through your data store to delete old records.</span></span> <span data-ttu-id="344c7-125"><xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> usa este método.</span><span class="sxs-lookup"><span data-stu-id="344c7-125">The <xref:System.ServiceModel.PeerResolvers.CustomPeerResolverService> uses this approach.</span></span>  
  
- <span data-ttu-id="344c7-126">**Eliminación pasiva**: en lugar de buscar activamente los registros obsoletos a intervalos regulares, puede identificar y eliminar los registros obsoletos cuando el servicio ya está realizando otra función.</span><span class="sxs-lookup"><span data-stu-id="344c7-126">**Passive deletion**: Instead of actively searching for stale records at regular intervals, you can identify and delete stale records when your service is already performing another function.</span></span> <span data-ttu-id="344c7-127">Existe la posibilidad de que se reduzca el tiempo de respuesta para las solicitudes de los clientes de resolución, pero evita la necesidad de disponer de un temporizador y puede ser más eficaz si se espera que pocos nodos terminen sin llamar a `Unregister`.</span><span class="sxs-lookup"><span data-stu-id="344c7-127">This may potentially slow down response time to requests from the resolver clients, but it eliminates the need for a timer, and may be more efficient if few nodes are expected to leave without calling `Unregister`.</span></span>  
  
## <a name="registrationlifetime-and-refresh"></a><span data-ttu-id="344c7-128">RegistrationLifetime y Refresh</span><span class="sxs-lookup"><span data-stu-id="344c7-128">RegistrationLifetime and Refresh</span></span>  

 <span data-ttu-id="344c7-129">Cuando un nodo se registra con un servicio de resolución, recibe un objeto <xref:System.ServiceModel.PeerResolvers.RegisterResponseInfo> desde el servicio.</span><span class="sxs-lookup"><span data-stu-id="344c7-129">When a node registers with a resolver service, it receives a <xref:System.ServiceModel.PeerResolvers.RegisterResponseInfo> object from the service.</span></span> <span data-ttu-id="344c7-130">Este objeto tiene una propiedad `RegistrationLifetime` que indica al nodo cuánto tiempo tiene antes de que el registro expire y el servicio de resolución lo quite.</span><span class="sxs-lookup"><span data-stu-id="344c7-130">This object has a `RegistrationLifetime` property which indicates to the node how much time it has before the registration expires and is removed by the resolver service.</span></span> <span data-ttu-id="344c7-131">Por ejemplo, si `RegistrationLifetime` es 2 minutos, el nodo necesita llamar a `Refresh` en menos de 2 minutos para asegurarse de que el registro se mantiene actualizado y no se elimina.</span><span class="sxs-lookup"><span data-stu-id="344c7-131">If, for example, the `RegistrationLifetime` is 2 minutes, the node needs to call `Refresh` in under 2 minutes to ensure the record stays fresh and is not deleted.</span></span> <span data-ttu-id="344c7-132">Cuando el servicio de resolución recibe una solicitud `Refresh`, busca el registro y restablece el tiempo de expiración.</span><span class="sxs-lookup"><span data-stu-id="344c7-132">When the resolver service receives a `Refresh` request, it looks up the record and resets the expiration time.</span></span> <span data-ttu-id="344c7-133">Refresh devuelve un objeto <xref:System.ServiceModel.PeerResolvers.RefreshResponseInfo> con una propiedad `RegistrationLifetime`.</span><span class="sxs-lookup"><span data-stu-id="344c7-133">Refresh returns a <xref:System.ServiceModel.PeerResolvers.RefreshResponseInfo> object with a `RegistrationLifetime` property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="344c7-134">Vea también</span><span class="sxs-lookup"><span data-stu-id="344c7-134">See also</span></span>

- [<span data-ttu-id="344c7-135">Resoluciones del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="344c7-135">Peer Resolvers</span></span>](peer-resolvers.md)
