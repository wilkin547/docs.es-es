---
description: 'Más información acerca de: atributos de transacción de ServiceModel'
title: Atributos de transacción de ServiceModel
ms.date: 03/30/2017
helpviewer_keywords:
- transactions [WCF], ServiceModel attributes
ms.assetid: 1e0d2436-6ae5-439b-9765-a448d6f60000
ms.openlocfilehash: 0b443fc6b9503007574608afe03c5e0508f666d9
ms.sourcegitcommit: ddf7edb67715a5b9a45e3dd44536dabc153c1de0
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/06/2021
ms.locfileid: "99793485"
---
# <a name="servicemodel-transaction-attributes"></a><span data-ttu-id="03655-103">Atributos de transacción de ServiceModel</span><span class="sxs-lookup"><span data-stu-id="03655-103">ServiceModel Transaction Attributes</span></span>

<span data-ttu-id="03655-104">Windows Communication Foundation (WCF) proporciona propiedades de tres <xref:System.ServiceModel> atributos estándar que permiten configurar el comportamiento de las transacciones para un servicio WCF:</span><span class="sxs-lookup"><span data-stu-id="03655-104">Windows Communication Foundation (WCF) provides properties on three standard <xref:System.ServiceModel> attributes that enable you to configure the behavior of transactions for a WCF service:</span></span>

- <xref:System.ServiceModel.TransactionFlowAttribute>

- <xref:System.ServiceModel.ServiceBehaviorAttribute>

- <xref:System.ServiceModel.OperationBehaviorAttribute>

## <a name="transactionflowattribute"></a><span data-ttu-id="03655-105">TransactionFlowAttribute</span><span class="sxs-lookup"><span data-stu-id="03655-105">TransactionFlowAttribute</span></span>

<span data-ttu-id="03655-106">El atributo <xref:System.ServiceModel.TransactionFlowAttribute> especifica la predisposición de una operación en un contrato de servicio para aceptar las transacciones entrantes de un cliente.</span><span class="sxs-lookup"><span data-stu-id="03655-106">The <xref:System.ServiceModel.TransactionFlowAttribute> attribute specifies the willingness of an operation in a service contract to accept incoming transactions from a client.</span></span> <span data-ttu-id="03655-107">El atributo proporciona la propiedad siguiente a este control: las transacciones utilizan la enumeración <xref:System.ServiceModel.TransactionFlowOption> para especificar si una transacción entrante es <xref:System.ServiceModel.TransactionFlowOption.Mandatory>, <xref:System.ServiceModel.TransactionFlowOption.Allowed>o <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>.</span><span class="sxs-lookup"><span data-stu-id="03655-107">The attribute provides this control with the following property: Transactions use the <xref:System.ServiceModel.TransactionFlowOption> enumeration to specify whether an incoming transaction is <xref:System.ServiceModel.TransactionFlowOption.Mandatory>, <xref:System.ServiceModel.TransactionFlowOption.Allowed>, or <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>.</span></span>

<span data-ttu-id="03655-108">Éste es el único atributo que relaciona las operaciones de servicio con las interacciones externas con un cliente.</span><span class="sxs-lookup"><span data-stu-id="03655-108">This is the only attribute that relates service operations to external interactions with a client.</span></span> <span data-ttu-id="03655-109">Los atributos descritos en las siguientes secciones se relacionan con el uso de transacciones dentro de la ejecución de la operación.</span><span class="sxs-lookup"><span data-stu-id="03655-109">The attributes described in the following sections relate to the use of transactions within the execution of the operation.</span></span>

## <a name="servicebehaviorattribute"></a><span data-ttu-id="03655-110">ServiceBehaviorAttribute</span><span class="sxs-lookup"><span data-stu-id="03655-110">ServiceBehaviorAttribute</span></span>

<span data-ttu-id="03655-111">El atributo <xref:System.ServiceModel.ServiceBehaviorAttribute> especifica el comportamiento de ejecución interno de una implementación de contrato de servicio.</span><span class="sxs-lookup"><span data-stu-id="03655-111">The <xref:System.ServiceModel.ServiceBehaviorAttribute> attribute specifies the internal execution behavior of a service contract implementation.</span></span> <span data-ttu-id="03655-112">Entre las propiedades específicas de transacciones de este atributo se incluyen:</span><span class="sxs-lookup"><span data-stu-id="03655-112">Transaction-specific properties of this attribute include:</span></span>

- <span data-ttu-id="03655-113"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> especifica si completar una transacción incompleta cuando la sesión se cierra.</span><span class="sxs-lookup"><span data-stu-id="03655-113"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> specifies whether to complete an uncompleted transaction when the session closes.</span></span> <span data-ttu-id="03655-114">El valor predeterminado de esta propiedad es `false`.</span><span class="sxs-lookup"><span data-stu-id="03655-114">The default value for this property is `false`.</span></span> <span data-ttu-id="03655-115">Si esta propiedad es `true`, y la sesión entrante se cerró correctamente en lugar de cerrarse debido a errores de red o de cliente, se completa correctamente cualquier transacción incompleta.</span><span class="sxs-lookup"><span data-stu-id="03655-115">If this property is `true`, and the incoming session was gracefully shut down instead of closing due to network or client faults, any uncompleted transaction is successfully completed.</span></span> <span data-ttu-id="03655-116">De lo contrario, si esta propiedad es `false` o si no se cerró la sesión correctamente, se deshace cualquier transacción incompleta cuando se cierra la sesión.</span><span class="sxs-lookup"><span data-stu-id="03655-116">Otherwise, if this property is `false` or if the session was not gracefully closed, any uncompleted transaction is rolled back when the session closes.</span></span> <span data-ttu-id="03655-117">Si esta propiedad es `true`, el canal de entrada debe basarse en sesión.</span><span class="sxs-lookup"><span data-stu-id="03655-117">If this property is `true`, the incoming channel must be session-based.</span></span>

- <span data-ttu-id="03655-118"><xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A> especifica si se libera la instancia del servicio subyacente cuando se completa una transacción.</span><span class="sxs-lookup"><span data-stu-id="03655-118"><xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A> specifies whether the underlying service instance is released when a transaction completes.</span></span> <span data-ttu-id="03655-119">El valor predeterminado de esta propiedad es `true`.</span><span class="sxs-lookup"><span data-stu-id="03655-119">The default value for this property is `true`.</span></span> <span data-ttu-id="03655-120">El siguiente mensaje entrante hace que se cree una nueva instancia subyacente, descartando cualquiera estado por transacción que la instancia anterior pudiese haber retenido.</span><span class="sxs-lookup"><span data-stu-id="03655-120">The next inbound message causes a new underlying instance to be created, discarding any per-transaction state that the previous instance might have held.</span></span> <span data-ttu-id="03655-121">Liberar una instancia de servicio es una acción interna que realiza el servicio y no tiene ningún impacto en ninguna conexión ni sesiones existentes que los clientes puedan haber establecido.</span><span class="sxs-lookup"><span data-stu-id="03655-121">Releasing a service instance is an internal action the service takes and has no impact on any existing connections or sessions that clients might have established.</span></span> <span data-ttu-id="03655-122">Esta funcionalidad es equivalente a la característica de activación just-in-time que proporciona COM+.</span><span class="sxs-lookup"><span data-stu-id="03655-122">This functionality is equivalent to the just-in-time activation feature COM+ provides.</span></span> <span data-ttu-id="03655-123">Si la propiedad es `true`, <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> debe ser igual a <xref:System.ServiceModel.ConcurrencyMode.Single>.</span><span class="sxs-lookup"><span data-stu-id="03655-123">If the property is `true`, <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> must be equal to <xref:System.ServiceModel.ConcurrencyMode.Single>.</span></span> <span data-ttu-id="03655-124">De lo contrario, el servicio produce una excepción de validación de configuración no válida durante el inicio.</span><span class="sxs-lookup"><span data-stu-id="03655-124">Otherwise, the service throws an invalid configuration validation exception during startup.</span></span>

- <span data-ttu-id="03655-125"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionIsolationLevel%2A> especifica el nivel de aislamiento que se utilizará para las transacciones dentro del servicio; esta propiedad toma uno de los valores <xref:System.Transactions.IsolationLevel>.</span><span class="sxs-lookup"><span data-stu-id="03655-125"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionIsolationLevel%2A> specifies the isolation level to use for transactions within the service; this property takes one of the <xref:System.Transactions.IsolationLevel> values.</span></span> <span data-ttu-id="03655-126">Si la propiedad de nivel de aislamiento local no es <xref:System.Transactions.IsolationLevel.Unspecified>, el nivel de aislamiento de una transacción entrante debe coincidir con el valor de esta propiedad local.</span><span class="sxs-lookup"><span data-stu-id="03655-126">If the local isolation level property is anything other than <xref:System.Transactions.IsolationLevel.Unspecified>, the isolation level of an incoming transaction must match the setting of this local property.</span></span> <span data-ttu-id="03655-127">De lo contrario, se rechaza la transacción entrante y se devuelve un error al cliente.</span><span class="sxs-lookup"><span data-stu-id="03655-127">Otherwise, the incoming transaction is rejected, and a fault is sent back to the client.</span></span> <span data-ttu-id="03655-128">Si <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> es `true`, y no se fluye ninguna transacción, esta propiedad determina el valor <xref:System.Transactions.IsolationLevel> que se utilizará para la transacción creada localmente.</span><span class="sxs-lookup"><span data-stu-id="03655-128">If <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> is `true`, and no transaction is flowed, this property determines the <xref:System.Transactions.IsolationLevel> value to use for the locally created transaction.</span></span> <span data-ttu-id="03655-129">Si se establece <xref:System.Transactions.IsolationLevel> como <xref:System.Transactions.IsolationLevel.Unspecified>, se usa <xref:System.Transactions.IsolationLevel><xref:System.Transactions.IsolationLevel.Serializable>.</span><span class="sxs-lookup"><span data-stu-id="03655-129">If <xref:System.Transactions.IsolationLevel> is set to <xref:System.Transactions.IsolationLevel.Unspecified>, <xref:System.Transactions.IsolationLevel><xref:System.Transactions.IsolationLevel.Serializable> is used.</span></span>

- <span data-ttu-id="03655-130"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> especifica el período de tiempo dentro del que una nueva transacción creada en el servicio debe completarse.</span><span class="sxs-lookup"><span data-stu-id="03655-130"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> specifies the time period within which a new transaction created at the service must complete.</span></span> <span data-ttu-id="03655-131">Si se alcanza este período de tiempo y no se ha completado la transacción, se anulará.</span><span class="sxs-lookup"><span data-stu-id="03655-131">If this time is reached and the transaction has not been completed, it will abort.</span></span> <span data-ttu-id="03655-132"><xref:System.TimeSpan> se utiliza como tiempo de espera <xref:System.Transactions.TransactionScope> para cualquier operación que tenga <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> destablecida como `true` y para la que se creó una nueva transacción.</span><span class="sxs-lookup"><span data-stu-id="03655-132">The <xref:System.TimeSpan> is used as the <xref:System.Transactions.TransactionScope> time-out for any operations that have <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> set to `true` and for which a new transaction was created.</span></span> <span data-ttu-id="03655-133">El tiempo de espera es la duración máxima permitida desde la creación de la transacción hasta la finalización de la fase 1 en el protocolo de confirmación de dos fases.</span><span class="sxs-lookup"><span data-stu-id="03655-133">The time-out is the maximum allowed duration from the creation of the transaction to the completion of phase 1 in the two-phase commit protocol.</span></span> <span data-ttu-id="03655-134">El valor de tiempo de espera utilizado es siempre el valor inferior entre la propiedad <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> y el valor de configuración `transactionTimeout`.</span><span class="sxs-lookup"><span data-stu-id="03655-134">The time-out value used is always the lower value between the <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> property and the `transactionTimeout` configuration setting.</span></span>

## <a name="operationbehaviorattribute"></a><span data-ttu-id="03655-135">OperationBehaviorAttribute</span><span class="sxs-lookup"><span data-stu-id="03655-135">OperationBehaviorAttribute</span></span>

<span data-ttu-id="03655-136">El atributo <xref:System.ServiceModel.OperationBehaviorAttribute> especifica los comportamientos de los métodos en la implementación del servicio.</span><span class="sxs-lookup"><span data-stu-id="03655-136">The <xref:System.ServiceModel.OperationBehaviorAttribute> attribute specifies the behaviors of the methods in the service implementation.</span></span> <span data-ttu-id="03655-137">Puede utilizarlo para indicar el comportamiento de ejecución concreto de la operación.</span><span class="sxs-lookup"><span data-stu-id="03655-137">You can use it to indicate the operation's specific execution behavior.</span></span> <span data-ttu-id="03655-138">Las propiedades de este atributo no afectan a la descripción del lenguaje de descripción de servicios web (WSDL) del contrato de servicio y son meramente elementos del modelo de programación de WCF que permiten características comunes que los desarrolladores tienen que implementar por sí mismos.</span><span class="sxs-lookup"><span data-stu-id="03655-138">Properties of this attribute do not affect the Web Service Description Language (WSDL) description of the service contract, and are purely elements of the WCF programming model that enable common features that developers otherwise have to implement themselves.</span></span>

<span data-ttu-id="03655-139">Este atributo tiene las siguientes propiedades específicas de transacciones:</span><span class="sxs-lookup"><span data-stu-id="03655-139">This attribute has the following transaction-specific properties:</span></span>

- <span data-ttu-id="03655-140"><xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> especifica si un método debe ejecutarse dentro de un ámbito de transacciones activo.</span><span class="sxs-lookup"><span data-stu-id="03655-140"><xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> specifies whether a method must execute within an active transaction scope.</span></span> <span data-ttu-id="03655-141">De manera predeterminada, es `false`.</span><span class="sxs-lookup"><span data-stu-id="03655-141">The default is `false`.</span></span> <span data-ttu-id="03655-142">Si el atributo <xref:System.ServiceModel.OperationBehaviorAttribute> no se establece para un método, también implica que el método no se ejecutará en una transacción.</span><span class="sxs-lookup"><span data-stu-id="03655-142">If the <xref:System.ServiceModel.OperationBehaviorAttribute> attribute is not set for a method, it also implies that the method will not execute in a transaction.</span></span> <span data-ttu-id="03655-143">Si no se requiere un ámbito de transacciones para una operación, cualquier transacción que esté presente dentro del encabezado del mensaje no se activa y permanece como un elemento de <xref:System.ServiceModel.OperationContext.IncomingMessageProperties%2A> de <xref:System.ServiceModel.OperationContext>.</span><span class="sxs-lookup"><span data-stu-id="03655-143">If a transaction scope is not required for an operation, any transaction that is present within the message header is not activated and remains as an element of the <xref:System.ServiceModel.OperationContext.IncomingMessageProperties%2A> of the <xref:System.ServiceModel.OperationContext>.</span></span> <span data-ttu-id="03655-144">Si se requiere un ámbito de la transacción para una operación, el origen para la transacción se deriva a partir de uno de los siguientes elementos:</span><span class="sxs-lookup"><span data-stu-id="03655-144">If a transaction scope is required for an operation, the source for the transaction is derived from one of the following:</span></span>

  - <span data-ttu-id="03655-145">Si una transacción fluye a partir del cliente, se ejecuta el método bajo un ámbito de transacciones creado mediante esa transacción distribuida.</span><span class="sxs-lookup"><span data-stu-id="03655-145">If a transaction is flowed from the client, the method is executed under a transaction scope created using that distributed transaction.</span></span>

  - <span data-ttu-id="03655-146">Con un transporte en cola, se usa la transacción utilizada para quitar el mensaje de la cola.</span><span class="sxs-lookup"><span data-stu-id="03655-146">With a queued transport, the transaction used to dequeue the message is used.</span></span> <span data-ttu-id="03655-147">Observe que la transacción utilizada no es una transacción de flujo, puesto que no la proporcionó el remitente original del mensaje.</span><span class="sxs-lookup"><span data-stu-id="03655-147">Note that the transaction used is not a flowed transaction, in that it was not provided by the original sender of the message.</span></span>

  - <span data-ttu-id="03655-148">Un transporte personalizado puede proporcionar una transacción mediante el uso de `TransportTransactionProperty`.</span><span class="sxs-lookup"><span data-stu-id="03655-148">A custom transport can provide a transaction through the use of the `TransportTransactionProperty`.</span></span>

  - <span data-ttu-id="03655-149">Si nada de lo anterior proporciona un origen externo para una transacción, se crea inmediatamente una nueva instancia <xref:System.Transactions.Transaction> antes de llamar al método.</span><span class="sxs-lookup"><span data-stu-id="03655-149">If none of the above provides an external source for a transaction, a new <xref:System.Transactions.Transaction> instance is created immediately prior to calling the method.</span></span>

- <span data-ttu-id="03655-150"><xref:System.ServiceModel.OperationBehaviorAttribute.TransactionAutoComplete%2A> especifica si se completa automáticamente la transacción en la que se ejecuta el método si no se produce ninguna excepción no controlada.</span><span class="sxs-lookup"><span data-stu-id="03655-150"><xref:System.ServiceModel.OperationBehaviorAttribute.TransactionAutoComplete%2A> specifies whether the transaction in which the method executes is automatically completed if no unhandled exceptions are thrown.</span></span> <span data-ttu-id="03655-151">Si esta propiedad es `true`, la infraestructura de la llamada marca automáticamente la transacción como "completada" si el método de usuario vuelve sin producir una excepción.</span><span class="sxs-lookup"><span data-stu-id="03655-151">If this property is `true`, the calling infrastructure automatically marks the transaction as "completed" if the user method returns without throwing an exception.</span></span> <span data-ttu-id="03655-152">Si esta propiedad es `false`, la transacción está adjunta a la instancia y solo se marca como "completada" si el cliente llama a un método subsiguiente marcado con esta propiedad igual a `true`, o si un método subsiguiente llama explícitamente a <xref:System.ServiceModel.OperationContext.SetTransactionComplete%2A>.</span><span class="sxs-lookup"><span data-stu-id="03655-152">If this property is `false`, the transaction is attached to the instance, and is only marked as "completed" if the client calls a subsequent method that is marked with this property equal to `true`, or if a subsequent method explicitly calls <xref:System.ServiceModel.OperationContext.SetTransactionComplete%2A>.</span></span> <span data-ttu-id="03655-153">Error al realizar cualquiera de estos resultados en la transacción, que nunca se completa y no se confirma el trabajo contenido, a menos que la propiedad <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> esté establecida como `true`.</span><span class="sxs-lookup"><span data-stu-id="03655-153">Failure to perform either of these results in the transaction never being "completed," and the contained work is not committed, unless the <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> property is set to `true`.</span></span> <span data-ttu-id="03655-154">Si esta propiedad se establece como `true`, debe utilizar un canal con una sesión y <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> debe establecerse como <xref:System.ServiceModel.InstanceContextMode.PerSession>.</span><span class="sxs-lookup"><span data-stu-id="03655-154">If this property is set to `true`, you must use a channel with a session, and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> must be set to <xref:System.ServiceModel.InstanceContextMode.PerSession>.</span></span>
