---
title: Escenarios de enrutamiento
ms.date: 03/30/2017
helpviewer_keywords:
- routing [WCF], scenarios
ms.assetid: ec22f308-665a-413e-9f94-7267cb665dab
ms.openlocfilehash: 455a6e42aea064d48846994b4e729b90667bc8e1
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/09/2020
ms.locfileid: "84590506"
---
# <a name="routing-scenarios"></a><span data-ttu-id="9971a-102">Escenarios de enrutamiento</span><span class="sxs-lookup"><span data-stu-id="9971a-102">Routing Scenarios</span></span>
<span data-ttu-id="9971a-103">Aunque el servicio de enrutamiento es muy personalizable, puede ser un desafío para diseñar una lógica de enrutamiento eficaz al crear una nueva configuración desde el principio.</span><span class="sxs-lookup"><span data-stu-id="9971a-103">While the Routing Service is highly customizable, it can be a challenge to design efficient routing logic when creating a new configuration from scratch.</span></span>  <span data-ttu-id="9971a-104">Sin embargo, hay varios escenarios comunes que sigue la mayoría de las configuraciones del servicio de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="9971a-104">However, there are several common scenarios that most Routing Service configurations follow.</span></span> <span data-ttu-id="9971a-105">Aunque puede que estos escenarios no se apliquen directamente a su configuración concreta, el hecho de saber cómo se puede configurar el servicio de enrutamiento para administrar estos escenarios le ayudará a entender el servicio de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="9971a-105">While these scenarios may not apply directly to your specific configuration, understanding how the Routing Service can be configured to handle these scenarios will aid you in understanding the Routing Service.</span></span>  
  
## <a name="common-scenarios"></a><span data-ttu-id="9971a-106">Escenarios comunes</span><span class="sxs-lookup"><span data-stu-id="9971a-106">Common Scenarios</span></span>  
 <span data-ttu-id="9971a-107">El uso más básico del servicio de enrutamiento es agregar varios extremos de destino para reducir el número de extremos expuestos en las aplicaciones cliente y, a continuación, usar filtros de mensajes para enrutar cada mensaje al destino correcto.</span><span class="sxs-lookup"><span data-stu-id="9971a-107">The most basic use of the Routing Service is to aggregate multiple destination endpoints to reduce the number of endpoints exposed to the client applications, and then use message filters to route each message to the correct destination.</span></span> <span data-ttu-id="9971a-108">Los mensajes se pueden enrutar en función de requisitos de procesamiento físicos o lógicos, como un tipo de mensaje que debe ser procesado por un servicio concreto, o en función de necesidades del negocio arbitrarias, como proporcionar procesamiento de prioridad de mensajes a partir de un origen concreto.</span><span class="sxs-lookup"><span data-stu-id="9971a-108">Messages may be routed based on logical or physical processing requirements, such as a message type that must be processed by a specific service, or based on arbitrary business needs such as providing priority processing of messages from a specific source.</span></span> <span data-ttu-id="9971a-109">En la siguiente tabla, se muestra una lista de algunos de los escenarios comunes y cuándo se producen:</span><span class="sxs-lookup"><span data-stu-id="9971a-109">The following table lists some of the common scenarios and when they are encountered:</span></span>  
  
|<span data-ttu-id="9971a-110">Escenario</span><span class="sxs-lookup"><span data-stu-id="9971a-110">Scenario</span></span>|<span data-ttu-id="9971a-111">Cuándo se utiliza</span><span class="sxs-lookup"><span data-stu-id="9971a-111">Use when</span></span>|  
|--------------|--------------|  
|<span data-ttu-id="9971a-112">Control de versiones de servicios</span><span class="sxs-lookup"><span data-stu-id="9971a-112">Service versioning</span></span>|<span data-ttu-id="9971a-113">Debe admitir varias versiones de un servicio o puede implementar un servicio actualizado en el futuro</span><span class="sxs-lookup"><span data-stu-id="9971a-113">You need to support multiple versions of a service or may deploy an updated service in the future</span></span>|  
|<span data-ttu-id="9971a-114">Particionar datos de servicio</span><span class="sxs-lookup"><span data-stu-id="9971a-114">Service data partitioning</span></span>|<span data-ttu-id="9971a-115">Debe crear una partición de un servicio en varios hosts</span><span class="sxs-lookup"><span data-stu-id="9971a-115">You must partition a service across multiple hosts</span></span>|  
|<span data-ttu-id="9971a-116">Actualización dinámica</span><span class="sxs-lookup"><span data-stu-id="9971a-116">Dynamic update</span></span>|<span data-ttu-id="9971a-117">Debe reconfigurar dinámicamente la lógica de enrutamiento en el tiempo de ejecución para administrar el cambio de implementaciones de servicio</span><span class="sxs-lookup"><span data-stu-id="9971a-117">You must dynamically reconfigure routing logic at runtime to handle changing service deployments</span></span>|  
|<span data-ttu-id="9971a-118">Multidifusión</span><span class="sxs-lookup"><span data-stu-id="9971a-118">Multicast</span></span>|<span data-ttu-id="9971a-119">Debe enviar un mensaje a varios puntos de conexión</span><span class="sxs-lookup"><span data-stu-id="9971a-119">You must send one message to multiple endpoints</span></span>|  
|<span data-ttu-id="9971a-120">Puente protocolar</span><span class="sxs-lookup"><span data-stu-id="9971a-120">Protocol bridging</span></span>|<span data-ttu-id="9971a-121">Recibe mensajes en un protocolo de transporte, y el punto de conexión del destino utiliza un protocolo diferente</span><span class="sxs-lookup"><span data-stu-id="9971a-121">You receive messages over one transport protocol, and the destination endpoint uses a different protocol</span></span>|  
|<span data-ttu-id="9971a-122">Tratamiento de errores</span><span class="sxs-lookup"><span data-stu-id="9971a-122">Error Handling</span></span>|<span data-ttu-id="9971a-123">Necesita proporcionar resistencia ante los cortes de la red y los errores de comunicación</span><span class="sxs-lookup"><span data-stu-id="9971a-123">You need to provide resilience to network outages and communication failures</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="9971a-124">Aunque muchos de los escenarios presentados son específicos de ciertas necesidades empresariales o requisitos de procesamiento, la planificación de soporte de actualizaciones dinámicas y el empleo del control de errores se pueden considerar a menudo como prácticas recomendadas, ya que le permiten modificar la lógica de enrutamiento en el tiempo de ejecución y recuperarse de errores transitorios de la red y errores de comunicación.</span><span class="sxs-lookup"><span data-stu-id="9971a-124">While many of the scenarios presented are specific to certain business needs or processing requirements, planning to support dynamic updates and utilizing error handling can often be considered as best practices as they allow you to modify routing logic at runtime and recover from transient network and communication failures.</span></span>  
  
### <a name="service-versioning"></a><span data-ttu-id="9971a-125">Control de versiones del servicio</span><span class="sxs-lookup"><span data-stu-id="9971a-125">Service Versioning</span></span>  
 <span data-ttu-id="9971a-126">Al introducir una nueva versión de un servicio, a menudo debe mantener la versión anterior hasta que todos los clientes hayan pasado al nuevo servicio.</span><span class="sxs-lookup"><span data-stu-id="9971a-126">When introducing a new version of a service, you must often maintain the previous version until all clients have transitioned to the new service.</span></span> <span data-ttu-id="9971a-127">Esto es especialmente importante si el servicio es un proceso de ejecución prolongada que tarda días, semanas o, incluso, meses completarse.</span><span class="sxs-lookup"><span data-stu-id="9971a-127">This is especially critical if the service is a long-running process that takes days, weeks, or even months to complete.</span></span> <span data-ttu-id="9971a-128">Normalmente, esto requiere la implementación de una nueva dirección de extremo para el nuevo servicio mientras se mantiene el extremo original para la versión anterior.</span><span class="sxs-lookup"><span data-stu-id="9971a-128">Usually this requires implementing a new endpoint address for the new service while maintaining the original endpoint for the previous version.</span></span>  
  
 <span data-ttu-id="9971a-129">Utilizando el servicio de enrutamiento, puede exponer un punto de conexión para recibir mensajes de aplicaciones cliente y, a continuación, enrutar cada mensaje a la versión de servicio correcta en función del contenido del mensaje.</span><span class="sxs-lookup"><span data-stu-id="9971a-129">By using the Routing Service, you can expose one endpoint to receive messages from client applications and then route each message to the correct service version based on the message content.</span></span> <span data-ttu-id="9971a-130">La implementación más básica implica agregar un encabezado personalizado al mensaje que indica la versión del servicio con el que se procesará el mensaje.</span><span class="sxs-lookup"><span data-stu-id="9971a-130">The most basic implementation involves adding a custom header to the message that indicates the version of the service that the message is to be processed by.</span></span> <span data-ttu-id="9971a-131">El servicio de enrutamiento puede utilizar XPathMessageFilter para inspeccionar cada mensaje con el fin de detectar la presencia del encabezado personalizado y enrutar el mensaje al punto de conexión de destino adecuado.</span><span class="sxs-lookup"><span data-stu-id="9971a-131">The Routing Service can use the XPathMessageFilter to inspect each message for the presence of the custom header and route the message to the appropriate destination endpoint.</span></span>  
  
 <span data-ttu-id="9971a-132">Para conocer los pasos utilizados para crear una configuración de control de versiones de servicio, consulte [How to: Service Versioning](how-to-service-versioning.md).</span><span class="sxs-lookup"><span data-stu-id="9971a-132">For the steps used to create a service versioning configuration, see [How To: Service Versioning](how-to-service-versioning.md).</span></span>
  
### <a name="service-data-partitioning"></a><span data-ttu-id="9971a-133">Particionar datos de servicio</span><span class="sxs-lookup"><span data-stu-id="9971a-133">Service Data Partitioning</span></span>  
 <span data-ttu-id="9971a-134">Al diseñar un entorno distribuido, a menudo es conveniente repartir la carga de procesamiento entre varios equipos para proporcionar una alta disponibilidad, disminuir la carga de procesamiento en equipos individuales o proporcionar recursos dedicados para un determinado subconjunto de mensajes.</span><span class="sxs-lookup"><span data-stu-id="9971a-134">When designing a distributed environment, it is often desirable to spread processing load across multiple computers in order to provide high availability, decrease processing load on individual computers, or to provide dedicated resources for a specific subset of messages.</span></span> <span data-ttu-id="9971a-135">Aunque el servicio de enrutamiento no reemplaza una solución de equilibrio de carga dedicada, su capacidad de realizar un enrutamiento basado en el contenido se puede utilizar para enrutar de otro modo mensajes similares a destinos concretos.</span><span class="sxs-lookup"><span data-stu-id="9971a-135">While the Routing Service does not replace a dedicated load balancing solution, its ability to perform content based routing can be used to route otherwise similar messages to specific destinations.</span></span> <span data-ttu-id="9971a-136">Por ejemplo, puede tener un requisito para procesar mensajes de un cliente concreto por separado de los mensajes recibidos de otros clientes.</span><span class="sxs-lookup"><span data-stu-id="9971a-136">For example, you may have a requirement to process messages from a specific client separately from messages received from other clients.</span></span>  
  
 <span data-ttu-id="9971a-137">Para obtener información sobre los pasos utilizados para crear una configuración de particiones de datos de servicio, consulte [Cómo: crear particiones de datos de servicio](how-to-service-data-partitioning.md).</span><span class="sxs-lookup"><span data-stu-id="9971a-137">For the steps used to create a service data partitioning configuration, see [How To: Service Data Partitioning](how-to-service-data-partitioning.md).</span></span>  
  
### <a name="dynamic-routing"></a><span data-ttu-id="9971a-138">Enrutamiento dinámico</span><span class="sxs-lookup"><span data-stu-id="9971a-138">Dynamic Routing</span></span>  
 <span data-ttu-id="9971a-139">A menudo, es conveniente modificar la configuración de enrutamiento para satisfacer las cambiantes necesidades empresariales, como agregar una ruta a una versión más reciente de un servicio, cambiar los criterios de enrutamiento o cambiar el punto de conexión de destino de un mensaje determinado al que enruta el filtro.</span><span class="sxs-lookup"><span data-stu-id="9971a-139">Often it is desirable to modify the routing configuration to satisfy changing business needs, such as adding a route to a newer version of a service, changing routing criteria, or changing the destination endpoint a specific message that the filter routes to.</span></span> <span data-ttu-id="9971a-140">El servicio de enrutamiento le permite hacer esto a través de <xref:System.ServiceModel.Routing.RoutingExtension>, que le permite proporcionar un nuevo RoutingConfiguration durante el tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="9971a-140">The Routing Service allows you to do this through the <xref:System.ServiceModel.Routing.RoutingExtension>, which allows you to provide a new RoutingConfiguration during run time.</span></span> <span data-ttu-id="9971a-141">La nueva configuración surte efecto inmediatamente, pero solo afecta a cualquier sesión nueva procesada mediante el servicio de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="9971a-141">The new configuration takes effect immediately, but only affects any new sessions processed by the Routing Service.</span></span>  
  
 <span data-ttu-id="9971a-142">Para conocer los pasos que se usan para implementar el enrutamiento dinámico, consulte [Cómo: actualización dinámica](how-to-dynamic-update.md).</span><span class="sxs-lookup"><span data-stu-id="9971a-142">For the steps used to implement dynamic routing, see [How To: Dynamic Update](how-to-dynamic-update.md).</span></span>
  
### <a name="multicast"></a><span data-ttu-id="9971a-143">Multidifusión</span><span class="sxs-lookup"><span data-stu-id="9971a-143">Multicast</span></span>  
 <span data-ttu-id="9971a-144">Al enrutar mensajes, normalmente enruta cada mensaje a un extremo de destino concreto.</span><span class="sxs-lookup"><span data-stu-id="9971a-144">When routing messages, usually you routing each message to one specific destination endpoint.</span></span>  <span data-ttu-id="9971a-145">Sin embargo, algunas veces, puede necesitar enrutar una copia del mensaje a varios puntos de conexión de destino.</span><span class="sxs-lookup"><span data-stu-id="9971a-145">However, you may occasionally need to route a copy of the message to multiple destination endpoints.</span></span> <span data-ttu-id="9971a-146">Para realizar un enrutamiento de multidifusión, deben cumplirse las siguientes condiciones:</span><span class="sxs-lookup"><span data-stu-id="9971a-146">To perform multicast routing, the following conditions must be true:</span></span>  
  
- <span data-ttu-id="9971a-147">La forma del canal no puede ser de solicitud-respuesta (aunque sí unidireccional o dúplex), porque, en caso de solicitud-respuesta, la aplicación cliente solo puede recibir una respuesta para cada solicitud.</span><span class="sxs-lookup"><span data-stu-id="9971a-147">The channel shape must not be request-reply (though it may be one-way or duplex,) because request-reply mandates that only one reply can be received by the client application in response to the request.</span></span>  
  
- <span data-ttu-id="9971a-148">Varios filtros deben devolver **true** al evaluar el mensaje.</span><span class="sxs-lookup"><span data-stu-id="9971a-148">Multiple filters must return **true** when evaluating the message.</span></span>  
  
 <span data-ttu-id="9971a-149">Si se cumplen estas condiciones, cada punto de conexión de destino asociado a un filtro que devuelva un valor verdadero recibirá una copia del mensaje.</span><span class="sxs-lookup"><span data-stu-id="9971a-149">If these conditions are met, each destination endpoint that is associated with a filter that returns true will receive a copy of the message.</span></span>  
  
### <a name="protocol-bridging"></a><span data-ttu-id="9971a-150">Puente protocolar</span><span class="sxs-lookup"><span data-stu-id="9971a-150">Protocol Bridging</span></span>  
 <span data-ttu-id="9971a-151">Al enrutar mensajes entre protocolos de SOAP diferentes entre sí, el servicio de enrutamiento utiliza API de WCF para convertir el mensaje de un protocolo al otro.</span><span class="sxs-lookup"><span data-stu-id="9971a-151">When routing messages between dissimilar SOAP protocols, the Routing Service uses WCF APIs to convert the message from one protocol to the other.</span></span> <span data-ttu-id="9971a-152">Esto se produce automáticamente cuando el extremo de servicio expuesto por el servicio de enrutamiento usa un protocolo diferente al de los extremos de cliente a los que se enrutan los mensajes.</span><span class="sxs-lookup"><span data-stu-id="9971a-152">This occurs automatically when the service endpoint(s) exposed by the Routing Service use a different protocol than the client endpoint(s) that messages are routed to.</span></span> <span data-ttu-id="9971a-153">Es posible deshabilitar este comportamiento si los protocolos en uso no son estándar; sin embargo, en ese caso, debe proporcionar su propio código de puente.</span><span class="sxs-lookup"><span data-stu-id="9971a-153">It is possible to disable this behavior if the protocols in use are not standard; however, you must then provide your own bridging code.</span></span>
  
### <a name="error-handling"></a><span data-ttu-id="9971a-154">Tratamiento de errores</span><span class="sxs-lookup"><span data-stu-id="9971a-154">Error Handling</span></span>  
 <span data-ttu-id="9971a-155">En un entorno distribuido, no es raro encontrar errores transitorios de red o errores de comunicación.</span><span class="sxs-lookup"><span data-stu-id="9971a-155">In a distributed environment, it is not uncommon to encounter transient network or communication failures.</span></span> <span data-ttu-id="9971a-156">Sin un servicio intermedio como el servicio de enrutamiento, la carga de administrar tales errores recae en la aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="9971a-156">Without an intermediary service such as the Routing Service, the burden of handling such failures falls on the client application.</span></span> <span data-ttu-id="9971a-157">Si la aplicación cliente no incluye una lógica concreta para realizar reintentos en caso de producirse errores de la red o errores de comunicación ni conocimiento de ubicaciones alternativas, el usuario puede encontrarse con escenarios donde un mensaje tenga que enviarse varias veces antes de ser procesado correctamente por el servicio de destino.</span><span class="sxs-lookup"><span data-stu-id="9971a-157">If the client application does not include specific logic to retry in the event of network or communication failures and knowledge of alternate locations, the user may encounter scenarios where a message must be submitted multiple times before it is successfully processed by the destination service.</span></span> <span data-ttu-id="9971a-158">Esto puede hacer que el cliente esté descontento con la aplicación, ya que se puede percibir como no confiable.</span><span class="sxs-lookup"><span data-stu-id="9971a-158">This can lead to customer dissatisfaction with the application, as it may be perceived as unreliable.</span></span>  
  
 <span data-ttu-id="9971a-159">El servicio de enrutamiento intenta solucionar este escenario proporcionando capacidades de control de errores sólidas para los mensajes que se encuentran con errores de la red o errores relacionados con la comunicación.</span><span class="sxs-lookup"><span data-stu-id="9971a-159">The Routing Service attempts to remedy this scenario by providing robust error handling capabilities for messages that encounter network or communication-related failures.</span></span> <span data-ttu-id="9971a-160">Al crear una lista de posibles extremos de destino y asociar esta lista a cada filtro de mensajes, elimina el punto de concentración de errores que se produce cuando solo hay un destino posible.</span><span class="sxs-lookup"><span data-stu-id="9971a-160">By creating a list of possible destination endpoints and associating this list with each message filter, you remove the single point of failure incurred by having only one possible destination.</span></span> <span data-ttu-id="9971a-161">En caso de error, el servicio de enrutamiento intentará entregar el mensaje al punto de conexión siguiente de la lista hasta que se entregue el mensaje, se produzca un error no relacionado con la comunicación o se hayan agotado todos los puntos de conexión.</span><span class="sxs-lookup"><span data-stu-id="9971a-161">In the event of a failure, the Routing Service will attempt to deliver the message to the next endpoint in the list until the message has been delivered, a non-communication failure occurs, or all endpoints have been exhausted.</span></span>  
  
 <span data-ttu-id="9971a-162">Para conocer los pasos utilizados para configurar el control de errores, consulte [How to: control de errores](how-to-error-handling.md).</span><span class="sxs-lookup"><span data-stu-id="9971a-162">For the steps used to configure error handling, see [How To: Error Handling](how-to-error-handling.md).</span></span>
  
### <a name="in-this-section"></a><span data-ttu-id="9971a-163">En esta sección</span><span class="sxs-lookup"><span data-stu-id="9971a-163">In This Section</span></span>  
 [<span data-ttu-id="9971a-164">Cómo Control de versiones del servicio</span><span class="sxs-lookup"><span data-stu-id="9971a-164">How To: Service Versioning</span></span>](how-to-service-versioning.md)  
  
 [<span data-ttu-id="9971a-165">Cómo Particionar datos de servicio</span><span class="sxs-lookup"><span data-stu-id="9971a-165">How To: Service Data Partitioning</span></span>](how-to-service-data-partitioning.md)  
  
 [<span data-ttu-id="9971a-166">Cómo actualización dinámica</span><span class="sxs-lookup"><span data-stu-id="9971a-166">How To: Dynamic Update</span></span>](how-to-dynamic-update.md)  
  
 [<span data-ttu-id="9971a-167">Cómo Control de errores</span><span class="sxs-lookup"><span data-stu-id="9971a-167">How To: Error Handling</span></span>](how-to-error-handling.md)  
  
## <a name="see-also"></a><span data-ttu-id="9971a-168">Vea también</span><span class="sxs-lookup"><span data-stu-id="9971a-168">See also</span></span>

- [<span data-ttu-id="9971a-169">Introducción al enrutamiento</span><span class="sxs-lookup"><span data-stu-id="9971a-169">Routing Introduction</span></span>](routing-introduction.md)
