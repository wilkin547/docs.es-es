---
title: Transferencia de mensajes por secuencias
ms.date: 03/30/2017
ms.assetid: 72a47a51-e5e7-4b76-b24a-299d51e0ae5a
ms.openlocfilehash: 4b90e5bf15f5cb1c4684a3ba224371f6cc232034
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/26/2020
ms.locfileid: "96246334"
---
# <a name="streaming-message-transfer"></a><span data-ttu-id="e207a-102">Transferencia de mensajes por secuencias</span><span class="sxs-lookup"><span data-stu-id="e207a-102">Streaming Message Transfer</span></span>

<span data-ttu-id="e207a-103">Los transportes de Windows Communication Foundation (WCF) admiten dos modos de transferencia de mensajes:</span><span class="sxs-lookup"><span data-stu-id="e207a-103">Windows Communication Foundation (WCF) transports support two modes for transferring messages:</span></span>  
  
- <span data-ttu-id="e207a-104">Las transferencias almacenadas en búfer contienen el mensaje completo en un búfer de memoria hasta que la transferencia haya finalizado.</span><span class="sxs-lookup"><span data-stu-id="e207a-104">Buffered transfers hold the entire message in a memory buffer until the transfer is complete.</span></span> <span data-ttu-id="e207a-105">Un mensaje almacenado en búfer debe entregarse por completo antes de que un receptor pueda leerlo.</span><span class="sxs-lookup"><span data-stu-id="e207a-105">A buffered message must be completely delivered before a receiver can read it.</span></span>  
  
- <span data-ttu-id="e207a-106">Las transferencias por secuencias exponen el mensaje como una secuencia.</span><span class="sxs-lookup"><span data-stu-id="e207a-106">Streamed transfers expose the message as a stream.</span></span> <span data-ttu-id="e207a-107">El receptor inicia a procesar el mensaje antes de que se haya entregado por completo.</span><span class="sxs-lookup"><span data-stu-id="e207a-107">The receiver starts processing the message before it is completely delivered.</span></span>  
  
- <span data-ttu-id="e207a-108">Las transferencias por secuencias pueden mejorar la escalabilidad de un servicio eliminando el requisito de grandes búferes de memoria.</span><span class="sxs-lookup"><span data-stu-id="e207a-108">Streamed transfers can improve the scalability of a service by eliminating the requirement for large memory buffers.</span></span> <span data-ttu-id="e207a-109">La mejora de la escalabilidad mediante el cambio del modo de transferencia depende del tamaño de los mensajes que se estén transfiriendo.</span><span class="sxs-lookup"><span data-stu-id="e207a-109">Whether changing the transfer mode improves scalability depends on the size of the messages being transferred.</span></span> <span data-ttu-id="e207a-110">Los tamaños de mensaje grandes favorecen el uso de transferencias por secuencias.</span><span class="sxs-lookup"><span data-stu-id="e207a-110">Large message sizes favor using streamed transfers.</span></span>  
  
 <span data-ttu-id="e207a-111">De forma predeterminada, los transportes HTTP, TCP/IP, y de canalización con nombre usan transferencias almacenadas en búfer.</span><span class="sxs-lookup"><span data-stu-id="e207a-111">By default, the HTTP, TCP/IP, and named pipe transports use buffered transfers.</span></span> <span data-ttu-id="e207a-112">En este documento se describe cómo intercambiar estos transportes desde un modo de transferencia almacenado en búfer hasta otro de transferencia por secuencias y las consecuencias de ello.</span><span class="sxs-lookup"><span data-stu-id="e207a-112">This document describes how to switch these transports from a buffered to streamed transfer mode and the consequences of doing so.</span></span>  
  
## <a name="enabling-streamed-transfers"></a><span data-ttu-id="e207a-113">Habilitación de transferencias por secuencias</span><span class="sxs-lookup"><span data-stu-id="e207a-113">Enabling Streamed Transfers</span></span>  

 <span data-ttu-id="e207a-114">La selección entre los modos de transferencia mediante búfer y mediante secuencias se realiza en el elemento de enlace del transporte.</span><span class="sxs-lookup"><span data-stu-id="e207a-114">Selecting between buffered and streamed transfer modes is done on the binding element of the transport.</span></span> <span data-ttu-id="e207a-115">El elemento de enlace tiene una propiedad <xref:System.ServiceModel.TransferMode> que puede establecerse en `Buffered`, `Streamed`, `StreamedRequest`o `StreamedResponse`.</span><span class="sxs-lookup"><span data-stu-id="e207a-115">The binding element has a <xref:System.ServiceModel.TransferMode> property that can be set to `Buffered`, `Streamed`, `StreamedRequest`, or `StreamedResponse`.</span></span> <span data-ttu-id="e207a-116">Establecer el modo de transferencia en `Streamed` habilita la comunicación de transmisión por secuencias en ambas direcciones.</span><span class="sxs-lookup"><span data-stu-id="e207a-116">Setting the transfer mode to `Streamed` enables streaming communication in both directions.</span></span> <span data-ttu-id="e207a-117">Establecer el modo de transferencia en `StreamedRequest` o `StreamedResponse` habilita la comunicación de la transmisión por secuencias solo en la dirección indicada.</span><span class="sxs-lookup"><span data-stu-id="e207a-117">Setting the transfer mode to `StreamedRequest` or `StreamedResponse` enables streaming communication in the indicated direction only.</span></span>  
  
 <span data-ttu-id="e207a-118">Los enlaces <xref:System.ServiceModel.BasicHttpBinding>, <xref:System.ServiceModel.NetTcpBinding>, y <xref:System.ServiceModel.NetNamedPipeBinding> exponen la propiedad <xref:System.ServiceModel.TransferMode>.</span><span class="sxs-lookup"><span data-stu-id="e207a-118">The <xref:System.ServiceModel.BasicHttpBinding>, <xref:System.ServiceModel.NetTcpBinding>, and <xref:System.ServiceModel.NetNamedPipeBinding> bindings expose the <xref:System.ServiceModel.TransferMode> property.</span></span> <span data-ttu-id="e207a-119">Para otros transportes, debe crear un enlace personalizado para establecer el modo de transferencia.</span><span class="sxs-lookup"><span data-stu-id="e207a-119">For other transports, you must create a custom binding to set the transfer mode.</span></span>  
  
 <span data-ttu-id="e207a-120">La decisión de utilizar transferencias almacenadas en búfer o transmitidas es una decisión local del punto de conexión.</span><span class="sxs-lookup"><span data-stu-id="e207a-120">The decision to use either buffered or streamed transfers is a local decision of the endpoint.</span></span> <span data-ttu-id="e207a-121">En los transportes HTTP, el modo de transferencia no se propaga a través de una conexión o a los servidores y otros intermediarios.</span><span class="sxs-lookup"><span data-stu-id="e207a-121">For HTTP transports, the transfer mode does not propagate across a connection, or to servers and other intermediaries.</span></span> <span data-ttu-id="e207a-122">Establecer el modo de transferencia no se refleja en la descripción de la interfaz de servicio.</span><span class="sxs-lookup"><span data-stu-id="e207a-122">Setting the transfer mode is not reflected in the description of the service interface.</span></span> <span data-ttu-id="e207a-123">Después de generar una clase de cliente para un servicio, debe modificar el archivo de configuración de los servicios pensados para ser utilizados con transferencias por secuencias para establecer el modo.</span><span class="sxs-lookup"><span data-stu-id="e207a-123">After generating a client class for a service, you must edit the configuration file for services intended to be used with streamed transfers to set the mode.</span></span> <span data-ttu-id="e207a-124">En los transportes con canalizaciones con nombre y TCP, el modo de transferencia se propaga como una aserción de directiva.</span><span class="sxs-lookup"><span data-stu-id="e207a-124">For TCP and named pipe transports, the transfer mode is propagated as a policy assertion.</span></span>  
  
 <span data-ttu-id="e207a-125">Para obtener ejemplos de código, consulte [Cómo: habilitar el streaming](how-to-enable-streaming.md).</span><span class="sxs-lookup"><span data-stu-id="e207a-125">For code samples, see [How to: Enable Streaming](how-to-enable-streaming.md).</span></span>  
  
## <a name="enabling-asynchronous-streaming"></a><span data-ttu-id="e207a-126">Habilitar la transmisión de datos asincrónica</span><span class="sxs-lookup"><span data-stu-id="e207a-126">Enabling Asynchronous Streaming</span></span>  

 <span data-ttu-id="e207a-127">Para habilitar el streaming asincrónico, agregue el comportamiento de punto de conexión <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> al host de servicio y establezca la propiedad <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> en `true`.</span><span class="sxs-lookup"><span data-stu-id="e207a-127">To enable asynchronous streaming, add the  <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> endpoint behavior to the service host and set its <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> property to `true`.</span></span>  
  
 <span data-ttu-id="e207a-128">Esta versión de WCF también agrega la capacidad de auténtica transmisión de datos asincrónica en el lado de envío.</span><span class="sxs-lookup"><span data-stu-id="e207a-128">This version of WCF also adde the capability of true asynchronous streaming on the send side.</span></span> <span data-ttu-id="e207a-129">Esto mejora la escalabilidad del servicio en escenarios donde transmite por secuencias mensajes para varios clientes, algunos de los cuales son lentos en la lectura; posiblemente debido a la congestión de red o que no leen en absoluto.</span><span class="sxs-lookup"><span data-stu-id="e207a-129">This improves scalability of the service in scenarios where it is streaming messages to multiple clients some of which are slow in reading; possibly due to network congestion or are not reading at all.</span></span> <span data-ttu-id="e207a-130">En estos escenarios WCF ya bloquea los subprocesos individuales en el servicio por cliente.</span><span class="sxs-lookup"><span data-stu-id="e207a-130">In these scenarios WCF no longer blocks individual threads on the service per client.</span></span> <span data-ttu-id="e207a-131">Esto garantiza que el servicio pueda procesar muchos más clientes, mejorando así la escalabilidad del servicio.</span><span class="sxs-lookup"><span data-stu-id="e207a-131">This ensures that the service is able to process many more clients thereby improving the scalability of the service.</span></span>  
  
## <a name="restrictions-on-streamed-transfers"></a><span data-ttu-id="e207a-132">Restricciones en transferencias por secuencias</span><span class="sxs-lookup"><span data-stu-id="e207a-132">Restrictions on Streamed Transfers</span></span>  

 <span data-ttu-id="e207a-133">El uso del modo de transferencia por secuencias hace que el tiempo de ejecución exija restricciones adicionales.</span><span class="sxs-lookup"><span data-stu-id="e207a-133">Using the streamed transfer mode causes the run time to enforce additional restrictions.</span></span>  
  
 <span data-ttu-id="e207a-134">Las operaciones que se producen en un transporte por secuencias pueden tener un contrato con, como mucho, un parámetro de entrada o de salida.</span><span class="sxs-lookup"><span data-stu-id="e207a-134">Operations that occur across a streamed transport can have a contract with at most one input or output parameter.</span></span> <span data-ttu-id="e207a-135">Ese parámetro corresponde al cuerpo completo del mensaje y ha de ser un <xref:System.ServiceModel.Channels.Message>, un tipo derivado de <xref:System.IO.Stream>, o una implementación <xref:System.Xml.Serialization.IXmlSerializable>.</span><span class="sxs-lookup"><span data-stu-id="e207a-135">That parameter corresponds to the entire body of the message and must be a <xref:System.ServiceModel.Channels.Message>, a derived type of <xref:System.IO.Stream>, or an <xref:System.Xml.Serialization.IXmlSerializable> implementation.</span></span> <span data-ttu-id="e207a-136">Tener un valor devuelto para una operación equivale a tener un parámetro de salida.</span><span class="sxs-lookup"><span data-stu-id="e207a-136">Having a return value for an operation is equivalent to having an output parameter.</span></span>  
  
 <span data-ttu-id="e207a-137">Algunas características de WCF, como la mensajería de confianza, las transacciones y la seguridad de nivel de mensaje SOAP, se basan en el almacenamiento en búfer de mensajes para las transmisiones.</span><span class="sxs-lookup"><span data-stu-id="e207a-137">Some WCF features, such as reliable messaging, transactions, and SOAP message-level security, rely on buffering messages for transmissions.</span></span> <span data-ttu-id="e207a-138">El uso de estas características puede reducir o eliminar las ventajas de rendimiento ganadas mediante la transmisión por secuencias.</span><span class="sxs-lookup"><span data-stu-id="e207a-138">Using these features may reduce or eliminate the performance benefits gained by using streaming.</span></span> <span data-ttu-id="e207a-139">Para proteger un transporte por secuencias, utilice la seguridad de nivel de transporte únicamente o utilice la seguridad de nivel de transporte más la seguridad de mensaje de solo autenticación.</span><span class="sxs-lookup"><span data-stu-id="e207a-139">To secure a streamed transport, use transport-level security only or use transport-level security plus authentication-only message security.</span></span>  
  
 <span data-ttu-id="e207a-140">Los encabezados SOAP siempre están almacenados en búfer, incluso cuando el modo de transferencia es por secuencias.</span><span class="sxs-lookup"><span data-stu-id="e207a-140">SOAP headers are always buffered, even when the transfer mode is set to streamed.</span></span> <span data-ttu-id="e207a-141">Los encabezados de un mensaje no deben superar el tamaño de la cuota de transporte `MaxBufferSize`.</span><span class="sxs-lookup"><span data-stu-id="e207a-141">The headers for a message must not exceed the size of the `MaxBufferSize` transport quota.</span></span> <span data-ttu-id="e207a-142">Para obtener más información acerca de esta configuración, consulte [cuotas de transporte](transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="e207a-142">For more information about this setting, see [Transport Quotas](transport-quotas.md).</span></span>  
  
## <a name="differences-between-buffered-and-streamed-transfers"></a><span data-ttu-id="e207a-143">Diferencias entre las transferencias almacenadas en búfer y las transferencias por secuencias</span><span class="sxs-lookup"><span data-stu-id="e207a-143">Differences Between Buffered and Streamed Transfers</span></span>  

 <span data-ttu-id="e207a-144">Si se cambia el modo de transferencia de almacenado en búfer a por secuencias, también se cambia la forma del canal nativo de transportes de canalización con nombre y TCP.</span><span class="sxs-lookup"><span data-stu-id="e207a-144">Changing the transfer mode from buffered to streamed also changes the native channel shape of the TCP and named pipe transports.</span></span> <span data-ttu-id="e207a-145">Para transferencias almacenadas en búfer, la forma del canal nativo es <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span><span class="sxs-lookup"><span data-stu-id="e207a-145">For buffered transfers, the native channel shape is <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span></span> <span data-ttu-id="e207a-146">Para las transferencias por secuencias, los canales nativos son <xref:System.ServiceModel.Channels.IRequestChannel> y <xref:System.ServiceModel.Channels.IReplyChannel>.</span><span class="sxs-lookup"><span data-stu-id="e207a-146">For streamed transfers, the native channels are <xref:System.ServiceModel.Channels.IRequestChannel> and <xref:System.ServiceModel.Channels.IReplyChannel>.</span></span> <span data-ttu-id="e207a-147">Al cambiar el modo de transferencia en una aplicación existente que utiliza estos transportes directamente (es decir, no a través de un contrato de servicios), requiere el cambio de la forma del canal esperada para los generadores de canales y agentes de escucha.</span><span class="sxs-lookup"><span data-stu-id="e207a-147">Changing the transfer mode in an existing application that uses these transports directly (that is, not through a service contract) requires changing the expected channel shape for channel factories and listeners.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e207a-148">Vea también</span><span class="sxs-lookup"><span data-stu-id="e207a-148">See also</span></span>

- [<span data-ttu-id="e207a-149">Procedimiento para habilitar el streaming</span><span class="sxs-lookup"><span data-stu-id="e207a-149">How to: Enable Streaming</span></span>](how-to-enable-streaming.md)
