---
title: Sesiones, creación de instancias y simultaneidad
ms.date: 03/30/2017
ms.assetid: 50797a3b-7678-44ed-8138-49ac1602f35b
ms.openlocfilehash: a7466d819e15f3bfe8def2d9407dcf2c6e0c7346
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/12/2020
ms.locfileid: "79184443"
---
# <a name="sessions-instancing-and-concurrency"></a><span data-ttu-id="4f0a8-102">Sesiones, creación de instancias y simultaneidad</span><span class="sxs-lookup"><span data-stu-id="4f0a8-102">Sessions, Instancing, and Concurrency</span></span>
<span data-ttu-id="4f0a8-103">Una *sesión* es una correlación de todos los mensajes enviados entre dos extremos.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-103">A *session* is a correlation of all messages sent between two endpoints.</span></span> <span data-ttu-id="4f0a8-104">*Creación de instancias* hace referencia al control de la vida de los objetos de servicio definidos por el usuario y sus objetos <xref:System.ServiceModel.InstanceContext> relacionados.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-104">*Instancing* refers to controlling the lifetime of user-defined service objects and their related <xref:System.ServiceModel.InstanceContext> objects.</span></span> <span data-ttu-id="4f0a8-105">La*simultaneidad* es el término dado al control del número de subprocesos que se ejecutan al mismo tiempo en un <xref:System.ServiceModel.InstanceContext> .</span><span class="sxs-lookup"><span data-stu-id="4f0a8-105">*Concurrency* is the term given to the control of the number of threads executing in an <xref:System.ServiceModel.InstanceContext> at the same time.</span></span>  
  
 <span data-ttu-id="4f0a8-106">En este tema se describen estos valores, cómo utilizarlos y las diversas interacciones entre ellos.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-106">This topic describes these settings, how to use them, and the various interactions between them.</span></span>  
  
## <a name="sessions"></a><span data-ttu-id="4f0a8-107">Sesiones</span><span class="sxs-lookup"><span data-stu-id="4f0a8-107">Sessions</span></span>  
 <span data-ttu-id="4f0a8-108">Cuando un contrato de servicios establece la propiedad <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> en <xref:System.ServiceModel.SessionMode.Required?displayProperty=nameWithType>, ese contrato está diciendo que todas las llamadas (es decir, los intercambios de mensajes subyacentes que admiten las llamadas) deben formar parte de la misma conversación.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-108">When a service contract sets the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.SessionMode.Required?displayProperty=nameWithType>, that contract is saying that all calls (that is, the underlying message exchanges that support the calls) must be part of the same conversation.</span></span> <span data-ttu-id="4f0a8-109">Si un contrato especifica que permite sesiones pero no requiere una, los clientes pueden conectarse y establecer o no una sesión.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-109">If a contract specifies that it allows sessions but does not require one, clients can connect and either establish a session or not.</span></span> <span data-ttu-id="4f0a8-110">Si la sesión finaliza y se envía un mensaje se envía sobre el mismo canal basado en sesión, se produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-110">If the session ends and a message is sent over the same session-based channel an exception is thrown.</span></span>  
  
 <span data-ttu-id="4f0a8-111">Las sesiones WCF tienen las siguientes características conceptuales principales:</span><span class="sxs-lookup"><span data-stu-id="4f0a8-111">WCF sessions have the following main conceptual features:</span></span>  
  
- <span data-ttu-id="4f0a8-112">La aplicación que realiza la llamada inicia y finaliza explícitamente las sesiones.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-112">They are explicitly initiated and terminated by the calling application.</span></span>  
  
- <span data-ttu-id="4f0a8-113">Los mensajes entregados durante una sesión se procesan en el orden de recepción.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-113">Messages delivered during a session are processed in the order in which they are received.</span></span>  
  
- <span data-ttu-id="4f0a8-114">Las sesiones correlacionan un grupo de mensajes en una conversación.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-114">Sessions correlate a group of messages into a conversation.</span></span> <span data-ttu-id="4f0a8-115">El significado de esa correlación es una abstracción.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-115">The meaning of that correlation is an abstraction.</span></span> <span data-ttu-id="4f0a8-116">Por ejemplo, un canal basado en sesión puede correlacionar mensajes basados en una conexión de red compartida, mientras que otro canal basado en sesión puede correlacionar mensajes basados en una etiqueta compartida en el cuerpo del mensaje.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-116">For instance, one session-based channel may correlate messages based on a shared network connection while another session-based channel may correlate messages based on a shared tag in the message body.</span></span> <span data-ttu-id="4f0a8-117">Las características que se pueden derivar a partir de la sesión dependen de la naturaleza de la correlación.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-117">The features that can be derived from the session depend on the nature of the correlation.</span></span>  
  
- <span data-ttu-id="4f0a8-118">No hay ningún almacén de datos general asociado a una sesión WCF.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-118">There is no general data store associated with a WCF session.</span></span>  
  
 <span data-ttu-id="4f0a8-119">Si está familiarizado <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> con la clase en ASP.NET aplicaciones y la funcionalidad que proporciona, es posible que observe las siguientes diferencias entre ese tipo de sesión y sesiones WCF:</span><span class="sxs-lookup"><span data-stu-id="4f0a8-119">If you are familiar with the <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> class in ASP.NET applications and the functionality it provides, you might notice the following differences between that kind of session and WCF sessions:</span></span>  
  
- <span data-ttu-id="4f0a8-120">ASP.NET sesiones siempre se inician en el servidor.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-120">ASP.NET sessions are always server-initiated.</span></span>  
  
- <span data-ttu-id="4f0a8-121">ASP.NET sesiones están implícitamente desordenadas.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-121">ASP.NET sessions are implicitly unordered.</span></span>  
  
- <span data-ttu-id="4f0a8-122">ASP.NET sesiones proporcionan un mecanismo general de almacenamiento de datos en todas las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-122">ASP.NET sessions provide a general data storage mechanism across requests.</span></span>  
  
 <span data-ttu-id="4f0a8-123">Las aplicaciones de cliente y servicio interactúan con sesiones de maneras diferentes.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-123">Client applications and service applications interact with sessions in different ways.</span></span> <span data-ttu-id="4f0a8-124">Las aplicaciones cliente inician sesiones y, a continuación, reciben y procesan los mensajes enviados dentro de la sesión.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-124">Client applications initiate sessions and then receive and process the messages sent within the session.</span></span> <span data-ttu-id="4f0a8-125">Las aplicaciones de servicio pueden utilizar sesiones como un punto de la extensibilidad para agregar comportamiento adicional.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-125">Service applications can use sessions as an extensibility point to add additional behavior.</span></span> <span data-ttu-id="4f0a8-126">Esto se realiza trabajando directamente con <xref:System.ServiceModel.InstanceContext> o implementando un proveedor de contexto de instancia personalizado.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-126">This is done by working directly with the <xref:System.ServiceModel.InstanceContext> or implementing a custom instance context provider.</span></span>  
  
## <a name="instancing"></a><span data-ttu-id="4f0a8-127">Creación de instancias</span><span class="sxs-lookup"><span data-stu-id="4f0a8-127">Instancing</span></span>  
 <span data-ttu-id="4f0a8-128">El comportamiento de la creación de instancias (establecido mediante el uso de la propiedad <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> ) controla cómo <xref:System.ServiceModel.InstanceContext> se crea en respuesta a los mensajes entrantes.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-128">The instancing behavior (set by using the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property) controls how the <xref:System.ServiceModel.InstanceContext> is created in response to incoming messages.</span></span> <span data-ttu-id="4f0a8-129">De forma predeterminada, <xref:System.ServiceModel.InstanceContext> está asociado a un objeto de servicio definido por el usuario, estableciendo así (en el caso predeterminado) la propiedad <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> , también se controla la creación de instancias de objetos de servicio definidos por el usuario.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-129">By default, each <xref:System.ServiceModel.InstanceContext> is associated with one user-defined service object, so (in the default case) setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> property also controls the instancing of user-defined service objects.</span></span> <span data-ttu-id="4f0a8-130">La enumeración <xref:System.ServiceModel.InstanceContextMode> define los modos de creación de instancias.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-130">The <xref:System.ServiceModel.InstanceContextMode> enumeration defines the instancing modes.</span></span>  
  
 <span data-ttu-id="4f0a8-131">Los siguientes modos de creación de instancias están disponibles:</span><span class="sxs-lookup"><span data-stu-id="4f0a8-131">The following instancing modes are available:</span></span>  
  
- <span data-ttu-id="4f0a8-132"><xref:System.ServiceModel.InstanceContextMode.PerCall>: Un nuevo <xref:System.ServiceModel.InstanceContext> (y, por consiguiente, objeto de servicio) se crea para cada solicitud de cliente.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-132"><xref:System.ServiceModel.InstanceContextMode.PerCall>: A new <xref:System.ServiceModel.InstanceContext> (and therefore service object) is created for each client request.</span></span>  
  
- <span data-ttu-id="4f0a8-133"><xref:System.ServiceModel.InstanceContextMode.PerSession>: Un nuevo <xref:System.ServiceModel.InstanceContext> (y, por consiguiente, objeto de servicio) se crea para cada nueva sesión del cliente y se mantiene durante el tiempo que dure esa sesión (esto requiere un enlace que admita sesiones).</span><span class="sxs-lookup"><span data-stu-id="4f0a8-133"><xref:System.ServiceModel.InstanceContextMode.PerSession>: A new <xref:System.ServiceModel.InstanceContext> (and therefore service object) is created for each new client session and maintained for the lifetime of that session (this requires a binding that supports sessions).</span></span>  
  
- <span data-ttu-id="4f0a8-134"><xref:System.ServiceModel.InstanceContextMode.Single>: Un <xref:System.ServiceModel.InstanceContext> único (y, por consiguiente, objeto de servicio) administra todas las solicitudes de cliente durante la vida de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-134"><xref:System.ServiceModel.InstanceContextMode.Single>: A single <xref:System.ServiceModel.InstanceContext> (and therefore service object) handles all client requests for the lifetime of the application.</span></span>  
  
 <span data-ttu-id="4f0a8-135">El ejemplo de código siguiente muestra el valor predeterminado de <xref:System.ServiceModel.InstanceContextMode> , <xref:System.ServiceModel.InstanceContextMode.PerSession> que se establecen de manera explícita en una clase de servicio.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-135">The following code example shows the default <xref:System.ServiceModel.InstanceContextMode> value, <xref:System.ServiceModel.InstanceContextMode.PerSession> being explicitly set on a service class.</span></span>  
  
```csharp  
[ServiceBehavior(InstanceContextMode=InstanceContextMode.PerSession)]
public class CalculatorService : ICalculatorInstance
{
    ...  
}  
```  
  
 <span data-ttu-id="4f0a8-136">Y mientras la propiedad <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> controla la frecuencia con la que se publica el <xref:System.ServiceModel.InstanceContext> , las propiedades <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> y <xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A?displayProperty=nameWithType> controlan cuando se publica el objeto de servicio.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-136">And while the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property controls how often the <xref:System.ServiceModel.InstanceContext> is released, the <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> and <xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A?displayProperty=nameWithType> properties control when the service object is released.</span></span>  
  
### <a name="well-known-singleton-services"></a><span data-ttu-id="4f0a8-137">Servicios conocidos singleton</span><span class="sxs-lookup"><span data-stu-id="4f0a8-137">Well-Known Singleton Services</span></span>  
 <span data-ttu-id="4f0a8-138">Una variación en objetos de servicio de instancia únicos es útil a veces: puede crear un objeto de servicio y crear el host del servicio mediante ese objeto.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-138">One variation on single instance service objects is sometimes useful: you can create a service object yourself and create the service host using that object.</span></span> <span data-ttu-id="4f0a8-139">Para hacerlo, debe establecer también la propiedad <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> en <xref:System.ServiceModel.InstanceContextMode.Single> o se producirá una excepción al abrir el host del servicio.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-139">To do so, you must also set the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property to <xref:System.ServiceModel.InstanceContextMode.Single> or an exception is thrown when the service host is opened.</span></span>  
  
 <span data-ttu-id="4f0a8-140">Utilice el constructor <xref:System.ServiceModel.ServiceHost.%23ctor%28System.Object%2CSystem.Uri%5B%5D%29?displayProperty=nameWithType> para crear este tipo de servicio.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-140">Use the <xref:System.ServiceModel.ServiceHost.%23ctor%28System.Object%2CSystem.Uri%5B%5D%29?displayProperty=nameWithType> constructor to create such a service.</span></span> <span data-ttu-id="4f0a8-141">Ofrece una alternativa para implementar un <xref:System.ServiceModel.Dispatcher.IInstanceContextInitializer?displayProperty=nameWithType> personalizado cuando desee proporcionar una instancia de objeto concreta para su uso con el servicio de singleton.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-141">It provides an alternative to implementing a custom <xref:System.ServiceModel.Dispatcher.IInstanceContextInitializer?displayProperty=nameWithType> when you wish to provide a specific object instance for use by a singleton service.</span></span> <span data-ttu-id="4f0a8-142">Puede usar esta sobrecarga cuando el tipo de implementación de servicio es difícil de construir (por ejemplo, si no implementa un constructor público sin parámetros).</span><span class="sxs-lookup"><span data-stu-id="4f0a8-142">You can use this overload when your service implementation type is difficult to construct (for example, if it does not implement a parameterless public constructor).</span></span>  
  
 <span data-ttu-id="4f0a8-143">Tenga en cuenta que cuando se proporciona un objeto a este constructor, algunas características relacionadas con el comportamiento de creación de instancias de Windows Communication Foundation (WCF) funcionan de forma diferente.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-143">Note that when an object is provided to this constructor, some features related to the Windows Communication Foundation (WCF) instancing behavior work differently.</span></span> <span data-ttu-id="4f0a8-144">Por ejemplo, llamar a <xref:System.ServiceModel.InstanceContext.ReleaseServiceInstance%2A?displayProperty=nameWithType> , no tiene ningún efecto cuando se proporciona una instancia de objeto singleton.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-144">For example, calling <xref:System.ServiceModel.InstanceContext.ReleaseServiceInstance%2A?displayProperty=nameWithType> has no effect when a singleton object instance is provided.</span></span> <span data-ttu-id="4f0a8-145">De igual forma, se omite cualquier otro mecanismo de publicación de instancia.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-145">Similarly, any other instance-release mechanism is ignored.</span></span> <span data-ttu-id="4f0a8-146"><xref:System.ServiceModel.ServiceHost> siempre se comporta como si la propiedad <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> estuviera definida en <xref:System.ServiceModel.ReleaseInstanceMode.None?displayProperty=nameWithType> para todas las operaciones.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-146">The <xref:System.ServiceModel.ServiceHost> always behaves as if the <xref:System.ServiceModel.OperationBehaviorAttribute.ReleaseInstanceMode%2A?displayProperty=nameWithType> property is set to <xref:System.ServiceModel.ReleaseInstanceMode.None?displayProperty=nameWithType> for all operations.</span></span>  
  
### <a name="sharing-instancecontext-objects"></a><span data-ttu-id="4f0a8-147">Uso compartido de objetos InstanceContext</span><span class="sxs-lookup"><span data-stu-id="4f0a8-147">Sharing InstanceContext Objects</span></span>  
 <span data-ttu-id="4f0a8-148">También puede controlar que canal con sesión o llamada se asocia a qué objeto <xref:System.ServiceModel.InstanceContext> realizando esa asociación usted mismo.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-148">You can also control which sessionful channel or call is associated with which <xref:System.ServiceModel.InstanceContext> object by performing that association yourself.</span></span>  
  
## <a name="concurrency"></a><span data-ttu-id="4f0a8-149">Simultaneidad</span><span class="sxs-lookup"><span data-stu-id="4f0a8-149">Concurrency</span></span>  
 <span data-ttu-id="4f0a8-150">La simultaneidad es el control del número de subprocesos activos en <xref:System.ServiceModel.InstanceContext> en cualquier un momento.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-150">Concurrency is the control of the number of threads active in an <xref:System.ServiceModel.InstanceContext> at any one time.</span></span> <span data-ttu-id="4f0a8-151">Esto se controla utilizando <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> con la enumeración <xref:System.ServiceModel.ConcurrencyMode> .</span><span class="sxs-lookup"><span data-stu-id="4f0a8-151">This is controlled by using the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A?displayProperty=nameWithType> with the <xref:System.ServiceModel.ConcurrencyMode> enumeration.</span></span>  
  
 <span data-ttu-id="4f0a8-152">Los tres modos de simultaneidad siguientes están disponibles:</span><span class="sxs-lookup"><span data-stu-id="4f0a8-152">The following three concurrency modes are available:</span></span>  
  
- <span data-ttu-id="4f0a8-153"><xref:System.ServiceModel.ConcurrencyMode.Single>: cada contexto de instancia puede tener a la vez un máximo de un subproceso procesando mensajes en el contexto de la instancia.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-153"><xref:System.ServiceModel.ConcurrencyMode.Single>: Each instance context is allowed to have a maximum of one thread processing messages in the instance context at a time.</span></span> <span data-ttu-id="4f0a8-154">El resto de subprocesos que deseen utilizar el mismo contexto de instancia se deben bloquear hasta que el subproceso original salga del contexto de la instancia.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-154">Other threads wishing to use the same instance context must block until the original thread exits the instance context.</span></span>  
  
- <span data-ttu-id="4f0a8-155"><xref:System.ServiceModel.ConcurrencyMode.Multiple>: cada instancia de servicio puede tener varios subprocesos procesando mensajes al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-155"><xref:System.ServiceModel.ConcurrencyMode.Multiple>: Each service instance can have multiple threads processing messages concurrently.</span></span> <span data-ttu-id="4f0a8-156">La implementación del servicio debe ser segura para los subprocesos para utilizar este modo de simultaneidad.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-156">The service implementation must be thread-safe to use this concurrency mode.</span></span>  
  
- <span data-ttu-id="4f0a8-157"><xref:System.ServiceModel.ConcurrencyMode.Reentrant>: cada instancia de servicio procesa a la vez un mensaje, pero acepta llamadas de operación reentrantes.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-157"><xref:System.ServiceModel.ConcurrencyMode.Reentrant>: Each service instance processes one message at a time, but accepts re-entrant operation calls.</span></span> <span data-ttu-id="4f0a8-158">El servicio solo acepta estas llamadas cuando llama a través de un objeto de cliente WCF.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-158">The service only accepts these calls when it is calling out through a WCF client object.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4f0a8-159">Entender y desarrollar código que use de manera segura más de un subproceso puede ser difícil de escribir correctamente.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-159">Understanding and developing code that safely uses more than one thread can be difficult to write successfully.</span></span> <span data-ttu-id="4f0a8-160">Antes de utilizar los valores <xref:System.ServiceModel.ConcurrencyMode.Multiple> o <xref:System.ServiceModel.ConcurrencyMode.Reentrant> , asegúrese de que su servicio está diseñado correctamente para estos modos.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-160">Before using <xref:System.ServiceModel.ConcurrencyMode.Multiple> or <xref:System.ServiceModel.ConcurrencyMode.Reentrant> values, ensure that your service is properly designed for these modes.</span></span> <span data-ttu-id="4f0a8-161">Para más información, consulte <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A>.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-161">For more information, see <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A>.</span></span>  
  
 <span data-ttu-id="4f0a8-162">El uso de simultaneidad se relaciona con el modo de creación de instancias.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-162">The use of concurrency is related to the instancing mode.</span></span> <span data-ttu-id="4f0a8-163">En <xref:System.ServiceModel.InstanceContextMode.PerCall> la creación de instancias, la simultaneidad no <xref:System.ServiceModel.InstanceContext> es relevante, porque cada mensaje es <xref:System.ServiceModel.InstanceContext>procesado por un nuevo y, por lo tanto, nunca más de un subproceso está activo en el archivo .</span><span class="sxs-lookup"><span data-stu-id="4f0a8-163">In <xref:System.ServiceModel.InstanceContextMode.PerCall> instancing, concurrency is not relevant, because each message is processed by a new <xref:System.ServiceModel.InstanceContext> and, therefore, never more than one thread is active in the <xref:System.ServiceModel.InstanceContext>.</span></span>  
  
 <span data-ttu-id="4f0a8-164">El siguiente ejemplo de código demuestra cómo establecer la propiedad <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> en <xref:System.ServiceModel.ConcurrencyMode.Multiple>.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-164">The following code example demonstrates setting the <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> property to <xref:System.ServiceModel.ConcurrencyMode.Multiple>.</span></span>  
  
```csharp
[ServiceBehavior(ConcurrencyMode=ConcurrencyMode.Multiple, InstanceContextMode = InstanceContextMode.Single)]
public class CalculatorService : ICalculatorConcurrency
{
    ...  
}  
```  
  
## <a name="sessions-interact-with-instancecontext-settings"></a><span data-ttu-id="4f0a8-165">Las sesiones interactúan con la configuración de InstanceContext</span><span class="sxs-lookup"><span data-stu-id="4f0a8-165">Sessions Interact with InstanceContext Settings</span></span>  
 <span data-ttu-id="4f0a8-166">Las sesiones y <xref:System.ServiceModel.InstanceContext> interactúan dependiendo de la combinación del valor de la enumeración <xref:System.ServiceModel.SessionMode> en un contrato y la propiedad <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> en la implementación del servicio, que controla la asociación entre los canales y los objetos de servicio concretos.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-166">Sessions and <xref:System.ServiceModel.InstanceContext> interact depending upon the combination of the value of the <xref:System.ServiceModel.SessionMode> enumeration in a contract and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property on the service implementation, which controls the association between channels and specific service objects.</span></span>  
  
 <span data-ttu-id="4f0a8-167">La tabla siguiente muestra el resultado de un canal entrante que admite o no sesiones dada una combinación de los valores de las propiedades <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> y <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> del servicio.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-167">The following table shows the result of an incoming channel either supporting sessions or not supporting sessions given a service's combination of the values of the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property.</span></span>  
  
|<span data-ttu-id="4f0a8-168">Valor InstanceContextMode</span><span class="sxs-lookup"><span data-stu-id="4f0a8-168">InstanceContextMode value</span></span>|<xref:System.ServiceModel.SessionMode.Required>|<xref:System.ServiceModel.SessionMode.Allowed>|<xref:System.ServiceModel.SessionMode.NotAllowed>|  
|-------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="4f0a8-169">PerCall</span><span class="sxs-lookup"><span data-stu-id="4f0a8-169">PerCall</span></span>|<span data-ttu-id="4f0a8-170">- Comportamiento con canal de <xref:System.ServiceModel.InstanceContext> sesión: Una sesión y para cada llamada.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-170">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each call.</span></span><br /><span data-ttu-id="4f0a8-171">- Comportamiento con canal sin sesión: se produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-171">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="4f0a8-172">- Comportamiento con canal de <xref:System.ServiceModel.InstanceContext> sesión: Una sesión y para cada llamada.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-172">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each call.</span></span><br /><span data-ttu-id="4f0a8-173">- Comportamiento con canal <xref:System.ServiceModel.InstanceContext> sin sesión: Un para cada llamada.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-173">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|<span data-ttu-id="4f0a8-174">- Comportamiento con canal con sesión: se produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-174">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="4f0a8-175">- Comportamiento con canal <xref:System.ServiceModel.InstanceContext> sin sesión: Un para cada llamada.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-175">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|  
|<span data-ttu-id="4f0a8-176">PerSession</span><span class="sxs-lookup"><span data-stu-id="4f0a8-176">PerSession</span></span>|<span data-ttu-id="4f0a8-177">- Comportamiento con canal con <xref:System.ServiceModel.InstanceContext> sesión: Una sesión y para cada canal.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-177">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each channel.</span></span><br /><span data-ttu-id="4f0a8-178">- Comportamiento con canal sin sesión: se produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-178">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="4f0a8-179">- Comportamiento con canal con <xref:System.ServiceModel.InstanceContext> sesión: Una sesión y para cada canal.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-179">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for each channel.</span></span><br /><span data-ttu-id="4f0a8-180">- Comportamiento con canal <xref:System.ServiceModel.InstanceContext> sin sesión: Un para cada llamada.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-180">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|<span data-ttu-id="4f0a8-181">- Comportamiento con canal con sesión: se produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-181">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="4f0a8-182">- Comportamiento con canal <xref:System.ServiceModel.InstanceContext> sin sesión: Un para cada llamada.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-182">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each call.</span></span>|  
|<span data-ttu-id="4f0a8-183">Single</span><span class="sxs-lookup"><span data-stu-id="4f0a8-183">Single</span></span>|<span data-ttu-id="4f0a8-184">- Comportamiento con canal con sesión: Una sesión y una <xref:System.ServiceModel.InstanceContext> para todas las llamadas.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-184">-   Behavior with sessionful channel: A session and one <xref:System.ServiceModel.InstanceContext> for all calls.</span></span><br /><span data-ttu-id="4f0a8-185">- Comportamiento con canal sin sesión: se produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-185">-   Behavior with sessionless channel: An exception is thrown.</span></span>|<span data-ttu-id="4f0a8-186">- Comportamiento con canal con <xref:System.ServiceModel.InstanceContext> sesión: Una sesión y para el singleton creado o especificado por el usuario.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-186">-   Behavior with sessionful channel: A session and <xref:System.ServiceModel.InstanceContext> for the created or user-specified singleton.</span></span><br /><span data-ttu-id="4f0a8-187">- Comportamiento con canal <xref:System.ServiceModel.InstanceContext> sin sesión: un para el singleton creado o especificado por el usuario.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-187">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for the created or user-specified singleton.</span></span>|<span data-ttu-id="4f0a8-188">- Comportamiento con canal con sesión: se produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-188">-   Behavior with sessionful channel: An exception is thrown.</span></span><br /><span data-ttu-id="4f0a8-189">- Comportamiento con canal <xref:System.ServiceModel.InstanceContext> sin sesión: Un para cada singleton creado o para el singleton especificado por el usuario.</span><span class="sxs-lookup"><span data-stu-id="4f0a8-189">-   Behavior with sessionless channel: An <xref:System.ServiceModel.InstanceContext> for each created singleton or for the user-specified singleton.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="4f0a8-190">Consulte también</span><span class="sxs-lookup"><span data-stu-id="4f0a8-190">See also</span></span>

- [<span data-ttu-id="4f0a8-191">Uso de sesiones</span><span class="sxs-lookup"><span data-stu-id="4f0a8-191">Using Sessions</span></span>](../../../../docs/framework/wcf/using-sessions.md)
- [<span data-ttu-id="4f0a8-192">Cómo crear un servicio que requiere sesiones</span><span class="sxs-lookup"><span data-stu-id="4f0a8-192">How to: Create a Service That Requires Sessions</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-service-that-requires-sessions.md)
- [<span data-ttu-id="4f0a8-193">Control de la creación de instancias de servicio</span><span class="sxs-lookup"><span data-stu-id="4f0a8-193">How to: Control Service Instancing</span></span>](../../../../docs/framework/wcf/feature-details/how-to-control-service-instancing.md)
- [<span data-ttu-id="4f0a8-194">Concurrencia</span><span class="sxs-lookup"><span data-stu-id="4f0a8-194">Concurrency</span></span>](../../../../docs/framework/wcf/samples/concurrency.md)
- [<span data-ttu-id="4f0a8-195">Creación de instancias</span><span class="sxs-lookup"><span data-stu-id="4f0a8-195">Instancing</span></span>](../../../../docs/framework/wcf/samples/instancing.md)
- [<span data-ttu-id="4f0a8-196">Sesión</span><span class="sxs-lookup"><span data-stu-id="4f0a8-196">Session</span></span>](../../../../docs/framework/wcf/samples/session.md)
