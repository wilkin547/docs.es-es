---
title: Definición y especificación de errores
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- handling faults [WCF], specifying
- handling faults [WCF], defining
ms.assetid: c00c84f1-962d-46a7-b07f-ebc4f80fbfc1
ms.openlocfilehash: 10fc045cab995cca8d78e470d74ec9341e167308
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 03/12/2020
ms.locfileid: "79176700"
---
# <a name="defining-and-specifying-faults"></a><span data-ttu-id="ae0cc-102">Definición y especificación de errores</span><span class="sxs-lookup"><span data-stu-id="ae0cc-102">Defining and Specifying Faults</span></span>
<span data-ttu-id="ae0cc-103">Los errores de SOAP transmiten información de condición de error desde un servicio a un cliente y, en caso de comunicación dúplex, desde un cliente a un servicio de una manera interoperable.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-103">SOAP faults convey error condition information from a service to a client and, in the duplex case, from a client to a service in an interoperable way.</span></span> <span data-ttu-id="ae0cc-104">Este tema describe cuándo y cómo definir contenido personalizado de error y especificar qué operaciones pueden devolverlos.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-104">This topic discusses when and how to define custom fault content and specify which operations can return them.</span></span> <span data-ttu-id="ae0cc-105">Para obtener más información acerca de cómo un servicio, o cliente dúplex, puede enviar esos errores y cómo un cliente o aplicación de servicio controla estos errores, vea [Enviar y recibir errores](sending-and-receiving-faults.md).</span><span class="sxs-lookup"><span data-stu-id="ae0cc-105">For more information about how a service, or duplex client, can send those faults and how a client or service application handles these faults, see [Sending and Receiving Faults](sending-and-receiving-faults.md).</span></span> <span data-ttu-id="ae0cc-106">Para obtener información general sobre el control de errores en aplicaciones de Windows Communication Foundation (WCF), vea [Especificar y controlar errores en contratos y servicios](specifying-and-handling-faults-in-contracts-and-services.md).</span><span class="sxs-lookup"><span data-stu-id="ae0cc-106">For an overview of error handling in Windows Communication Foundation (WCF) applications, see [Specifying and Handling Faults in Contracts and Services](specifying-and-handling-faults-in-contracts-and-services.md).</span></span>  
  
## <a name="overview"></a><span data-ttu-id="ae0cc-107">Información general</span><span class="sxs-lookup"><span data-stu-id="ae0cc-107">Overview</span></span>  
 <span data-ttu-id="ae0cc-108">Los errores de SOAP declarados son aquéllos en los que una operación tiene <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> que especifica un tipo de error de SOAP personalizado.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-108">Declared SOAP faults are those in which an operation has a <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> that specifies a custom SOAP fault type.</span></span> <span data-ttu-id="ae0cc-109">Los errores de SOAP no declarados son aquéllos que no se especifican en el contrato para una operación.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-109">Undeclared SOAP faults are those that are not specified in the contract for an operation.</span></span> <span data-ttu-id="ae0cc-110">Este tema le ayuda a identificar esas condiciones de error y crear un contrato de error para su servicio, que los clientes pueden utilizar para administrar correctamente esas condiciones de error cuando sean notificadas por errores de SOAP personalizados.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-110">This topic helps you identify those error conditions and create a fault contract for your service that clients can use to properly handle those error conditions when notified by custom SOAP faults.</span></span> <span data-ttu-id="ae0cc-111">Las tareas básicas son, en orden:</span><span class="sxs-lookup"><span data-stu-id="ae0cc-111">The basic tasks are, in order:</span></span>  
  
1. <span data-ttu-id="ae0cc-112">Defina las condiciones que un cliente de su servicio debería saber.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-112">Define the error conditions that a client of your service should know about.</span></span>  
  
2. <span data-ttu-id="ae0cc-113">Defina el contenido personalizado de los errores de SOAP para esas condiciones de error.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-113">Define the custom content of the SOAP faults for those error conditions.</span></span>  
  
3. <span data-ttu-id="ae0cc-114">Marque sus operaciones para que los errores de SOAP específicos que inician se expongan a los clientes en WSDL.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-114">Mark your operations so that the specific SOAP faults that they throw are exposed to clients in WSDL.</span></span>  
  
### <a name="defining-error-conditions-that-clients-should-know-about"></a><span data-ttu-id="ae0cc-115">Definir Condiciones de error que los clientes deberían saber</span><span class="sxs-lookup"><span data-stu-id="ae0cc-115">Defining Error Conditions That Clients Should Know About</span></span>  
 <span data-ttu-id="ae0cc-116">Los errores de SOAP son mensajes descritos públicamente que llevan información de error para una operación determinada.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-116">SOAP faults are publicly described messages that carry fault information for a particular operation.</span></span> <span data-ttu-id="ae0cc-117">Dado que se describen junto con otros mensajes de la operación en WSDL, los clientes saben y, por consiguiente, esperan controlar dichos errores al invocar una operación.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-117">Because they are described along with other operation messages in WSDL, clients know and, therefore, expect to handle such faults when invoking an operation.</span></span> <span data-ttu-id="ae0cc-118">Pero como los servicios WCF se escriben en código administrado, decidir qué condiciones de error en el código administrado se convertirán en errores y devolver al cliente le proporciona la oportunidad de separar las condiciones de error y errores en el servicio del error formal conversación que tiene con un cliente.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-118">But because WCF services are written in managed code, deciding which error conditions in managed code are to be converted into faults and returned to the client provides you the opportunity to separate error conditions and bugs in your service from the formal error conversation you have with a client.</span></span>  
  
 <span data-ttu-id="ae0cc-119">Por ejemplo, el ejemplo de código siguiente muestra una operación que toma dos enteros y devuelve otro entero.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-119">For example, the following code example shows an operation that takes two integers and returns another integer.</span></span> <span data-ttu-id="ae0cc-120">Aquí, se pueden producir varias excepciones, por lo que al diseñar el contrato del error, debe determinar qué condiciones de error son importantes para su cliente.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-120">Several exceptions can be thrown here, so when designing the fault contract, you must determine which error conditions are important for your client.</span></span> <span data-ttu-id="ae0cc-121">En este caso, el servicio debería detectar la excepción <xref:System.DivideByZeroException?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-121">In this case, the service should detect the <xref:System.DivideByZeroException?displayProperty=nameWithType> exception.</span></span>  
  
```csharp  
[ServiceContract]  
public class CalculatorService  
{  
    [OperationContract]
    int Divide(int a, int b)  
    {  
      if (b==0) throw new Exception("Division by zero!");  
      return a/b;  
    }  
}  
```  
  
```vb
<ServiceContract> _
Public Class CalculatorService
    <OperationContract> _
    Public Function Divide(a As Integer, b As Integer) As Integer
        If b = 0 Then Throw New DivideByZeroException("Division by zero!")
        Return a / b
    End Function
End Class
```
  
 <span data-ttu-id="ae0cc-122">En el ejemplo anterior, la operación puede devolver un error de SOAP personalizado, específico de dividir por cero, un error personalizado específico a las operaciones de matemática, pero con información específica a dividir por cero, varios errores para varias situaciones de error diferentes, o ningún error de SOAP en absoluto.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-122">In the preceding example the operation can either return a custom SOAP fault that is specific to dividing by zero, a custom fault that is specific to math operations but that contains information specific to dividing by zero, multiple faults for several different error situations, or no SOAP fault at all.</span></span>  
  
### <a name="define-the-content-of-error-conditions"></a><span data-ttu-id="ae0cc-123">Definir el contenido de condiciones de error</span><span class="sxs-lookup"><span data-stu-id="ae0cc-123">Define the Content of Error Conditions</span></span>  
 <span data-ttu-id="ae0cc-124">Una vez identificada una condición de error como una que puede devolver un error de SOAP personalizado de forma útil, el paso siguiente es definir los contenidos de ese error y garantizar que se puede serializar la estructura de contenido.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-124">Once an error condition has been identified as one that can usefully return a custom SOAP fault, the next step is to define the contents of that fault and ensure that the content structure can be serialized.</span></span> <span data-ttu-id="ae0cc-125">El ejemplo de código de la sección anterior muestra un error específico en una operación `Divide`, pero si hay otras operaciones en el servicio `Calculator`, a continuación, un error de SOAP personalizado único puede informar el cliente de todas las condiciones de error de la calculadora, `Divide` incluido.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-125">The code example in the preceding section shows an error specific to a `Divide` operation, but if there are other operations on the `Calculator` service, then a single custom SOAP fault can inform the client of all calculator error conditions, `Divide` included.</span></span> <span data-ttu-id="ae0cc-126">El ejemplo de código siguiente muestra la creación de un error de SOAP personalizado, `MathFault`, que puede notificar los errores realizados utilizando todas las operaciones de matemática, incluso `Divide`.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-126">The following code example shows the creation of a custom SOAP fault, `MathFault`, which can report errors made using all math operations, including `Divide`.</span></span> <span data-ttu-id="ae0cc-127">Mientras que la clase puede especificar una operación (la propiedad `Operation` ) y un valor que describe el problema (la propiedad `ProblemType` ), la clase y estas propiedades deben ser serializables para ser transferidas al cliente en un error de SOAP personalizado.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-127">While the class can specify an operation (the `Operation` property) and a value that describes the problem (the `ProblemType` property), the class and these properties must be serializable to be transferred to the client in a custom SOAP fault.</span></span> <span data-ttu-id="ae0cc-128">Por consiguiente, <xref:System.Runtime.Serialization.DataContractAttribute?displayProperty=nameWithType> y los atributos <xref:System.Runtime.Serialization.DataMemberAttribute?displayProperty=nameWithType> se utilizan para hacer el tipo y sus propiedades serializables y tan interoperable como sea posible.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-128">Therefore, the <xref:System.Runtime.Serialization.DataContractAttribute?displayProperty=nameWithType> and <xref:System.Runtime.Serialization.DataMemberAttribute?displayProperty=nameWithType> attributes are used to make the type and its properties serializable and as interoperable as possible.</span></span>  
  
 [!code-csharp[Faults#2](../../../samples/snippets/csharp/VS_Snippets_CFX/faults/cs/service.cs#2)]
 [!code-vb[Faults#2](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faults/vb/service.vb#2)]  
  
 <span data-ttu-id="ae0cc-129">Para obtener más información acerca de cómo asegurarse de que los datos son serializables, vea Especificar la transferencia de datos [en contratos](./feature-details/specifying-data-transfer-in-service-contracts.md)de servicio .</span><span class="sxs-lookup"><span data-stu-id="ae0cc-129">For more information about how to ensure your data is serializable, see [Specifying Data Transfer in Service Contracts](./feature-details/specifying-data-transfer-in-service-contracts.md).</span></span> <span data-ttu-id="ae0cc-130">Para obtener una lista <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType> de la compatibilidad de serialización que proporciona, vea [Tipos admitidos por el serializador](./feature-details/types-supported-by-the-data-contract-serializer.md)de contratos de datos .</span><span class="sxs-lookup"><span data-stu-id="ae0cc-130">For a list of the serialization support that <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType> provides, see [Types Supported by the Data Contract Serializer](./feature-details/types-supported-by-the-data-contract-serializer.md).</span></span>  
  
### <a name="mark-operations-to-establish-the-fault-contract"></a><span data-ttu-id="ae0cc-131">Marcar operaciones para establecer el contrato de error</span><span class="sxs-lookup"><span data-stu-id="ae0cc-131">Mark Operations to Establish the Fault Contract</span></span>  
 <span data-ttu-id="ae0cc-132">Una vez definida una estructura de datos serializable que se devuelve como parte de un error de SOAP personalizado, el último paso es marcar su contrato de operación como iniciar un error de SOAP de ese tipo.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-132">Once a serializable data structure that is returned as part of a custom SOAP fault is defined, the last step is to mark your operation contract as throwing a SOAP fault of that type.</span></span> <span data-ttu-id="ae0cc-133">Para ello, utilice el atributo <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> y pase el tipo del tipo de datos personalizado que ha construido.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-133">To do this, use the <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> attribute and pass the type of the custom data type that you have constructed.</span></span> <span data-ttu-id="ae0cc-134">El ejemplo de código siguiente muestra cómo usar el atributo <xref:System.ServiceModel.FaultContractAttribute> para especificar que la operación `Divide` puede devolver un error de SOAP del tipo `MathFault`.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-134">The following code example shows how to use the <xref:System.ServiceModel.FaultContractAttribute> attribute to specify that the `Divide` operation can return a SOAP fault of type `MathFault`.</span></span> <span data-ttu-id="ae0cc-135">Otras operaciones basadas en matemáticas, ahora, también pueden especificar que pueden devolver un `MathFault`.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-135">Other math-based operations can now also specify that they can return a `MathFault`.</span></span>  
  
 [!code-csharp[Faults#1](../../../samples/snippets/csharp/VS_Snippets_CFX/faults/cs/service.cs#1)]
 [!code-vb[Faults#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faults/vb/service.vb#1)]  
  
 <span data-ttu-id="ae0cc-136">Una operación puede especificar que devuelve más de un error personalizado marcando esa operación con más de un atributo <xref:System.ServiceModel.FaultContractAttribute>.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-136">An operation can specify that it returns more than one custom fault by marking that operation with more than one <xref:System.ServiceModel.FaultContractAttribute> attribute.</span></span>  
  
 <span data-ttu-id="ae0cc-137">El siguiente paso, para implementar el contrato de error en la implementación de la operación, se describe en el tema [Envío y recepción](sending-and-receiving-faults.md)de errores .</span><span class="sxs-lookup"><span data-stu-id="ae0cc-137">The next step, to implement the fault contract in your operation implementation, is described in the topic [Sending and Receiving Faults](sending-and-receiving-faults.md).</span></span>  
  
#### <a name="soap-wsdl-and-interoperability-considerations"></a><span data-ttu-id="ae0cc-138">SOAP, WSDL y consideraciones de la interoperabilidad</span><span class="sxs-lookup"><span data-stu-id="ae0cc-138">SOAP, WSDL, and Interoperability Considerations</span></span>  
 <span data-ttu-id="ae0cc-139">En algunas circunstancias, sobre todo al interoperar con otras plataformas, puede ser importante para controlar la manera en que aparece un error en un mensaje SOAP o la manera en el que se describe en los metadatos de WSDL.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-139">In some circumstances, especially when interoperating with other platforms, it may be important to control the way a fault appears in a SOAP message or the way it is described in the WSDL metadata.</span></span>  
  
 <span data-ttu-id="ae0cc-140">El atributo <xref:System.ServiceModel.FaultContractAttribute> tiene una propiedad <xref:System.ServiceModel.FaultContractAttribute.Name%2A> que permite controlar el nombre del elemento de error WSDL que se genera en los metadatos para ese error.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-140">The <xref:System.ServiceModel.FaultContractAttribute> attribute has a <xref:System.ServiceModel.FaultContractAttribute.Name%2A> property that allows control of the WSDL fault element name that is generated in the metadata for that fault.</span></span>  
  
 <span data-ttu-id="ae0cc-141">Según la norma de SOAP, un error puede tener `Action`, `Code`y `Reason`.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-141">According to the SOAP standard, a fault can have an `Action`, a `Code`, and a `Reason`.</span></span> <span data-ttu-id="ae0cc-142">`Action` es controlado por la propiedad <xref:System.ServiceModel.FaultContractAttribute.Action%2A>.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-142">The `Action` is controlled by the <xref:System.ServiceModel.FaultContractAttribute.Action%2A> property.</span></span> <span data-ttu-id="ae0cc-143">La propiedad <xref:System.ServiceModel.FaultException.Code%2A> y la propiedad <xref:System.ServiceModel.FaultException.Reason%2A> son ambas propiedades de la clase <xref:System.ServiceModel.FaultException?displayProperty=nameWithType>, que es la clase primaria del <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType> genérico.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-143">The <xref:System.ServiceModel.FaultException.Code%2A> property and <xref:System.ServiceModel.FaultException.Reason%2A> property are both properties of the <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> class, which is the parent class of the generic <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType>.</span></span> <span data-ttu-id="ae0cc-144">Una propiedad `Code` incluye un miembro <xref:System.ServiceModel.FaultCode.SubCode%2A>.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-144">The `Code` property includes a <xref:System.ServiceModel.FaultCode.SubCode%2A> member.</span></span>  
  
 <span data-ttu-id="ae0cc-145">Al tener acceso a servicios que generan errores, ciertas limitaciones existen.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-145">When accessing non-services that generate faults, certain limitations exist.</span></span> <span data-ttu-id="ae0cc-146">WCF solo admite errores con tipos de detalle que describe el esquema y que son compatibles con los contratos de datos.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-146">WCF supports only faults with detail types that the schema describes and that are compatible with data contracts.</span></span> <span data-ttu-id="ae0cc-147">Por ejemplo, como se mencionó anteriormente, WCF no admite errores que usan atributos XML en sus tipos de detalle o errores con más de un elemento de nivel superior en la sección de detalles.</span><span class="sxs-lookup"><span data-stu-id="ae0cc-147">For example, as mentioned above, WCF does not support faults that use XML attributes in their detail types, or faults with more than one top-level element in the detail section.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ae0cc-148">Consulte también</span><span class="sxs-lookup"><span data-stu-id="ae0cc-148">See also</span></span>

- <xref:System.ServiceModel.FaultContractAttribute>
- <xref:System.Runtime.Serialization.DataContractAttribute>
- <xref:System.Runtime.Serialization.DataMemberAttribute>
- [<span data-ttu-id="ae0cc-149">Especificación y gestión de errores en contratos y servicios</span><span class="sxs-lookup"><span data-stu-id="ae0cc-149">Specifying and Handling Faults in Contracts and Services</span></span>](specifying-and-handling-faults-in-contracts-and-services.md)
- [<span data-ttu-id="ae0cc-150">Envío y recepción de errores</span><span class="sxs-lookup"><span data-stu-id="ae0cc-150">Sending and Receiving Faults</span></span>](sending-and-receiving-faults.md)
- [<span data-ttu-id="ae0cc-151">Cómo declarar errores en contratos de servicio</span><span class="sxs-lookup"><span data-stu-id="ae0cc-151">How to: Declare Faults in Service Contracts</span></span>](how-to-declare-faults-in-service-contracts.md)
- [<span data-ttu-id="ae0cc-152">Descripción de los niveles de protección</span><span class="sxs-lookup"><span data-stu-id="ae0cc-152">Understanding Protection Level</span></span>](understanding-protection-level.md)
- [<span data-ttu-id="ae0cc-153">Cómo establecerla propiedad ProtectionLevel Property</span><span class="sxs-lookup"><span data-stu-id="ae0cc-153">How to: Set the ProtectionLevel Property</span></span>](how-to-set-the-protectionlevel-property.md)
- [<span data-ttu-id="ae0cc-154">Specifying Data Transfer in Service Contracts</span><span class="sxs-lookup"><span data-stu-id="ae0cc-154">Specifying Data Transfer in Service Contracts</span></span>](./feature-details/specifying-data-transfer-in-service-contracts.md)
