---
title: Comunicación entre servicios
description: Obtenga información sobre cómo los microservicios de back-end nativos en la nube se comunican con otros microservicios de back-end.
author: robvet
ms.date: 01/19/2021
ms.openlocfilehash: 63c80b38e2fa42dccebefc772c969266fa9d79ca
ms.sourcegitcommit: f2ab02d9a780819ca2e5310bbcf5cfe5b7993041
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/03/2021
ms.locfileid: "99506271"
---
# <a name="service-to-service-communication"></a><span data-ttu-id="c26e7-103">Comunicación entre servicios</span><span class="sxs-lookup"><span data-stu-id="c26e7-103">Service-to-service communication</span></span>

<span data-ttu-id="c26e7-104">Al pasar del cliente front-end, ahora se abordan los microservicios de back-end que se comunican entre sí.</span><span class="sxs-lookup"><span data-stu-id="c26e7-104">Moving from the front-end client, we now address back-end microservices communicate with each other.</span></span>

<span data-ttu-id="c26e7-105">Al construir una aplicación nativa en la nube, querrá ser sensible a la manera en que los servicios back-end se comunican entre sí.</span><span class="sxs-lookup"><span data-stu-id="c26e7-105">When constructing a cloud-native application, you'll want to be sensitive to how back-end services communicate with each other.</span></span> <span data-ttu-id="c26e7-106">Idealmente, la menor comunicación entre servicios, mejor.</span><span class="sxs-lookup"><span data-stu-id="c26e7-106">Ideally, the less inter-service communication, the better.</span></span> <span data-ttu-id="c26e7-107">Sin embargo, no siempre es posible evitar que los servicios back-end se basen entre sí para completar una operación.</span><span class="sxs-lookup"><span data-stu-id="c26e7-107">However, avoidance isn't always possible as back-end services often rely on one another to complete an operation.</span></span>

<span data-ttu-id="c26e7-108">Hay varios métodos ampliamente aceptados para implementar la comunicación entre servicios.</span><span class="sxs-lookup"><span data-stu-id="c26e7-108">There are several widely accepted approaches to implementing cross-service communication.</span></span> <span data-ttu-id="c26e7-109">El *tipo de interacción de comunicación* a menudo determinará el mejor enfoque.</span><span class="sxs-lookup"><span data-stu-id="c26e7-109">The *type of communication interaction* will often determine the best approach.</span></span>

<span data-ttu-id="c26e7-110">Tenga en cuenta los siguientes tipos de interacción:</span><span class="sxs-lookup"><span data-stu-id="c26e7-110">Consider the following interaction types:</span></span>

- <span data-ttu-id="c26e7-111">*Consulta* : cuando un microservicio de llamada requiere una respuesta de un microservicio llamado, como "¡ Hola, quiero obtener la información de comprador de un identificador de cliente determinado".</span><span class="sxs-lookup"><span data-stu-id="c26e7-111">*Query* – when a calling microservice requires a response from a called microservice, such as, "Hey, give me the buyer information for a given customer Id."</span></span>

- <span data-ttu-id="c26e7-112">*Comando* : cuando el microservicio de llamada necesita otro microservicio para ejecutar una acción, pero no requiere una respuesta, como "Hola, simplemente enviar este pedido".</span><span class="sxs-lookup"><span data-stu-id="c26e7-112">*Command* – when the calling microservice needs another microservice to execute an action but doesn't require a response, such as, "Hey, just ship this order."</span></span>

- <span data-ttu-id="c26e7-113">*Evento* : cuando un microservicio, denominado publicador, genera un evento que el estado ha cambiado o se ha producido una acción.</span><span class="sxs-lookup"><span data-stu-id="c26e7-113">*Event* – when a microservice, called the publisher, raises an event that state has changed or an action has occurred.</span></span> <span data-ttu-id="c26e7-114">Otros microservicios, denominados suscriptores interesados, pueden reaccionar al evento adecuadamente.</span><span class="sxs-lookup"><span data-stu-id="c26e7-114">Other microservices, called subscribers, who are interested, can react to the event appropriately.</span></span> <span data-ttu-id="c26e7-115">El publicador y los suscriptores no se reconocen entre sí.</span><span class="sxs-lookup"><span data-stu-id="c26e7-115">The publisher and the subscribers aren't aware of each other.</span></span>

<span data-ttu-id="c26e7-116">Los sistemas de microservicios suelen usar una combinación de estos tipos de interacción al ejecutar operaciones que requieren interacción entre servicios.</span><span class="sxs-lookup"><span data-stu-id="c26e7-116">Microservice systems typically use a combination of these interaction types when executing operations that require cross-service interaction.</span></span> <span data-ttu-id="c26e7-117">Echemos un vistazo a cada una de ellas y cómo podría implementarlas.</span><span class="sxs-lookup"><span data-stu-id="c26e7-117">Let's take a close look at each and how you might implement them.</span></span>

## <a name="queries"></a><span data-ttu-id="c26e7-118">Consultas</span><span class="sxs-lookup"><span data-stu-id="c26e7-118">Queries</span></span>

<span data-ttu-id="c26e7-119">Muchas veces, un microservicio podría necesitar *consultar* otro, lo que requiere una respuesta inmediata para completar una operación.</span><span class="sxs-lookup"><span data-stu-id="c26e7-119">Many times, one microservice might need to *query* another, requiring an immediate response to complete an operation.</span></span> <span data-ttu-id="c26e7-120">Un microservicio de cesta de la compra puede necesitar información del producto y un precio para agregar un artículo a su cesta.</span><span class="sxs-lookup"><span data-stu-id="c26e7-120">A shopping basket microservice may need product information and a price to add an item to its basket.</span></span> <span data-ttu-id="c26e7-121">Existen muchos enfoques para implementar operaciones de consulta.</span><span class="sxs-lookup"><span data-stu-id="c26e7-121">There are many approaches for implementing query operations.</span></span>

### <a name="requestresponse-messaging"></a><span data-ttu-id="c26e7-122">Mensajería de solicitud-respuesta</span><span class="sxs-lookup"><span data-stu-id="c26e7-122">Request/Response Messaging</span></span>

<span data-ttu-id="c26e7-123">Una opción para implementar este escenario es que el microservicio de back-end que realiza la llamada realice solicitudes HTTP directas a los microservicios que necesita consultar, tal como se muestra en la figura 4-8.</span><span class="sxs-lookup"><span data-stu-id="c26e7-123">One option for implementing this scenario is for the calling back-end microservice to make direct HTTP requests to the microservices it needs to query, shown in Figure 4-8.</span></span>

![Comunicación HTTP directa](./media/direct-http-communication.png)

<span data-ttu-id="c26e7-125">**Figura 4-8**.</span><span class="sxs-lookup"><span data-stu-id="c26e7-125">**Figure 4-8**.</span></span> <span data-ttu-id="c26e7-126">Comunicación HTTP directa</span><span class="sxs-lookup"><span data-stu-id="c26e7-126">Direct HTTP communication</span></span>

<span data-ttu-id="c26e7-127">Aunque las llamadas HTTP directas entre microservicios son relativamente fáciles de implementar, se debe tener cuidado para minimizar esta práctica.</span><span class="sxs-lookup"><span data-stu-id="c26e7-127">While direct HTTP calls between microservices are relatively simple to implement, care should be taken to minimize this practice.</span></span> <span data-ttu-id="c26e7-128">Para empezar, estas llamadas siempre son *sincrónicas* y bloquearán la operación hasta que se devuelva un resultado o se agote el tiempo de espera de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="c26e7-128">To start, these calls are always *synchronous* and will block the operation until a result is returned or the request times outs.</span></span> <span data-ttu-id="c26e7-129">A partir de ahora, los servicios independientes, que se pueden desarrollar de manera independiente e implementar con frecuencia, se acoplan entre sí.</span><span class="sxs-lookup"><span data-stu-id="c26e7-129">What were once self-contained, independent services, able to evolve independently and deploy frequently, now become coupled to each other.</span></span> <span data-ttu-id="c26e7-130">A medida que el acoplamiento entre los microservicios aumenta, disminuyen sus ventajas arquitectónicas.</span><span class="sxs-lookup"><span data-stu-id="c26e7-130">As coupling among microservices increase, their architectural benefits diminish.</span></span>

<span data-ttu-id="c26e7-131">La ejecución de una solicitud poco frecuente que realiza una única llamada HTTP directa a otro microservicio puede ser aceptable para algunos sistemas.</span><span class="sxs-lookup"><span data-stu-id="c26e7-131">Executing an infrequent request that makes a single direct HTTP call to another microservice might be acceptable for some systems.</span></span> <span data-ttu-id="c26e7-132">Sin embargo, no se recomienda realizar llamadas de gran volumen que invoquen llamadas HTTP directas a varios microservicios.</span><span class="sxs-lookup"><span data-stu-id="c26e7-132">However, high-volume calls that invoke direct HTTP calls to multiple microservices aren't advisable.</span></span> <span data-ttu-id="c26e7-133">Pueden aumentar la latencia y afectar negativamente al rendimiento, la escalabilidad y la disponibilidad del sistema.</span><span class="sxs-lookup"><span data-stu-id="c26e7-133">They can increase latency and negatively impact the performance, scalability, and availability of your system.</span></span> <span data-ttu-id="c26e7-134">Incluso peor, una larga serie de comunicaciones HTTP directas puede conducir a cadenas profundas y complejas de llamadas de microservicios sincrónicas, que se muestran en la figura 4-9:</span><span class="sxs-lookup"><span data-stu-id="c26e7-134">Even worse, a long series of direct HTTP communication can lead to deep and complex chains of synchronous microservices calls, shown in Figure 4-9:</span></span>

![Encadenamiento de consultas HTTP](./media/chaining-http-queries.png)

<span data-ttu-id="c26e7-136">**Figura 4-9**.</span><span class="sxs-lookup"><span data-stu-id="c26e7-136">**Figure 4-9**.</span></span> <span data-ttu-id="c26e7-137">Encadenamiento de consultas HTTP</span><span class="sxs-lookup"><span data-stu-id="c26e7-137">Chaining HTTP queries</span></span>

<span data-ttu-id="c26e7-138">Por supuesto, puede imaginarse el riesgo en el diseño que se muestra en la imagen anterior.</span><span class="sxs-lookup"><span data-stu-id="c26e7-138">You can certainly imagine the risk in the design shown in the previous image.</span></span> <span data-ttu-id="c26e7-139">¿Qué ocurre si \# se produce un error en el paso 3?</span><span class="sxs-lookup"><span data-stu-id="c26e7-139">What happens if Step \#3 fails?</span></span> <span data-ttu-id="c26e7-140">¿O el paso \# 8 produce un error?</span><span class="sxs-lookup"><span data-stu-id="c26e7-140">Or Step \#8 fails?</span></span> <span data-ttu-id="c26e7-141">¿Cómo se recupera?</span><span class="sxs-lookup"><span data-stu-id="c26e7-141">How do you recover?</span></span> <span data-ttu-id="c26e7-142">¿Qué ocurre si \# el paso 6 es lento porque el servicio subyacente está ocupado?</span><span class="sxs-lookup"><span data-stu-id="c26e7-142">What if Step \#6 is slow because the underlying service is busy?</span></span> <span data-ttu-id="c26e7-143">¿Cómo se puede continuar?</span><span class="sxs-lookup"><span data-stu-id="c26e7-143">How do you continue?</span></span> <span data-ttu-id="c26e7-144">Incluso si todo funciona correctamente, piense en la latencia que podría tener esta llamada, que es la suma de la latencia de cada paso.</span><span class="sxs-lookup"><span data-stu-id="c26e7-144">Even if all works correctly, think of the latency this call would incur, which is the sum of the latency of each step.</span></span>

<span data-ttu-id="c26e7-145">El gran grado de acoplamiento en la imagen anterior sugiere que los servicios no se modelaron de forma óptima.</span><span class="sxs-lookup"><span data-stu-id="c26e7-145">The large degree of coupling in the previous image suggests the services weren't optimally modeled.</span></span> <span data-ttu-id="c26e7-146">El equipo volvería a revisar su diseño.</span><span class="sxs-lookup"><span data-stu-id="c26e7-146">It would behoove the team to revisit their design.</span></span>

### <a name="materialized-view-pattern"></a><span data-ttu-id="c26e7-147">Patrón Materialized View</span><span class="sxs-lookup"><span data-stu-id="c26e7-147">Materialized View pattern</span></span>

<span data-ttu-id="c26e7-148">Una opción popular para quitar el acoplamiento de microservicios es el [patrón de vista materializada](/azure/architecture/patterns/materialized-view).</span><span class="sxs-lookup"><span data-stu-id="c26e7-148">A popular option for removing microservice coupling is the [Materialized View pattern](/azure/architecture/patterns/materialized-view).</span></span> <span data-ttu-id="c26e7-149">Con este patrón, un microservicio almacena su propia copia local y desnormalizada de los datos que pertenecen a otros servicios.</span><span class="sxs-lookup"><span data-stu-id="c26e7-149">With this pattern, a microservice stores its own local, denormalized copy of data that's owned by other services.</span></span> <span data-ttu-id="c26e7-150">En lugar del microservicio de cesta de la compra que consulta el catálogo de productos y los microservicios de precios, mantiene su propia copia local de los datos.</span><span class="sxs-lookup"><span data-stu-id="c26e7-150">Instead of the Shopping Basket microservice querying the Product Catalog and Pricing microservices, it maintains its own local copy of that data.</span></span> <span data-ttu-id="c26e7-151">Este patrón elimina el acoplamiento innecesario y mejora la confiabilidad y el tiempo de respuesta.</span><span class="sxs-lookup"><span data-stu-id="c26e7-151">This pattern eliminates unnecessary coupling and improves reliability and response time.</span></span> <span data-ttu-id="c26e7-152">Toda la operación se ejecuta dentro de un único proceso.</span><span class="sxs-lookup"><span data-stu-id="c26e7-152">The entire operation executes inside a single process.</span></span> <span data-ttu-id="c26e7-153">Exploramos este patrón y otros aspectos relacionados con los datos en el capítulo 5.</span><span class="sxs-lookup"><span data-stu-id="c26e7-153">We explore this pattern and other data concerns in Chapter 5.</span></span>

### <a name="service-aggregator-pattern"></a><span data-ttu-id="c26e7-154">Patrón Service Aggregator</span><span class="sxs-lookup"><span data-stu-id="c26e7-154">Service Aggregator Pattern</span></span>

<span data-ttu-id="c26e7-155">Otra opción para eliminar el acoplamiento de microservicios a microservicios es un [microservicio de agregador](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/), que se muestra en color púrpura en la figura 4-10.</span><span class="sxs-lookup"><span data-stu-id="c26e7-155">Another option for eliminating microservice-to-microservice coupling is an [Aggregator microservice](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/), shown in purple in Figure 4-10.</span></span>

![Servicio de agregación](./media/aggregator-service.png)

<span data-ttu-id="c26e7-157">**Figura 4-10**.</span><span class="sxs-lookup"><span data-stu-id="c26e7-157">**Figure 4-10**.</span></span> <span data-ttu-id="c26e7-158">Microservicio del agregador</span><span class="sxs-lookup"><span data-stu-id="c26e7-158">Aggregator microservice</span></span>

<span data-ttu-id="c26e7-159">El patrón aísla una operación que realiza llamadas a varios microservicios de back-end, centralizando su lógica en un microservicio especializado.</span><span class="sxs-lookup"><span data-stu-id="c26e7-159">The pattern isolates an operation that makes calls to multiple back-end microservices, centralizing its logic into a specialized microservice.</span></span>  <span data-ttu-id="c26e7-160">El microservicio del agregador de retirada púrpura de la ilustración anterior organiza el flujo de trabajo para la operación de desprotección.</span><span class="sxs-lookup"><span data-stu-id="c26e7-160">The purple checkout aggregator microservice in the previous figure orchestrates the workflow for the Checkout operation.</span></span> <span data-ttu-id="c26e7-161">Incluye llamadas a varios microservicios de back-end en orden secuencial.</span><span class="sxs-lookup"><span data-stu-id="c26e7-161">It includes calls to several back-end microservices in a sequenced order.</span></span> <span data-ttu-id="c26e7-162">Los datos del flujo de trabajo se agregan y se devuelven al autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="c26e7-162">Data from the workflow is aggregated and returned to the caller.</span></span> <span data-ttu-id="c26e7-163">Aunque sigue implementando llamadas HTTP directas, el microservicio del agregador reduce las dependencias directas entre los microservicios de back-end.</span><span class="sxs-lookup"><span data-stu-id="c26e7-163">While it still implements direct HTTP calls, the aggregator microservice reduces direct dependencies among back-end microservices.</span></span>

### <a name="requestreply-pattern"></a><span data-ttu-id="c26e7-164">Patrón de solicitud/respuesta</span><span class="sxs-lookup"><span data-stu-id="c26e7-164">Request/Reply Pattern</span></span>

<span data-ttu-id="c26e7-165">Otro enfoque para desacoplar mensajes HTTP sincrónicos es un [patrón de solicitud-respuesta](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html), que usa la comunicación en cola.</span><span class="sxs-lookup"><span data-stu-id="c26e7-165">Another approach for decoupling synchronous HTTP messages is a [Request-Reply Pattern](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html), which uses queuing communication.</span></span> <span data-ttu-id="c26e7-166">La comunicación mediante una cola es siempre un canal unidireccional, con un productor que envía el mensaje y el consumidor la recibe.</span><span class="sxs-lookup"><span data-stu-id="c26e7-166">Communication using a queue is always a one-way channel, with a producer sending the message and consumer receiving it.</span></span> <span data-ttu-id="c26e7-167">Con este patrón, se implementan una cola de solicitudes y una cola de respuesta, que se muestran en la figura 4-11.</span><span class="sxs-lookup"><span data-stu-id="c26e7-167">With this pattern, both a request queue and response queue are implemented, shown in Figure 4-11.</span></span>

![Patrón de solicitud-respuesta](./media/request-reply-pattern.png)

<span data-ttu-id="c26e7-169">**Figura 4-11**.</span><span class="sxs-lookup"><span data-stu-id="c26e7-169">**Figure 4-11**.</span></span> <span data-ttu-id="c26e7-170">Patrón de solicitud-respuesta</span><span class="sxs-lookup"><span data-stu-id="c26e7-170">Request-reply pattern</span></span>

<span data-ttu-id="c26e7-171">En este caso, el productor de mensajes crea un mensaje basado en consulta que contiene un identificador de correlación único y lo coloca en una cola de solicitudes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-171">Here, the message producer creates a query-based message that contains a unique correlation ID and places it into a request queue.</span></span> <span data-ttu-id="c26e7-172">El servicio consumidor quita los mensajes de la cola, los procesa y coloca la respuesta en la cola de respuesta con el mismo identificador de correlación.</span><span class="sxs-lookup"><span data-stu-id="c26e7-172">The consuming service dequeues the messages, processes it and places the response into the response queue with the same correlation ID.</span></span> <span data-ttu-id="c26e7-173">El servicio productor quita el mensaje de la cola, lo hace coincidir con el identificador de correlación y continúa el procesamiento.</span><span class="sxs-lookup"><span data-stu-id="c26e7-173">The producer service dequeues the message, matches it with the correlation ID and continues processing.</span></span> <span data-ttu-id="c26e7-174">En la sección siguiente se describen los detalles de las colas.</span><span class="sxs-lookup"><span data-stu-id="c26e7-174">We cover queues in detail in the next section.</span></span>

## <a name="commands"></a><span data-ttu-id="c26e7-175">Comandos:</span><span class="sxs-lookup"><span data-stu-id="c26e7-175">Commands</span></span>

<span data-ttu-id="c26e7-176">Otro tipo de interacción de comunicación es un *comando*.</span><span class="sxs-lookup"><span data-stu-id="c26e7-176">Another type of communication interaction is a *command*.</span></span> <span data-ttu-id="c26e7-177">Un microservicio puede necesitar otro microservicio para realizar una acción.</span><span class="sxs-lookup"><span data-stu-id="c26e7-177">A microservice may need another microservice to perform an action.</span></span> <span data-ttu-id="c26e7-178">El microservicio de pedidos puede necesitar el microservicio de envío para crear un envío para un pedido aprobado.</span><span class="sxs-lookup"><span data-stu-id="c26e7-178">The Ordering microservice may need the Shipping microservice to create a shipment for an approved order.</span></span> <span data-ttu-id="c26e7-179">En la figura 4-12, un microservicio, denominado productor, envía un mensaje a otro microservicio, el consumidor, y le hace algo.</span><span class="sxs-lookup"><span data-stu-id="c26e7-179">In Figure 4-12, one microservice, called a Producer, sends a message to another microservice, the Consumer, commanding it to do something.</span></span>

![Interacción de comandos con una cola](./media/command-interaction-with-queue.png)

<span data-ttu-id="c26e7-181">**Figura 4-12**.</span><span class="sxs-lookup"><span data-stu-id="c26e7-181">**Figure 4-12**.</span></span> <span data-ttu-id="c26e7-182">Interacción de comandos con una cola</span><span class="sxs-lookup"><span data-stu-id="c26e7-182">Command interaction with a queue</span></span>

<span data-ttu-id="c26e7-183">La mayoría de las veces, el productor no requiere una respuesta y puede *desencadenar y olvidar* el mensaje.</span><span class="sxs-lookup"><span data-stu-id="c26e7-183">Most often, the Producer doesn't require a response and can *fire-and-forget* the message.</span></span> <span data-ttu-id="c26e7-184">Si se necesita una respuesta, el consumidor envía un mensaje independiente de vuelta al productor en otro canal.</span><span class="sxs-lookup"><span data-stu-id="c26e7-184">If a reply is needed, the Consumer sends a separate message back to Producer on another channel.</span></span> <span data-ttu-id="c26e7-185">Un mensaje de comando se envía mejor de forma asincrónica con una cola de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-185">A command message is best sent asynchronously with a message queue.</span></span> <span data-ttu-id="c26e7-186">compatible con un agente de mensajes ligeros.</span><span class="sxs-lookup"><span data-stu-id="c26e7-186">supported by a lightweight message broker.</span></span> <span data-ttu-id="c26e7-187">En el diagrama anterior, observe cómo una cola separa y desacopla ambos servicios.</span><span class="sxs-lookup"><span data-stu-id="c26e7-187">In the previous diagram, note how a queue separates and decouples both services.</span></span>

<span data-ttu-id="c26e7-188">Una cola de mensajes es una construcción intermediario a través de la cual un productor y un consumidor pasan un mensaje.</span><span class="sxs-lookup"><span data-stu-id="c26e7-188">A message queue is an intermediary construct through which a producer and consumer pass a message.</span></span> <span data-ttu-id="c26e7-189">Las colas implementan un patrón de mensajería asincrónico y punto a punto.</span><span class="sxs-lookup"><span data-stu-id="c26e7-189">Queues implement an asynchronous, point-to-point messaging pattern.</span></span> <span data-ttu-id="c26e7-190">El productor sabe dónde se debe enviar un comando y enruta las rutas correctamente.</span><span class="sxs-lookup"><span data-stu-id="c26e7-190">The Producer knows where a command needs to be sent and routes appropriately.</span></span> <span data-ttu-id="c26e7-191">La cola garantiza que un mensaje se procesa exactamente en una de las instancias del consumidor que leen desde el canal.</span><span class="sxs-lookup"><span data-stu-id="c26e7-191">The queue guarantees that a message is processed by exactly one of the consumer instances that are reading from the channel.</span></span> <span data-ttu-id="c26e7-192">En este escenario, el productor o el servicio de consumidor se pueden escalar horizontalmente sin que ello afecte a los demás.</span><span class="sxs-lookup"><span data-stu-id="c26e7-192">In this scenario, either the producer or consumer service can scale out without affecting the other.</span></span> <span data-ttu-id="c26e7-193">Además, las tecnologías pueden ser dispares en cada lado, lo que significa que podríamos tener un microservicio de Java que llame a un microservicio de [Golang](https://golang.org) .</span><span class="sxs-lookup"><span data-stu-id="c26e7-193">As well, technologies can be disparate on each side, meaning that we might have a Java microservice calling a [Golang](https://golang.org) microservice.</span></span>

<span data-ttu-id="c26e7-194">En el capítulo 1, hablamos sobre los *servicios de respaldo*.</span><span class="sxs-lookup"><span data-stu-id="c26e7-194">In chapter 1, we talked about *backing services*.</span></span> <span data-ttu-id="c26e7-195">Los servicios de respaldo son recursos auxiliares de los que dependen los sistemas nativos en la nube.</span><span class="sxs-lookup"><span data-stu-id="c26e7-195">Backing services are ancillary resources upon which cloud-native systems depend.</span></span> <span data-ttu-id="c26e7-196">Las colas de mensajes son servicios de respaldo.</span><span class="sxs-lookup"><span data-stu-id="c26e7-196">Message queues are backing services.</span></span> <span data-ttu-id="c26e7-197">La nube de Azure admite dos tipos de colas de mensajes que los sistemas nativos en la nube pueden usar para implementar la mensajería de comandos: Azure Storage colas y colas de Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="c26e7-197">The Azure cloud supports two types of message queues that your cloud-native systems can consume to implement command messaging: Azure Storage Queues and Azure Service Bus Queues.</span></span>

### <a name="azure-storage-queues"></a><span data-ttu-id="c26e7-198">Colas de Azure Storage</span><span class="sxs-lookup"><span data-stu-id="c26e7-198">Azure Storage Queues</span></span>

<span data-ttu-id="c26e7-199">Las colas de Azure Storage ofrecen una infraestructura de puesta en cola sencilla, rápida, asequible y respaldada por cuentas de Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="c26e7-199">Azure storage queues offer a simple queueing infrastructure that is fast, affordable, and backed by Azure storage accounts.</span></span>

<span data-ttu-id="c26e7-200">[Azure Storage colas](/azure/storage/queues/storage-queues-introduction) incluyen un mecanismo de puesta en cola basado en REST con mensajería confiable y persistente.</span><span class="sxs-lookup"><span data-stu-id="c26e7-200">[Azure Storage Queues](/azure/storage/queues/storage-queues-introduction) feature a REST-based queuing mechanism with reliable and persistent messaging.</span></span> <span data-ttu-id="c26e7-201">Proporcionan un conjunto de características mínimas, pero son económicas y almacenan millones de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-201">They provide a minimal feature set, but are inexpensive and store millions of messages.</span></span> <span data-ttu-id="c26e7-202">Su capacidad oscila hasta 500 TB.</span><span class="sxs-lookup"><span data-stu-id="c26e7-202">Their capacity ranges up to 500 TB.</span></span> <span data-ttu-id="c26e7-203">Un solo mensaje puede tener un tamaño de hasta 64 KB.</span><span class="sxs-lookup"><span data-stu-id="c26e7-203">A single message can be up to 64 KB in size.</span></span>

<span data-ttu-id="c26e7-204">Puede tener acceso a los mensajes desde cualquier lugar del mundo a través de llamadas autenticadas con HTTP o HTTPS.</span><span class="sxs-lookup"><span data-stu-id="c26e7-204">You can access messages from anywhere in the world via authenticated calls using HTTP or HTTPS.</span></span> <span data-ttu-id="c26e7-205">Las colas de almacenamiento se pueden escalar horizontalmente a un gran número de clientes simultáneos para controlar los picos de tráfico.</span><span class="sxs-lookup"><span data-stu-id="c26e7-205">Storage queues can scale out to large numbers of concurrent clients to handle traffic spikes.</span></span>

<span data-ttu-id="c26e7-206">Dicho esto, existen limitaciones en el servicio:</span><span class="sxs-lookup"><span data-stu-id="c26e7-206">That said, there are limitations with the service:</span></span>

- <span data-ttu-id="c26e7-207">No se garantiza el orden de los mensajes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-207">Message order isn't guaranteed.</span></span>

- <span data-ttu-id="c26e7-208">Los mensajes solo se pueden conservar durante siete días antes de que se quiten automáticamente.</span><span class="sxs-lookup"><span data-stu-id="c26e7-208">A message can only persist for seven days before it's automatically removed.</span></span>

- <span data-ttu-id="c26e7-209">No está disponible la compatibilidad con la administración de estado, la detección de duplicados o las transacciones.</span><span class="sxs-lookup"><span data-stu-id="c26e7-209">Support for state management, duplicate detection, or transactions isn't available.</span></span>

<span data-ttu-id="c26e7-210">En la figura 4-13 se muestra la jerarquía de una cola de Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="c26e7-210">Figure 4-13 shows the hierarchy of an Azure Storage Queue.</span></span>

![Jerarquía de colas de almacenamiento](./media/storage-queue-hierarchy.png)

<span data-ttu-id="c26e7-212">**Figura 4-13**.</span><span class="sxs-lookup"><span data-stu-id="c26e7-212">**Figure 4-13**.</span></span> <span data-ttu-id="c26e7-213">Jerarquía de colas de almacenamiento</span><span class="sxs-lookup"><span data-stu-id="c26e7-213">Storage queue hierarchy</span></span>

<span data-ttu-id="c26e7-214">En la ilustración anterior, observe cómo las colas de almacenamiento almacenan sus mensajes en la cuenta de Azure Storage subyacente.</span><span class="sxs-lookup"><span data-stu-id="c26e7-214">In the previous figure, note how storage queues store their messages in the underlying Azure Storage account.</span></span>

<span data-ttu-id="c26e7-215">Para los desarrolladores, Microsoft proporciona varias bibliotecas de cliente y de servidor para el procesamiento de colas de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="c26e7-215">For developers, Microsoft provides several client and server-side libraries for Storage queue processing.</span></span> <span data-ttu-id="c26e7-216">Se admiten la mayoría de las plataformas principales, como .NET, Java, JavaScript, Ruby, Python y go.</span><span class="sxs-lookup"><span data-stu-id="c26e7-216">Most major platforms are supported including .NET, Java, JavaScript, Ruby, Python, and Go.</span></span> <span data-ttu-id="c26e7-217">Los desarrolladores nunca deben comunicarse directamente con estas bibliotecas.</span><span class="sxs-lookup"><span data-stu-id="c26e7-217">Developers should never communicate directly with these libraries.</span></span> <span data-ttu-id="c26e7-218">Al hacerlo, se acoplará estrechamente el código del microservicio al Queue service Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="c26e7-218">Doing so will tightly couple your microservice code to the Azure Storage Queue service.</span></span> <span data-ttu-id="c26e7-219">Es aconsejable aislar los detalles de implementación de la API.</span><span class="sxs-lookup"><span data-stu-id="c26e7-219">It's a better practice to insulate the implementation details of the API.</span></span> <span data-ttu-id="c26e7-220">Introduzca una capa de intermediación, o una API intermedia, que exponga las operaciones genéricas y encapsule la biblioteca concreta.</span><span class="sxs-lookup"><span data-stu-id="c26e7-220">Introduce an intermediation layer, or intermediate API, that exposes generic operations and encapsulates the concrete library.</span></span> <span data-ttu-id="c26e7-221">Este acoplamiento flexible le permite intercambiar un servicio de cola por otro sin tener que realizar cambios en el código del servicio principal.</span><span class="sxs-lookup"><span data-stu-id="c26e7-221">This loose coupling enables you to swap out one queuing service for another without having to make changes to the mainline service code.</span></span>

<span data-ttu-id="c26e7-222">Azure Storage las colas son una opción económica para implementar la mensajería de comandos en las aplicaciones nativas de la nube.</span><span class="sxs-lookup"><span data-stu-id="c26e7-222">Azure Storage queues are an economical option to implement command messaging in your cloud-native applications.</span></span> <span data-ttu-id="c26e7-223">Especialmente cuando el tamaño de una cola supera los 80 GB, o un conjunto de características simple es aceptable.</span><span class="sxs-lookup"><span data-stu-id="c26e7-223">Especially when a queue size will exceed 80 GB, or a simple feature set is acceptable.</span></span> <span data-ttu-id="c26e7-224">Solo paga por el almacenamiento de los mensajes; no hay cargos por hora fijos.</span><span class="sxs-lookup"><span data-stu-id="c26e7-224">You only pay for the storage of the messages; there are no fixed hourly charges.</span></span>

### <a name="azure-service-bus-queues"></a><span data-ttu-id="c26e7-225">Colas de Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="c26e7-225">Azure Service Bus Queues</span></span>

<span data-ttu-id="c26e7-226">Para requisitos de mensajería más complejos, considere la posibilidad de Azure Service Bus las colas.</span><span class="sxs-lookup"><span data-stu-id="c26e7-226">For more complex messaging requirements, consider Azure Service Bus queues.</span></span>

<span data-ttu-id="c26e7-227">Sentado sobre una infraestructura de mensajes sólida, [Azure Service Bus](/azure/service-bus-messaging/service-bus-messaging-overview) admite un *modelo de mensajería* asíncrona.</span><span class="sxs-lookup"><span data-stu-id="c26e7-227">Sitting atop a robust message infrastructure, [Azure Service Bus](/azure/service-bus-messaging/service-bus-messaging-overview) supports a *brokered messaging model*.</span></span> <span data-ttu-id="c26e7-228">Los mensajes se almacenan de forma confiable en un agente (la cola) hasta que los recibe el consumidor.</span><span class="sxs-lookup"><span data-stu-id="c26e7-228">Messages are reliably stored in a broker (the queue) until received by the consumer.</span></span> <span data-ttu-id="c26e7-229">La cola garantiza la entrega de mensajes de primero en salir/primero en salir (FIFO), respetando el orden en que se agregaron los mensajes a la cola.</span><span class="sxs-lookup"><span data-stu-id="c26e7-229">The queue guarantees First-In/First-Out (FIFO) message delivery, respecting the order in which messages were added to the queue.</span></span>

<span data-ttu-id="c26e7-230">El tamaño de un mensaje puede ser mucho mayor, hasta 256 KB.</span><span class="sxs-lookup"><span data-stu-id="c26e7-230">The size of a message can be much larger, up to 256 KB.</span></span> <span data-ttu-id="c26e7-231">Los mensajes se conservan en la cola durante un período de tiempo ilimitado.</span><span class="sxs-lookup"><span data-stu-id="c26e7-231">Messages are persisted in the queue for an unlimited period of time.</span></span> <span data-ttu-id="c26e7-232">Service Bus admite no solo llamadas basadas en HTTP, sino que también proporciona compatibilidad total con el [Protocolo AMQP](/azure/service-bus-messaging/service-bus-amqp-overview).</span><span class="sxs-lookup"><span data-stu-id="c26e7-232">Service Bus supports not only HTTP-based calls, but also provides full support for the [AMQP protocol](/azure/service-bus-messaging/service-bus-amqp-overview).</span></span> <span data-ttu-id="c26e7-233">AMQP es un estándar abierto entre proveedores que admite un protocolo binario y mayores grados de confiabilidad.</span><span class="sxs-lookup"><span data-stu-id="c26e7-233">AMQP is an open-standard across vendors that supports a binary protocol and higher degrees of reliability.</span></span>

<span data-ttu-id="c26e7-234">Service Bus proporciona un amplio conjunto de características, incluida la [compatibilidad con transacciones](/azure/service-bus-messaging/service-bus-transactions) y una [característica de detección de duplicados](/azure/service-bus-messaging/duplicate-detection).</span><span class="sxs-lookup"><span data-stu-id="c26e7-234">Service Bus provides a rich set of features, including [transaction support](/azure/service-bus-messaging/service-bus-transactions) and a [duplicate detection feature](/azure/service-bus-messaging/duplicate-detection).</span></span> <span data-ttu-id="c26e7-235">La cola garantiza "como máximo una entrega" por mensaje.</span><span class="sxs-lookup"><span data-stu-id="c26e7-235">The queue guarantees "at most once delivery" per message.</span></span> <span data-ttu-id="c26e7-236">Descarta automáticamente un mensaje que ya se ha enviado.</span><span class="sxs-lookup"><span data-stu-id="c26e7-236">It automatically discards a message that has already been sent.</span></span> <span data-ttu-id="c26e7-237">Si un productor tiene dudas, puede volver a enviar el mismo mensaje y Service Bus garantiza que solo se procesará una copia.</span><span class="sxs-lookup"><span data-stu-id="c26e7-237">If a producer is in doubt, it can resend the same message, and Service Bus guarantees that only one copy will be processed.</span></span> <span data-ttu-id="c26e7-238">La detección de duplicados le libera de tener que crear una infraestructura de infraestructura adicional.</span><span class="sxs-lookup"><span data-stu-id="c26e7-238">Duplicate detection frees you from  having to build additional infrastructure plumbing.</span></span>

<span data-ttu-id="c26e7-239">Dos características más empresariales son las particiones y las sesiones.</span><span class="sxs-lookup"><span data-stu-id="c26e7-239">Two more enterprise features are partitioning and sessions.</span></span> <span data-ttu-id="c26e7-240">Un solo agente de mensajes controla una cola de Service Bus convencional y se almacena en un único almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-240">A conventional Service Bus queue is handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="c26e7-241">No obstante, la creación de [particiones Service Bus](/azure/service-bus-messaging/service-bus-partitioning) propaga la cola entre varios agentes de mensajes y almacenes de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-241">But, [Service Bus Partitioning](/azure/service-bus-messaging/service-bus-partitioning) spreads the queue across multiple message brokers and message stores.</span></span> <span data-ttu-id="c26e7-242">El rendimiento general ya no está limitado por el rendimiento de un solo agente de mensajes o almacén de mensajería.</span><span class="sxs-lookup"><span data-stu-id="c26e7-242">The overall throughput is no longer limited by the performance of a single message broker or messaging store.</span></span> <span data-ttu-id="c26e7-243">Una interrupción temporal de un almacén de mensajería no representa una cola con particiones disponible.</span><span class="sxs-lookup"><span data-stu-id="c26e7-243">A temporary outage of a messaging store doesn't render a partitioned queue unavailable.</span></span>

<span data-ttu-id="c26e7-244">Las [sesiones de Service Bus](https://codingcanvas.com/azure-service-bus-sessions/) proporcionan una manera de agrupar mensajes relacionados.</span><span class="sxs-lookup"><span data-stu-id="c26e7-244">[Service Bus Sessions](https://codingcanvas.com/azure-service-bus-sessions/) provide a way to group-related messages.</span></span> <span data-ttu-id="c26e7-245">Imagine un escenario de flujo de trabajo en el que los mensajes se deben procesar juntos y la operación se completa al final.</span><span class="sxs-lookup"><span data-stu-id="c26e7-245">Imagine a workflow scenario where messages must be processed together and the operation completed at the end.</span></span> <span data-ttu-id="c26e7-246">Para aprovechar las ventajas, las sesiones se deben habilitar explícitamente para la cola y cada mensaje relacionado debe contener el mismo identificador de sesión.</span><span class="sxs-lookup"><span data-stu-id="c26e7-246">To take advantage, sessions must be explicitly enabled for the queue and each related messaged must contain the same session ID.</span></span>

<span data-ttu-id="c26e7-247">Sin embargo, hay algunas advertencias importantes: Service Bus tamaño de las colas está limitado a 80 GB, que es mucho menor que lo que está disponible en las colas de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="c26e7-247">However, there are some important caveats: Service Bus queues size is limited to 80 GB, which is much smaller than what's available from store queues.</span></span> <span data-ttu-id="c26e7-248">Además, Service Bus las colas incurren en un costo base y un cargo por operación.</span><span class="sxs-lookup"><span data-stu-id="c26e7-248">Additionally, Service Bus queues incur a base cost and charge per operation.</span></span>

<span data-ttu-id="c26e7-249">En la figura 4-14 se describe la arquitectura de alto nivel de una cola de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="c26e7-249">Figure 4-14 outlines the high-level architecture of a Service Bus queue.</span></span>

![Cola de Service Bus](./media/service-bus-queue.png)

<span data-ttu-id="c26e7-251">**Figura 4-14**.</span><span class="sxs-lookup"><span data-stu-id="c26e7-251">**Figure 4-14**.</span></span> <span data-ttu-id="c26e7-252">Cola de Service Bus</span><span class="sxs-lookup"><span data-stu-id="c26e7-252">Service Bus queue</span></span>

<span data-ttu-id="c26e7-253">En la ilustración anterior, observe la relación punto a punto.</span><span class="sxs-lookup"><span data-stu-id="c26e7-253">In the previous figure, note the point-to-point relationship.</span></span> <span data-ttu-id="c26e7-254">Dos instancias del mismo proveedor están poniendo en cola los mensajes en una sola cola de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="c26e7-254">Two instances of the same provider are enqueuing messages into a single Service Bus queue.</span></span> <span data-ttu-id="c26e7-255">Cada mensaje se consume solo en una de las tres instancias de consumidor de la derecha.</span><span class="sxs-lookup"><span data-stu-id="c26e7-255">Each message is consumed by only one of three consumer instances on the right.</span></span> <span data-ttu-id="c26e7-256">A continuación, se describe cómo implementar la mensajería en la que es posible que todos los consumidores puedan estar interesados en el mismo mensaje.</span><span class="sxs-lookup"><span data-stu-id="c26e7-256">Next, we discuss how to implement messaging where different consumers may all be interested the same message.</span></span>

## <a name="events"></a><span data-ttu-id="c26e7-257">Eventos</span><span class="sxs-lookup"><span data-stu-id="c26e7-257">Events</span></span>

<span data-ttu-id="c26e7-258">Message Queue Server es una manera eficaz de implementar la comunicación en la que un productor puede enviar un mensaje de forma asincrónica a un consumidor.</span><span class="sxs-lookup"><span data-stu-id="c26e7-258">Message queuing is an effective way to implement communication where a producer can asynchronously send a consumer a message.</span></span> <span data-ttu-id="c26e7-259">Sin embargo, ¿qué ocurre cuando *muchos consumidores diferentes* están interesados en el mismo mensaje?</span><span class="sxs-lookup"><span data-stu-id="c26e7-259">However, what happens when *many different consumers* are interested in the same message?</span></span> <span data-ttu-id="c26e7-260">Una cola de mensajes dedicada para cada consumidor no se podría escalar bien y resultaría difícil de administrar.</span><span class="sxs-lookup"><span data-stu-id="c26e7-260">A dedicated message queue for each consumer wouldn't scale well and would become difficult to manage.</span></span>

<span data-ttu-id="c26e7-261">Para abordar este escenario, pasamos al tercer tipo de interacción de mensajes, el *evento*.</span><span class="sxs-lookup"><span data-stu-id="c26e7-261">To address this scenario, we move to the third type of message interaction, the *event*.</span></span> <span data-ttu-id="c26e7-262">Un microservicio anuncia que se ha producido una acción.</span><span class="sxs-lookup"><span data-stu-id="c26e7-262">One microservice announces that an action had occurred.</span></span> <span data-ttu-id="c26e7-263">Otros microservicios, si está interesado, reaccionan ante la acción o el evento.</span><span class="sxs-lookup"><span data-stu-id="c26e7-263">Other microservices, if interested, react to the action, or event.</span></span>

<span data-ttu-id="c26e7-264">Los eventos son un proceso de dos pasos.</span><span class="sxs-lookup"><span data-stu-id="c26e7-264">Eventing is a two-step process.</span></span> <span data-ttu-id="c26e7-265">Para un cambio de estado determinado, un microservicio publica un evento en un agente de mensajes, lo que lo pone a disposición de cualquier otro microservicio interesado.</span><span class="sxs-lookup"><span data-stu-id="c26e7-265">For a given state change, a microservice publishes an event to a message broker, making it available to any other interested microservice.</span></span> <span data-ttu-id="c26e7-266">El microservicio interesado se notifica mediante la suscripción al evento en el agente de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-266">The interested microservice is notified by subscribing to the event in the message broker.</span></span> <span data-ttu-id="c26e7-267">El patrón de [publicación/suscripción](/azure/architecture/patterns/publisher-subscriber) se usa para implementar la [comunicación basada en eventos](/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications).</span><span class="sxs-lookup"><span data-stu-id="c26e7-267">You use the [Publish/Subscribe](/azure/architecture/patterns/publisher-subscriber) pattern to implement [event-based communication](/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications).</span></span>

<span data-ttu-id="c26e7-268">En la figura 4-15 se muestra un microservicio de cesta de la compra que publica un evento con otros dos microservicios que se suscriben a él.</span><span class="sxs-lookup"><span data-stu-id="c26e7-268">Figure 4-15 shows a shopping basket microservice publishing an event with two other microservices subscribing to it.</span></span>

![Mensajería Event-Driven](./media/event-driven-messaging.png)

<span data-ttu-id="c26e7-270">**Figura 4-15**.</span><span class="sxs-lookup"><span data-stu-id="c26e7-270">**Figure 4-15**.</span></span> <span data-ttu-id="c26e7-271">Mensajería Event-Driven</span><span class="sxs-lookup"><span data-stu-id="c26e7-271">Event-Driven messaging</span></span>

<span data-ttu-id="c26e7-272">Tenga en cuenta el componente de *bus de eventos* que se encuentra en medio del canal de comunicación.</span><span class="sxs-lookup"><span data-stu-id="c26e7-272">Note the *event bus* component that sits in the middle of the communication channel.</span></span> <span data-ttu-id="c26e7-273">Es una clase personalizada que encapsula el agente de mensajes y lo desacopla de la aplicación subyacente.</span><span class="sxs-lookup"><span data-stu-id="c26e7-273">It's a custom class that encapsulates the message broker and decouples it from the underlying application.</span></span> <span data-ttu-id="c26e7-274">Los microservicios de ordenación y de inventario operan de forma independiente el evento sin ningún conocimiento de los demás ni del microservicio de cesta de la compra.</span><span class="sxs-lookup"><span data-stu-id="c26e7-274">The ordering and inventory microservices independently operate the event with no knowledge of each other, nor the shopping basket microservice.</span></span> <span data-ttu-id="c26e7-275">Cuando el evento registrado se publica en el bus de eventos, actúan sobre él.</span><span class="sxs-lookup"><span data-stu-id="c26e7-275">When the registered event is published to the event bus, they act upon it.</span></span>

<span data-ttu-id="c26e7-276">Con los eventos, pasamos de la tecnología de puesta en cola a los *temas*.</span><span class="sxs-lookup"><span data-stu-id="c26e7-276">With eventing, we move from queuing technology to *topics*.</span></span> <span data-ttu-id="c26e7-277">Un [tema](/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) es similar a una cola, pero admite un patrón de mensajería de uno a varios.</span><span class="sxs-lookup"><span data-stu-id="c26e7-277">A [topic](/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) is similar to a queue, but supports a one-to-many messaging pattern.</span></span> <span data-ttu-id="c26e7-278">Un microservicio publica un mensaje.</span><span class="sxs-lookup"><span data-stu-id="c26e7-278">One microservice publishes a message.</span></span> <span data-ttu-id="c26e7-279">Varios microservicios de suscripción pueden optar por recibir el mensaje y actuar sobre él.</span><span class="sxs-lookup"><span data-stu-id="c26e7-279">Multiple subscribing microservices can choose to receive and act upon that message.</span></span> <span data-ttu-id="c26e7-280">En la figura 4-16 se muestra una arquitectura de tema.</span><span class="sxs-lookup"><span data-stu-id="c26e7-280">Figure 4-16 shows a topic architecture.</span></span>

![Arquitectura de temas](./media/topic-architecture.png)

<span data-ttu-id="c26e7-282">**Figura 4-16**.</span><span class="sxs-lookup"><span data-stu-id="c26e7-282">**Figure 4-16**.</span></span> <span data-ttu-id="c26e7-283">Arquitectura de temas</span><span class="sxs-lookup"><span data-stu-id="c26e7-283">Topic architecture</span></span>

<span data-ttu-id="c26e7-284">En la ilustración anterior, los publicadores envían mensajes al tema.</span><span class="sxs-lookup"><span data-stu-id="c26e7-284">In the previous figure, publishers send messages to the topic.</span></span> <span data-ttu-id="c26e7-285">Al final, los suscriptores reciben mensajes de las suscripciones.</span><span class="sxs-lookup"><span data-stu-id="c26e7-285">At the end, subscribers receive messages from subscriptions.</span></span> <span data-ttu-id="c26e7-286">En el centro, el tema reenvía los mensajes a las suscripciones en función de un conjunto de reglas, que se muestra en los cuadros azul oscuro.</span><span class="sxs-lookup"><span data-stu-id="c26e7-286">In the middle, the topic forwards messages to subscriptions based on a set of rules, shown in dark blue boxes.</span></span> <span data-ttu-id="c26e7-287">Las reglas actúan como un filtro que reenvía mensajes específicos a una suscripción.</span><span class="sxs-lookup"><span data-stu-id="c26e7-287">Rules act as a filter that forward specific messages to a subscription.</span></span> <span data-ttu-id="c26e7-288">En este caso, se enviará un evento "GetPrice" al precio y a las suscripciones de registro, ya que la suscripción de registro ha elegido recibir todos los mensajes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-288">Here, a "GetPrice" event would be sent to the price and logging subscriptions as the logging subscription has chosen to receive all messages.</span></span>  <span data-ttu-id="c26e7-289">Un evento "GetInformation" se enviaría a la información y a las suscripciones de registro.</span><span class="sxs-lookup"><span data-stu-id="c26e7-289">A "GetInformation" event would be sent to the information and logging subscriptions.</span></span>

<span data-ttu-id="c26e7-290">La nube de Azure admite dos servicios de temas distintos: Azure Service Bus temas y Azure EventGrid.</span><span class="sxs-lookup"><span data-stu-id="c26e7-290">The Azure cloud supports two different topic services: Azure Service Bus Topics and Azure EventGrid.</span></span>

### <a name="azure-service-bus-topics"></a><span data-ttu-id="c26e7-291">Azure Service Bus Topics</span><span class="sxs-lookup"><span data-stu-id="c26e7-291">Azure Service Bus Topics</span></span>

<span data-ttu-id="c26e7-292">En la parte superior del mismo modelo de mensaje asincrónico de Azure Service Bus colas se [Azure Service Bus temas](/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span><span class="sxs-lookup"><span data-stu-id="c26e7-292">Sitting on top of the same robust brokered message model of Azure Service Bus queues are [Azure Service Bus Topics](/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span></span> <span data-ttu-id="c26e7-293">Un tema puede recibir mensajes de varios publicadores independientes y enviar mensajes a hasta 2.000 suscriptores.</span><span class="sxs-lookup"><span data-stu-id="c26e7-293">A topic can receive messages from multiple independent publishers and send messages to up to 2,000 subscribers.</span></span> <span data-ttu-id="c26e7-294">Las suscripciones se pueden agregar o quitar dinámicamente en tiempo de ejecución sin detener el sistema ni volver a crear el tema.</span><span class="sxs-lookup"><span data-stu-id="c26e7-294">Subscriptions can be dynamically added or removed at runtime without stopping the system or recreating the topic.</span></span>

<span data-ttu-id="c26e7-295">Muchas características avanzadas de Azure Service Bus colas también están disponibles para los temas, como la [detección de duplicados](/azure/service-bus-messaging/duplicate-detection) y la [compatibilidad con transacciones](/azure/service-bus-messaging/service-bus-transactions).</span><span class="sxs-lookup"><span data-stu-id="c26e7-295">Many advanced features from Azure Service Bus queues are also available for topics, including [Duplicate Detection](/azure/service-bus-messaging/duplicate-detection) and [Transaction support](/azure/service-bus-messaging/service-bus-transactions).</span></span> <span data-ttu-id="c26e7-296">De forma predeterminada, los temas de Service Bus se controlan mediante un único agente de mensajes y se almacenan en un único almacén de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-296">By default, Service Bus topics are handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="c26e7-297">No obstante, la creación de [particiones de Service Bus](/azure/service-bus-messaging/service-bus-partitioning) escala un tema mediante la propagación entre varios agentes de mensajes y almacenes de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-297">But, [Service Bus Partitioning](/azure/service-bus-messaging/service-bus-partitioning) scales a topic by spreading it across many message brokers and message stores.</span></span>

<span data-ttu-id="c26e7-298">La [entrega de mensajes programada](/azure/service-bus-messaging/message-sequencing) etiqueta un mensaje con una hora específica para su procesamiento.</span><span class="sxs-lookup"><span data-stu-id="c26e7-298">[Scheduled Message Delivery](/azure/service-bus-messaging/message-sequencing) tags a message with a specific time for processing.</span></span> <span data-ttu-id="c26e7-299">El mensaje no aparecerá en el tema antes de esa hora.</span><span class="sxs-lookup"><span data-stu-id="c26e7-299">The message won't appear in the topic before that time.</span></span> <span data-ttu-id="c26e7-300">El [aplazamiento de mensajes](/azure/service-bus-messaging/message-deferral) le permite aplazar una recuperación de un mensaje en otro momento.</span><span class="sxs-lookup"><span data-stu-id="c26e7-300">[Message Deferral](/azure/service-bus-messaging/message-deferral) enables you to defer a retrieval of a message to a later time.</span></span> <span data-ttu-id="c26e7-301">Ambos se usan normalmente en escenarios de procesamiento de flujo de trabajo donde las operaciones se procesan en un orden determinado.</span><span class="sxs-lookup"><span data-stu-id="c26e7-301">Both are commonly used in workflow processing scenarios where operations are processed in a particular order.</span></span> <span data-ttu-id="c26e7-302">Puede posponer el procesamiento de los mensajes recibidos hasta que se complete el trabajo anterior.</span><span class="sxs-lookup"><span data-stu-id="c26e7-302">You can postpone processing of received messages until prior work has been completed.</span></span>

<span data-ttu-id="c26e7-303">Service Bus temas son una tecnología sólida y probada para habilitar la comunicación de publicación/suscripción en los sistemas nativos de la nube.</span><span class="sxs-lookup"><span data-stu-id="c26e7-303">Service Bus topics are a robust and proven technology for enabling publish/subscribe communication in your cloud-native systems.</span></span>

### <a name="azure-event-grid"></a><span data-ttu-id="c26e7-304">Azure Event Grid</span><span class="sxs-lookup"><span data-stu-id="c26e7-304">Azure Event Grid</span></span>

<span data-ttu-id="c26e7-305">Aunque Azure Service Bus es un agente de mensajería probado en la batalla con un conjunto completo de características empresariales, [Azure Event Grid](/azure/event-grid/overview) es el nuevo niño en el bloque.</span><span class="sxs-lookup"><span data-stu-id="c26e7-305">While Azure Service Bus is a battle-tested messaging broker with a full set of enterprise features, [Azure Event Grid](/azure/event-grid/overview) is the new kid on the block.</span></span>

<span data-ttu-id="c26e7-306">A primera vista, Event Grid puede parecer simplemente otro sistema de mensajería basado en temas.</span><span class="sxs-lookup"><span data-stu-id="c26e7-306">At first glance, Event Grid may look like just another topic-based messaging system.</span></span> <span data-ttu-id="c26e7-307">Sin embargo, es diferente de muchas maneras.</span><span class="sxs-lookup"><span data-stu-id="c26e7-307">However, it's different in many ways.</span></span> <span data-ttu-id="c26e7-308">Centrado en las cargas de trabajo orientadas a eventos, permite el procesamiento de eventos en tiempo real, la integración profunda de Azure y una plataforma abierta, todo ello en una infraestructura sin servidor.</span><span class="sxs-lookup"><span data-stu-id="c26e7-308">Focused on event-driven workloads, it enables real-time event processing, deep Azure integration, and an open-platform - all on serverless infrastructure.</span></span> <span data-ttu-id="c26e7-309">Está diseñado para aplicaciones contemporáneos nativas en la nube y sin servidor</span><span class="sxs-lookup"><span data-stu-id="c26e7-309">It's designed for contemporary cloud-native and serverless applications</span></span>

<span data-ttu-id="c26e7-310">Como *backplane* centralizado, o canalización, Event Grid reacciona a los eventos dentro de los recursos de Azure y desde sus propios servicios.</span><span class="sxs-lookup"><span data-stu-id="c26e7-310">As a centralized *eventing backplane*, or pipe, Event Grid reacts to events inside Azure resources and from your own services.</span></span>

<span data-ttu-id="c26e7-311">Las notificaciones de eventos se publican en un tema Event Grid, que, a su vez, enruta cada evento a una suscripción.</span><span class="sxs-lookup"><span data-stu-id="c26e7-311">Event notifications are published to an Event Grid Topic, which, in turn, routes each event to a subscription.</span></span> <span data-ttu-id="c26e7-312">Los suscriptores se asignan a las suscripciones y consumen los eventos.</span><span class="sxs-lookup"><span data-stu-id="c26e7-312">Subscribers map to subscriptions and consume the events.</span></span> <span data-ttu-id="c26e7-313">Al igual que Service Bus, Event Grid admite un *modelo de suscriptor filtrado* donde una suscripción establece una regla para los eventos que desea recibir.</span><span class="sxs-lookup"><span data-stu-id="c26e7-313">Like Service Bus, Event Grid supports a *filtered subscriber model* where a subscription sets rule for the events it wishes to receive.</span></span> <span data-ttu-id="c26e7-314">Event Grid proporciona un rendimiento rápido con una garantía de 10 millones eventos por segundo, lo que permite la entrega casi en tiempo real, más allá de lo que puede generar Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="c26e7-314">Event Grid provides fast throughput with a guarantee of 10 million events per second enabling near real-time delivery - far more than what Azure Service Bus can generate.</span></span>

<span data-ttu-id="c26e7-315">Una zona dulce para Event Grid es su profunda integración en el tejido de la infraestructura de Azure.</span><span class="sxs-lookup"><span data-stu-id="c26e7-315">A sweet spot for Event Grid is its deep integration into the fabric of Azure infrastructure.</span></span> <span data-ttu-id="c26e7-316">Un recurso de Azure, como Cosmos DB, puede publicar eventos integrados directamente en otros recursos de Azure interesados, sin necesidad de código personalizado.</span><span class="sxs-lookup"><span data-stu-id="c26e7-316">An Azure resource, such as Cosmos DB, can publish built-in events directly to other interested Azure resources - without the need for custom code.</span></span> <span data-ttu-id="c26e7-317">Event Grid puede publicar eventos de una suscripción, un grupo de recursos o un servicio de Azure, lo que permite a los desarrolladores controlar el ciclo de vida de los recursos en la nube.</span><span class="sxs-lookup"><span data-stu-id="c26e7-317">Event Grid can publish events from an Azure Subscription, Resource Group, or Service, giving developers fine-grained control over the lifecycle of cloud resources.</span></span> <span data-ttu-id="c26e7-318">Sin embargo, Event Grid no se limita a Azure.</span><span class="sxs-lookup"><span data-stu-id="c26e7-318">However, Event Grid isn't limited to Azure.</span></span> <span data-ttu-id="c26e7-319">Es una plataforma abierta que puede consumir eventos HTTP personalizados publicados desde aplicaciones o servicios de terceros y enrutar eventos a suscriptores externos.</span><span class="sxs-lookup"><span data-stu-id="c26e7-319">It's an open platform that can consume custom HTTP events published from applications or third-party services and route events to external subscribers.</span></span>

<span data-ttu-id="c26e7-320">Al publicar y suscribirse a eventos nativos desde recursos de Azure, no se requiere ninguna codificación.</span><span class="sxs-lookup"><span data-stu-id="c26e7-320">When publishing and subscribing to native events from Azure resources, no coding is required.</span></span> <span data-ttu-id="c26e7-321">Con la configuración sencilla, puede integrar eventos de un recurso de Azure a otro aprovechando la fontanería integrada para los temas y las suscripciones.</span><span class="sxs-lookup"><span data-stu-id="c26e7-321">With simple configuration, you can integrate events from one Azure resource to another leveraging built-in plumbing for Topics and Subscriptions.</span></span> <span data-ttu-id="c26e7-322">En la figura 4-17 se muestra la anatomía de Event Grid.</span><span class="sxs-lookup"><span data-stu-id="c26e7-322">Figure 4-17 shows the anatomy of Event Grid.</span></span>

![Event Grid anatomía](./media/event-grid-anatomy.png)

<span data-ttu-id="c26e7-324">**Figura 4-17**.</span><span class="sxs-lookup"><span data-stu-id="c26e7-324">**Figure 4-17**.</span></span> <span data-ttu-id="c26e7-325">Event Grid anatomía</span><span class="sxs-lookup"><span data-stu-id="c26e7-325">Event Grid anatomy</span></span>

<span data-ttu-id="c26e7-326">Una diferencia importante entre EventGrid y Service Bus es el *patrón de intercambio de mensajes* subyacente.</span><span class="sxs-lookup"><span data-stu-id="c26e7-326">A major difference between EventGrid and Service Bus is the underlying *message exchange pattern*.</span></span>

<span data-ttu-id="c26e7-327">Service Bus implementa un *modelo de extracción* de estilo anterior en el que el suscriptor de nivel inferior sondea activamente la suscripción de tema para los nuevos mensajes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-327">Service Bus implements an older style *pull model* in which the downstream subscriber actively polls the topic subscription for new messages.</span></span> <span data-ttu-id="c26e7-328">En el costado, este enfoque proporciona al suscriptor control total sobre el ritmo en el que procesa los mensajes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-328">On the upside, this approach gives the subscriber full control of the pace at which it processes messages.</span></span> <span data-ttu-id="c26e7-329">Controla cuándo y cuántos mensajes se procesan en un momento dado.</span><span class="sxs-lookup"><span data-stu-id="c26e7-329">It controls when and how many messages to process at any given time.</span></span> <span data-ttu-id="c26e7-330">Los mensajes sin leer permanecen en la suscripción hasta que se procesen.</span><span class="sxs-lookup"><span data-stu-id="c26e7-330">Unread messages remain in the subscription until processed.</span></span> <span data-ttu-id="c26e7-331">Una laguna significativa es la latencia entre el momento en que se genera el evento y la operación de sondeo que extrae ese mensaje al suscriptor para su procesamiento.</span><span class="sxs-lookup"><span data-stu-id="c26e7-331">A significant shortcoming is the latency between the time the event is generated and the polling operation that pulls that message to the subscriber for processing.</span></span> <span data-ttu-id="c26e7-332">Además, la sobrecarga de sondeo constante para el siguiente evento consume recursos y dinero.</span><span class="sxs-lookup"><span data-stu-id="c26e7-332">Also, the overhead of constant polling for the next event consumes resources and money.</span></span>

<span data-ttu-id="c26e7-333">Sin embargo, EventGrid es diferente.</span><span class="sxs-lookup"><span data-stu-id="c26e7-333">EventGrid, however, is different.</span></span> <span data-ttu-id="c26e7-334">Implementa un modelo de *Insertar* en el que los eventos se envían a EventHandlers tal como se reciben, lo que da lugar a una entrega de eventos casi en tiempo real.</span><span class="sxs-lookup"><span data-stu-id="c26e7-334">It implements a *push model* in which events are sent to the EventHandlers as received, giving near real-time event delivery.</span></span> <span data-ttu-id="c26e7-335">También reduce el costo ya que el servicio solo se desencadena cuando se necesita consumir un evento, no continuamente como con el sondeo.</span><span class="sxs-lookup"><span data-stu-id="c26e7-335">It also reduces cost as the service is triggered only when it's needed to consume an event – not continually as with polling.</span></span> <span data-ttu-id="c26e7-336">Dicho esto, un controlador de eventos debe administrar la carga entrante y proporcionar mecanismos de limitación para evitar que se sobrecargue.</span><span class="sxs-lookup"><span data-stu-id="c26e7-336">That said, an event handler must handle the incoming load and provide throttling mechanisms to protect itself from becoming overwhelmed.</span></span> <span data-ttu-id="c26e7-337">Muchos servicios de Azure que consumen estos eventos, como Azure Functions y Logic Apps proporcionan funcionalidades de escalado automático automática para controlar las mayores cargas.</span><span class="sxs-lookup"><span data-stu-id="c26e7-337">Many Azure services that consume these events, such as Azure Functions and Logic Apps provide automatic autoscaling capabilities to handle increased loads.</span></span>  

<span data-ttu-id="c26e7-338">Event Grid es un servicio en la nube sin servidor totalmente administrado.</span><span class="sxs-lookup"><span data-stu-id="c26e7-338">Event Grid is a fully managed serverless cloud service.</span></span> <span data-ttu-id="c26e7-339">Se escala dinámicamente en función del tráfico y se le cobra solo por el uso real, no por la capacidad adquirida previamente.</span><span class="sxs-lookup"><span data-stu-id="c26e7-339">It dynamically scales based on your traffic and charges you only for your actual usage, not pre-purchased capacity.</span></span> <span data-ttu-id="c26e7-340">Las primeras 100.000 operaciones al mes son gratuitas: las operaciones que se definen como entrada de eventos (notificaciones de eventos entrantes), intentos de entrega de suscripciones, llamadas de administración y filtrado por asunto.</span><span class="sxs-lookup"><span data-stu-id="c26e7-340">The first 100,000 operations per month are free – operations being defined as event ingress (incoming event notifications), subscription delivery attempts, management calls, and filtering by subject.</span></span> <span data-ttu-id="c26e7-341">Con una disponibilidad del 99,99%, EventGrid garantiza la entrega de un evento en un período de 24 horas, con funcionalidad de reintento integrada para la entrega incorrecta.</span><span class="sxs-lookup"><span data-stu-id="c26e7-341">With 99.99% availability, EventGrid guarantees the delivery of an event within a 24-hour period, with built-in retry functionality for unsuccessful delivery.</span></span> <span data-ttu-id="c26e7-342">Los mensajes no entregados se pueden migrar a una cola de "mensajes con problemas de entrega" para su resolución.</span><span class="sxs-lookup"><span data-stu-id="c26e7-342">Undelivered messages can be moved to a "dead-letter" queue for resolution.</span></span>  <span data-ttu-id="c26e7-343">A diferencia de Azure Service Bus, Event Grid se optimiza para un rendimiento rápido y no admite características como mensajería ordenada, transacciones y sesiones.</span><span class="sxs-lookup"><span data-stu-id="c26e7-343">Unlike Azure Service Bus, Event Grid is tuned for fast performance and doesn't support features like ordered messaging, transactions, and sessions.</span></span>

### <a name="streaming-messages-in-the-azure-cloud"></a><span data-ttu-id="c26e7-344">Transmisión de mensajes en la nube de Azure</span><span class="sxs-lookup"><span data-stu-id="c26e7-344">Streaming messages in the Azure cloud</span></span>

<span data-ttu-id="c26e7-345">Azure Service Bus y Event Grid proporcionan una gran compatibilidad para las aplicaciones que exponen eventos únicos y discretos, como un nuevo documento, que se ha insertado en un Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="c26e7-345">Azure Service Bus and Event Grid provide great support for applications that expose single, discrete events like a new document has been inserted into a Cosmos DB.</span></span> <span data-ttu-id="c26e7-346">Pero, ¿qué ocurre si el sistema nativo de la nube necesita procesar un *flujo de eventos relacionados*?</span><span class="sxs-lookup"><span data-stu-id="c26e7-346">But, what if your cloud-native system needs to process a *stream of related events*?</span></span> <span data-ttu-id="c26e7-347">Los [flujos de eventos](/archive/msdn-magazine/2015/february/microsoft-azure-the-rise-of-event-stream-oriented-systems) son más complejos.</span><span class="sxs-lookup"><span data-stu-id="c26e7-347">[Event streams](/archive/msdn-magazine/2015/february/microsoft-azure-the-rise-of-event-stream-oriented-systems) are more complex.</span></span> <span data-ttu-id="c26e7-348">Normalmente, se ordenan por tiempo, se interrelacionan y se deben procesar como un grupo.</span><span class="sxs-lookup"><span data-stu-id="c26e7-348">They're typically time-ordered, interrelated, and must be processed as a group.</span></span>

<span data-ttu-id="c26e7-349">[Azure Event hubs](https://azure.microsoft.com/services/event-hubs/) es una plataforma de streaming de datos y un servicio de ingesta de eventos que recopila, transforma y almacena eventos.</span><span class="sxs-lookup"><span data-stu-id="c26e7-349">[Azure Event Hub](https://azure.microsoft.com/services/event-hubs/) is a data streaming platform and event ingestion service that collects, transforms, and stores events.</span></span> <span data-ttu-id="c26e7-350">Se ajusta para capturar datos de streaming, como las notificaciones de eventos continuos que se emiten desde un contexto de telemetría.</span><span class="sxs-lookup"><span data-stu-id="c26e7-350">It's fine-tuned to capture streaming data, such as continuous event notifications emitted from a telemetry context.</span></span> <span data-ttu-id="c26e7-351">El servicio es muy escalable y puede almacenar y [procesar millones de eventos por segundo](/azure/event-hubs/event-hubs-about).</span><span class="sxs-lookup"><span data-stu-id="c26e7-351">The service is highly scalable and can store and [process millions of events per second](/azure/event-hubs/event-hubs-about).</span></span> <span data-ttu-id="c26e7-352">Como se muestra en la figura 4-18, a menudo es una puerta delantera para una canalización de eventos, desacoplando el flujo de ingesta del consumo de eventos.</span><span class="sxs-lookup"><span data-stu-id="c26e7-352">Shown in Figure 4-18, it's often a front door for an event pipeline, decoupling ingest stream from event consumption.</span></span>

![Centro de eventos de Azure](./media/azure-event-hub.png)

<span data-ttu-id="c26e7-354">**Figura 4-18**.</span><span class="sxs-lookup"><span data-stu-id="c26e7-354">**Figure 4-18**.</span></span> <span data-ttu-id="c26e7-355">Centro de eventos de Azure</span><span class="sxs-lookup"><span data-stu-id="c26e7-355">Azure Event Hub</span></span>

<span data-ttu-id="c26e7-356">Event hubs admite la baja latencia y la retención de tiempo configurable.</span><span class="sxs-lookup"><span data-stu-id="c26e7-356">Event Hub supports low latency and configurable time retention.</span></span> <span data-ttu-id="c26e7-357">A diferencia de las colas y los temas, Event Hubs conservar los datos de eventos después de que los lea un consumidor.</span><span class="sxs-lookup"><span data-stu-id="c26e7-357">Unlike queues and topics, Event Hubs keep event data after it's been read by a consumer.</span></span> <span data-ttu-id="c26e7-358">Esta característica permite a otros servicios de análisis de datos, tanto internos como externos, reproducir los datos para su posterior análisis.</span><span class="sxs-lookup"><span data-stu-id="c26e7-358">This feature enables other data analytic services, both internal and external, to replay the data for further analysis.</span></span> <span data-ttu-id="c26e7-359">Los eventos almacenados en el centro de eventos solo se eliminan tras la expiración del período de retención, que es un día de forma predeterminada, pero configurable.</span><span class="sxs-lookup"><span data-stu-id="c26e7-359">Events stored in event hub are only deleted upon expiration of the retention period, which is one day by default, but configurable.</span></span>

<span data-ttu-id="c26e7-360">Event hubs admite protocolos de publicación de eventos comunes, como HTTPS y AMQP.</span><span class="sxs-lookup"><span data-stu-id="c26e7-360">Event Hub supports common event publishing protocols including HTTPS and AMQP.</span></span> <span data-ttu-id="c26e7-361">También es compatible con Kafka 1,0.</span><span class="sxs-lookup"><span data-stu-id="c26e7-361">It also supports Kafka 1.0.</span></span> <span data-ttu-id="c26e7-362">[Las aplicaciones de Kafka existentes pueden comunicarse con el centro de eventos](/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) mediante el protocolo Kafka, lo que proporciona una alternativa a la administración de clústeres de Kafka de gran tamaño.</span><span class="sxs-lookup"><span data-stu-id="c26e7-362">[Existing Kafka applications can communicate with Event Hub](/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) using the Kafka protocol providing an alternative to managing large Kafka clusters.</span></span> <span data-ttu-id="c26e7-363">Muchos sistemas nativos de la nube de código abierto adoptan Kafka.</span><span class="sxs-lookup"><span data-stu-id="c26e7-363">Many open-source cloud-native systems embrace Kafka.</span></span>

<span data-ttu-id="c26e7-364">Event Hubs implementa el streaming de mensajes a través de un [modelo de consumidor con particiones](/azure/event-hubs/event-hubs-features) en el que cada consumidor solo Lee un subconjunto específico o una partición del flujo de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-364">Event Hubs implements message streaming through a [partitioned consumer model](/azure/event-hubs/event-hubs-features) in which each consumer only reads a specific subset, or partition, of the message stream.</span></span> <span data-ttu-id="c26e7-365">Este patrón permite una gran escala horizontal para procesamiento de eventos y proporciona otras características centradas en secuencias que no están disponibles en colas y temas.</span><span class="sxs-lookup"><span data-stu-id="c26e7-365">This pattern enables tremendous horizontal scale for event processing and provides other stream-focused features that are unavailable in queues and topics.</span></span> <span data-ttu-id="c26e7-366">Una partición es una secuencia ordenada de eventos que se mantiene en un centro de eventos.</span><span class="sxs-lookup"><span data-stu-id="c26e7-366">A partition is an ordered sequence of events that is held in an event hub.</span></span> <span data-ttu-id="c26e7-367">A medida que llegan eventos más recientes, se agregan al final de esta secuencia.</span><span class="sxs-lookup"><span data-stu-id="c26e7-367">As newer events arrive, they're added to the end of this sequence.</span></span> <span data-ttu-id="c26e7-368">En la figura 4-19 se muestra la creación de particiones en un centro de eventos.</span><span class="sxs-lookup"><span data-stu-id="c26e7-368">Figure 4-19 shows partitioning in an Event Hub.</span></span>

![Creación de particiones del centro de eventos](./media/event-hub-partitioning.png)

<span data-ttu-id="c26e7-370">**Figura 4-19**.</span><span class="sxs-lookup"><span data-stu-id="c26e7-370">**Figure 4-19**.</span></span> <span data-ttu-id="c26e7-371">Creación de particiones del centro de eventos</span><span class="sxs-lookup"><span data-stu-id="c26e7-371">Event Hub partitioning</span></span>

<span data-ttu-id="c26e7-372">En lugar de leer desde el mismo recurso, cada grupo de consumidores Lee un subconjunto o una partición del flujo de mensajes.</span><span class="sxs-lookup"><span data-stu-id="c26e7-372">Instead of reading from the same resource, each consumer group reads across a subset, or partition, of the message stream.</span></span>

<span data-ttu-id="c26e7-373">En el caso de las aplicaciones nativas de la nube que deben transmitir un gran número de eventos, Azure Event Hub puede ser una solución sólida y asequible.</span><span class="sxs-lookup"><span data-stu-id="c26e7-373">For cloud-native applications that must stream large numbers of events, Azure Event Hub can be a robust and affordable solution.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="c26e7-374">[Anterior](front-end-communication.md)
>[Siguiente](grpc.md)</span><span class="sxs-lookup"><span data-stu-id="c26e7-374">[Previous](front-end-communication.md)
[Next](grpc.md)</span></span>
