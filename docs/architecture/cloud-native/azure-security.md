---
title: Seguridad de Azure para aplicaciones nativas en la nube
description: Diseño de aplicaciones .NET nativas en la nube para Azure | Seguridad de Azure para aplicaciones nativas en la nube
ms.date: 05/13/2020
ms.openlocfilehash: a39b64477eb9e896c6603e5609ede653bfee1e07
ms.sourcegitcommit: 27db07ffb26f76912feefba7b884313547410db5
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/19/2020
ms.locfileid: "83614258"
---
# <a name="azure-security-for-cloud-native-apps"></a><span data-ttu-id="5a2e6-103">Seguridad de Azure para aplicaciones nativas en la nube</span><span class="sxs-lookup"><span data-stu-id="5a2e6-103">Azure security for cloud-native apps</span></span>

<span data-ttu-id="5a2e6-104">Las aplicaciones nativas en la nube pueden ser más fáciles y más difíciles de proteger que las aplicaciones tradicionales.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-104">Cloud-native applications can be both easier and more difficult to secure than traditional applications.</span></span> <span data-ttu-id="5a2e6-105">En el inconveniente, debe proteger aplicaciones más pequeñas y dedicar más energía a la creación de la infraestructura de seguridad.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-105">On the downside, you need to secure more smaller applications and dedicate more energy to build out the security infrastructure.</span></span> <span data-ttu-id="5a2e6-106">La naturaleza heterogénea de los lenguajes de programación y los estilos en la mayoría de las implementaciones de servicio también significa que debe prestar más atención a los boletines de seguridad de muchos proveedores diferentes.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-106">The heterogeneous nature of programming languages and styles in most service deployments also means you need to pay more attention to security bulletins from many different providers.</span></span>

<span data-ttu-id="5a2e6-107">En el lado de volteo, los servicios más pequeños, cada uno con su propio almacén de datos, limitan el ámbito de un ataque.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-107">On the flip side, smaller services, each with their own data store, limit the scope of an attack.</span></span> <span data-ttu-id="5a2e6-108">Si un atacante pone en peligro un sistema, probablemente sea más difícil para el atacante hacer el salto a otro sistema que en una aplicación monolítica.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-108">If an attacker compromises one system, it's probably more difficult for the attacker to make the jump to another system than it is in a monolithic application.</span></span> <span data-ttu-id="5a2e6-109">Los límites de los procesos son límites fuertes.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-109">Process boundaries are strong boundaries.</span></span> <span data-ttu-id="5a2e6-110">Además, si se pierde una copia de seguridad de la base de datos, el daño es más limitado, ya que la base de datos solo contiene un subconjunto de datos y es improbable que contenga datos personales.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-110">Also, if a database backup leaks, then the damage is more limited, as that database contains only a subset of data and is unlikely to contain personal data.</span></span>

## <a name="threat-modeling"></a><span data-ttu-id="5a2e6-111">Modelado de amenazas</span><span class="sxs-lookup"><span data-stu-id="5a2e6-111">Threat modeling</span></span>

<span data-ttu-id="5a2e6-112">Sin importar si las ventajas superan las desventajas de las aplicaciones nativas de la nube, se debe seguir la misma mentalidad holística de seguridad.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-112">No matter if the advantages outweigh the disadvantages of cloud-native applications, the same holistic security mindset must be followed.</span></span> <span data-ttu-id="5a2e6-113">La seguridad y el pensamiento seguro deben formar parte de cada paso del desarrollo y la historia de las operaciones.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-113">Security and secure thinking must be part of every step of the development and operations story.</span></span> <span data-ttu-id="5a2e6-114">Al planear una aplicación, formule preguntas como:</span><span class="sxs-lookup"><span data-stu-id="5a2e6-114">When planning an application ask questions like:</span></span>

- <span data-ttu-id="5a2e6-115">¿Cuál sería el impacto de la pérdida de estos datos?</span><span class="sxs-lookup"><span data-stu-id="5a2e6-115">What would be the impact of this data being lost?</span></span>
- <span data-ttu-id="5a2e6-116">¿Cómo podemos limitar el daño de los datos no válidos que se insertan en este servicio?</span><span class="sxs-lookup"><span data-stu-id="5a2e6-116">How can we limit the damage from bad data being injected into this service?</span></span>
- <span data-ttu-id="5a2e6-117">¿Quién debe tener acceso a estos datos?</span><span class="sxs-lookup"><span data-stu-id="5a2e6-117">Who should have access to this data?</span></span>
- <span data-ttu-id="5a2e6-118">¿Hay directivas de auditoría implementadas en torno al proceso de desarrollo y lanzamiento?</span><span class="sxs-lookup"><span data-stu-id="5a2e6-118">Are there auditing policies in place around the development and release process?</span></span>

<span data-ttu-id="5a2e6-119">Todas estas preguntas forman parte de un proceso llamado [modelo de amenazas](https://docs.microsoft.com/azure/security/azure-security-threat-modeling-tool).</span><span class="sxs-lookup"><span data-stu-id="5a2e6-119">All these questions are part of a process called [threat modeling](https://docs.microsoft.com/azure/security/azure-security-threat-modeling-tool).</span></span> <span data-ttu-id="5a2e6-120">Este proceso intenta responder a la pregunta de qué amenazas hay en el sistema, la probabilidad de que se trate de las amenazas y los posibles daños que puedan tener.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-120">This process tries to answer the question of what threats there are to the system, how likely the threats are, and the potential damage from them.</span></span>

<span data-ttu-id="5a2e6-121">Una vez establecida la lista de amenazas, debe decidir si merece la pena mitigarla.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-121">Once the list of threats has been established, you need to decide whether they're worth mitigating.</span></span> <span data-ttu-id="5a2e6-122">A veces, una amenaza es tan improbable y costosa de planear que no merece la pena gastar energía en ella.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-122">Sometimes a threat is so unlikely and expensive to plan for that it isn't worth spending energy on it.</span></span> <span data-ttu-id="5a2e6-123">Por ejemplo, algunos actores de nivel de estado pueden insertar cambios en el diseño de un proceso que usan millones de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-123">For instance, some state level actor could inject changes into the design of a process that is used by millions of devices.</span></span> <span data-ttu-id="5a2e6-124">Ahora, en lugar de ejecutar un determinado fragmento de código en el [anillo 3](https://en.wikipedia.org/wiki/Protection_ring), el código se ejecuta en el anillo 0.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-124">Now, instead of running a certain piece of code in [Ring 3](https://en.wikipedia.org/wiki/Protection_ring), that code is run in Ring 0.</span></span> <span data-ttu-id="5a2e6-125">Esto permite una vulnerabilidad que puede omitir el hipervisor y ejecutar el código de ataque en los equipos sin sistema operativo, lo que permite ataques en todas las máquinas virtuales que se ejecutan en ese hardware.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-125">This allows an exploit that can bypass the hypervisor and run the attack code on the bare metal machines, allowing attacks on all the virtual machines that are running on that hardware.</span></span>

<span data-ttu-id="5a2e6-126">Los procesadores modificados son difíciles de detectar sin un microscopio y conocimientos avanzados del diseño de Silicon del procesador.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-126">The altered processors are difficult to detect without a microscope and advanced knowledge of the on silicon design of that processor.</span></span> <span data-ttu-id="5a2e6-127">No es probable que se produzca este escenario y se reduzca el costo, por lo que es probable que no haya ningún modelo de amenazas que recomiende la creación de protección contra vulnerabilidades.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-127">This scenario is unlikely to happen and expensive to mitigate, so probably no threat model would recommend building exploit protection for it.</span></span>

<span data-ttu-id="5a2e6-128">Las amenazas más probables, como los controles de acceso roto que permiten `Id` aumentar los ataques (reemplazando `Id=2` por `Id=3` en la dirección URL) o la inyección de SQL, son más atractivas para la creación de protecciones en.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-128">More likely threats, such as broken access controls permitting `Id` incrementing attacks (replacing `Id=2` with `Id=3` in the URL) or SQL injection, are more attractive to build protections against.</span></span> <span data-ttu-id="5a2e6-129">Las mitigaciones de estas amenazas son bastante razonables para compilar y evitar vulnerabilidades de seguridad embarazosas que abven la reputación de la empresa.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-129">The mitigations for these threats are quite reasonable to build and prevent embarrassing security holes that smear the company's reputation.</span></span>

## <a name="principle-of-least-privilege"></a><span data-ttu-id="5a2e6-130">Principio de privilegio mínimo</span><span class="sxs-lookup"><span data-stu-id="5a2e6-130">Principle of least privilege</span></span>

<span data-ttu-id="5a2e6-131">Una de las ideas de Fundación en la seguridad del equipo es el principio de privilegios mínimos (POLP).</span><span class="sxs-lookup"><span data-stu-id="5a2e6-131">One of the founding ideas in computer security is the Principle of Least Privilege (POLP).</span></span> <span data-ttu-id="5a2e6-132">En realidad, es una idea fundamental en la mayoría de las formas de seguridad, ya sea digital o física.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-132">It's actually a foundational idea in most any form of security be it digital or physical.</span></span> <span data-ttu-id="5a2e6-133">En Resumen, el principio es que cualquier usuario o proceso debe tener el menor número de derechos posible para ejecutar su tarea.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-133">In short, the principle is that any user or process should have the smallest number of rights possible to execute its task.</span></span>

<span data-ttu-id="5a2e6-134">Como ejemplo, piense en los cajeros de un banco: el acceso a la seguridad es una actividad no habitual.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-134">As an example, think of the tellers at a bank: accessing the safe is an uncommon activity.</span></span> <span data-ttu-id="5a2e6-135">Por lo tanto, el cajero medio no puede abrir la caja de seguridad.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-135">So, the average teller can't open the safe themselves.</span></span> <span data-ttu-id="5a2e6-136">Para obtener acceso, deben remitir su solicitud a través de un administrador bancario, que realiza comprobaciones de seguridad adicionales.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-136">To gain access, they need to escalate their request through a bank manager, who performs additional security checks.</span></span>

<span data-ttu-id="5a2e6-137">En un sistema informático, un ejemplo fantástico son los derechos de un usuario que se conecta a una base de datos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-137">In a computer system, a fantastic example is the rights of a user connecting to a database.</span></span> <span data-ttu-id="5a2e6-138">En muchos casos, hay una cuenta de usuario única que se usa para compilar la estructura de base de datos y ejecutar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-138">In many cases, there's a single user account used to both build the database structure and run the application.</span></span> <span data-ttu-id="5a2e6-139">A excepción de los casos extremos, la cuenta que ejecuta la aplicación no necesita la capacidad de actualizar la información del esquema.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-139">Except in extreme cases, the account running the application doesn't need the ability to update schema information.</span></span> <span data-ttu-id="5a2e6-140">Debe haber varias cuentas que proporcionen diferentes niveles de privilegios.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-140">There should be several accounts that provide different levels of privilege.</span></span> <span data-ttu-id="5a2e6-141">La aplicación solo debe usar el nivel de permiso que concede acceso de lectura y escritura a los datos de las tablas.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-141">The application should only use the permission level that grants read and write access to the data in the tables.</span></span> <span data-ttu-id="5a2e6-142">Este tipo de protección eliminará los ataques que destinan a quitar tablas de base de datos o a introducir desencadenadores malintencionados.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-142">This kind of protection would eliminate attacks that aimed to drop database tables or introduce malicious triggers.</span></span>

<span data-ttu-id="5a2e6-143">Casi todas las partes de la creación de una aplicación nativa en la nube pueden beneficiarse de recordar el principio de privilegios mínimos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-143">Almost every part of building a cloud-native application can benefit from remembering the principle of least privilege.</span></span> <span data-ttu-id="5a2e6-144">Puede encontrarla en juego al configurar firewalls, grupos de seguridad de red, roles y ámbitos en el control de acceso basado en rol (RBAC).</span><span class="sxs-lookup"><span data-stu-id="5a2e6-144">You can find it at play when setting up firewalls, network security groups, roles, and scopes in Role-based access control (RBAC).</span></span>

## <a name="penetration-testing"></a><span data-ttu-id="5a2e6-145">Pruebas de penetración</span><span class="sxs-lookup"><span data-stu-id="5a2e6-145">Penetration testing</span></span>

<span data-ttu-id="5a2e6-146">A medida que las aplicaciones se vuelven más complicadas, el número de vectores de ataque aumenta a una velocidad alarmante.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-146">As applications become more complicated the number of attack vectors increases at an alarming rate.</span></span> <span data-ttu-id="5a2e6-147">El modelado de amenazas tiene un error porque tiende a ser ejecutado por las mismas personas que compilan el sistema.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-147">Threat modeling is flawed in that it tends to be executed by the same people building the system.</span></span> <span data-ttu-id="5a2e6-148">Del mismo modo que muchos desarrolladores tienen problemas para aprovisionar las interacciones del usuario y compilar interfaces de usuario inutilizables, la mayoría de los desarrolladores tienen dificultades para ver todos los vectores de ataque.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-148">In the same way that many developers have trouble envisioning user interactions and then build unusable user interfaces, most developers have difficulty seeing every attack vector.</span></span> <span data-ttu-id="5a2e6-149">También es posible que los desarrolladores que compilan el sistema no estén bien desconocidos en las metodologías de ataque y no pierdan algo cruciales.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-149">It's also possible that the developers building the system aren't well versed in attack methodologies and miss something crucial.</span></span>

<span data-ttu-id="5a2e6-150">La prueba de penetración o la "prueba de plumilla" implica la incorporación de actores externos para intentar atacar el sistema.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-150">Penetration testing or "pen testing" involves bringing in external actors to attempt to attack the system.</span></span> <span data-ttu-id="5a2e6-151">Estos atacantes pueden ser una compañía de consultoría externa u otros desarrolladores con buenos conocimientos de seguridad de otra parte de la empresa.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-151">These attackers may be an external consulting company or other developers with good security knowledge from another part of the business.</span></span> <span data-ttu-id="5a2e6-152">Se les asigna blanca para intentar deshacer el sistema.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-152">They're given carte blanche to attempt to subvert the system.</span></span> <span data-ttu-id="5a2e6-153">Con frecuencia, encontrará extensos agujeros de seguridad que deben revisarse.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-153">Frequently, they'll find extensive security holes that need to be patched.</span></span> <span data-ttu-id="5a2e6-154">A veces, el vector de ataque será algo totalmente inesperado, como aprovechar un ataque de suplantación de identidad contra el CEO.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-154">Sometimes the attack vector will be something totally unexpected like exploiting a phishing attack against the CEO.</span></span>

<span data-ttu-id="5a2e6-155">Azure en sí está realizando continuamente ataques de un [equipo de hackers dentro de Microsoft](https://azure.microsoft.com/resources/videos/red-vs-blue-internal-security-penetration-testing-of-microsoft-azure/).</span><span class="sxs-lookup"><span data-stu-id="5a2e6-155">Azure itself is constantly undergoing attacks from a [team of hackers inside Microsoft](https://azure.microsoft.com/resources/videos/red-vs-blue-internal-security-penetration-testing-of-microsoft-azure/).</span></span> <span data-ttu-id="5a2e6-156">A lo largo de los años, han sido el primero en encontrar docenas de vectores de ataque potencialmente catastróficos, y cerrarlos antes de que se puedan aprovechar externamente.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-156">Over the years, they've been the first to find dozens of potentially catastrophic attack vectors, closing them before they can be exploited externally.</span></span> <span data-ttu-id="5a2e6-157">Cuanto más tentador sea el destino, más probable es que los actores de infinitas intenten aprovecharlo y que hay algunos destinos en el mundo más tentados que Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-157">The more tempting a target, the more likely that eternal actors will attempt to exploit it and there are a few targets in the world more tempting than Azure.</span></span>

## <a name="monitoring"></a><span data-ttu-id="5a2e6-158">Supervisión</span><span class="sxs-lookup"><span data-stu-id="5a2e6-158">Monitoring</span></span>

<span data-ttu-id="5a2e6-159">En caso de que un atacante intente penetrar en una aplicación, debería haber alguna advertencia.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-159">Should an attacker attempt to penetrate an application, there should be some warning of it.</span></span> <span data-ttu-id="5a2e6-160">Con frecuencia, los ataques se pueden detectar examinando los registros de los servicios.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-160">Frequently, attacks can be spotted by examining the logs from services.</span></span> <span data-ttu-id="5a2e6-161">Los ataques dejan signos testigo que se pueden detectar antes de que se realicen correctamente.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-161">Attacks leave telltale signs that can be spotted before they succeed.</span></span> <span data-ttu-id="5a2e6-162">Por ejemplo, un atacante que intente adivinar una contraseña realizará muchas solicitudes a un sistema de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-162">For instance, an attacker attempting to guess a password will make many requests to a login system.</span></span> <span data-ttu-id="5a2e6-163">La supervisión alrededor del sistema de inicio de sesión puede detectar patrones extraños que no están en línea con el patrón de acceso típico.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-163">Monitoring around the login system can detect weird patterns that are out of line with the typical access pattern.</span></span> <span data-ttu-id="5a2e6-164">Esta supervisión se puede convertir en una alerta que, a su vez, alerta a una persona de operaciones para activar algún tipo de contramedida.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-164">This monitoring can be turned into an alert that can, in turn, alert an operations person to activate some sort of countermeasure.</span></span> <span data-ttu-id="5a2e6-165">Un sistema de supervisión muy maduro podría incluso actuar en función de estas desviaciones agregando de forma proactiva reglas para bloquear solicitudes o limitar las respuestas.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-165">A highly mature monitoring system might even take action based on these deviations proactively adding rules to block requests or throttle responses.</span></span>

## <a name="securing-the-build"></a><span data-ttu-id="5a2e6-166">Proteger la compilación</span><span class="sxs-lookup"><span data-stu-id="5a2e6-166">Securing the build</span></span>

<span data-ttu-id="5a2e6-167">Un lugar en el que se suele pasar por alto la seguridad está en torno al proceso de compilación.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-167">One place where security is often overlooked is around the build process.</span></span> <span data-ttu-id="5a2e6-168">La compilación no solo debe ejecutar comprobaciones de seguridad, como el análisis de código no seguro ni credenciales protegidas, pero la propia compilación debe ser segura.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-168">Not only should the build run security checks, such as scanning for insecure code or checked-in credentials, but the build itself should be secure.</span></span> <span data-ttu-id="5a2e6-169">Si el servidor de compilación está en peligro, proporciona un vector fantástico para introducir código arbitrario en el producto.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-169">If the build server is compromised, then it provides a fantastic vector for introducing arbitrary code into the product.</span></span>

<span data-ttu-id="5a2e6-170">Imagine que un atacante está intentando robar las contraseñas de los usuarios que inician sesión en una aplicación Web.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-170">Imagine that an attacker is looking to steal the passwords of people signing into a web application.</span></span> <span data-ttu-id="5a2e6-171">Podrían introducir un paso de compilación que modifica el código desprotegido para reflejar cualquier solicitud de inicio de sesión en otro servidor.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-171">They could introduce a build step that modifies the checked-out code to mirror any login request to another server.</span></span> <span data-ttu-id="5a2e6-172">La próxima vez que el código pase por la compilación, se actualizará de forma silenciosa.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-172">The next time code goes through the build, it's silently updated.</span></span> <span data-ttu-id="5a2e6-173">El examen de vulnerabilidades del código fuente no lo detectará mientras se ejecuta antes de la compilación.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-173">The source code vulnerability scanning won't catch this as it runs before the build.</span></span> <span data-ttu-id="5a2e6-174">Del mismo modo, nadie lo detectará en una revisión de código, ya que los pasos de compilación se activan en el servidor de compilación.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-174">Equally, nobody will catch it in a code review because the build steps live on the build server.</span></span> <span data-ttu-id="5a2e6-175">El código aprovechado irá a producción en la que puede recopilar contraseñas.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-175">The exploited code will go to production where it can harvest passwords.</span></span> <span data-ttu-id="5a2e6-176">Probablemente no haya ningún registro de auditoría de los cambios realizados en el proceso de compilación, o al menos nadie supervisando la auditoría.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-176">Probably there's no audit log of the build process changes, or at least nobody monitoring the audit.</span></span>

<span data-ttu-id="5a2e6-177">Este es un ejemplo perfecto de un destino de valor aparentemente bajo que se puede utilizar para interrumpir el sistema.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-177">This is a perfect example of a seemingly low value target that can be used to break into the system.</span></span> <span data-ttu-id="5a2e6-178">Una vez que un atacante infringe el perímetro del sistema, puede empezar a trabajar en la búsqueda de maneras de elevar sus permisos hasta el punto en el que pueden causar daños reales en cualquier lugar en el que quieran.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-178">Once an attacker breaches the perimeter of the system, they can start working on finding ways to elevate their permissions to the point that they can cause real harm anywhere they like.</span></span>

## <a name="building-secure-code"></a><span data-ttu-id="5a2e6-179">Compilar código seguro</span><span class="sxs-lookup"><span data-stu-id="5a2e6-179">Building secure code</span></span>

<span data-ttu-id="5a2e6-180">.NET Framework ya es un marco bastante seguro.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-180">.NET Framework is already a quite secure framework.</span></span> <span data-ttu-id="5a2e6-181">Evita algunos de los problemas de código no administrado, como recorrer los extremos de las matrices.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-181">It avoids some of the pitfalls of unmanaged code, such as walking off the ends of arrays.</span></span> <span data-ttu-id="5a2e6-182">El trabajo se realiza activamente para corregir las carencias de seguridad a medida que se detectan.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-182">Work is actively done to fix security holes as they're discovered.</span></span> <span data-ttu-id="5a2e6-183">Hay incluso un [programa de recompensa de errores](https://www.microsoft.com/msrc/bounty) que paga a los investigadores a encontrar problemas en el marco y notificarlos en lugar de aprovecharlos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-183">There's even a [bug bounty program](https://www.microsoft.com/msrc/bounty) that pays researchers to find issues in the framework and report them instead of exploiting them.</span></span>

<span data-ttu-id="5a2e6-184">Hay muchas maneras de hacer que el código .NET sea más seguro.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-184">There are many ways to make .NET code more secure.</span></span> <span data-ttu-id="5a2e6-185">Las instrucciones siguientes, como el artículo [instrucciones de codificación segura para .net](https://docs.microsoft.com/dotnet/standard/security/secure-coding-guidelines) , son un paso razonable para asegurarse de que el código es seguro desde el principio.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-185">Following guidelines such as the [Secure coding guidelines for .NET](https://docs.microsoft.com/dotnet/standard/security/secure-coding-guidelines) article is a reasonable step to take to ensure that the code is secure from the ground up.</span></span> <span data-ttu-id="5a2e6-186">[OWASP Top 10](https://owasp.org/www-project-top-ten/) es otra guía valiosa para compilar código seguro.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-186">The [OWASP top 10](https://owasp.org/www-project-top-ten/) is another invaluable guide to build secure code.</span></span>

<span data-ttu-id="5a2e6-187">El proceso de compilación es un buen lugar para colocar herramientas de detección para detectar problemas en el código fuente antes de que se pongan en producción.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-187">The build process is a good place to put scanning tools to detect problems in source code before they make it into production.</span></span> <span data-ttu-id="5a2e6-188">La mayoría de los proyectos tiene dependencias en otros paquetes.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-188">Most every project has dependencies on some other packages.</span></span> <span data-ttu-id="5a2e6-189">Una herramienta que puede buscar paquetes obsoletos detectará problemas en una compilación nocturna.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-189">A tool that can scan for outdated packages will catch problems in a nightly build.</span></span> <span data-ttu-id="5a2e6-190">Incluso al crear imágenes de Docker, es útil comprobar y asegurarse de que la imagen base no tiene vulnerabilidades conocidas.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-190">Even when building Docker images, it's useful to check and make sure that the base image doesn't have known vulnerabilities.</span></span> <span data-ttu-id="5a2e6-191">Otro aspecto que hay que comprobar es que nadie ha protegido accidentalmente las credenciales.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-191">Another thing to check is that nobody has accidentally checked in credentials.</span></span>

## <a name="built-in-security"></a><span data-ttu-id="5a2e6-192">Seguridad integrada</span><span class="sxs-lookup"><span data-stu-id="5a2e6-192">Built-in security</span></span>

<span data-ttu-id="5a2e6-193">Azure está diseñado para equilibrar la facilidad de uso y la seguridad de la mayoría de los usuarios.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-193">Azure is designed to balance usability and security for the majority of users.</span></span> <span data-ttu-id="5a2e6-194">Los distintos usuarios van a tener distintos requisitos de seguridad, por lo que necesitan ajustar su enfoque a la seguridad en la nube.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-194">Different users are going to have different security requirements, so they need to fine-tune their approach to cloud security.</span></span> <span data-ttu-id="5a2e6-195">Microsoft publica una gran cantidad de información de seguridad en el [centro de confianza](https://azure.microsoft.com/support/trust-center/).</span><span class="sxs-lookup"><span data-stu-id="5a2e6-195">Microsoft publishes a great deal of security information in the [Trust Center](https://azure.microsoft.com/support/trust-center/).</span></span> <span data-ttu-id="5a2e6-196">Este recurso debe ser el primero en los profesionales interesados en comprender cómo funcionan las tecnologías integradas de mitigación de ataques.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-196">This resource should be the first stop for those professionals interested in understanding how the built-in attack mitigation technologies work.</span></span>

<span data-ttu-id="5a2e6-197">Dentro del Azure Portal, el [Azure Advisor](https://azure.microsoft.com/services/advisor/) es un sistema que está explorando un entorno constantemente y realizando recomendaciones.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-197">Within the Azure portal, the [Azure Advisor](https://azure.microsoft.com/services/advisor/) is a system that is constantly scanning an environment and making recommendations.</span></span> <span data-ttu-id="5a2e6-198">Algunas de estas recomendaciones están diseñadas para ahorrar dinero a los usuarios, pero otras están diseñadas para identificar configuraciones potencialmente inseguras, como tener un contenedor de almacenamiento abierto al mundo y no estar protegido por un Virtual Network.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-198">Some of these recommendations are designed to save users money, but others are designed to identify potentially insecure configurations, such as having a storage container open to the world and not protected by a Virtual Network.</span></span>

## <a name="azure-network-infrastructure"></a><span data-ttu-id="5a2e6-199">Infraestructura de red de Azure</span><span class="sxs-lookup"><span data-stu-id="5a2e6-199">Azure network infrastructure</span></span>

<span data-ttu-id="5a2e6-200">En un entorno de implementación local, una gran cantidad de energía está dedicada a la configuración de redes.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-200">In an on-premises deployment environment, a great deal of energy is dedicated to setting up networking.</span></span> <span data-ttu-id="5a2e6-201">La configuración de enrutadores, conmutadores y el tipo de trabajo es complicado.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-201">Setting up routers, switches, and the such is complicated work.</span></span> <span data-ttu-id="5a2e6-202">Las redes permiten determinados recursos para comunicarse con otros recursos y evitar el acceso en algunos casos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-202">Networks allow certain resources to talk to other resources and prevent access in some cases.</span></span> <span data-ttu-id="5a2e6-203">Una regla de red frecuente es restringir el acceso al entorno de producción desde el entorno de desarrollo sin que sea posible que un fragmento de código de uso medio se ejecute mal y elimine un montón de datos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-203">A frequent network rule is to restrict access to the production environment from the development environment on the off chance that a half-developed piece of code runs awry and deletes a swath of data.</span></span>

<span data-ttu-id="5a2e6-204">Desde el cuadro, la mayoría de los recursos de Azure PaaS solo tienen la configuración de redes más básica y permisiva.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-204">Out of the box, most PaaS Azure resources have only the most basic and permissive networking setup.</span></span> <span data-ttu-id="5a2e6-205">Por ejemplo, cualquier persona en Internet puede acceder a una instancia de App Service.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-205">For instance, anybody on the Internet can access an app service.</span></span> <span data-ttu-id="5a2e6-206">Las instancias de SQL Server nuevas suelen estar restringidas, por lo que las entidades externas no pueden tener acceso a ellas, pero se permiten los intervalos de direcciones IP que usa Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-206">New SQL Server instances typically come restricted, so that external parties can't access them, but the IP address ranges used by Azure itself are permitted through.</span></span> <span data-ttu-id="5a2e6-207">Por lo tanto, mientras el servidor SQL Server está protegido contra amenazas externas, un atacante solo necesita configurar un servidor cabeza de puente de Azure desde donde puedan lanzar ataques contra todas las instancias de SQL en Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-207">So, while the SQL server is protected from external threats, an attacker only needs to set up an Azure bridgehead from where they can launch attacks against all SQL instances on Azure.</span></span>

<span data-ttu-id="5a2e6-208">Afortunadamente, la mayoría de los recursos de Azure se pueden colocar en una Virtual Network de Azure que permite un control de acceso más detallado.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-208">Fortunately, most Azure resources can be placed into an Azure Virtual Network that allows finer grained access control.</span></span> <span data-ttu-id="5a2e6-209">De forma similar a la manera en que las redes locales establecen redes privadas que están protegidas del mundo más amplio, las redes virtuales son islas de direcciones IP privadas que se encuentran en la red de Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-209">Similar to the way that on-premises networks establish private networks that are protected from the wider world, virtual networks are islands of private IP addresses that are located within the Azure network.</span></span>

![Figura 9-1 una red virtual en Azure](./media/virtual-network.png)

<span data-ttu-id="5a2e6-211">**Figura 9-1**.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-211">**Figure 9-1**.</span></span> <span data-ttu-id="5a2e6-212">Una red virtual en Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-212">A virtual network in Azure.</span></span>

<span data-ttu-id="5a2e6-213">Del mismo modo que las redes locales tienen un firewall que rige el acceso a la red, puede establecer un firewall similar en el límite de la red virtual.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-213">In the same way that on-premises networks have a firewall governing access to the network, you can establish a similar firewall at the boundary of the virtual network.</span></span> <span data-ttu-id="5a2e6-214">De forma predeterminada, todos los recursos de una red virtual pueden seguir hablando con Internet.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-214">By default, all the resources on a virtual network can still talk to the Internet.</span></span> <span data-ttu-id="5a2e6-215">Solo son conexiones entrantes que requieren algún tipo de excepción explícita del firewall.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-215">It's only incoming connections that require some form of explicit firewall exception.</span></span>

<span data-ttu-id="5a2e6-216">Con la red establecida, los recursos internos, como las cuentas de almacenamiento, pueden configurarse para permitir solo el acceso a los recursos que también se encuentran en el Virtual Network.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-216">With the network established, internal resources like storage accounts can be set up to only allow for access by resources that are also on the Virtual Network.</span></span> <span data-ttu-id="5a2e6-217">Este firewall proporciona un nivel de seguridad adicional, en caso de que se pierdan las claves de esa cuenta de almacenamiento, los atacantes no podrán conectarse a ella para aprovechar las claves perdidas.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-217">This firewall provides an extra level of security, should the keys for that storage account be leaked, attackers wouldn't be able to connect to it to exploit the leaked keys.</span></span> <span data-ttu-id="5a2e6-218">Este es otro ejemplo del principio de privilegios mínimos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-218">This is another example of the principle of least privilege.</span></span>

<span data-ttu-id="5a2e6-219">Los nodos de un clúster de Azure Kubernetes pueden participar en una red virtual, al igual que otros recursos que son más nativos de Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-219">The nodes in an Azure Kubernetes cluster can participate in a virtual network just like other resources that are more native to Azure.</span></span> <span data-ttu-id="5a2e6-220">Esta funcionalidad se denomina [interfaz de red de contenedor de Azure](https://github.com/Azure/azure-container-networking/blob/master/docs/cni.md).</span><span class="sxs-lookup"><span data-stu-id="5a2e6-220">This functionality is called [Azure Container Networking Interface](https://github.com/Azure/azure-container-networking/blob/master/docs/cni.md).</span></span> <span data-ttu-id="5a2e6-221">De hecho, asigna una subred dentro de la red virtual en la que se asignan las máquinas virtuales y las imágenes de contenedor.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-221">In effect, it allocates a subnet within the virtual network on which virtual machines and container images are allocated.</span></span>

<span data-ttu-id="5a2e6-222">Al continuar con la ruta de acceso que ilustra el principio de privilegios mínimos, no todos los recursos de una Virtual Network deben comunicarse con los demás recursos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-222">Continuing down the path of illustrating the principle of least privilege, not every resource within a Virtual Network needs to talk to every other resource.</span></span> <span data-ttu-id="5a2e6-223">Por ejemplo, en una aplicación que proporciona una API Web a través de una cuenta de almacenamiento y una base de datos SQL, es poco probable que la base de datos y la cuenta de almacenamiento deban comunicarse entre sí.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-223">For instance, in an application that provides a web API over a storage account and a SQL database, it's unlikely that the database and the storage account need to talk to one another.</span></span> <span data-ttu-id="5a2e6-224">Cualquier uso compartido de datos entre ellos pasará a través de la aplicación Web.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-224">Any data sharing between them would go through the web application.</span></span> <span data-ttu-id="5a2e6-225">Por lo tanto, se puede usar un [grupo de seguridad de red (NSG)](https://docs.microsoft.com/azure/virtual-network/security-overview) para denegar el tráfico entre los dos servicios.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-225">So, a [network security group (NSG)](https://docs.microsoft.com/azure/virtual-network/security-overview) could be used to deny traffic between the two services.</span></span>

<span data-ttu-id="5a2e6-226">Una directiva de denegación de la comunicación entre los recursos puede resultar molesta de implementar, especialmente desde un segundo plano sobre el uso de Azure sin restricciones de tráfico.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-226">A policy of denying communication between resources can be annoying to implement, especially coming from a background of using Azure without traffic restrictions.</span></span> <span data-ttu-id="5a2e6-227">En algunas otras nubes, el concepto de grupos de seguridad de red es mucho más frecuente.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-227">On some other clouds, the concept of network security groups is much more prevalent.</span></span> <span data-ttu-id="5a2e6-228">Por ejemplo, la directiva predeterminada en AWS es que los recursos no se pueden comunicar entre ellos hasta que las reglas de un NSG lo habilitan.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-228">For instance, the default policy on AWS is that resources can't communicate among themselves until enabled by rules in an NSG.</span></span> <span data-ttu-id="5a2e6-229">Aunque es más lento desarrollar esto, el entorno más restrictivo proporciona un valor predeterminado más seguro.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-229">While slower to develop this, more restrictive environment provides a more secure default.</span></span> <span data-ttu-id="5a2e6-230">El uso de prácticas de DevOps adecuadas, especialmente el uso de [Azure Resource Manager o terraform](infrastructure-as-code.md) para administrar permisos puede facilitar el control de las reglas.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-230">Making use of proper DevOps practices, especially using [Azure Resource Manager or Terraform](infrastructure-as-code.md) to manage permissions can make controlling the rules easier.</span></span>

<span data-ttu-id="5a2e6-231">Las redes virtuales también pueden ser útiles al configurar la comunicación entre los recursos locales y en la nube.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-231">Virtual Networks can also be useful when setting up communication between on-premises and cloud resources.</span></span> <span data-ttu-id="5a2e6-232">Una red privada virtual se puede usar para conectar las dos redes sin problemas.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-232">A virtual private network can be used to seamlessly attach the two networks together.</span></span> <span data-ttu-id="5a2e6-233">Esto permite ejecutar una red virtual sin ningún tipo de puerta de enlace para los escenarios en los que todos los usuarios están en el sitio.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-233">This allows running a virtual network without any sort of gateway for scenarios where all the users are on-site.</span></span> <span data-ttu-id="5a2e6-234">Hay una serie de tecnologías que se pueden usar para establecer esta red.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-234">There are a number of technologies that can be used to establish this network.</span></span> <span data-ttu-id="5a2e6-235">La más sencilla es usar una [VPN de sitio a sitio](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpngateways?toc=%2fazure%2fvirtual-network%2ftoc.json#s2smulti) que se puede establecer entre varios enrutadores y Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-235">The simplest is to use a [site-to-site VPN](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpngateways?toc=%2fazure%2fvirtual-network%2ftoc.json#s2smulti) that can be established between many routers and Azure.</span></span> <span data-ttu-id="5a2e6-236">El tráfico se cifra y se tuneliza por Internet con el mismo costo por byte que cualquier otro tráfico.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-236">Traffic is encrypted and tunneled over the Internet at the same cost per byte as any other traffic.</span></span> <span data-ttu-id="5a2e6-237">En escenarios donde se desea más ancho de banda o más seguridad, Azure ofrece un [servicio denominado expressroute](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpngateways?toc=%2fazure%2fvirtual-network%2ftoc.json#ExpressRoute) que usa un circuito privado entre una red local y Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-237">For scenarios where more bandwidth or more security is desirable, Azure offers a service called [Express Route](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpngateways?toc=%2fazure%2fvirtual-network%2ftoc.json#ExpressRoute) that uses a private circuit between an on-premises network and Azure.</span></span> <span data-ttu-id="5a2e6-238">Es más costosa y difícil de establecer, pero también más seguro.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-238">It's more costly and difficult to establish but also more secure.</span></span>

## <a name="role-based-access-control-for-restricting-access-to-azure-resources"></a><span data-ttu-id="5a2e6-239">Control de acceso basado en roles para restringir el acceso a los recursos de Azure</span><span class="sxs-lookup"><span data-stu-id="5a2e6-239">Role-based access control for restricting access to Azure resources</span></span>

<span data-ttu-id="5a2e6-240">RBAC es un sistema que proporciona una identidad a las aplicaciones que se ejecutan en Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-240">RBAC is a system that provides an identity to applications running in Azure.</span></span> <span data-ttu-id="5a2e6-241">Las aplicaciones pueden tener acceso a los recursos que usan esta identidad en lugar de usar claves o contraseñas.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-241">Applications can access resources using this identity instead of or in addition to using keys or passwords.</span></span>

## <a name="security-principals"></a><span data-ttu-id="5a2e6-242">Entidades de seguridad</span><span class="sxs-lookup"><span data-stu-id="5a2e6-242">Security Principals</span></span>

<span data-ttu-id="5a2e6-243">El primer componente de RBAC es una entidad de seguridad.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-243">The first component in RBAC is a security principal.</span></span> <span data-ttu-id="5a2e6-244">Una entidad de seguridad puede ser un usuario, un grupo, una entidad de servicio o una identidad administrada.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-244">A security principal can be a user, group, service principal, or managed identity.</span></span>

![Figura 9-2 distintos tipos de entidades de seguridad](./media/rbac-security-principal.png)

<span data-ttu-id="5a2e6-246">**Figura 9-2**.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-246">**Figure 9-2**.</span></span> <span data-ttu-id="5a2e6-247">Distintos tipos de entidades de seguridad.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-247">Different types of security principals.</span></span>

- <span data-ttu-id="5a2e6-248">Usuario: cualquier usuario que tenga una cuenta en Azure Active Directory es un usuario.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-248">User - Any user who has an account in Azure Active Directory is a user.</span></span>
- <span data-ttu-id="5a2e6-249">Grupo: una colección de usuarios de Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-249">Group - A collection of users from Azure Active Directory.</span></span> <span data-ttu-id="5a2e6-250">Como miembro de un grupo, un usuario toma los roles de ese grupo además de los suyos propios.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-250">As a member of a group, a user takes on the roles of that group in addition to their own.</span></span>
- <span data-ttu-id="5a2e6-251">Entidad de servicio: identidad de seguridad en la que se ejecutan los servicios o las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-251">Service principal - A security identity under which services or applications run.</span></span>
- <span data-ttu-id="5a2e6-252">Identidad administrada: identidad de Azure Active Directory administrada por Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-252">Managed identity - An Azure Active Directory identity managed by Azure.</span></span> <span data-ttu-id="5a2e6-253">Las identidades administradas se utilizan normalmente al desarrollar aplicaciones en la nube que administran las credenciales para autenticarse en los servicios de Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-253">Managed identities are typically used when developing cloud applications that manage the credentials for authenticating to Azure services.</span></span>

<span data-ttu-id="5a2e6-254">La entidad de seguridad se puede aplicar a la mayoría de los recursos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-254">The security principal can be applied to most any resource.</span></span> <span data-ttu-id="5a2e6-255">Esto significa que es posible asignar una entidad de seguridad a un contenedor que se ejecuta en Azure Kubernetes, lo que le permite acceder a los secretos almacenados en Key Vault.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-255">This means that it's possible to assign a security principal to a container running within Azure Kubernetes, allowing it to access secrets stored in Key Vault.</span></span> <span data-ttu-id="5a2e6-256">Una función de Azure puede asumir un permiso que le permite comunicarse con una instancia de Active Directory para validar un JWT para un usuario que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-256">An Azure Function could take on a permission allowing it to talk to an Active Directory instance to validate a JWT for a calling user.</span></span> <span data-ttu-id="5a2e6-257">Una vez que los servicios se habilitan con una entidad de servicio, sus permisos se pueden administrar granularmente mediante roles y ámbitos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-257">Once services are enabled with a service principal, their permissions can be managed granularly using roles and scopes.</span></span>

## <a name="roles"></a><span data-ttu-id="5a2e6-258">Roles</span><span class="sxs-lookup"><span data-stu-id="5a2e6-258">Roles</span></span>

<span data-ttu-id="5a2e6-259">Una entidad de seguridad puede asumir muchos roles o, con una analogía más sartorial, gastar muchos sombreros.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-259">A security principal can take on many roles or, using a more sartorial analogy, wear many hats.</span></span> <span data-ttu-id="5a2e6-260">Cada rol define una serie de permisos, como "leer mensajes de Azure Service Bus punto de conexión".</span><span class="sxs-lookup"><span data-stu-id="5a2e6-260">Each role defines a series of permissions such as "Read messages from Azure Service Bus endpoint".</span></span> <span data-ttu-id="5a2e6-261">El conjunto de permisos efectivo de una entidad de seguridad es la combinación de todos los permisos asignados a todos los roles que tiene la entidad de seguridad.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-261">The effective permission set of a security principal is the combination of all the permissions assigned to all the roles that security principal has.</span></span> <span data-ttu-id="5a2e6-262">Azure tiene un gran número de roles integrados y los usuarios pueden definir sus propios roles.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-262">Azure has a large number of built-in roles and users can define their own roles.</span></span>

![Figura 9-3 definiciones de roles RBAC](./media/rbac-role-definition.png)

<span data-ttu-id="5a2e6-264">**Figura 9-3**.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-264">**Figure 9-3**.</span></span> <span data-ttu-id="5a2e6-265">Definiciones de roles de RBAC.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-265">RBAC role definitions.</span></span>

<span data-ttu-id="5a2e6-266">Integrado en Azure también son una serie de roles de alto nivel, como propietario, colaborador, lector y administrador de cuentas de usuario.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-266">Built into Azure are also a number of high-level roles such as Owner, Contributor, Reader, and User Account Administrator.</span></span> <span data-ttu-id="5a2e6-267">Con el rol de propietario, una entidad de seguridad puede tener acceso a todos los recursos y asignar permisos a otros usuarios.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-267">With the Owner role, a security principal can access all resources and assign permissions to others.</span></span> <span data-ttu-id="5a2e6-268">Un colaborador tiene el mismo nivel de acceso a todos los recursos, pero no puede asignar permisos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-268">A contributor has the same level of access to all resources but they can't assign permissions.</span></span> <span data-ttu-id="5a2e6-269">Un lector solo puede ver los recursos de Azure existentes y un administrador de cuentas de usuario puede administrar el acceso a los recursos de Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-269">A Reader can only view existing Azure resources and a User Account Administrator can manage access to Azure resources.</span></span>

<span data-ttu-id="5a2e6-270">Los roles integrados más granulares, como el [colaborador de zona DNS](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#dns-zone-contributor) , tienen derechos limitados a un único servicio.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-270">More granular built-in roles such as [DNS Zone Contributor](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles#dns-zone-contributor) have rights limited to a single service.</span></span> <span data-ttu-id="5a2e6-271">Las entidades de seguridad pueden tomar cualquier número de roles.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-271">Security principals can take on any number of roles.</span></span>

## <a name="scopes"></a><span data-ttu-id="5a2e6-272">Ámbitos</span><span class="sxs-lookup"><span data-stu-id="5a2e6-272">Scopes</span></span>

<span data-ttu-id="5a2e6-273">Los roles se pueden aplicar a un conjunto restringido de recursos dentro de Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-273">Roles can be applied to a restricted set of resources within Azure.</span></span> <span data-ttu-id="5a2e6-274">Por ejemplo, al aplicar el ámbito al ejemplo anterior de lectura desde una cola de Service Bus, puede restringir el permiso a una sola cola: "leer mensajes de un punto de conexión de Azure Service Bus `blah.servicebus.windows.net/queue1` ".</span><span class="sxs-lookup"><span data-stu-id="5a2e6-274">For instance, applying scope to the previous example of reading from a Service Bus queue, you can narrow the permission to a single queue: "Read messages from Azure Service Bus endpoint `blah.servicebus.windows.net/queue1`"</span></span>

<span data-ttu-id="5a2e6-275">El ámbito puede ser tan estrecho como un recurso único o se puede aplicar a un grupo de recursos completo, una suscripción o incluso un grupo de administración.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-275">The scope can be as narrow as a single resource or it can be applied to an entire resource group, subscription, or even management group.</span></span>

<span data-ttu-id="5a2e6-276">Al probar si una entidad de seguridad tiene un permiso determinado, se tiene en cuenta la combinación de rol y ámbito.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-276">When testing if a security principal has a certain permission, the combination of role and scope are taken into account.</span></span> <span data-ttu-id="5a2e6-277">Esta combinación proporciona un mecanismo de autorización eficaz.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-277">This combination provides a powerful authorization mechanism.</span></span>

## <a name="deny"></a><span data-ttu-id="5a2e6-278">Denegar</span><span class="sxs-lookup"><span data-stu-id="5a2e6-278">Deny</span></span>

<span data-ttu-id="5a2e6-279">Anteriormente, solo se permitían las reglas de "permitir" para RBAC.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-279">Previously, only "allow" rules were permitted for RBAC.</span></span> <span data-ttu-id="5a2e6-280">Este comportamiento hace que algunos ámbitos sean complicados de compilar.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-280">This behavior made some scopes complicated to build.</span></span> <span data-ttu-id="5a2e6-281">Por ejemplo, permitir que una entidad de seguridad tenga acceso a todas las cuentas de almacenamiento, salvo que se requiera conceder permisos explícitos a una lista de cuentas de almacenamiento potencialmente ilimitada.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-281">For instance, allowing a security principal access to all storage accounts except one required granting explicit permission to a potentially endless list of storage accounts.</span></span> <span data-ttu-id="5a2e6-282">Cada vez que se crea una nueva cuenta de almacenamiento, debe agregarse a esta lista de cuentas.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-282">Every time a new storage account was created, it would have to be added to this list of accounts.</span></span> <span data-ttu-id="5a2e6-283">Esta sobrecarga de administración agregada sin duda.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-283">This added management overhead that certainly wasn't desirable.</span></span>

<span data-ttu-id="5a2e6-284">Las reglas de denegación tienen prioridad sobre las reglas de permiso.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-284">Deny rules take precedence over allow rules.</span></span> <span data-ttu-id="5a2e6-285">Ahora que representa el mismo ámbito "permitir todo menos uno" se puede representar como dos reglas "permitir todo" y "denegar esta una específica".</span><span class="sxs-lookup"><span data-stu-id="5a2e6-285">Now representing the same "allow all but one" scope could be represented as two rules "allow all" and "deny this one specific one".</span></span> <span data-ttu-id="5a2e6-286">Las reglas de denegación no solo facilitan la administración, sino que permiten que los recursos sean más seguros al denegar el acceso a todos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-286">Deny rules not only ease management but allow for resources that are extra secure by denying access to everybody.</span></span>

## <a name="checking-access"></a><span data-ttu-id="5a2e6-287">Comprobando el acceso</span><span class="sxs-lookup"><span data-stu-id="5a2e6-287">Checking access</span></span>

<span data-ttu-id="5a2e6-288">Como puede imaginar, tener un gran número de roles y ámbitos puede hacer que la determinancia del permiso efectivo de una entidad de servicio sea bastante difícil.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-288">As you can imagine, having a large number of roles and scopes can make figuring out the effective permission of a service principal quite difficult.</span></span> <span data-ttu-id="5a2e6-289">Apilar las reglas de denegación en la parte superior, solo sirve para aumentar la complejidad.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-289">Piling deny rules on top of that, only serves to increase the complexity.</span></span> <span data-ttu-id="5a2e6-290">Afortunadamente, hay una calculadora de permisos que puede mostrar los permisos efectivos de cualquier entidad de servicio.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-290">Fortunately, there's a permissions calculator that can show the effective permissions for any service principal.</span></span> <span data-ttu-id="5a2e6-291">Normalmente se encuentra en la pestaña IAM del portal, como se muestra en la figura 10-3.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-291">It's typically found under the IAM tab in the portal, as shown in Figure 10-3.</span></span>

![Figura 9-4 calculadora de permisos para una aplicación de App Service](./media/check-rbac.png)

<span data-ttu-id="5a2e6-293">**Figura 9-4**.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-293">**Figure 9-4**.</span></span> <span data-ttu-id="5a2e6-294">Calculadora de permisos para una aplicación de App Service.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-294">Permission calculator for an app service.</span></span>

## <a name="securing-secrets"></a><span data-ttu-id="5a2e6-295">Protección de secretos</span><span class="sxs-lookup"><span data-stu-id="5a2e6-295">Securing secrets</span></span>

<span data-ttu-id="5a2e6-296">Las contraseñas y los certificados son un vector de ataque común para los atacantes.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-296">Passwords and certificates are a common attack vector for attackers.</span></span> <span data-ttu-id="5a2e6-297">El hardware de averiguación de contraseñas puede realizar un ataque por fuerza bruta e intentar adivinar miles de millones de contraseñas por segundo.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-297">Password-cracking hardware can do a  brute-force attack and try to guess billions of passwords per second.</span></span> <span data-ttu-id="5a2e6-298">Por lo tanto, es importante que las contraseñas que se usan para tener acceso a los recursos sean seguras, con una gran variedad de caracteres.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-298">So it's important that the passwords that are used to access resources are strong, with a large variety of characters.</span></span> <span data-ttu-id="5a2e6-299">Estas contraseñas son exactamente el tipo de contraseñas que son casi imposibles de recordar.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-299">These passwords are exactly the kind of passwords that are near impossible to remember.</span></span> <span data-ttu-id="5a2e6-300">Afortunadamente, las contraseñas de Azure no necesitan ser conocidas por ningún usuario.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-300">Fortunately, the passwords in Azure don't actually need to be known by any human.</span></span>

<span data-ttu-id="5a2e6-301">Muchos expertos en seguridad [sugieren](https://www.troyhunt.com/password-managers-dont-have-to-be-perfect-they-just-have-to-be-better-than-not-having-one/) que el uso de un administrador de contraseñas para mantener sus propias contraseñas es el mejor enfoque.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-301">Many security [experts suggest](https://www.troyhunt.com/password-managers-dont-have-to-be-perfect-they-just-have-to-be-better-than-not-having-one/) that using a password manager to keep your own passwords is the best approach.</span></span> <span data-ttu-id="5a2e6-302">Aunque centraliza las contraseñas en una ubicación, también permite usar contraseñas muy complejas y asegurarse de que son únicas para cada cuenta.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-302">While it centralizes your passwords in one location, it also allows using highly complex passwords and ensuring they're unique for each account.</span></span> <span data-ttu-id="5a2e6-303">El mismo sistema existe en Azure: un almacén central de secretos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-303">The same system exists within Azure: a central store for secrets.</span></span>

## <a name="azure-key-vault"></a><span data-ttu-id="5a2e6-304">Azure Key Vault</span><span class="sxs-lookup"><span data-stu-id="5a2e6-304">Azure Key Vault</span></span>

<span data-ttu-id="5a2e6-305">Azure Key Vault proporciona una ubicación centralizada para almacenar las contraseñas de elementos como bases de datos, claves de API y certificados.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-305">Azure Key Vault provides a centralized location to store passwords for things such as databases, API keys, and certificates.</span></span> <span data-ttu-id="5a2e6-306">Una vez que se introduce un secreto en el almacén, nunca se vuelve a mostrar y los comandos para extraer y ver son complicados.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-306">Once a secret is entered into the Vault, it's never shown again and the commands to extract and view it are purposefully complicated.</span></span> <span data-ttu-id="5a2e6-307">La información contenida en Safe está protegida mediante el cifrado de software o los módulos de seguridad de hardware validados de nivel 2 de FIPS 140-2.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-307">The information in the safe is protected using either software encryption or FIPS 140-2 Level 2 validated Hardware Security Modules.</span></span>

<span data-ttu-id="5a2e6-308">El acceso al almacén de claves se proporciona a través de RBACs, lo que significa que no solo cualquier usuario puede acceder a la información del almacén.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-308">Access to the key vault is provided through RBACs, meaning that not just any user can access the information in the vault.</span></span> <span data-ttu-id="5a2e6-309">Suponga que una aplicación web desea tener acceso a la cadena de conexión de base de datos almacenada en Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-309">Say a web application wishes to access the database connection string stored in Azure Key Vault.</span></span> <span data-ttu-id="5a2e6-310">Para obtener acceso, las aplicaciones deben ejecutarse con una entidad de servicio.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-310">To gain access, applications need to run using a service principal.</span></span> <span data-ttu-id="5a2e6-311">En este rol asumido, pueden leer los secretos de la caja de seguridad.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-311">Under this assumed role, they can read the secrets from the safe.</span></span> <span data-ttu-id="5a2e6-312">Hay una serie de opciones de configuración de seguridad diferentes que pueden limitar aún más el acceso que tiene una aplicación al almacén, de modo que no pueda actualizar los secretos pero solo leerlos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-312">There are a number of different security settings that can further limit the access that an application has to the vault, so that it can't update secrets but only read them.</span></span>

<span data-ttu-id="5a2e6-313">Se puede supervisar el acceso al almacén de claves para asegurarse de que solo las aplicaciones esperadas tengan acceso al almacén.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-313">Access to the key vault can be monitored to ensure that only the expected applications are accessing the vault.</span></span> <span data-ttu-id="5a2e6-314">Los registros se pueden volver a integrar en Azure Monitor, desbloqueando la capacidad de configurar alertas cuando se encuentran condiciones inesperadas.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-314">The logs can be integrated back into Azure Monitor, unlocking the ability to set up alerts when unexpected conditions are encountered.</span></span>

## <a name="kubernetes"></a><span data-ttu-id="5a2e6-315">Kubernetes</span><span class="sxs-lookup"><span data-stu-id="5a2e6-315">Kubernetes</span></span>

<span data-ttu-id="5a2e6-316">Dentro de Kubernetes, hay un servicio similar para mantener pequeños fragmentos de información secreta.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-316">Within Kubernetes, there's a similar service for maintaining small pieces of secret information.</span></span> <span data-ttu-id="5a2e6-317">Los secretos de Kubernetes se pueden establecer mediante el `kubectl` ejecutable típico.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-317">Kubernetes Secrets can be set via the typical `kubectl` executable.</span></span>

<span data-ttu-id="5a2e6-318">Crear un secreto es tan sencillo como encontrar la versión de Base64 de los valores que se van a almacenar:</span><span class="sxs-lookup"><span data-stu-id="5a2e6-318">Creating a secret is as simple as finding the base64 version of the values to be stored:</span></span>

```console
echo -n 'admin' | base64
YWRtaW4=
echo -n '1f2d1e2e67df' | base64
MWYyZDFlMmU2N2Rm
```

<span data-ttu-id="5a2e6-319">A continuación, agréguelo a un archivo de secretos denominado, por ejemplo, con un `secret.yml` aspecto similar al ejemplo siguiente:</span><span class="sxs-lookup"><span data-stu-id="5a2e6-319">Then adding it to a secrets file named `secret.yml` for example that looks similar to the following example:</span></span>

```yml
apiVersion: v1
kind: Secret
metadata:
  name: mysecret
type: Opaque
data:
  username: YWRtaW4=
  password: MWYyZDFlMmU2N2Rm
```

<span data-ttu-id="5a2e6-320">Por último, este archivo se puede cargar en Kubernetes ejecutando el comando siguiente:</span><span class="sxs-lookup"><span data-stu-id="5a2e6-320">Finally, this file can be loaded into Kubernetes by running the following command:</span></span>

```console
kubectl apply -f ./secret.yaml
```

<span data-ttu-id="5a2e6-321">Estos secretos se pueden montar en volúmenes o exponerse a los procesos de contenedor mediante variables de entorno.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-321">These secrets can then be mounted into volumes or exposed to container processes through environment variables.</span></span> <span data-ttu-id="5a2e6-322">El enfoque de [aplicación de doce factores](https://12factor.net/) para la creación de aplicaciones sugiere el uso del denominador común más bajo para transmitir la configuración a una aplicación.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-322">The [Twelve-factor app](https://12factor.net/) approach to building applications suggests using the lowest common denominator to transmit settings to an application.</span></span> <span data-ttu-id="5a2e6-323">Las variables de entorno son el denominador común más bajo, ya que se admiten independientemente del sistema operativo o de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-323">Environment variables are the lowest common denominator, because they're supported no matter the operating system or application.</span></span>

<span data-ttu-id="5a2e6-324">Una alternativa a usar los secretos de Kubernetes integrados es acceder a los secretos en Azure Key Vault desde Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-324">An alternative to use the built-in Kubernetes secrets is to access the secrets in Azure Key Vault from within Kubernetes.</span></span> <span data-ttu-id="5a2e6-325">La manera más sencilla de hacerlo es asignar un rol de RBAC al contenedor que quiera cargar los secretos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-325">The simplest way to do this is to assign an RBAC role to the container looking to load secrets.</span></span> <span data-ttu-id="5a2e6-326">A continuación, la aplicación puede usar las API de Azure Key Vault para tener acceso a los secretos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-326">The application can then use the Azure Key Vault APIs to access the secrets.</span></span> <span data-ttu-id="5a2e6-327">Sin embargo, este enfoque requiere modificaciones en el código y no sigue el patrón de uso de variables de entorno.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-327">However, this approach requires modifications to the code and doesn't follow the pattern of using environment variables.</span></span> <span data-ttu-id="5a2e6-328">En su lugar, es posible insertar valores en un contenedor mediante el uso del inyector de [Azure Key Vault](https://mrdevops.io/introducing-azure-key-vault-to-kubernetes-931f82364354).</span><span class="sxs-lookup"><span data-stu-id="5a2e6-328">Instead, it's possible to inject values into a container through the use of the [Azure Key Vault Injector](https://mrdevops.io/introducing-azure-key-vault-to-kubernetes-931f82364354).</span></span> <span data-ttu-id="5a2e6-329">Este enfoque es realmente más seguro que usar los secretos de Kubernetes directamente, ya que los usuarios pueden tener acceso a ellos en el clúster.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-329">This approach is actually more secure than using the Kubernetes secrets directly, as they can be accessed by users on the cluster.</span></span>

## <a name="encryption-in-transit-and-at-rest"></a><span data-ttu-id="5a2e6-330">Cifrado en tránsito y en reposo</span><span class="sxs-lookup"><span data-stu-id="5a2e6-330">Encryption in transit and at rest</span></span>

<span data-ttu-id="5a2e6-331">Mantener la seguridad de los datos es importante tanto si se encuentra en el disco como si está en tránsito entre distintos servicios.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-331">Keeping data safe is important whether it's on disk or transiting between various different services.</span></span> <span data-ttu-id="5a2e6-332">La forma más eficaz de evitar la pérdida de datos es cifrarla en un formato que otros usuarios no puedan leer con facilidad.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-332">The most effective way to keep data from leaking is to encrypt it into a format that can't be easily read by others.</span></span> <span data-ttu-id="5a2e6-333">Azure admite una amplia gama de opciones de cifrado.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-333">Azure supports a wide range of encryption options.</span></span>

### <a name="in-transit"></a><span data-ttu-id="5a2e6-334">En tránsito</span><span class="sxs-lookup"><span data-stu-id="5a2e6-334">In transit</span></span>

<span data-ttu-id="5a2e6-335">Hay varias maneras de cifrar el tráfico en la red en Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-335">There are several ways to encrypt traffic on the network in Azure.</span></span> <span data-ttu-id="5a2e6-336">Normalmente, el acceso a los servicios de Azure se realiza a través de las conexiones que usan la seguridad de la capa de transporte (TLS).</span><span class="sxs-lookup"><span data-stu-id="5a2e6-336">The access to Azure services is typically done over connections that use Transport Layer Security (TLS).</span></span> <span data-ttu-id="5a2e6-337">Por ejemplo, todas las conexiones a las API de Azure requieren conexiones TLS.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-337">For instance, all the connections to the Azure APIs require TLS connections.</span></span> <span data-ttu-id="5a2e6-338">Del mismo modo, las conexiones a los puntos de conexión de Azure Storage se pueden restringir para que solo funcionen con conexiones cifradas TLS.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-338">Equally, connections to endpoints in Azure storage can be restricted to work only over TLS encrypted connections.</span></span>

<span data-ttu-id="5a2e6-339">TLS es un protocolo complicado y solo sabe que la conexión está usando TLS no es suficiente para garantizar la seguridad.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-339">TLS is a complicated protocol and simply knowing that the connection is using TLS isn't sufficient to ensure security.</span></span> <span data-ttu-id="5a2e6-340">Por ejemplo, TLS 1,0 es crónicomente inseguro y TLS 1,1 no es mucho mejor.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-340">For instance, TLS 1.0 is chronically insecure, and TLS 1.1 isn't much better.</span></span> <span data-ttu-id="5a2e6-341">Incluso dentro de las versiones de TLS, hay varias configuraciones que pueden facilitar el descifrado de las conexiones.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-341">Even within the versions of TLS, there are various settings that can make the connections easier to decrypt.</span></span> <span data-ttu-id="5a2e6-342">La mejor opción consiste en comprobar y ver si la conexión del servidor usa protocolos actualizados y bien configurados.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-342">The best course of action is to check and see if the server connection is using up-to-date and well configured protocols.</span></span>

<span data-ttu-id="5a2e6-343">Esta comprobación se puede realizar mediante un servicio externo, como la prueba de servidor SSL de los laboratorios SSL.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-343">This check can be done by an external service such as SSL labs' SSL Server Test.</span></span> <span data-ttu-id="5a2e6-344">Una ejecución de pruebas en un punto de conexión de Azure típico, en este caso un punto de conexión de Service Bus, produce una puntuación casi perfecta de.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-344">A test run against a typical Azure endpoint, in this case a service bus endpoint, yields a near perfect score of A.</span></span>

<span data-ttu-id="5a2e6-345">Incluso los servicios como las bases de datos SQL de Azure usan cifrado TLS para mantener los datos ocultos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-345">Even services like Azure SQL databases use TLS encryption to keep data hidden.</span></span> <span data-ttu-id="5a2e6-346">La parte interesante sobre el cifrado de los datos en tránsito mediante TLS es que no es posible, incluso para Microsoft, escuchar en la conexión entre equipos que ejecutan TLS.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-346">The interesting part about encrypting the data in transit using TLS is that it isn't possible, even for Microsoft, to listen in on the connection between computers running TLS.</span></span> <span data-ttu-id="5a2e6-347">Esto debe aportar la comodidad a las empresas interesadas en que sus datos pueden estar en riesgo de ser adecuados para Microsoft o incluso un actor de estado con más recursos que el atacante estándar.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-347">This should provide comfort for companies concerned that their data may be at risk from Microsoft proper or even a state actor with more resources than the standard attacker.</span></span>

![Figura 9-5 Informe de laboratorios de SSL que muestra la puntuación de un para un punto de conexión de Service Bus.](./media/ssl-report.png)

<span data-ttu-id="5a2e6-349">**Figura 9-5**.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-349">**Figure 9-5**.</span></span> <span data-ttu-id="5a2e6-350">Informe de laboratorios de SSL que muestra una puntuación de un para un punto de conexión de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-350">SSL labs report showing a score of A for a Service Bus endpoint.</span></span>

<span data-ttu-id="5a2e6-351">Aunque este nivel de cifrado no va a ser suficiente para todo el tiempo, debe inspirar confianza a que las conexiones TLS de Azure son bastante seguras.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-351">While this level of encryption isn't going to be sufficient for all time, it should inspire confidence that Azure TLS connections are quite secure.</span></span> <span data-ttu-id="5a2e6-352">Azure seguirá evolucionando sus estándares de seguridad a medida que el cifrado mejora.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-352">Azure will continue to evolve its security standards as encryption improves.</span></span> <span data-ttu-id="5a2e6-353">Es interesante saber que hay alguien viendo los estándares de seguridad y actualizando Azure a medida que mejoran.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-353">It's nice to know that there's somebody watching the security standards and updating Azure as they improve.</span></span>

### <a name="at-rest"></a><span data-ttu-id="5a2e6-354">En reposo</span><span class="sxs-lookup"><span data-stu-id="5a2e6-354">At rest</span></span>

<span data-ttu-id="5a2e6-355">En cualquier aplicación, hay una serie de lugares en los que los datos se colocan en el disco.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-355">In any application, there are a number of places where data rests on disk.</span></span> <span data-ttu-id="5a2e6-356">El propio código de aplicación se carga desde algún mecanismo de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-356">The application code itself is loaded from some storage mechanism.</span></span> <span data-ttu-id="5a2e6-357">La mayoría de las aplicaciones también utilizan algún tipo de base de datos, como SQL Server, Cosmos DB o incluso el Table Storage sorprendentemente eficaz.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-357">Most applications also use some kind of database such as SQL Server, Cosmos DB, or even the amazingly price-efficient Table Storage.</span></span> <span data-ttu-id="5a2e6-358">Todas estas bases de datos usan almacenamiento de gran cifrado para asegurarse de que nadie distinto de las aplicaciones con los permisos adecuados puede leer los datos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-358">These databases all use heavily encrypted storage to ensure that nobody other than the applications with proper permissions can read your data.</span></span> <span data-ttu-id="5a2e6-359">Incluso los operadores del sistema no pueden leer los datos que se han cifrado.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-359">Even the system operators can't read data that has been encrypted.</span></span> <span data-ttu-id="5a2e6-360">Así, los clientes pueden estar seguros de que la información secreta sigue siendo secreta.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-360">So customers can remain confident their secret information remains secret.</span></span>

### <a name="storage"></a><span data-ttu-id="5a2e6-361">Storage</span><span class="sxs-lookup"><span data-stu-id="5a2e6-361">Storage</span></span>

<span data-ttu-id="5a2e6-362">La subyacente de gran parte de Azure es el motor de Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-362">The underpinning of much of Azure is the Azure Storage engine.</span></span> <span data-ttu-id="5a2e6-363">Los discos de máquina virtual se montan encima de Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-363">Virtual machine disks are mounted on top of Azure Storage.</span></span> <span data-ttu-id="5a2e6-364">Azure Kubernetes Services se ejecuta en máquinas virtuales que, a su vez, se hospedan en Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-364">Azure Kubernetes Services run on virtual machines that, themselves, are hosted on Azure Storage.</span></span> <span data-ttu-id="5a2e6-365">Incluso las tecnologías sin servidor, como Azure Functions aplicaciones y Azure Container Instances, se ejecutan fuera del disco que forma parte de Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-365">Even serverless technologies, such as Azure Functions Apps and Azure Container Instances, run out of disk that is part of Azure Storage.</span></span>

<span data-ttu-id="5a2e6-366">Si Azure Storage está bien cifrado, proporciona una base para la mayoría de los demás que también se cifren.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-366">If Azure Storage is well encrypted, then it provides for a foundation for most everything else to also be encrypted.</span></span> <span data-ttu-id="5a2e6-367">Azure Storage [está cifrado](https://docs.microsoft.com/azure/storage/common/storage-service-encryption) con la [norma FIPS 140-2](https://en.wikipedia.org/wiki/FIPS_140) compatible con [AES de 256 bits](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard).</span><span class="sxs-lookup"><span data-stu-id="5a2e6-367">Azure Storage [is encrypted](https://docs.microsoft.com/azure/storage/common/storage-service-encryption) with [FIPS 140-2](https://en.wikipedia.org/wiki/FIPS_140) compliant [256-bit AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard).</span></span> <span data-ttu-id="5a2e6-368">Se trata de una tecnología de cifrado bien considerada que ha sido el asunto de un amplio examen académico en los últimos 20 años.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-368">This is a well-regarded encryption technology having been the subject of extensive academic scrutiny over the last 20 or so years.</span></span> <span data-ttu-id="5a2e6-369">En la actualidad, no hay ningún ataque práctico conocido que permita a alguien sin conocimiento de la clave leer los datos cifrados con AES.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-369">At present, there's no known practical attack that would allow someone without knowledge of the key to read data encrypted by AES.</span></span>

<span data-ttu-id="5a2e6-370">De forma predeterminada, Microsoft administra las claves utilizadas para cifrar Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-370">By default, the keys used for encrypting Azure Storage are managed by Microsoft.</span></span> <span data-ttu-id="5a2e6-371">Existen amplias protecciones para garantizar la prevención del acceso malintencionado a estas claves.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-371">There are extensive protections in place to ensure to prevent malicious access to these keys.</span></span> <span data-ttu-id="5a2e6-372">Sin embargo, los usuarios con determinados requisitos de cifrado también pueden [proporcionar sus propias claves de almacenamiento](https://docs.microsoft.com/azure/storage/common/storage-encryption-keys-powershell) que se administran en Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-372">However, users with particular encryption requirements can also [provide their own storage keys](https://docs.microsoft.com/azure/storage/common/storage-encryption-keys-powershell) that are managed in Azure Key Vault.</span></span> <span data-ttu-id="5a2e6-373">Estas claves se pueden revocar en cualquier momento, lo que representaría de forma eficaz el contenido de la cuenta de almacenamiento mediante el acceso no accesible.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-373">These keys can be revoked at any time, which would effectively render the contents of the Storage account using them inaccessible.</span></span>

<span data-ttu-id="5a2e6-374">Las máquinas virtuales usan almacenamiento cifrado, pero es posible proporcionar otra capa de cifrado mediante tecnologías como BitLocker en Windows o DM-Crypt en Linux.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-374">Virtual machines use encrypted storage, but it's possible to provide another layer of encryption by using technologies like BitLocker on Windows or DM-Crypt on Linux.</span></span> <span data-ttu-id="5a2e6-375">Estas tecnologías significan que incluso si la imagen de disco se perdió fuera del almacenamiento, no sería posible leerla.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-375">These technologies mean that even if the disk image was leaked off of storage, it would remain near impossible to read it.</span></span>

### <a name="azure-sql"></a><span data-ttu-id="5a2e6-376">Azure SQL</span><span class="sxs-lookup"><span data-stu-id="5a2e6-376">Azure SQL</span></span>

<span data-ttu-id="5a2e6-377">Las bases de datos hospedadas en SQL de Azure usan una tecnología denominada [cifrado de datos transparente (TDE)](/sql/relational-databases/security/encryption/transparent-data-encryption) para asegurarse de que los datos permanecen cifrados.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-377">Databases hosted on Azure SQL use a technology called [Transparent Data Encryption (TDE)](/sql/relational-databases/security/encryption/transparent-data-encryption) to ensure data remains encrypted.</span></span> <span data-ttu-id="5a2e6-378">Está habilitada de forma predeterminada en todas las bases de datos SQL recién creadas, pero debe habilitarse manualmente para las bases de datos heredadas.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-378">It's enabled by default on all newly created SQL databases, but must be enabled manually for legacy databases.</span></span> <span data-ttu-id="5a2e6-379">TDE ejecuta el cifrado y descifrado en tiempo real de no solo la base de datos, sino también las copias de seguridad y los registros de transacciones.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-379">TDE executes real-time encryption and decryption of not just the database, but also the backups and transaction logs.</span></span>

<span data-ttu-id="5a2e6-380">Los parámetros de cifrado se almacenan en la `master` base de datos y, en el inicio, se leen en la memoria para las operaciones restantes.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-380">The encryption parameters are stored in the `master` database and, on startup, are read into memory for the remaining operations.</span></span> <span data-ttu-id="5a2e6-381">Esto significa que la `master` base de datos debe permanecer sin cifrar.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-381">This means that the `master` database must remain unencrypted.</span></span> <span data-ttu-id="5a2e6-382">La clave real es administrada por Microsoft.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-382">The actual key is managed by Microsoft.</span></span> <span data-ttu-id="5a2e6-383">Sin embargo, los usuarios con los requisitos de seguridad de peractuación pueden proporcionar su propia clave en Key Vault de forma muy similar a como se hace en Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-383">However, users with exacting security requirements may provide their own key in Key Vault in much the same way as is done for Azure Storage.</span></span> <span data-ttu-id="5a2e6-384">La Key Vault proporciona para tales servicios como la revocación y la rotación de claves.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-384">The Key Vault provides for such services as key rotation and revocation.</span></span>

<span data-ttu-id="5a2e6-385">La parte "transparente" de TDS procede del hecho de que no se necesitan cambios en el cliente para utilizar una base de datos cifrada.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-385">The "Transparent" part of TDS comes from the fact that there aren't client changes needed to use an encrypted database.</span></span> <span data-ttu-id="5a2e6-386">Aunque este enfoque proporciona una buena seguridad, la pérdida de la contraseña de la base de datos es suficiente para que los usuarios puedan descifrar los datos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-386">While this approach provides for good security, leaking the database password is enough for users to be able to decrypt the data.</span></span> <span data-ttu-id="5a2e6-387">Hay otro enfoque que cifra columnas o tablas individuales en una base de datos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-387">There's another approach that encrypts individual columns or tables in a database.</span></span> <span data-ttu-id="5a2e6-388">[Always Encrypted](https://docs.microsoft.com/azure/sql-database/sql-database-always-encrypted-azure-key-vault) garantiza que en ningún momento los datos cifrados aparecen en texto sin formato dentro de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-388">[Always Encrypted](https://docs.microsoft.com/azure/sql-database/sql-database-always-encrypted-azure-key-vault) ensures that at no point the encrypted data appears in plain text inside the database.</span></span>

<span data-ttu-id="5a2e6-389">La configuración de este nivel de cifrado requiere que se ejecute a través de un asistente en SQL Server Management Studio para seleccionar el tipo de cifrado y en Key Vault para almacenar las claves asociadas.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-389">Setting up this tier of encryption requires running through a wizard in SQL Server Management Studio to select the sort of encryption and where in Key Vault to store the associated keys.</span></span>

![Figura 9-6 selección de las columnas de una tabla que se van a cifrar con Always Encrypted](./media/always-encrypted.png)

<span data-ttu-id="5a2e6-391">**Figura 9-6**.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-391">**Figure 9-6**.</span></span> <span data-ttu-id="5a2e6-392">Seleccionar las columnas de una tabla que se van a cifrar mediante Always Encrypted.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-392">Selecting columns in a table to be encrypted using Always Encrypted.</span></span>

<span data-ttu-id="5a2e6-393">Las aplicaciones cliente que leen la información de estas columnas cifradas deben tomar provisiones especiales para leer los datos cifrados.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-393">Client applications that read information from these encrypted columns need to make special allowances to read encrypted data.</span></span> <span data-ttu-id="5a2e6-394">Las cadenas de conexión deben actualizarse con `Column Encryption Setting=Enabled` y las credenciales del cliente se deben recuperar del Key Vault.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-394">Connection strings need to be updated with `Column Encryption Setting=Enabled` and client credentials must be retrieved from the Key Vault.</span></span> <span data-ttu-id="5a2e6-395">A continuación, el cliente de SQL Server debe estar injunto con las claves de cifrado de columna.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-395">The SQL Server client must then be primed with the column encryption keys.</span></span> <span data-ttu-id="5a2e6-396">Una vez hecho esto, las acciones restantes usan las interfaces estándar para el cliente SQL.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-396">Once that is done, the remaining actions use the standard interfaces to SQL Client.</span></span> <span data-ttu-id="5a2e6-397">Es decir, herramientas como Dapper y Entity Framework, que se basan en SQL Client, seguirán funcionando sin cambios.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-397">That is, tools like Dapper and Entity Framework, which are built on top of SQL Client, will continue to work without changes.</span></span> <span data-ttu-id="5a2e6-398">Es posible que Always Encrypted todavía no esté disponible para cada controlador de SQL Server en todos los idiomas.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-398">Always Encrypted may not yet be available for every SQL Server driver on every language.</span></span>

<span data-ttu-id="5a2e6-399">La combinación de TDE y Always Encrypted, que se pueden usar con claves específicas del cliente, garantiza que se admiten incluso los requisitos de cifrado más inactivos.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-399">The combination of TDE and Always Encrypted, both of which can be used with client-specific keys, ensures that even the most exacting encryption requirements are supported.</span></span>

### <a name="cosmos-db"></a><span data-ttu-id="5a2e6-400">Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="5a2e6-400">Cosmos DB</span></span>

<span data-ttu-id="5a2e6-401">Cosmos DB es la base de datos más reciente proporcionada por Microsoft en Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-401">Cosmos DB is the newest database provided by Microsoft in Azure.</span></span> <span data-ttu-id="5a2e6-402">Se ha creado desde el principio con la seguridad y la criptografía en mente.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-402">It has been built from the ground up with security and cryptography in mind.</span></span> <span data-ttu-id="5a2e6-403">El cifrado AES-256bit es estándar para todas las bases de datos de Cosmos DB y no se puede deshabilitar.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-403">AES-256bit encryption is standard for all Cosmos DB databases and can't be disabled.</span></span> <span data-ttu-id="5a2e6-404">Junto con el requisito de TLS 1,2 para la comunicación, se cifra toda la solución de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-404">Coupled with the TLS 1.2 requirement for communication, the entire storage solution is encrypted.</span></span>

![Figura 9-7 el flujo del cifrado de datos dentro de Cosmos DB](./media/cosmos-encryption.png)

<span data-ttu-id="5a2e6-406">**Figura 9-7**.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-406">**Figure 9-7**.</span></span> <span data-ttu-id="5a2e6-407">El flujo de cifrado de datos dentro de Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-407">The flow of data encryption within Cosmos DB.</span></span>

<span data-ttu-id="5a2e6-408">Aunque Cosmos DB no proporciona claves de cifrado de cliente, ha habido un trabajo importante realizado por el equipo para asegurarse de que sigue siendo compatible con PCI-DSS sin eso.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-408">While Cosmos DB doesn't provide for supplying customer encryption keys, there has been significant work done by the team to ensure it remains PCI-DSS compliant without that.</span></span> <span data-ttu-id="5a2e6-409">Cosmos DB tampoco admite todavía ningún tipo de cifrado de una sola columna similar a la Always Encrypted de Azure SQL.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-409">Cosmos DB also doesn't support any sort of single column encryption similar to Azure SQL's Always Encrypted yet.</span></span>

## <a name="keeping-secure"></a><span data-ttu-id="5a2e6-410">Mantener la seguridad</span><span class="sxs-lookup"><span data-stu-id="5a2e6-410">Keeping secure</span></span>

<span data-ttu-id="5a2e6-411">Azure tiene todas las herramientas necesarias para publicar un producto de alta seguridad.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-411">Azure has all the tools necessary to release a highly secure product.</span></span> <span data-ttu-id="5a2e6-412">Sin embargo, una cadena es tan segura como su vínculo más débil.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-412">However, a chain is only as strong as its weakest link.</span></span> <span data-ttu-id="5a2e6-413">Si las aplicaciones implementadas sobre Azure no se desarrollan con una mentalidad de seguridad adecuada y auditorías de seguridad adecuadas, se convierten en el vínculo débil de la cadena.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-413">If the applications deployed on top of Azure aren't developed with a proper security mindset and good security audits, then they become the weak link in the chain.</span></span> <span data-ttu-id="5a2e6-414">Hay muchas excelentes herramientas de análisis estático, bibliotecas de cifrado y prácticas de seguridad que se pueden usar para asegurarse de que el software instalado en Azure es tan seguro como el propio Azure.</span><span class="sxs-lookup"><span data-stu-id="5a2e6-414">There are many great static analysis tools, encryption libraries, and security practices that can be used to ensure that the software installed on Azure is as secure as Azure itself.</span></span> <span data-ttu-id="5a2e6-415">Entre los ejemplos se incluyen [herramientas de análisis estático](https://www.whitesourcesoftware.com/), [bibliotecas de cifrado](https://www.libressl.org/)y [prácticas de seguridad](https://azure.microsoft.com/resources/videos/red-vs-blue-internal-security-penetration-testing-of-microsoft-azure/).</span><span class="sxs-lookup"><span data-stu-id="5a2e6-415">Examples include [static analysis tools](https://www.whitesourcesoftware.com/), [encryption libraries](https://www.libressl.org/), and [security practices](https://azure.microsoft.com/resources/videos/red-vs-blue-internal-security-penetration-testing-of-microsoft-azure/).</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="5a2e6-416">[Anterior](security.md)
>[Siguiente](devops.md)</span><span class="sxs-lookup"><span data-stu-id="5a2e6-416">[Previous](security.md)
[Next](devops.md)</span></span>
