---
title: gRPC
description: Obtenga información sobre gRPC, su rol en aplicaciones nativas de la nube y cómo difiere de la comunicación HTTP RESTful.
author: robvet
ms.date: 03/31/2020
ms.openlocfilehash: 01dd4c934f0b39041ea377691067edf4dbe20378
ms.sourcegitcommit: 957c49696eaf048c284ef8f9f8ffeb562357ad95
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/07/2020
ms.locfileid: "82895568"
---
# <a name="grpc"></a><span data-ttu-id="ccda3-103">gRPC</span><span class="sxs-lookup"><span data-stu-id="ccda3-103">gRPC</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="ccda3-104">Hasta ahora en este libro nos hemos centrado en la comunicación [basada en REST](https://docs.microsoft.com/azure/architecture/best-practices/api-design) .</span><span class="sxs-lookup"><span data-stu-id="ccda3-104">So far in this book, we've focused on [REST-based](https://docs.microsoft.com/azure/architecture/best-practices/api-design) communication.</span></span> <span data-ttu-id="ccda3-105">Hemos visto que REST es un estilo arquitectónico flexible que define las operaciones basadas en CRUD en recursos de entidad.</span><span class="sxs-lookup"><span data-stu-id="ccda3-105">We've seen that REST is a flexible architectural style that defines CRUD-based operations against entity resources.</span></span> <span data-ttu-id="ccda3-106">Los clientes interactúan con los recursos a través de HTTP con un modelo de comunicación de solicitud-respuesta.</span><span class="sxs-lookup"><span data-stu-id="ccda3-106">Clients interact with resources across HTTP with a request/response communication model.</span></span> <span data-ttu-id="ccda3-107">Aunque REST está ampliamente implementado, una tecnología de comunicación más reciente, gRPC, ha obtenido un gran impulso de la comunidad nativa en la nube.</span><span class="sxs-lookup"><span data-stu-id="ccda3-107">While REST is widely implemented, a newer communication technology, gRPC, has gained tremendous momentum across the cloud-native community.</span></span>

## <a name="what-is-grpc"></a><span data-ttu-id="ccda3-108">¿Qué es gRPC?</span><span class="sxs-lookup"><span data-stu-id="ccda3-108">What is gRPC?</span></span>

<span data-ttu-id="ccda3-109">gRPC es un marco de trabajo moderno y de alto rendimiento que evoluciona el protocolo de [llamada a procedimiento remoto (RPC)](https://en.wikipedia.org/wiki/Remote_procedure_call) de edad antiguo.</span><span class="sxs-lookup"><span data-stu-id="ccda3-109">gRPC is a modern, high-performance framework that evolves the age-old [remote procedure call (RPC)](https://en.wikipedia.org/wiki/Remote_procedure_call) protocol.</span></span> <span data-ttu-id="ccda3-110">En el nivel de aplicación, gRPC simplifica la mensajería entre los clientes y los servicios back-end.</span><span class="sxs-lookup"><span data-stu-id="ccda3-110">At the application level, gRPC streamlines messaging between clients and back-end services.</span></span> <span data-ttu-id="ccda3-111">Desde Google, gRPC es código abierto y forma parte del ecosistema de [Cloud Native Computing Foundation (CNCF)](https://www.cncf.io/) de las ofertas nativas de la nube.</span><span class="sxs-lookup"><span data-stu-id="ccda3-111">Originating from Google, gRPC is open source and part of the  [Cloud Native Computing Foundation (CNCF)](https://www.cncf.io/) ecosystem of cloud-native offerings.</span></span> <span data-ttu-id="ccda3-112">CNCF considera gRPC un proyecto en el que se está [incubando](https://github.com/cncf/toc/blob/master/process/graduation_criteria.adoc).</span><span class="sxs-lookup"><span data-stu-id="ccda3-112">CNCF considers gRPC an [incubating project](https://github.com/cncf/toc/blob/master/process/graduation_criteria.adoc).</span></span> <span data-ttu-id="ccda3-113">La incubación significa que los usuarios finales usan la tecnología de las aplicaciones de producción y el proyecto tiene un número correcto de colaboradores.</span><span class="sxs-lookup"><span data-stu-id="ccda3-113">Incubating means end users are using the technology in production applications, and the project has a healthy number of contributors.</span></span>

<span data-ttu-id="ccda3-114">Una aplicación cliente gRPC típica expondrá una función local y en proceso que implementa una operación empresarial.</span><span class="sxs-lookup"><span data-stu-id="ccda3-114">A typical gRPC client app will expose a local, in-process function that implements a business operation.</span></span> <span data-ttu-id="ccda3-115">En segundo plano, esa función local invoca a otra función en un equipo remoto.</span><span class="sxs-lookup"><span data-stu-id="ccda3-115">Under the covers, that local function invokes another function on a remote machine.</span></span> <span data-ttu-id="ccda3-116">Lo que parece ser una llamada local se convierte esencialmente en una llamada fuera de proceso transparente a un servicio remoto.</span><span class="sxs-lookup"><span data-stu-id="ccda3-116">What appears to be a local call essentially becomes a transparent out-of-process call to a remote service.</span></span> <span data-ttu-id="ccda3-117">La fontanería de RPC abstrae la comunicación de red punto a punto, la serialización y la ejecución entre equipos.</span><span class="sxs-lookup"><span data-stu-id="ccda3-117">The RPC plumbing abstracts the point-to-point networking communication, serialization, and execution between computers.</span></span>

<span data-ttu-id="ccda3-118">En aplicaciones nativas en la nube, los desarrolladores suelen trabajar en lenguajes de programación, marcos y tecnologías.</span><span class="sxs-lookup"><span data-stu-id="ccda3-118">In cloud-native applications, developers often work across programming languages, frameworks, and technologies.</span></span> <span data-ttu-id="ccda3-119">Esta *interoperabilidad* complica los contratos de mensajes y la fontanería necesaria para la comunicación entre plataformas.</span><span class="sxs-lookup"><span data-stu-id="ccda3-119">This *interoperability* complicates message contracts and the plumbing required for cross-platform communication.</span></span>  <span data-ttu-id="ccda3-120">gRPC proporciona una "capa horizontal uniforme" que abstrae estas preocupaciones.</span><span class="sxs-lookup"><span data-stu-id="ccda3-120">gRPC provides a "uniform horizontal layer" that abstracts these concerns.</span></span> <span data-ttu-id="ccda3-121">Los desarrolladores codifican en su plataforma nativa centrada en la funcionalidad empresarial, mientras que gRPC controla la fontanería de la comunicación.</span><span class="sxs-lookup"><span data-stu-id="ccda3-121">Developers code in their native platform focused on business functionality, while gRPC handles communication plumbing.</span></span>

<span data-ttu-id="ccda3-122">gRPC ofrece compatibilidad completa en las pilas de desarrollo más populares, como Java, JavaScript, C#, Go, SWIFT y NodeJS.</span><span class="sxs-lookup"><span data-stu-id="ccda3-122">gRPC offers comprehensive support across most popular development stacks, including Java, JavaScript, C#, Go, Swift, and NodeJS.</span></span>

## <a name="grpc-benefits"></a><span data-ttu-id="ccda3-123">Ventajas de gRPC</span><span class="sxs-lookup"><span data-stu-id="ccda3-123">gRPC Benefits</span></span>

<span data-ttu-id="ccda3-124">gRPC usa HTTP/2 para su Protocolo de transporte.</span><span class="sxs-lookup"><span data-stu-id="ccda3-124">gRPC uses HTTP/2 for its transport protocol.</span></span> <span data-ttu-id="ccda3-125">Aunque es compatible con HTTP 1,1, las características de HTTP/2 tienen muchas capacidades avanzadas:</span><span class="sxs-lookup"><span data-stu-id="ccda3-125">While compatible with HTTP 1.1, HTTP/2 features many advanced capabilities:</span></span>

- <span data-ttu-id="ccda3-126">Un protocolo binario para el transporte de datos, a diferencia de HTTP 1,1, que envía los datos como texto sin cifrar.</span><span class="sxs-lookup"><span data-stu-id="ccda3-126">A binary protocol for data transport - unlike HTTP 1.1, which sends data as clear text.</span></span>
- <span data-ttu-id="ccda3-127">Compatibilidad con multiplexación para enviar varias solicitudes paralelas a través de la misma conexión: HTTP 1,1 limita el procesamiento a un mensaje de solicitud/respuesta a la vez.</span><span class="sxs-lookup"><span data-stu-id="ccda3-127">Multiplexing support for sending multiple parallel requests over the same connection - HTTP 1.1 limits processing to one request/response message at a time.</span></span>
- <span data-ttu-id="ccda3-128">Comunicación dúplex completa bidireccional para enviar solicitudes de cliente y respuestas de servidor simultáneamente.</span><span class="sxs-lookup"><span data-stu-id="ccda3-128">Bidirectional full-duplex communication for sending both client requests and server responses simultaneously.</span></span>
- <span data-ttu-id="ccda3-129">Streaming integrado que habilita las solicitudes y respuestas para transmitir conjuntos de datos grandes de forma asincrónica.</span><span class="sxs-lookup"><span data-stu-id="ccda3-129">Built-in streaming enabling requests and responses to asynchronously stream large data sets.</span></span>

<span data-ttu-id="ccda3-130">gRPC es ligero y de alto rendimiento.</span><span class="sxs-lookup"><span data-stu-id="ccda3-130">gRPC is lightweight and highly performant.</span></span> <span data-ttu-id="ccda3-131">Puede ser hasta 8X más rápido que la serialización de JSON con mensajes 60-80% más pequeños.</span><span class="sxs-lookup"><span data-stu-id="ccda3-131">It can be up to 8x faster than JSON serialization with messages 60-80% smaller.</span></span> <span data-ttu-id="ccda3-132">En el lenguaje de Microsoft [Windows Communication Foundation (WCF)](https://docs.microsoft.com/dotnet/framework/wcf/whats-wcf) , el rendimiento de gRPC supera la velocidad y la eficacia de los [enlaces de NetTCP](https://docs.microsoft.com/dotnet/api/system.servicemodel.nettcpbinding?view=netframework-4.8)altamente optimizados.</span><span class="sxs-lookup"><span data-stu-id="ccda3-132">In Microsoft [Windows Communication Foundation (WCF)](https://docs.microsoft.com/dotnet/framework/wcf/whats-wcf) parlance, gRPC performance exceeds the speed and efficiency of the highly optimized [NetTCP bindings](https://docs.microsoft.com/dotnet/api/system.servicemodel.nettcpbinding?view=netframework-4.8).</span></span> <span data-ttu-id="ccda3-133">A diferencia de NetTCP, que favorece la pila de Microsoft, gRPC es multiplataforma.</span><span class="sxs-lookup"><span data-stu-id="ccda3-133">Unlike NetTCP, which favors the Microsoft stack, gRPC is cross-platform.</span></span>

## <a name="protocol-buffers"></a><span data-ttu-id="ccda3-134">Búferes de protocolo</span><span class="sxs-lookup"><span data-stu-id="ccda3-134">Protocol Buffers</span></span>

<span data-ttu-id="ccda3-135">gRPC adopta una tecnología de código abierto denominada [búferes de protocolo](https://developers.google.com/protocol-buffers/docs/overview).</span><span class="sxs-lookup"><span data-stu-id="ccda3-135">gRPC embraces an open-source technology called [Protocol Buffers](https://developers.google.com/protocol-buffers/docs/overview).</span></span> <span data-ttu-id="ccda3-136">Proporcionan un formato de serialización neutro y de alta eficacia de la plataforma para serializar los mensajes estructurados que los servicios envían entre sí.</span><span class="sxs-lookup"><span data-stu-id="ccda3-136">They provide a highly efficient and platform-neutral serialization format for serializing structured messages that services send to each other.</span></span> <span data-ttu-id="ccda3-137">Con un lenguaje de definición de interfaz (IDL) multiplataforma, los desarrolladores definen un contrato de servicio para cada microservicio.</span><span class="sxs-lookup"><span data-stu-id="ccda3-137">Using a cross-platform Interface Definition Language (IDL), developers define a service contract for each microservice.</span></span> <span data-ttu-id="ccda3-138">El contrato, implementado como un archivo basado `.proto` en texto, describe los métodos, las entradas y las salidas de cada servicio.</span><span class="sxs-lookup"><span data-stu-id="ccda3-138">The contract, implemented as a text-based `.proto` file, describes the methods, inputs, and outputs for each service.</span></span> <span data-ttu-id="ccda3-139">Se puede usar el mismo archivo de contrato para clientes y servicios de gRPC creados en distintas plataformas de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="ccda3-139">The same contract file can be used for gRPC clients and services built on different development platforms.</span></span>

<span data-ttu-id="ccda3-140">Mediante el uso del archivo proto, el compilador protobuf, `protoc`, genera código de cliente y servicio para la plataforma de destino.</span><span class="sxs-lookup"><span data-stu-id="ccda3-140">Using the proto file, the Protobuf compiler, `protoc`, generates both client and service code for your target platform.</span></span> <span data-ttu-id="ccda3-141">El código incluye los componentes siguientes:</span><span class="sxs-lookup"><span data-stu-id="ccda3-141">The code includes the following components:</span></span>

- <span data-ttu-id="ccda3-142">Objetos fuertemente tipados, compartidos por el cliente y el servicio, que representan las operaciones de servicio y los elementos de datos de un mensaje.</span><span class="sxs-lookup"><span data-stu-id="ccda3-142">Strongly-typed objects, shared by the client and service, that represent the service operations and data elements for a message.</span></span>
- <span data-ttu-id="ccda3-143">Una clase base fuertemente tipada con la infraestructura de red necesaria que el servicio gRPC remoto puede heredar y extender.</span><span class="sxs-lookup"><span data-stu-id="ccda3-143">A strongly-typed base class with the required network plumbing that the remote gRPC service can inherit and extend.</span></span>
- <span data-ttu-id="ccda3-144">Código auxiliar de cliente que contiene la fontanería necesaria para invocar el servicio gRPC remoto.</span><span class="sxs-lookup"><span data-stu-id="ccda3-144">A client stub that contains the required plumbing to invoke the remote gRPC service.</span></span>

<span data-ttu-id="ccda3-145">En tiempo de ejecución, cada mensaje se serializa como una representación de protobuf estándar y se intercambia entre el cliente y el servicio remoto.</span><span class="sxs-lookup"><span data-stu-id="ccda3-145">At runtime, each message is serialized as a standard Protobuf representation and exchanged between the client and remote service.</span></span> <span data-ttu-id="ccda3-146">A diferencia de JSON o XML, los mensajes protobuf se serializan como bytes binarios compilados.</span><span class="sxs-lookup"><span data-stu-id="ccda3-146">Unlike JSON or XML, Protobuf messages are serialized as compiled binary bytes.</span></span>

<span data-ttu-id="ccda3-147">El libro [gRPC para desarrolladores de WCF](https://docs.microsoft.com/dotnet/architecture/grpc-for-wcf-developers/), disponible en el sitio de la arquitectura de Microsoft, proporciona una cobertura detallada de los búferes de GRPC y protocolo.</span><span class="sxs-lookup"><span data-stu-id="ccda3-147">The book, [gRPC for WCF Developers](https://docs.microsoft.com/dotnet/architecture/grpc-for-wcf-developers/), available from the Microsoft Architecture site, provides in-depth coverage of gRPC and Protocol Buffers.</span></span>

## <a name="grpc-support-in-net"></a><span data-ttu-id="ccda3-148">compatibilidad con gRPC en .NET</span><span class="sxs-lookup"><span data-stu-id="ccda3-148">gRPC support in .NET</span></span>

<span data-ttu-id="ccda3-149">gRPC está integrado en el SDK de .NET Core 3,0 y versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="ccda3-149">gRPC is integrated into .NET Core 3.0 SDK and later.</span></span> <span data-ttu-id="ccda3-150">Las siguientes herramientas lo admiten:</span><span class="sxs-lookup"><span data-stu-id="ccda3-150">The following tools support it:</span></span>

- <span data-ttu-id="ccda3-151">Visual Studio 2019, versión 16,3 o posterior, con la carga de trabajo de desarrollo web instalada.</span><span class="sxs-lookup"><span data-stu-id="ccda3-151">Visual Studio 2019, version 16.3 or later, with the web development workload installed.</span></span>
- <span data-ttu-id="ccda3-152">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="ccda3-152">Visual Studio Code</span></span>
- <span data-ttu-id="ccda3-153">la CLI de dotnet</span><span class="sxs-lookup"><span data-stu-id="ccda3-153">the dotnet CLI</span></span>

<span data-ttu-id="ccda3-154">El SDK incluye herramientas para el enrutamiento de puntos de conexión, IoC integrado y registro.</span><span class="sxs-lookup"><span data-stu-id="ccda3-154">The SDK includes tooling for endpoint routing, built-in IoC, and logging.</span></span> <span data-ttu-id="ccda3-155">El servidor Web Kestrel de código abierto admite conexiones HTTP/2.</span><span class="sxs-lookup"><span data-stu-id="ccda3-155">The open-source Kestrel web server supports HTTP/2 connections.</span></span> <span data-ttu-id="ccda3-156">En la figura 4-20 se muestra una plantilla de Visual Studio 2019 que scaffolding un proyecto de esqueleto para un servicio de gRPC.</span><span class="sxs-lookup"><span data-stu-id="ccda3-156">Figure 4-20 shows a Visual Studio 2019 template that scaffolds a skeleton project for a gRPC service.</span></span> <span data-ttu-id="ccda3-157">Tenga en cuenta que .NET Core es totalmente compatible con Windows, Linux y macOS.</span><span class="sxs-lookup"><span data-stu-id="ccda3-157">Note how .NET Core fully supports Windows, Linux, and macOS.</span></span>

![Compatibilidad con gRPC en Visual Studio 2019](./media/visual-studio-2019-grpc-template.png)

<span data-ttu-id="ccda3-159">**Figura 4-20**.</span><span class="sxs-lookup"><span data-stu-id="ccda3-159">**Figure 4-20**.</span></span> <span data-ttu-id="ccda3-160">compatibilidad con gRPC en Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="ccda3-160">gRPC support in Visual Studio 2019</span></span>
  
<span data-ttu-id="ccda3-161">En la figura 4-21 se muestra el esqueleto del servicio gRPC generado a partir de la técnica scaffolding integrada incluida en Visual Studio 2019.</span><span class="sxs-lookup"><span data-stu-id="ccda3-161">Figure 4-21 shows the skeleton gRPC service generated from the built-in scaffolding included in Visual Studio 2019.</span></span>  

![proyecto gRPC en Visual Studio 2019](./media/grpc-project.png  )

<span data-ttu-id="ccda3-163">**Figura 4-21**.</span><span class="sxs-lookup"><span data-stu-id="ccda3-163">**Figure 4-21**.</span></span> <span data-ttu-id="ccda3-164">proyecto gRPC en Visual Studio 2019</span><span class="sxs-lookup"><span data-stu-id="ccda3-164">gRPC project in Visual Studio 2019</span></span>

<span data-ttu-id="ccda3-165">En la ilustración anterior, tenga en cuenta el archivo de descripción de proto y el código de servicio.</span><span class="sxs-lookup"><span data-stu-id="ccda3-165">In the previous figure, note the proto description file and service code.</span></span> <span data-ttu-id="ccda3-166">Como verá en breve, Visual Studio genera una configuración adicional en la clase de inicio y en el archivo de proyecto subyacente.</span><span class="sxs-lookup"><span data-stu-id="ccda3-166">As you'll see shortly, Visual Studio generates additional configuration in both the Startup class and underlying project file.</span></span>

## <a name="grpc-usage"></a><span data-ttu-id="ccda3-167">uso de gRPC</span><span class="sxs-lookup"><span data-stu-id="ccda3-167">gRPC usage</span></span>

<span data-ttu-id="ccda3-168">Favorecer gRPC para los siguientes escenarios:</span><span class="sxs-lookup"><span data-stu-id="ccda3-168">Favor gRPC for the following scenarios:</span></span>

- <span data-ttu-id="ccda3-169">Comunicación de microservicios de back-end sincrónica a microservicios donde se requiere una respuesta inmediata para continuar el procesamiento.</span><span class="sxs-lookup"><span data-stu-id="ccda3-169">Synchronous backend microservice-to-microservice communication where an immediate response is required to continue processing.</span></span>
- <span data-ttu-id="ccda3-170">Entornos polyglot que necesitan admitir plataformas de programación mixtas.</span><span class="sxs-lookup"><span data-stu-id="ccda3-170">Polyglot environments that need to support mixed programming platforms.</span></span>
- <span data-ttu-id="ccda3-171">Baja latencia y comunicación de alto rendimiento donde el rendimiento es crítico.</span><span class="sxs-lookup"><span data-stu-id="ccda3-171">Low latency and high throughput communication where performance is critical.</span></span>
- <span data-ttu-id="ccda3-172">Comunicación en tiempo real de punto a punto: gRPC puede enviar mensajes en tiempo real sin sondeo y tiene una excelente compatibilidad para el streaming bidireccional.</span><span class="sxs-lookup"><span data-stu-id="ccda3-172">Point-to-point real-time communication - gRPC can push messages in real time without polling and has excellent support for bi-directional streaming.</span></span>
- <span data-ttu-id="ccda3-173">Entornos con restricción de red: los mensajes gRPC binarios siempre son más pequeños que un mensaje JSON basado en texto equivalente.</span><span class="sxs-lookup"><span data-stu-id="ccda3-173">Network constrained environments – binary gRPC messages are always smaller than an equivalent text-based JSON message.</span></span>

<span data-ttu-id="ccda3-174">En el momento en que se redactó este documento, gRPC se usa principalmente con los servicios back-end.</span><span class="sxs-lookup"><span data-stu-id="ccda3-174">At the time, of this writing, gRPC is primarily used with backend services.</span></span> <span data-ttu-id="ccda3-175">La mayoría de los exploradores modernos no pueden proporcionar el nivel de control HTTP/2 necesario para admitir un cliente de gRPC de front-end.</span><span class="sxs-lookup"><span data-stu-id="ccda3-175">Most modern browsers can't provide the level of HTTP/2 control required to support a front-end gRPC client.</span></span> <span data-ttu-id="ccda3-176">Dicho esto, hay una [iniciativa temprana](https://devblogs.microsoft.com/aspnet/grpc-web-experiment/) que permite la comunicación de gRPC desde aplicaciones basadas en explorador creadas con tecnologías webassembly de JavaScript o increíbles.</span><span class="sxs-lookup"><span data-stu-id="ccda3-176">That said, there's an [early initiative](https://devblogs.microsoft.com/aspnet/grpc-web-experiment/) that enables gRPC communication from browser-based apps built with JavaScript or Blazor WebAssembly technologies.</span></span> <span data-ttu-id="ccda3-177">[GRPC-web para .net](https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-WEB.md) permite que una aplicación ASP.net Core gRPC admita características de gRPC en aplicaciones de explorador:</span><span class="sxs-lookup"><span data-stu-id="ccda3-177">The  [gRPC-Web for .NET](https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-WEB.md) enables an ASP.NET Core gRPC app to support gRPC features in browser apps:</span></span>

- <span data-ttu-id="ccda3-178">Clientes generados por código fuertemente tipados</span><span class="sxs-lookup"><span data-stu-id="ccda3-178">Strongly-typed code-generated clients</span></span>
- <span data-ttu-id="ccda3-179">Mensajes protobuf de Compact</span><span class="sxs-lookup"><span data-stu-id="ccda3-179">Compact Protobuf messages</span></span>
- <span data-ttu-id="ccda3-180">Streaming de servidor</span><span class="sxs-lookup"><span data-stu-id="ccda3-180">Server streaming</span></span>

## <a name="grpc-implementation"></a><span data-ttu-id="ccda3-181">implementación de gRPC</span><span class="sxs-lookup"><span data-stu-id="ccda3-181">gRPC implementation</span></span>

<span data-ttu-id="ccda3-182">La arquitectura de referencia de microservicios, [eShop en contenedores](https://github.com/dotnet-architecture/eShopOnContainers), de Microsoft, muestra cómo implementar gRPC Services en aplicaciones de .net Core.</span><span class="sxs-lookup"><span data-stu-id="ccda3-182">The microservice reference architecture, [eShop on Containers](https://github.com/dotnet-architecture/eShopOnContainers), from Microsoft, shows how to implement gRPC services in .NET Core applications.</span></span> <span data-ttu-id="ccda3-183">En la figura 4-22 se presenta la arquitectura de back-end.</span><span class="sxs-lookup"><span data-stu-id="ccda3-183">Figure 4-22 presents the back-end architecture.</span></span>

![Arquitectura de back-end para eShop en contenedores](./media/eshop-with-aggregators.png)

<span data-ttu-id="ccda3-185">**Figura 4-22**.</span><span class="sxs-lookup"><span data-stu-id="ccda3-185">**Figure 4-22**.</span></span> <span data-ttu-id="ccda3-186">Arquitectura de back-end para eShop en contenedores</span><span class="sxs-lookup"><span data-stu-id="ccda3-186">Backend architecture for eShop on Containers</span></span>

<span data-ttu-id="ccda3-187">En la ilustración anterior, observe cómo eShop adopta el [back-end para el patrón de Front](https://docs.microsoft.com/azure/architecture/patterns/backends-for-frontends) -ends (BFF) exponiendo varias puertas de enlace de API.</span><span class="sxs-lookup"><span data-stu-id="ccda3-187">In the previous figure, note how eShop embraces the [Backend for Frontends pattern](https://docs.microsoft.com/azure/architecture/patterns/backends-for-frontends) (BFF) by exposing multiple API gateways.</span></span> <span data-ttu-id="ccda3-188">En este capítulo se describe el patrón BFF.</span><span class="sxs-lookup"><span data-stu-id="ccda3-188">We discussed the BFF pattern earlier in this chapter.</span></span> <span data-ttu-id="ccda3-189">Preste mucha atención al microservicio del agregador (en gris) que se encuentra entre la puerta de enlace de API de la compra web y los microservicios de compra de back-end.</span><span class="sxs-lookup"><span data-stu-id="ccda3-189">Pay close attention to the Aggregator microservice (in gray) that sits between the Web-Shopping API Gateway and backend Shopping microservices.</span></span> <span data-ttu-id="ccda3-190">El agregador recibe una única solicitud de un cliente, la envía a varios microservicios, agrega los resultados y los devuelve al cliente que realiza la solicitud.</span><span class="sxs-lookup"><span data-stu-id="ccda3-190">The Aggregator receives a single request from a client, dispatches it to various microservices, aggregates the results, and sends them back to the requesting client.</span></span> <span data-ttu-id="ccda3-191">Estas operaciones suelen requerir la comunicación sincrónica como para generar una respuesta inmediata.</span><span class="sxs-lookup"><span data-stu-id="ccda3-191">Such operations typically require synchronous communication as to produce an immediate response.</span></span> <span data-ttu-id="ccda3-192">En eShop, las llamadas de back-end del agregador se realizan mediante gRPC como se muestra en la figura 4-23.</span><span class="sxs-lookup"><span data-stu-id="ccda3-192">In eShop, backend calls from the Aggregator are performed using gRPC as shown in Figure 4-23.</span></span>

![gRPC en eShop en contenedores](./media/grpc-implementation.png)

<span data-ttu-id="ccda3-194">**Figura 4-23**.</span><span class="sxs-lookup"><span data-stu-id="ccda3-194">**Figure 4-23**.</span></span> <span data-ttu-id="ccda3-195">gRPC en eShop en contenedores</span><span class="sxs-lookup"><span data-stu-id="ccda3-195">gRPC in eShop on Containers</span></span>

<span data-ttu-id="ccda3-196">la comunicación de gRPC requiere componentes de cliente y de servidor.</span><span class="sxs-lookup"><span data-stu-id="ccda3-196">gRPC communication requires both client and server components.</span></span> <span data-ttu-id="ccda3-197">En la ilustración anterior, observe cómo el agregador de compras implementa un cliente de gRPC.</span><span class="sxs-lookup"><span data-stu-id="ccda3-197">In the previous figure, note how the Shopping Aggregator implements a gRPC client.</span></span> <span data-ttu-id="ccda3-198">El cliente realiza llamadas sincrónicas de gRPC (en rojo) a microservicios de back-end, cada una de las cuales implementa un servidor de gRPC.</span><span class="sxs-lookup"><span data-stu-id="ccda3-198">The client makes synchronous gRPC calls (in red) to backend microservices, each of which implement a gRPC server.</span></span> <span data-ttu-id="ccda3-199">Tanto el cliente como el servidor aprovechan las ventajas de la estructura gRPC integrada desde el SDK de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="ccda3-199">Both the client and server take advantage of the built-in gRPC plumbing from the .NET Core SDK.</span></span> <span data-ttu-id="ccda3-200">El *código auxiliar* del lado cliente proporciona la fontanería para invocar llamadas gRPC remotas.</span><span class="sxs-lookup"><span data-stu-id="ccda3-200">Client-side *stubs* provide the plumbing to invoke remote gRPC calls.</span></span> <span data-ttu-id="ccda3-201">Los componentes del lado servidor proporcionan mecanismos gRPC que las clases de servicio personalizadas pueden heredar y consumir.</span><span class="sxs-lookup"><span data-stu-id="ccda3-201">Server-side components provide gRPC plumbing that custom service classes can inherit and consume.</span></span>

<span data-ttu-id="ccda3-202">Los microservicios que exponen una API de RESTful y la comunicación de gRPC requieren varios puntos de conexión para administrar el tráfico.</span><span class="sxs-lookup"><span data-stu-id="ccda3-202">Microservices that expose both a RESTful API and gRPC communication require multiple endpoints to manage traffic.</span></span> <span data-ttu-id="ccda3-203">Abriría un punto de conexión que escucha el tráfico HTTP para las llamadas RESTful y otro para llamadas gRPC.</span><span class="sxs-lookup"><span data-stu-id="ccda3-203">You would open an endpoint that listens for HTTP traffic for the RESTful calls and another for gRPC calls.</span></span> <span data-ttu-id="ccda3-204">El punto de conexión de gRPC debe configurarse para el protocolo HTTP/2 que se requiere para la comunicación de gRPC.</span><span class="sxs-lookup"><span data-stu-id="ccda3-204">The gRPC endpoint must be configured for the HTTP/2 protocol that is required for gRPC communication.</span></span>

<span data-ttu-id="ccda3-205">Aunque nos esforzamos por desacoplar los microservicios con patrones de comunicación asincrónica, algunas operaciones requieren llamadas directas.</span><span class="sxs-lookup"><span data-stu-id="ccda3-205">While we strive to decouple microservices with asynchronous communication patterns, some operations require direct calls.</span></span> <span data-ttu-id="ccda3-206">gRPC debe ser la opción principal para la comunicación sincrónica directa entre microservicios.</span><span class="sxs-lookup"><span data-stu-id="ccda3-206">gRPC should be the primary choice for direct synchronous communication between microservices.</span></span> <span data-ttu-id="ccda3-207">Su Protocolo de comunicación de alto rendimiento, basado en HTTP/2 y los búferes de protocolo, lo convierten en una opción perfecta.</span><span class="sxs-lookup"><span data-stu-id="ccda3-207">Its high-performance communication protocol, based on HTTP/2 and protocol buffers, make it a perfect choice.</span></span>

## <a name="looking-ahead"></a><span data-ttu-id="ccda3-208">Mirar hacia arriba</span><span class="sxs-lookup"><span data-stu-id="ccda3-208">Looking ahead</span></span>

<span data-ttu-id="ccda3-209">En el futuro, gRPC continuará ganando tracción para sistemas nativos en la nube.</span><span class="sxs-lookup"><span data-stu-id="ccda3-209">Looking ahead, gRPC will continue to gain traction for cloud-native systems.</span></span> <span data-ttu-id="ccda3-210">Las ventajas de rendimiento y la facilidad de desarrollo son atractivas.</span><span class="sxs-lookup"><span data-stu-id="ccda3-210">The performance benefits and ease of development are compelling.</span></span> <span data-ttu-id="ccda3-211">Sin embargo, es probable que REST esté aproximadamente durante mucho tiempo.</span><span class="sxs-lookup"><span data-stu-id="ccda3-211">However, REST will likely be around for a long time.</span></span> <span data-ttu-id="ccda3-212">Excel es para las API expuestas públicamente y por motivos de compatibilidad con versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="ccda3-212">It excels for publicly exposed APIs and for backward compatibility reasons.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="ccda3-213">[Anterior](service-to-service-communication.md)
>[Siguiente](service-mesh-communication-infrastructure.md)</span><span class="sxs-lookup"><span data-stu-id="ccda3-213">[Previous](service-to-service-communication.md)
[Next](service-mesh-communication-infrastructure.md)</span></span>
