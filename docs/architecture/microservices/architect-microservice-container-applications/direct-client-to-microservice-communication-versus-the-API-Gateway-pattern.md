---
title: Diferencias entre el patrón de puerta de enlace de API y la comunicación directa de cliente a microservicio
description: Obtenga más información sobre las diferencias y los usos del patrón de puerta de enlace de API y la comunicación directa de cliente a microservicio.
ms.date: 01/07/2019
ms.openlocfilehash: 089b6302132437e4bb733653b3edb401ff81a164
ms.sourcegitcommit: 5280b2aef60a1ed99002dba44e4b9e7f6c830604
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 06/03/2020
ms.locfileid: "84306960"
---
# <a name="the-api-gateway-pattern-versus-the-direct-client-to-microservice-communication"></a><span data-ttu-id="f7e9b-103">Diferencias entre el patrón de puerta de enlace de API y la comunicación directa de cliente a microservicio</span><span class="sxs-lookup"><span data-stu-id="f7e9b-103">The API gateway pattern versus the Direct client-to-microservice communication</span></span>

<span data-ttu-id="f7e9b-104">En una arquitectura de microservicios, cada microservicio expone un conjunto de puntos de conexión específicos (normalmente).</span><span class="sxs-lookup"><span data-stu-id="f7e9b-104">In a microservices architecture, each microservice exposes a set of (typically) fine-grained endpoints.</span></span> <span data-ttu-id="f7e9b-105">Este hecho puede afectar a la comunicación entre el cliente y el microservicio, como se explica en esta sección.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-105">This fact can impact the client-to-microservice communication, as explained in this section.</span></span>

## <a name="direct-client-to-microservice-communication"></a><span data-ttu-id="f7e9b-106">Comunicación directa de cliente a microservicio</span><span class="sxs-lookup"><span data-stu-id="f7e9b-106">Direct client-to-microservice communication</span></span>

<span data-ttu-id="f7e9b-107">Un posible enfoque es usar una arquitectura de comunicación directa de cliente a microservicio.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-107">A possible approach is to use a direct client-to-microservice communication architecture.</span></span> <span data-ttu-id="f7e9b-108">En este enfoque, una aplicación cliente puede realizar solicitudes directamente a algunos de los microservicios, tal como se muestra en la figura 4-12.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-108">In this approach, a client app can make requests directly to some of the microservices, as shown in Figure 4-12.</span></span>

![Diagrama que muestra la arquitectura de comunicación directa de cliente a microservicio.](./media/direct-client-to-microservice-communication.png)

<span data-ttu-id="f7e9b-110">**Figura 4-12**.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-110">**Figure 4-12**.</span></span> <span data-ttu-id="f7e9b-111">Uso de una arquitectura de comunicación directa de cliente a microservicio</span><span class="sxs-lookup"><span data-stu-id="f7e9b-111">Using a direct client-to-microservice communication architecture</span></span>

<span data-ttu-id="f7e9b-112">En este enfoque, cada microservicio tiene un punto de conexión público, a veces con un puerto TCP distinto para cada microservicio.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-112">In this approach, each microservice has a public endpoint, sometimes with a different TCP port for each microservice.</span></span> <span data-ttu-id="f7e9b-113">La siguiente dirección URL de Azure sería un ejemplo de URL de un servicio determinado:</span><span class="sxs-lookup"><span data-stu-id="f7e9b-113">An example of a URL for a particular service could be the following URL in Azure:</span></span>

`http://eshoponcontainers.westus.cloudapp.azure.com:88/`

<span data-ttu-id="f7e9b-114">En un entorno de producción basado en un clúster, la dirección URL anterior estaría asignada al equilibrador de carga que se utiliza en el clúster, que a su vez distribuye las solicitudes entre los microservicios.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-114">In a production environment based on a cluster, that URL would map to the load balancer used in the cluster, which in turn distributes the requests across the microservices.</span></span> <span data-ttu-id="f7e9b-115">En entornos de producción, se puede tener un controlador de entrega de aplicaciones (ADC) como [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) entre los microservicios e Internet.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-115">In production environments, you could have an Application Delivery Controller (ADC) like [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) between your microservices and the Internet.</span></span> <span data-ttu-id="f7e9b-116">Este controlador actúa como una capa transparente que no solo realiza el equilibrio de carga, sino que también protege sus servicios, ya que ofrece terminación SSL.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-116">This acts as a transparent tier that not only performs load balancing, but secures your services by offering SSL termination.</span></span> <span data-ttu-id="f7e9b-117">Esto mejora la carga de los hosts, puesto que Azure Application Gateway se descarga de la terminación SSL y de otras tareas de enrutamiento que consumen mucha CPU.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-117">This improves the load of your hosts by offloading CPU-intensive SSL termination and other routing duties to the Azure Application Gateway.</span></span> <span data-ttu-id="f7e9b-118">En cualquier caso, un equilibrador de carga y el ADC son transparentes desde un punto de vista de la arquitectura de aplicación lógica.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-118">In any case, a load balancer and ADC are transparent from a logical application architecture point of view.</span></span>

<span data-ttu-id="f7e9b-119">Una arquitectura de comunicación directa de cliente a microservicio podría bastar para una pequeña aplicación basada en microservicio, especialmente si se trata de una aplicación web del lado cliente como, por ejemplo, una aplicación de ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-119">A direct client-to-microservice communication architecture could be good enough for a small microservice-based application, especially if the client app is a server-side web application like an ASP.NET MVC app.</span></span> <span data-ttu-id="f7e9b-120">Pero al compilar aplicaciones grandes y complejas basadas en microservicios (por ejemplo, al administrar docenas de tipos de microservicio) y, sobre todo, cuando las aplicaciones cliente son aplicaciones móviles remotas o aplicaciones web SPA, este enfoque se enfrenta a algunos problemas.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-120">However, when you build large and complex microservice-based applications (for example, when handling dozens of microservice types), and especially when the client apps are remote mobile apps or SPA web applications, that approach faces a few issues.</span></span>

<span data-ttu-id="f7e9b-121">Al desarrollar una aplicación de gran tamaño basada en microservicios, considere las siguientes preguntas:</span><span class="sxs-lookup"><span data-stu-id="f7e9b-121">Consider the following questions when developing a large application based on microservices:</span></span>

- <span data-ttu-id="f7e9b-122">*¿Cómo pueden las aplicaciones cliente minimizar el número de solicitudes al back-end y reducir el exceso de comunicación con varios microservicios?*</span><span class="sxs-lookup"><span data-stu-id="f7e9b-122">*How can client apps minimize the number of requests to the back end and reduce chatty communication to multiple microservices?*</span></span>

<span data-ttu-id="f7e9b-123">Interactuar con varios microservicios para crear una única pantalla de interfaz de usuario aumenta el número de recorridos de ida y vuelta a través de Internet.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-123">Interacting with multiple microservices to build a single UI screen increases the number of round trips across the Internet.</span></span> <span data-ttu-id="f7e9b-124">Esto aumenta la latencia y la complejidad en el lado de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-124">This increases latency and complexity on the UI side.</span></span> <span data-ttu-id="f7e9b-125">Idealmente, las respuestas se deberían agregar eficazmente en el lado del servidor.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-125">Ideally, responses should be efficiently aggregated in the server side.</span></span> <span data-ttu-id="f7e9b-126">Esto reduce la latencia, ya que varios fragmentos de datos regresan en paralelo y alguna interfaz de usuario puede mostrar los datos tan pronto como estén listos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-126">This reduces latency, since multiple pieces of data come back in parallel and some UI can show data as soon as it's ready.</span></span>

- <span data-ttu-id="f7e9b-127">*¿Cómo se pueden controlar cuestiones transversales como la autorización, las transformaciones de datos y la distribución de solicitudes dinámicas?*</span><span class="sxs-lookup"><span data-stu-id="f7e9b-127">*How can you handle cross-cutting concerns such as authorization, data transformations, and dynamic request dispatching?*</span></span>

<span data-ttu-id="f7e9b-128">La implementación de seguridad y cuestiones transversales como la seguridad y la autorización en cada microservicio pueden requerir un esfuerzo de desarrollo importante.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-128">Implementing security and cross-cutting concerns like security and authorization on every microservice can require significant development effort.</span></span> <span data-ttu-id="f7e9b-129">Un posible enfoque es tener esos servicios en el host de Docker o en un clúster interno para así restringir el acceso directo a ellos desde el exterior, e implementar estas cuestiones transversales en un lugar centralizado, como una puerta de enlace de API.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-129">A possible approach is to have those services within the Docker host or internal cluster to restrict direct access to them from the outside, and to implement those cross-cutting concerns in a centralized place, like an API Gateway.</span></span>

- <span data-ttu-id="f7e9b-130">*¿Cómo pueden las aplicaciones cliente comunicarse con servicios que usan protocolos no compatible con Internet?*</span><span class="sxs-lookup"><span data-stu-id="f7e9b-130">*How can client apps communicate with services that use non-Internet-friendly protocols?*</span></span>

<span data-ttu-id="f7e9b-131">Normalmente, los protocolos usados en el lado del servidor (por ejemplo, AMQP o protocolos binarios) no se admiten en aplicaciones cliente.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-131">Protocols used on the server side (like AMQP or binary protocols) are usually not supported in client apps.</span></span> <span data-ttu-id="f7e9b-132">Por lo tanto, las solicitudes deben realizarse a través de protocolos como HTTP/HTTPS y convertirse posteriormente a los demás protocolos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-132">Therefore, requests must be performed through protocols like HTTP/HTTPS and translated to the other protocols afterwards.</span></span> <span data-ttu-id="f7e9b-133">Un enfoque *man-in-the-middle* puede ser útil en esta situación.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-133">A *man-in-the-middle* approach can help in this situation.</span></span>

- <span data-ttu-id="f7e9b-134">*¿Cómo se puede dar forma a una fachada creada especialmente para las aplicaciones móviles?*</span><span class="sxs-lookup"><span data-stu-id="f7e9b-134">*How can you shape a facade especially made for mobile apps?*</span></span>

<span data-ttu-id="f7e9b-135">El diseño de la API de varios microservicios podría no adaptarse a las necesidades de diferentes aplicaciones cliente.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-135">The API of multiple microservices might not be well designed for the needs of different client applications.</span></span> <span data-ttu-id="f7e9b-136">Por ejemplo, las necesidades de una aplicación móvil pueden ser diferentes a las necesidades de una aplicación web.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-136">For instance, the needs of a mobile app might be different than the needs of a web app.</span></span> <span data-ttu-id="f7e9b-137">Para las aplicaciones móviles, la optimización debe ser incluso mayor para que las respuestas de datos sean más eficaces.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-137">For mobile apps, you might need to optimize even further so that data responses can be more efficient.</span></span> <span data-ttu-id="f7e9b-138">Para lograr esto, puede agregar los datos de varios microservicios y devolver un único conjunto de datos y, a veces, eliminar los datos de la respuesta que no son necesarios para la aplicación móvil.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-138">You might do this by aggregating data from multiple microservices and returning a single set of data, and sometimes eliminating any data in the response that isn't needed by the mobile app.</span></span> <span data-ttu-id="f7e9b-139">Y, por supuesto, puede comprimir los datos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-139">And, of course, you might compress that data.</span></span> <span data-ttu-id="f7e9b-140">Una vez más, una fachada o API entre la aplicación móvil y los microservicios puede ser conveniente para este escenario.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-140">Again, a facade or API in between the mobile app and the microservices can be convenient for this scenario.</span></span>

## <a name="why-consider-api-gateways-instead-of-direct-client-to-microservice-communication"></a><span data-ttu-id="f7e9b-141">Por qué considerar las puertas de enlace de API en lugar de la comunicación directa de cliente a microservicio</span><span class="sxs-lookup"><span data-stu-id="f7e9b-141">Why consider API Gateways instead of direct client-to-microservice communication</span></span>

<span data-ttu-id="f7e9b-142">En una arquitectura de microservicios, las aplicaciones cliente generalmente necesitan consumir funcionalidades de más de un microservicio.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-142">In a microservices architecture, the client apps usually need to consume functionality from more than one microservice.</span></span> <span data-ttu-id="f7e9b-143">Si ese consumo se realiza directamente, el cliente debe controlar varias llamadas a los puntos de conexión de microservicio.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-143">If that consumption is performed directly, the client needs to handle multiple calls to microservice endpoints.</span></span> <span data-ttu-id="f7e9b-144">¿Qué ocurre cuando la aplicación evoluciona y se introducen nuevos microservicios o se actualizan microservicios existentes?</span><span class="sxs-lookup"><span data-stu-id="f7e9b-144">What happens when the application evolves and new microservices are introduced or existing microservices are updated?</span></span> <span data-ttu-id="f7e9b-145">Si la aplicación tiene muchos microservicios, controlar tantos puntos de conexión desde las aplicaciones cliente puede ser una pesadilla.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-145">If your application has many microservices, handling so many endpoints from the client apps can be a nightmare.</span></span> <span data-ttu-id="f7e9b-146">Puesto que la aplicación cliente debería acoplarse a esos puntos de conexión internos, la evolución de los microservicios en el futuro podría provocar un alto impacto para las aplicaciones cliente.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-146">Since the client app would be coupled to those internal endpoints, evolving the microservices in the future can cause high impact for the client apps.</span></span>

<span data-ttu-id="f7e9b-147">Por lo tanto, disponer de un nivel intermedio o un nivel de direccionamiento indirecto (puerta de enlace) puede ser muy práctico para las aplicaciones basadas en microservicios.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-147">Therefore, having an intermediate level or tier of indirection (Gateway) can be very convenient for microservice-based applications.</span></span> <span data-ttu-id="f7e9b-148">Si no dispone de las puertas de enlace de API, las aplicaciones cliente deben enviar solicitudes directamente a los microservicios y eso genera problemas, como los siguientes:</span><span class="sxs-lookup"><span data-stu-id="f7e9b-148">If you don't have API Gateways, the client apps must send requests directly to the microservices and that raises problems, such as the following issues:</span></span>

- <span data-ttu-id="f7e9b-149">**Acoplamiento**: Sin el patrón de puerta de enlace de API, las aplicaciones cliente se acoplan a los microservicios internos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-149">**Coupling**: Without the API Gateway pattern, the client apps are coupled to the internal microservices.</span></span> <span data-ttu-id="f7e9b-150">Las aplicaciones cliente necesitan saber cómo se descomponen las diferentes áreas de la aplicación en microservicios.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-150">The client apps need to know how the multiple areas of the application are decomposed in microservices.</span></span> <span data-ttu-id="f7e9b-151">Al hacer evolucionar y refactorizar los microservicios internos, esas acciones tienen un impacto en el mantenimiento porque provocan cambios bruscos en las aplicaciones cliente debido a la referencia directa a los microservicios internos desde las aplicaciones cliente.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-151">When evolving and refactoring the internal microservices, those actions impact maintenance because they cause breaking changes to the client apps due to the direct reference to the internal microservices from the client apps.</span></span> <span data-ttu-id="f7e9b-152">Las aplicaciones cliente deben actualizarse con frecuencia, lo que dificulta la evolución de la solución.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-152">Client apps need to be updated frequently, making the solution harder to evolve.</span></span>

- <span data-ttu-id="f7e9b-153">**Demasiados ciclos de ida y vuelta**: Una única pantalla o página en la aplicación cliente puede requerir varias llamadas a varios servicios.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-153">**Too many round trips**: A single page/screen in the client app might require several calls to multiple services.</span></span> <span data-ttu-id="f7e9b-154">Esto puede dar como resultado múltiples recorridos de ida y vuelta entre el cliente y el servidor, lo cual agrega una latencia significativa.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-154">That can result in multiple network round trips between the client and the server, adding significant latency.</span></span> <span data-ttu-id="f7e9b-155">La agregación controlada en un nivel intermedio podría mejorar el rendimiento y la experiencia del usuario para la aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-155">Aggregation handled in an intermediate level could improve the performance and user experience for the client app.</span></span>

- <span data-ttu-id="f7e9b-156">**Problemas de seguridad**: Sin una puerta de enlace, todos los microservicios se deben exponer al "mundo externo", haciendo que la superficie del ataque sea mayor que si se ocultan los microservicios internos que las aplicaciones cliente no usan de forma directa.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-156">**Security issues**: Without a gateway, all the microservices must be exposed to the "external world", making the attack surface larger than if you hide internal microservices that aren't directly used by the client apps.</span></span> <span data-ttu-id="f7e9b-157">Cuanto menor sea la superficie de ataque, más segura será la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-157">The smaller the attack surface is, the more secure your application can be.</span></span>

- <span data-ttu-id="f7e9b-158">**Intereses transversales**: Cada microservicio difundido de manera pública debe ocuparse de cuestiones tales como la autorización y SSL.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-158">**Cross-cutting concerns**: Each publicly published microservice must handle concerns such as authorization and SSL.</span></span> <span data-ttu-id="f7e9b-159">En muchos casos, estas cuestiones podrían controlarse en un solo nivel de manera que se simplifiquen los microservicios internos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-159">In many situations, those concerns could be handled in a single tier so the internal microservices are simplified.</span></span>

## <a name="what-is-the-api-gateway-pattern"></a><span data-ttu-id="f7e9b-160">¿Qué es el patrón de puerta de enlace de API?</span><span class="sxs-lookup"><span data-stu-id="f7e9b-160">What is the API Gateway pattern?</span></span>

<span data-ttu-id="f7e9b-161">Al diseñar y crear aplicaciones basadas en microservicios grandes o complejas con varias aplicaciones cliente, un buen planteamiento podría ser una [puerta de enlace de API](https://microservices.io/patterns/apigateway.html).</span><span class="sxs-lookup"><span data-stu-id="f7e9b-161">When you design and build large or complex microservice-based applications with multiple client apps, a good approach to consider can be an [API Gateway](https://microservices.io/patterns/apigateway.html).</span></span> <span data-ttu-id="f7e9b-162">Se trata de un servicio que proporciona un punto de entrada único para determinados grupos de microservicios.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-162">This is a service that provides a single-entry point for certain groups of microservices.</span></span> <span data-ttu-id="f7e9b-163">Es similar al [patrón de fachada](https://en.wikipedia.org/wiki/Facade_pattern) del diseño orientado a objetos, pero en este caso forma parte de un sistema distribuido.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-163">It's similar to the [Facade pattern](https://en.wikipedia.org/wiki/Facade_pattern) from object-oriented design, but in this case, it's part of a distributed system.</span></span> <span data-ttu-id="f7e9b-164">En ocasiones, el patrón de puerta de enlace de API también se conoce como "back-end para front-end" ([BFF](https://samnewman.io/patterns/architectural/bff/)) porque en la compilación se tienen en cuenta las necesidades de la aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-164">The API Gateway pattern is also sometimes known as the "backend for frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) because you build it while thinking about the needs of the client app.</span></span>

<span data-ttu-id="f7e9b-165">Por lo tanto, la puerta de enlace de API se encuentra entre las aplicaciones cliente y los microservicios.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-165">Therefore, the API gateway sits between the client apps and the microservices.</span></span> <span data-ttu-id="f7e9b-166">Actúa como un proxy inverso, enrutando las solicitudes de los clientes a los servicios.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-166">It acts as a reverse proxy, routing requests from clients to services.</span></span> <span data-ttu-id="f7e9b-167">También puede proporcionar características transversales adicionales, como autenticación, terminación SSL y caché.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-167">It can also provide additional cross-cutting features such as authentication, SSL termination, and cache.</span></span>

<span data-ttu-id="f7e9b-168">La figura 4-13 muestra el encaje de una puerta de enlace de API personalizada en una arquitectura basada en microservicios simplificada con solo algunos microservicios.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-168">Figure 4-13 shows how a custom API Gateway can fit into a simplified microservice-based architecture with just a few microservices.</span></span>

![Diagrama que muestra una puerta de enlace de API implementada como un servicio personalizado.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/custom-service-api-gateway.png)

<span data-ttu-id="f7e9b-170">**Figura 4-13**.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-170">**Figure 4-13**.</span></span> <span data-ttu-id="f7e9b-171">Uso de una puerta de enlace de API implementada como un servicio personalizado</span><span class="sxs-lookup"><span data-stu-id="f7e9b-171">Using an API Gateway implemented as a custom service</span></span>

<span data-ttu-id="f7e9b-172">Las aplicaciones se conecten a un único punto de conexión (la puerta de enlace de API) configurado para reenviar solicitudes a los microservicios individuales.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-172">Apps connect to a single endpoint, the API Gateway, that's configured to forward requests to individual microservices.</span></span> <span data-ttu-id="f7e9b-173">En este ejemplo, la puerta de enlace de API se implementa como un servicio ASP.NET Core WebHost personalizado que se ejecuta como un contenedor.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-173">In this example, the API Gateway would be implemented as a custom ASP.NET Core WebHost service running as a container.</span></span>

<span data-ttu-id="f7e9b-174">Es importante resaltar que en ese diagrama se usa un único servicio de puerta de enlace de API personalizado con conexión a varias aplicaciones cliente distintas.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-174">It's important to highlight that in that diagram, you would be using a single custom API Gateway service facing multiple and different client apps.</span></span> <span data-ttu-id="f7e9b-175">Ese hecho puede suponer un riesgo importante porque el servicio de puerta de enlace de API irá creciendo y evolucionando en función de los muchos requisitos de las aplicaciones cliente.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-175">That fact can be an important risk because your API Gateway service will be growing and evolving based on many different requirements from the client apps.</span></span> <span data-ttu-id="f7e9b-176">Finalmente, se verá sobredimensionado debido a las distintas necesidades y, en la práctica, podría ser similar a una aplicación o un servicio monolíticos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-176">Eventually, it will be bloated because of those different needs and effectively it could be similar to a monolithic application or monolithic service.</span></span> <span data-ttu-id="f7e9b-177">Por eso es muy recomendable dividir la puerta de enlace de API en varios servicios o varias puertas de enlace de API más pequeñas, por ejemplo, una por cada tipo de factor de forma de aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-177">That's why it's very much recommended to split the API Gateway in multiple services or multiple smaller API Gateways, one per client app form-factor type, for instance.</span></span>

<span data-ttu-id="f7e9b-178">Debe tener cuidado al implementar el patrón de puerta de enlace de API.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-178">You need to be careful when implementing the API Gateway pattern.</span></span> <span data-ttu-id="f7e9b-179">No suele ser una buena idea de tener una única puerta de enlace de API en la que se agreguen todos los microservicios internos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-179">Usually it isn't a good idea to have a single API Gateway aggregating all the internal microservices of your application.</span></span> <span data-ttu-id="f7e9b-180">Si es así, actúa como un orquestador o agregador monolítico e infringe la autonomía de los microservicios al acoplarlos todos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-180">If it does, it acts as a monolithic aggregator or orchestrator and violates microservice autonomy by coupling all the microservices.</span></span>

<span data-ttu-id="f7e9b-181">Por lo tanto, las puertas de enlace de API se deberían segregar en función de los límites del negocio y las aplicaciones cliente no deberían actuar como un simple agregador para todos los microservicios internos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-181">Therefore, the API Gateways should be segregated based on business boundaries and the client apps and not act as a single aggregator for all the internal microservices.</span></span>

<span data-ttu-id="f7e9b-182">Al dividir el nivel de puerta de enlace de API en múltiples puertas de enlace de API, si la aplicación tiene varias aplicaciones cliente, puede servir de pivote principal al identificar los múltiples tipos de puertas de enlace de API, de manera que puede tener otra fachada para las necesidades de cada aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-182">When splitting the API Gateway tier into multiple API Gateways, if your application has multiple client apps, that can be a primary pivot when identifying the multiple API Gateways types, so that you can have a different facade for the needs of each client app.</span></span> <span data-ttu-id="f7e9b-183">Este caso es un patrón denominado "back-end para front-end" ([BFF](https://samnewman.io/patterns/architectural/bff/)), donde cada puerta de enlace de API puede proporcionar una API distinta adaptada a cada tipo de aplicación cliente, posiblemente basada incluso en el factor de forma de cliente, mediante la implementación de código adaptador específico que llame, de forma subyacente, a varios servicios internos, como se muestra en la imagen siguiente:</span><span class="sxs-lookup"><span data-stu-id="f7e9b-183">This case is a pattern named "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) where each API Gateway can provide a different API tailored for each client app type, possibly even based on the client form factor by implementing specific adapter code which underneath calls multiple internal microservices, as shown in the following image:</span></span>

![Diagrama que muestra varias puertas de enlace de API personalizadas.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/multiple-custom-api-gateways.png)

<span data-ttu-id="f7e9b-185">**Figura 4-13.1**.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-185">**Figure 4-13.1**.</span></span> <span data-ttu-id="f7e9b-186">Uso de varias puertas de enlace de API personalizadas</span><span class="sxs-lookup"><span data-stu-id="f7e9b-186">Using multiple custom API Gateways</span></span>

<span data-ttu-id="f7e9b-187">Figura 4-13.1 que muestra puertas de enlace de API personalizadas, segregadas por tipo de cliente; una para los clientes móviles y otra para los clientes web.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-187">Figure 4-13.1 shows API Gateways that are segregated by client type; one for mobile clients and one for web clients.</span></span> <span data-ttu-id="f7e9b-188">Una aplicación web tradicional se conecta a un microservicio MVC que usa la puerta de enlace de API web.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-188">A traditional web app connects to an MVC microservice that uses the web API Gateway.</span></span> <span data-ttu-id="f7e9b-189">En el ejemplo se muestra una arquitectura simplificada con varias puertas de enlace de API específicas.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-189">The example depicts a simplified architecture with multiple fine-grained API Gateways.</span></span> <span data-ttu-id="f7e9b-190">En este caso, los límites identificados para cada puerta de enlace de API se basan estrictamente en el patrón "back-end para front-end" ([BFF](https://samnewman.io/patterns/architectural/bff/)); por tanto, se basan solo en la API necesaria para cada aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-190">In this case, the boundaries identified for each API Gateway are based purely on the "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) pattern, hence based just on the API needed per client app.</span></span> <span data-ttu-id="f7e9b-191">Pero en aplicaciones más grandes también debe ir más allá y crear otras puertas de enlace de API basadas en los límites del negocio como un segundo pivote de diseño.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-191">But in larger applications you should also go further and create additional API Gateways based on business boundaries as a second design pivot.</span></span>

## <a name="main-features-in-the-api-gateway-pattern"></a><span data-ttu-id="f7e9b-192">Características principales en el patrón de puerta de enlace de API</span><span class="sxs-lookup"><span data-stu-id="f7e9b-192">Main features in the API Gateway pattern</span></span>

<span data-ttu-id="f7e9b-193">Una puerta de enlace de API puede ofrecer varias características.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-193">An API Gateway can offer multiple features.</span></span> <span data-ttu-id="f7e9b-194">Dependiendo del producto, podría ofrecer características más completas o más sencillas; sin embargo, las características más importantes y fundamentales para cualquier puerta de enlace de API son los siguientes patrones de diseño:</span><span class="sxs-lookup"><span data-stu-id="f7e9b-194">Depending on the product it might offer richer or simpler features, however, the most important and foundational features for any API Gateway are the following design patterns:</span></span>

<span data-ttu-id="f7e9b-195">**Proxy inverso o enrutamiento de puerta de enlace**.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-195">**Reverse proxy or gateway routing.**</span></span> <span data-ttu-id="f7e9b-196">La puerta de enlace de API ofrece un proxy inverso para redirigir o enrutar las solicitudes (enrutamiento de capa 7, normalmente solicitudes HTTP) a los puntos de conexión de los microservicios internos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-196">The API Gateway offers a reverse proxy to redirect or route requests (layer 7 routing, usually HTTP requests) to the endpoints of the internal microservices.</span></span> <span data-ttu-id="f7e9b-197">La puerta de enlace proporciona un único punto de conexión o dirección URL para las aplicaciones cliente y, a continuación, asigna internamente las solicitudes a un grupo de microservicios internos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-197">The gateway provides a single endpoint or URL for the client apps and then internally maps the requests to a group of internal microservices.</span></span> <span data-ttu-id="f7e9b-198">Esta característica de enrutamiento ayuda a desconectar las aplicaciones cliente de los microservicios, pero también resulta práctica al modernizar una API monolítica colocando la puerta de enlace de API entre la API monolítica y las aplicaciones cliente; de este modo, se pueden agregar nuevas API como nuevos microservicios mientras se sigue usando la API monolítica heredada hasta que se divida en muchos microservicios en el futuro.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-198">This routing feature helps to decouple the client apps from the microservices but it's also convenient when modernizing a monolithic API by sitting the API Gateway in between the monolithic API and the client apps, then you can add new APIs as new microservices while still using the legacy monolithic API until it's split into many microservices in the future.</span></span> <span data-ttu-id="f7e9b-199">Debido a la puerta de enlace de API, las aplicaciones cliente no notarán si las API que se usan se implementan como microservicios internos o una API monolítica y, lo que es más importante, al evolucionar y refactorizar la API monolítica en microservicios, gracias al enrutamiento de la puerta de enlace de API, las aplicaciones cliente no se verán afectadas por ningún cambio de URI.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-199">Because of the API Gateway, the client apps won't notice if the APIs being used are implemented as internal microservices or a monolithic API and more importantly, when evolving and refactoring the monolithic API into microservices, thanks to the API Gateway routing, client apps won't be impacted with any URI change.</span></span>

<span data-ttu-id="f7e9b-200">Para obtener más información, consulte [Patrón Gateway Routing](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span><span class="sxs-lookup"><span data-stu-id="f7e9b-200">For more information, see [Gateway routing pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-routing).</span></span>

<span data-ttu-id="f7e9b-201">**Agregación de solicitudes.**</span><span class="sxs-lookup"><span data-stu-id="f7e9b-201">**Requests aggregation.**</span></span> <span data-ttu-id="f7e9b-202">Como parte del patrón de puerta de enlace, es posible agregar varias solicitudes de cliente (normalmente las solicitudes HTTP) dirigidas a varios microservicios internos en una sola solicitud de cliente.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-202">As part of the gateway pattern you can aggregate multiple client requests (usually HTTP requests) targeting multiple internal microservices into a single client request.</span></span> <span data-ttu-id="f7e9b-203">Este patrón es especialmente útil cuando una página o pantalla de cliente necesita información de varios microservicios.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-203">This pattern is especially convenient when a client page/screen needs information from several microservices.</span></span> <span data-ttu-id="f7e9b-204">Con este enfoque, la aplicación cliente envía una solicitud única a la puerta de enlace de API que envía varias solicitudes a los microservicios internos y, a continuación, agrega los resultados y envía todo el contenido de nuevo a la aplicación cliente.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-204">With this approach, the client app sends a single request to the API Gateway that dispatches several requests to the internal microservices and then aggregates the results and sends everything back to the client app.</span></span> <span data-ttu-id="f7e9b-205">La ventaja principal y el objetivo de este patrón de diseño radica en la reducción del intercambio de mensajes entre las aplicaciones cliente y la API de back-end, lo cual es especialmente importante para las aplicaciones remotas fuera del centro de datos donde residen los microservicios, como aplicaciones móviles o solicitudes de aplicaciones SPA que provienen de JavaScript en exploradores de cliente remotos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-205">The main benefit and goal of this design pattern is to reduce chattiness between the client apps and the backend API, which is especially important for remote apps out of the datacenter where the microservices live, like mobile apps or requests coming from SPA apps that come from JavaScript in client remote browsers.</span></span> <span data-ttu-id="f7e9b-206">En el caso de las aplicaciones web normales que realizan las solicitudes en el entorno del servidor (como una aplicación web ASP.NET Core MVC), este patrón no es tan importante, ya que la latencia es mucho menor que para las aplicaciones cliente remotas.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-206">For regular web apps performing the requests in the server environment (like an ASP.NET Core MVC web app), this pattern is not so important as the latency is very much smaller than for remote client apps.</span></span>

<span data-ttu-id="f7e9b-207">Dependiendo del producto de puerta de enlace de API que use, es posible que pueda realizar esta agregación.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-207">Depending on the API Gateway product you use, it might be able to perform this aggregation.</span></span> <span data-ttu-id="f7e9b-208">Pero en muchos casos resulta más flexible crear microservicios de agregación en el ámbito de la puerta de enlace de API, de manera que la agregación se define en el código (es decir, código de C#):</span><span class="sxs-lookup"><span data-stu-id="f7e9b-208">However, in many cases it's more flexible to create aggregation microservices under the scope of the API Gateway, so you define the aggregation in code (that is, C# code):</span></span>

<span data-ttu-id="f7e9b-209">Para obtener más información, consulte [Patrón Gateway Aggregation](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span><span class="sxs-lookup"><span data-stu-id="f7e9b-209">For more information, see [Gateway aggregation pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-aggregation).</span></span>

<span data-ttu-id="f7e9b-210">**Cuestiones transversales o descarga de puerta de enlace.**</span><span class="sxs-lookup"><span data-stu-id="f7e9b-210">**Cross-cutting concerns or gateway offloading.**</span></span> <span data-ttu-id="f7e9b-211">Dependiendo de las características que ofrece cada producto de puerta de enlace de API, puede descargar la funcionalidad de microservicios individuales a la puerta de enlace, lo que simplifica la implementación de cada microservicio consolidando las cuestiones transversales en un nivel.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-211">Depending on the features offered by each API Gateway product, you can offload functionality from individual microservices to the gateway, which simplifies the implementation of each microservice by consolidating cross-cutting concerns into one tier.</span></span> <span data-ttu-id="f7e9b-212">Esto resulta especialmente útil para las características especializadas, que pueden ser bastante complicadas de implementar correctamente en cada microservicio interno, como la funcionalidad siguiente:</span><span class="sxs-lookup"><span data-stu-id="f7e9b-212">This is especially convenient for specialized features that can be complex to implement properly in every internal microservice, such as the following functionality:</span></span>

- <span data-ttu-id="f7e9b-213">Autenticación y autorización</span><span class="sxs-lookup"><span data-stu-id="f7e9b-213">Authentication and authorization</span></span>
- <span data-ttu-id="f7e9b-214">Integración del servicio de detección</span><span class="sxs-lookup"><span data-stu-id="f7e9b-214">Service discovery integration</span></span>
- <span data-ttu-id="f7e9b-215">Almacenamiento en caché de respuestas</span><span class="sxs-lookup"><span data-stu-id="f7e9b-215">Response caching</span></span>
- <span data-ttu-id="f7e9b-216">Directivas de reintento, interruptor y QoS</span><span class="sxs-lookup"><span data-stu-id="f7e9b-216">Retry policies, circuit breaker, and QoS</span></span>
- <span data-ttu-id="f7e9b-217">Limitación de velocidad</span><span class="sxs-lookup"><span data-stu-id="f7e9b-217">Rate limiting and throttling</span></span>
- <span data-ttu-id="f7e9b-218">Equilibrio de carga</span><span class="sxs-lookup"><span data-stu-id="f7e9b-218">Load balancing</span></span>
- <span data-ttu-id="f7e9b-219">Registro, seguimiento, correlación</span><span class="sxs-lookup"><span data-stu-id="f7e9b-219">Logging, tracing, correlation</span></span>
- <span data-ttu-id="f7e9b-220">Encabezados, cadenas de consulta y transformación de notificaciones</span><span class="sxs-lookup"><span data-stu-id="f7e9b-220">Headers, query strings, and claims transformation</span></span>
- <span data-ttu-id="f7e9b-221">Creación de listas blancas IP</span><span class="sxs-lookup"><span data-stu-id="f7e9b-221">IP whitelisting</span></span>

<span data-ttu-id="f7e9b-222">Para obtener más información, consulte [Patrón Gateway Offloading](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span><span class="sxs-lookup"><span data-stu-id="f7e9b-222">For more information, see [Gateway offloading pattern](https://docs.microsoft.com/azure/architecture/patterns/gateway-offloading).</span></span>

## <a name="using-products-with-api-gateway-features"></a><span data-ttu-id="f7e9b-223">Uso de productos con características de puerta de enlace de API</span><span class="sxs-lookup"><span data-stu-id="f7e9b-223">Using products with API Gateway features</span></span>

<span data-ttu-id="f7e9b-224">Puede haber muchas más cuestiones transversales ofrecidas por los productos de las puertas de enlace de API dependiendo de cada implementación.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-224">There can be many more cross-cutting concerns offered by the API Gateways products depending on each implementation.</span></span> <span data-ttu-id="f7e9b-225">Aquí trataremos los siguientes puntos:</span><span class="sxs-lookup"><span data-stu-id="f7e9b-225">We'll explore here:</span></span>

- [<span data-ttu-id="f7e9b-226">Azure API Management</span><span class="sxs-lookup"><span data-stu-id="f7e9b-226">Azure API Management</span></span>](https://azure.microsoft.com/services/api-management/)
- [<span data-ttu-id="f7e9b-227">Ocelot</span><span class="sxs-lookup"><span data-stu-id="f7e9b-227">Ocelot</span></span>](https://github.com/ThreeMammals/Ocelot)

### <a name="azure-api-management"></a><span data-ttu-id="f7e9b-228">Azure API Management</span><span class="sxs-lookup"><span data-stu-id="f7e9b-228">Azure API Management</span></span>

<span data-ttu-id="f7e9b-229">[Azure API Management](https://azure.microsoft.com/services/api-management/) (como se muestra en la figura 4-14) no solo resuelve las necesidades de puerta de enlace de API, sino que también proporciona características como la recopilación de información de las API.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-229">[Azure API Management](https://azure.microsoft.com/services/api-management/) (as shown in Figure 4-14) not only solves your API Gateway needs but provides features like gathering insights from your APIs.</span></span> <span data-ttu-id="f7e9b-230">Si se usa una solución de administración de API, una puerta de enlace de API es solo un componente dentro de esa solución de administración de API completa.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-230">If you're using an API management solution, an API Gateway is only a component within that full API management solution.</span></span>

![Diagrama que muestra cómo usar Azure API Management como la puerta de enlace de API.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/api-gateway-azure-api-management.png)

<span data-ttu-id="f7e9b-232">**Figura 4-14**.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-232">**Figure 4-14**.</span></span> <span data-ttu-id="f7e9b-233">Uso de Azure API Management para la puerta de enlace de API</span><span class="sxs-lookup"><span data-stu-id="f7e9b-233">Using Azure API Management for your API Gateway</span></span>

<span data-ttu-id="f7e9b-234">Azure API Management resuelve las necesidades de administración y de puerta de enlace de API, como el registro, la seguridad, la medición, etc. En este caso, cuando se usa un producto como Azure API Management, el hecho de tener una sola puerta de enlace de API no es tan arriesgado porque estos tipos de puertas de enlace de API son "más estrechos", lo que significa que no implementan código C# personalizado que podría evolucionar hacia un componente monolítico.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-234">Azure API Management solves both your API Gateway and Management needs like logging, security, metering, etc. In this case, when using a product like Azure API Management, the fact that you might have a single API Gateway is not so risky because these kinds of API Gateways are "thinner", meaning that you don't implement custom C# code that could evolve towards a monolithic component.</span></span>

<span data-ttu-id="f7e9b-235">Los productos de puerta de enlace de API suelen actuar más como un proxy inverso para la comunicación de entrada, en el que se pueden filtrar las API de los microservicios internos y también aplicar la autorización a las API publicadas en este nivel único.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-235">The API Gateway products usually act like a reverse proxy for ingress communication, where you can also filter the APIs from the internal microservices plus apply authorization to the published APIs in this single tier.</span></span>

<span data-ttu-id="f7e9b-236">La información disponible desde un sistema API le ayuda a comprender cómo se están utilizando las API y cuál es su rendimiento.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-236">The insights available from an API Management system help you get an understanding of how your APIs are being used and how they are performing.</span></span> <span data-ttu-id="f7e9b-237">Para ello, le permiten ver informes de análisis prácticamente en tiempo real e identificar las tendencias que podrían afectar a su negocio.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-237">They do this by letting you view near real-time analytics reports and identifying trends that might impact your business.</span></span> <span data-ttu-id="f7e9b-238">Además, puede obtener registros sobre la actividad de solicitudes y respuestas para su posterior análisis en línea y sin conexión.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-238">Plus, you can have logs about request and response activity for further online and offline analysis.</span></span>

<span data-ttu-id="f7e9b-239">Con Azure API Management, puede proteger sus API con una clave, un token y el filtrado de IP.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-239">With Azure API Management, you can secure your APIs using a key, a token, and IP filtering.</span></span> <span data-ttu-id="f7e9b-240">Estas características le permiten aplicar cuotas flexibles y específicas y límites de frecuencia, modificar la forma y el comportamiento de las API mediante directivas y mejorar el rendimiento con el almacenamiento de respuestas en caché.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-240">These features let you enforce flexible and fine-grained quotas and rate limits, modify the shape and behavior of your APIs using policies, and improve performance with response caching.</span></span>

<span data-ttu-id="f7e9b-241">En esta guía y en la aplicación de ejemplo de referencia (eShopOnContainers), nos limitamos a una arquitectura en contenedores más sencilla y personalizada para que pueda centrarse en los contenedores sin formato sin utilizar productos de PaaS como Azure API Management.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-241">In this guide and the reference sample application (eShopOnContainers), the architecture is limited to a simpler and custom-made containerized architecture in order to focus on plain containers without using PaaS products like Azure API Management.</span></span> <span data-ttu-id="f7e9b-242">Pero para las grandes aplicaciones basadas en microservicios que se implementan en Microsoft Azure, le recomendamos que valore Azure API Management como base para las puertas de enlace de API en producción.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-242">But for large microservice-based applications that are deployed into Microsoft Azure, we encourage you to evaluate Azure API Management as the base for your API Gateways in production.</span></span>

### <a name="ocelot"></a><span data-ttu-id="f7e9b-243">Ocelot</span><span class="sxs-lookup"><span data-stu-id="f7e9b-243">Ocelot</span></span>

<span data-ttu-id="f7e9b-244">[Ocelot](https://github.com/ThreeMammals/Ocelot) es una puerta de enlace de API ligera, recomendada para enfoques más simples.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-244">[Ocelot](https://github.com/ThreeMammals/Ocelot) is a lightweight API Gateway, recommended for simpler approaches.</span></span> <span data-ttu-id="f7e9b-245">Ocelot es una puerta de enlace de API de código abierto basada en .NET Core especialmente diseñada para las arquitecturas de microservicios que necesitan puntos de entrada unificados en sus sistemas.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-245">Ocelot is an Open Source .NET Core-based API Gateway especially made for microservices architectures that need unified points of entry into their systems.</span></span> <span data-ttu-id="f7e9b-246">Es ligera, rápida y escalable, y proporciona enrutamiento y autenticación, entre muchas otras características.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-246">It's lightweight, fast, and scalable and provides routing and authentication among many other features.</span></span>

<span data-ttu-id="f7e9b-247">La razón principal para elegir Ocelot para la [aplicación de referencia eShopOnContainers](https://github.com/dotnet-architecture/eShopOnContainers) es porque es una puerta de enlace de API ligera de .NET Core que se puede implementar en el mismo entorno de implementación de aplicaciones en el que se implementan los microservicios y contenedores, como Docker Host, Kubernetes, etc. Y puesto que se basa en .NET Core, es multiplataforma, así que la puede implementar en Linux o Windows.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-247">The main reason to choose Ocelot for the [eShopOnContainers reference application](https://github.com/dotnet-architecture/eShopOnContainers) is because Ocelot is a .NET Core lightweight API Gateway that you can deploy into the same application deployment environment where you're deploying your microservices/containers, such as a Docker Host, Kubernetes, etc. And since it's based on .NET Core, it's cross-platform allowing you to deploy on Linux or Windows.</span></span>

<span data-ttu-id="f7e9b-248">Los diagramas anteriores que muestran puertas de enlace de API personalizadas que se ejecutan en contenedores son precisamente la forma en que también puede ejecutar Ocelot en una aplicación basada en contenedor y microservicio.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-248">The previous diagrams showing custom API Gateways running in containers are precisely how you can also run Ocelot in a container and microservice-based application.</span></span>

<span data-ttu-id="f7e9b-249">Además, hay otros muchos productos en el mercado que ofrecen características de puertas de enlace de API, como Apigee, Kong, MuleSoft o WSO2, y otros productos, como Linkerd y Istio, para características de controlador de ingreso de malla de servicio.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-249">In addition, there are many other products in the market offering API Gateways features, such as Apigee, Kong, MuleSoft, WSO2, and other products like Linkerd and Istio for service mesh ingress controller features.</span></span>

<span data-ttu-id="f7e9b-250">Después de las secciones iniciales de explicación de arquitectura y patrones, las siguientes secciones explican cómo implementar puertas de enlace de API con [Ocelot](https://github.com/ThreeMammals/Ocelot).</span><span class="sxs-lookup"><span data-stu-id="f7e9b-250">After the initial architecture and patterns explanation sections, the next sections explain how to implement API Gateways with [Ocelot](https://github.com/ThreeMammals/Ocelot).</span></span>

## <a name="drawbacks-of-the-api-gateway-pattern"></a><span data-ttu-id="f7e9b-251">Desventajas del patrón de puerta de enlace de API</span><span class="sxs-lookup"><span data-stu-id="f7e9b-251">Drawbacks of the API Gateway pattern</span></span>

- <span data-ttu-id="f7e9b-252">El inconveniente más importante es que, al implementar una puerta de enlace de API, se acopla ese nivel con los microservicios internos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-252">The most important drawback is that when you implement an API Gateway, you're coupling that tier with the internal microservices.</span></span> <span data-ttu-id="f7e9b-253">Un acoplamiento así podría provocar problemas graves para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-253">Coupling like this might introduce serious difficulties for your application.</span></span> <span data-ttu-id="f7e9b-254">Clemens Vaster, arquitecto del equipo de Azure Service Bus, se refiere a esta posible dificultad como "el nuevo ESB" en su sesión sobre "[mensajería y microservicios](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" de GOTO 2016.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-254">Clemens Vaster, architect at the Azure Service Bus team, refers to this potential difficulty as "the new ESB" in the "[Messaging and Microservices](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" session at GOTO 2016.</span></span>

- <span data-ttu-id="f7e9b-255">Usar una puerta de enlace de API de microservicios crea un posible único punto de error adicional.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-255">Using a microservices API Gateway creates an additional possible single point of failure.</span></span>

- <span data-ttu-id="f7e9b-256">Una puerta de enlace de API puede incrementar el tiempo de respuesta debido a la llamada de red adicional.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-256">An API Gateway can introduce increased response time due to the additional network call.</span></span> <span data-ttu-id="f7e9b-257">Pero esta llamada adicional suele tener menor impacto que una interfaz de cliente que realiza demasiadas llamadas a los microservicios internos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-257">However, this extra call usually has less impact than having a client interface that's too chatty directly calling the internal microservices.</span></span>

- <span data-ttu-id="f7e9b-258">Si no se escala horizontalmente de manera correcta, la puerta de enlace de API puede dar lugar a un cuello de botella.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-258">If not scaled out properly, the API Gateway can become a bottleneck.</span></span>

- <span data-ttu-id="f7e9b-259">Una puerta de enlace de API exige un mayor desarrollo y mantenimiento futuro si incluye lógica personalizada y agregación de datos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-259">An API Gateway requires additional development cost and future maintenance if it includes custom logic and data aggregation.</span></span> <span data-ttu-id="f7e9b-260">Los desarrolladores deben actualizar la puerta de enlace de API con el fin de exponer los puntos de conexión de cada microservicio.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-260">Developers must update the API Gateway in order to expose each microservice's endpoints.</span></span> <span data-ttu-id="f7e9b-261">Además, los cambios de implementación en los microservicios internos pueden provocar cambios de código en el nivel de la puerta de enlace de API.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-261">Moreover, implementation changes in the internal microservices might cause code changes at the API Gateway level.</span></span> <span data-ttu-id="f7e9b-262">Pero si la puerta de enlace de API simplemente aplica seguridad, registro y control de versiones (como al utilizar Azure API Management), este costo de desarrollo adicional podría no ser aplicable.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-262">However, if the API Gateway is just applying security, logging, and versioning (as when using Azure API Management), this additional development cost might not apply.</span></span>

- <span data-ttu-id="f7e9b-263">Si la puerta de enlace de API ha sido desarrollada por un único equipo, puede haber un cuello de botella de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-263">If the API Gateway is developed by a single team, there can be a development bottleneck.</span></span> <span data-ttu-id="f7e9b-264">Este es otro de los motivos por el que es más adecuado tener varias puertas de enlace de API específicas que respondan a las distintas necesidades del cliente.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-264">This is another reason why a better approach is to have several fined-grained API Gateways that respond to different client needs.</span></span> <span data-ttu-id="f7e9b-265">También puede separar la puerta de enlace de API internamente en varias áreas o capas que pertenezcan a los diferentes equipos que trabajan en los microservicios internos.</span><span class="sxs-lookup"><span data-stu-id="f7e9b-265">You could also segregate the API Gateway internally into multiple areas or layers that are owned by the different teams working on the internal microservices.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="f7e9b-266">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="f7e9b-266">Additional resources</span></span>

- <span data-ttu-id="f7e9b-267">**Chris Richardson. Patrón: Puerta de enlace de API o back-end para front-end** </span><span class="sxs-lookup"><span data-stu-id="f7e9b-267">**Chris Richardson. Pattern: API Gateway / Backend for Front-End** </span></span>\
  <https://microservices.io/patterns/apigateway.html>

- <span data-ttu-id="f7e9b-268">**Puertas de enlace de API** </span><span class="sxs-lookup"><span data-stu-id="f7e9b-268">**API Gateway pattern** </span></span>\
  <https://docs.microsoft.com/azure/architecture/microservices/gateway>

- <span data-ttu-id="f7e9b-269">**Patrón de agregación y composición** </span><span class="sxs-lookup"><span data-stu-id="f7e9b-269">**Aggregation and composition pattern** </span></span>\
  <https://microservices.io/patterns/data/api-composition.html>

- <span data-ttu-id="f7e9b-270">**Azure API Management** </span><span class="sxs-lookup"><span data-stu-id="f7e9b-270">**Azure API Management** </span></span>\
  <https://azure.microsoft.com/services/api-management/>

- <span data-ttu-id="f7e9b-271">**Udi Dahan. Service Oriented Composition (Composición orientada a servicios)**  </span><span class="sxs-lookup"><span data-stu-id="f7e9b-271">**Udi Dahan. Service Oriented Composition** </span></span>\
  <https://udidahan.com/2014/07/30/service-oriented-composition-with-video/>

- <span data-ttu-id="f7e9b-272">**Clemens Vasters. Mensajería y microservicios en GOTO 2016; vídeo** </span><span class="sxs-lookup"><span data-stu-id="f7e9b-272">**Clemens Vasters. Messaging and Microservices at GOTO 2016 (video)** </span></span>\
  <https://www.youtube.com/watch?v=rXi5CLjIQ9k>

- <span data-ttu-id="f7e9b-273">**Puerta de enlace de API en resumen** (Serie de tutoriales de puerta de enlace de API de ASP.NET Core) </span><span class="sxs-lookup"><span data-stu-id="f7e9b-273">**API Gateway in a Nutshell** (ASP.NET Core API Gateway Tutorial Series) </span></span>\
  <https://www.pogsdotnet.com/2018/08/api-gateway-in-nutshell.html>

>[!div class="step-by-step"]
><span data-ttu-id="f7e9b-274">[Anterior](identify-microservice-domain-model-boundaries.md)
>[Siguiente](communication-in-microservice-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="f7e9b-274">[Previous](identify-microservice-domain-model-boundaries.md)
[Next](communication-in-microservice-architecture.md)</span></span>
