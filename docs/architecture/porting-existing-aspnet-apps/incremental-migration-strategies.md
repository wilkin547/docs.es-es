---
title: Estrategias para migrar incrementalmente
description: ¿Qué estrategias pueden adoptar los equipos que les permitirán migrar aplicaciones de gran tamaño de ASP.NET MVC a .NET Core de forma incremental?
author: ardalis
ms.date: 11/13/2020
ms.openlocfilehash: 615d2a853b698bfc752c3baf36f31ab2a4f2bab8
ms.sourcegitcommit: b5d2290673e1c91260c9205202dd8b95fbab1a0b
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/01/2021
ms.locfileid: "106122890"
---
# <a name="strategies-for-migrating-incrementally"></a><span data-ttu-id="14776-103">Estrategias para migrar incrementalmente</span><span class="sxs-lookup"><span data-stu-id="14776-103">Strategies for migrating incrementally</span></span>

<span data-ttu-id="14776-104">El mayor desafío con la migración de cualquier aplicación grande es determinar cómo dividir el proceso en tareas más pequeñas.</span><span class="sxs-lookup"><span data-stu-id="14776-104">The biggest challenge with migrating any large app is determining how to break the process into smaller tasks.</span></span> <span data-ttu-id="14776-105">Hay varias estrategias que se pueden aplicar a este propósito, como dividir la aplicación en capas horizontales como la interfaz de usuario, el acceso a datos, la lógica de negocios o dividir la aplicación en aplicaciones independientes y más pequeñas.</span><span class="sxs-lookup"><span data-stu-id="14776-105">There are several strategies that can be applied for this purpose, including breaking the app into horizontal layers such as UI, data access, business logic, or breaking up the app into separate, smaller apps.</span></span> <span data-ttu-id="14776-106">Otra estrategia es actualizar algunas o todas las aplicaciones a diferentes versiones de .NET Framework en una versión reciente de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="14776-106">Another strategy is to upgrade some or all of the app to different framework versions on the way to a recent .NET Core release.</span></span> <span data-ttu-id="14776-107">Un enfoque que podría usar es migrar [segmentos verticales](https://deviq.com/practices/vertical-slices) de la aplicación, en lugar de intentar migrar una capa horizontal a la vez.</span><span class="sxs-lookup"><span data-stu-id="14776-107">One approach you could use is to migrate [vertical slices](https://deviq.com/practices/vertical-slices) of the app, rather than attempting to migrate one horizontal layer at a time.</span></span> <span data-ttu-id="14776-108">Veamos cada uno de estos enfoques diferentes.</span><span class="sxs-lookup"><span data-stu-id="14776-108">Let's consider each of these different approaches.</span></span>

## <a name="migrating-slice-by-slice"></a><span data-ttu-id="14776-109">Migrando segmento por segmento</span><span class="sxs-lookup"><span data-stu-id="14776-109">Migrating slice by slice</span></span>

<span data-ttu-id="14776-110">Un enfoque correcto para la migración consiste en identificar los segmentos verticales de funcionalidad y migrarlos a la plataforma de destino uno a uno.</span><span class="sxs-lookup"><span data-stu-id="14776-110">One successful approach to migrating is to identify vertical slices of functionality and migrate them to the target platform one by one.</span></span> <span data-ttu-id="14776-111">El primer paso es crear una nueva ASP.NET Core aplicación 3,1 o 5.</span><span class="sxs-lookup"><span data-stu-id="14776-111">The first step is to create a new ASP.NET Core 3.1 or 5 app.</span></span> <span data-ttu-id="14776-112">A continuación, identifique la página o el punto de conexión de API individual que se migrará primero.</span><span class="sxs-lookup"><span data-stu-id="14776-112">Next, identify the individual page or API endpoint that will be migrated first.</span></span> <span data-ttu-id="14776-113">Cree solo la funcionalidad necesaria para admitir esta ruta en la aplicación ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="14776-113">Build out just the necessary functionality to support this one route in the ASP.NET Core app.</span></span> <span data-ttu-id="14776-114">A continuación, use la reescritura HTTP y/o un proxy inverso para empezar a enviar solicitudes para estas páginas o puntos de conexión a la nueva aplicación en lugar de a la aplicación ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="14776-114">Then use HTTP rewriting and/or a reverse proxy to start sending requests for these pages or endpoints to the new app rather than the ASP.NET app.</span></span> <span data-ttu-id="14776-115">Este enfoque es idóneo para los proyectos de API, pero también puede funcionar para muchas aplicaciones de MVC.</span><span class="sxs-lookup"><span data-stu-id="14776-115">This approach is well-suited to API projects, but can also work for many MVC apps.</span></span>

<span data-ttu-id="14776-116">Al migrar Slice by Slice, toda la pila del punto de conexión de API individual o de la ruta solicitada se vuelve a crear en el nuevo proyecto o solución.</span><span class="sxs-lookup"><span data-stu-id="14776-116">When migrating slice by slice, the entire stack of the individual API endpoint or requested route is recreated in the new project or solution.</span></span> <span data-ttu-id="14776-117">El primero de estos segmentos suele requerir la mayor parte del trabajo, ya que normalmente necesitará que se creen varios proyectos y se tomen decisiones sobre el acceso a los datos y la organización de la solución.</span><span class="sxs-lookup"><span data-stu-id="14776-117">The very first such slice typically requires the most effort, since it will typically need several projects to be created and decisions to be made about data access and solution organization.</span></span> <span data-ttu-id="14776-118">Una vez que la funcionalidad del primer segmento refleja el de la aplicación existente, se puede implementar y la aplicación existente puede redirigirse a ella o simplemente quitarse.</span><span class="sxs-lookup"><span data-stu-id="14776-118">Once the first slice's functionality mirrors the existing app's, it can be deployed and the existing app can redirect to it or simply be removed.</span></span> <span data-ttu-id="14776-119">Este enfoque se repite hasta que se haya trasladado toda la aplicación a la nueva estructura.</span><span class="sxs-lookup"><span data-stu-id="14776-119">This approach is then repeated until the entire app has been ported to the new structure.</span></span>

<span data-ttu-id="14776-120">En el [capítulo 5, escenarios de implementación,](deployment-scenarios.md)se explican algunas instrucciones específicas sobre cómo seguir esta estrategia con IIS.</span><span class="sxs-lookup"><span data-stu-id="14776-120">Some specific guidance on how to follow this strategy using IIS is covered in [Chapter 5, Deployment Scenarios](deployment-scenarios.md).</span></span>

## <a name="migrating-layer-by-layer"></a><span data-ttu-id="14776-121">Migrar capa por nivel</span><span class="sxs-lookup"><span data-stu-id="14776-121">Migrating layer by layer</span></span>

<span data-ttu-id="14776-122">Tenga en cuenta el reto de migrar una aplicación grande de ASP.NET 4,5.</span><span class="sxs-lookup"><span data-stu-id="14776-122">Consider the challenge of migrating a large ASP.NET 4.5 app.</span></span> <span data-ttu-id="14776-123">Un enfoque consiste en migrar toda la aplicación directamente desde .NET Framework 4,5 a .NET Core 3,1.</span><span class="sxs-lookup"><span data-stu-id="14776-123">One approach is to migrate the entire app directly from .NET Framework 4.5 to .NET Core 3.1.</span></span> <span data-ttu-id="14776-124">Sin embargo, este enfoque debe tener en cuenta todos los cambios importantes entre los dos marcos y versiones, que son importantes.</span><span class="sxs-lookup"><span data-stu-id="14776-124">However, this approach needs to account for every breaking change between the two frameworks and versions, which are substantial.</span></span> <span data-ttu-id="14776-125">La realización de este trabajo en un proyecto a la vez proporciona un conjunto de piedras de paso para que no sea necesario desplazar toda la solución a la vez.</span><span class="sxs-lookup"><span data-stu-id="14776-125">Performing this work on one project at a time provides a set of stepping stones so that the entire solution doesn't need to be moved at once.</span></span>

<span data-ttu-id="14776-126">Se [.net Standard](https://dotnet.microsoft.com/platform/dotnet-standard)una adición reciente al ecosistema de .net que ayuda a la interoperabilidad entre diferentes .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="14776-126">One recent addition to the .NET ecosystem that helps with interoperability between different .NET frameworks is [.NET Standard](https://dotnet.microsoft.com/platform/dotnet-standard).</span></span> <span data-ttu-id="14776-127">.NET Standard permite que las bibliotecas se compilan en el conjunto acordado de API comunes, asegurándose de que se pueden usar en cualquier aplicación .NET.</span><span class="sxs-lookup"><span data-stu-id="14776-127">.NET Standard allows libraries to build against the agreed upon set of common APIs, ensuring they can be used in any .NET app.</span></span> <span data-ttu-id="14776-128">.NET Standard 2,0 es importante porque abarca la mayoría de la funcionalidad de la biblioteca de clases base que utilizan la mayoría de las aplicaciones de .NET Framework y .NET Core.</span><span class="sxs-lookup"><span data-stu-id="14776-128">.NET Standard 2.0 is notable because it covers most base class library functionality used by most .NET Framework and .NET Core apps.</span></span> <span data-ttu-id="14776-129">Desafortunadamente, la versión más antigua de .NET compatible con .NET Standard 2,0 es .NET Framework 4.6.1 y hay una serie de actualizaciones en .NET Framework 4,8 que lo convierten en una opción atractiva para las actualizaciones iniciales.</span><span class="sxs-lookup"><span data-stu-id="14776-129">Unfortunately, the earliest version of .NET with support for .NET Standard 2.0 is .NET Framework 4.6.1, and there are a number of updates in .NET Framework 4.8 that make it a compelling choice for initial upgrades.</span></span>

<span data-ttu-id="14776-130">Un enfoque para actualizar de forma incremental un sistema .NET Framework 4,5 de nivel por nivel es actualizar primero sus dependencias de la biblioteca de clases a .NET Framework 4,8.</span><span class="sxs-lookup"><span data-stu-id="14776-130">One approach to incrementally upgrade a .NET Framework 4.5 system layer-by-layer is to first update its class library dependencies to .NET Framework 4.8.</span></span> <span data-ttu-id="14776-131">A continuación, modifique estas bibliotecas para que sean .NET Standard bibliotecas de clases.</span><span class="sxs-lookup"><span data-stu-id="14776-131">Then, modify these libraries to be .NET Standard class libraries.</span></span> <span data-ttu-id="14776-132">Use la compilación condicional y de compatibilidad con múltiples versiones, si es necesario.</span><span class="sxs-lookup"><span data-stu-id="14776-132">Use multi-targeting and conditional compilation, if necessary.</span></span> <span data-ttu-id="14776-133">Este paso puede ser útil en escenarios donde las dependencias de la aplicación requieren .NET Framework y no se pueden migrar fácilmente directamente para usar .NET Standard y .NET Core.</span><span class="sxs-lookup"><span data-stu-id="14776-133">This step can be helpful in scenarios where app dependencies require .NET Framework and cannot easily be ported directly to use .NET Standard and .NET Core.</span></span> <span data-ttu-id="14776-134">Como las bibliotecas de .NET Framework pueden usarse en aplicaciones de ASP.NET Core 2,1, el siguiente paso es migrar la funcionalidad web de la aplicación a ASP.NET Core 2,1 (como se describe en el [capítulo anterior](choose-net-core-version.md)).</span><span class="sxs-lookup"><span data-stu-id="14776-134">Since .NET Framework libraries can be consumed by ASP.NET Core 2.1 apps, the next step is to migrate some or all of the web functionality of the app to ASP.NET Core 2.1 (as described in the [previous chapter](choose-net-core-version.md)).</span></span> <span data-ttu-id="14776-135">Se trata de un enfoque "inferior hacia arriba", que comienza con las dependencias de la biblioteca de clases de bajo nivel y trabaja hasta el punto de entrada de la aplicación Web.</span><span class="sxs-lookup"><span data-stu-id="14776-135">This is a "bottom up" approach, starting with low level class library dependencies and working up to the web app entry point.</span></span>

<span data-ttu-id="14776-136">Una vez que la aplicación se ejecuta en ASP.NET Core 2,1, la migración a ASP.NET Core 3,1 en el aislamiento es relativamente sencilla.</span><span class="sxs-lookup"><span data-stu-id="14776-136">Once the app is running on ASP.NET Core 2.1, migrating it to ASP.NET Core 3.1 in isolation is relatively straightforward.</span></span> <span data-ttu-id="14776-137">El desafío más probable de este paso es actualizar las dependencias incompatibles para admitir .NET Core y, posiblemente, versiones superiores de .NET Standard.</span><span class="sxs-lookup"><span data-stu-id="14776-137">The most likely challenge during this step is updating incompatible dependencies to support .NET Core and possibly higher versions of .NET Standard.</span></span> <span data-ttu-id="14776-138">En el caso de las aplicaciones que no tienen dependencias problemáticas en bibliotecas solo de .NET Framework, hay poca razón para actualizar a ASP.NET Core 2,1.</span><span class="sxs-lookup"><span data-stu-id="14776-138">For apps that don't have problematic dependencies on .NET Framework-only libraries, there's little reason to upgrade to ASP.NET Core 2.1.</span></span> <span data-ttu-id="14776-139">Migrar directamente a ASP.NET Core 3,1 tiene más sentido y requiere menos esfuerzo.</span><span class="sxs-lookup"><span data-stu-id="14776-139">Porting directly to ASP.NET Core 3.1 makes more sense and requires less effort.</span></span>

<span data-ttu-id="14776-140">En el momento en que la aplicación se ejecuta en .NET Core 3,1, la migración a la versión actual de .NET 5 es relativamente sencilla.</span><span class="sxs-lookup"><span data-stu-id="14776-140">By the time the app is running on .NET Core 3.1, migrating to the current .NET 5 release is relatively painless.</span></span> <span data-ttu-id="14776-141">El proceso implica principalmente actualizar el marco de trabajo de destino de los archivos de proyecto y sus dependencias de paquetes NuGet asociadas.</span><span class="sxs-lookup"><span data-stu-id="14776-141">The process primarily involves updating the target framework of your project files and their associated NuGet package dependencies.</span></span> <span data-ttu-id="14776-142">Aunque se deben [tener en cuenta varios cambios importantes](../../core/compatibility/5.0.md), la mayoría de las aplicaciones no requieren modificaciones significativas para pasar de .net Core 3,1 a .net 5.</span><span class="sxs-lookup"><span data-stu-id="14776-142">While there are several [breaking changes to consider](../../core/compatibility/5.0.md), most apps don't require significant modifications to move from .NET Core 3.1 to .NET 5.</span></span> <span data-ttu-id="14776-143">Lo más probable es que el factor decisivo [para elegir entre .net Core 3,1 y .net 5 sea compatible](choose-net-core-version.md).</span><span class="sxs-lookup"><span data-stu-id="14776-143">The primary deciding factor in [choosing between .NET Core 3.1 and .NET 5 is likely to be support](choose-net-core-version.md).</span></span>

<span data-ttu-id="14776-144">En lugar de un enfoque "inferior", otra alternativa es comenzar con la aplicación web (o incluso con toda la solución) y usar una herramienta automatizada para ayudarle con la actualización.</span><span class="sxs-lookup"><span data-stu-id="14776-144">Instead of a "bottom up" approach, another alternative is to start with the web app (or even the entire solution) and use an automated tool to assist with the upgrade.</span></span> <span data-ttu-id="14776-145">La [herramienta del Asistente para actualización de .net](https://aka.ms/dotnet-upgrade-assistant) se puede usar para ayudar a actualizar .NET Framework aplicaciones a .net Core/.net 5.</span><span class="sxs-lookup"><span data-stu-id="14776-145">The [.NET Upgrade Assistant tool](https://aka.ms/dotnet-upgrade-assistant) can be used to help upgrade .NET Framework apps to .NET Core / .NET 5.</span></span> <span data-ttu-id="14776-146">Automatiza muchas de las tareas comunes relacionadas con la actualización de aplicaciones, como la modificación del formato de archivo del proyecto, la configuración de las plataformas de destino adecuadas, la actualización de las dependencias de NuGet, etc.</span><span class="sxs-lookup"><span data-stu-id="14776-146">It automates many of the common tasks related to upgrading apps, such as modifying project file format, setting appropriate target frameworks, updating NuGet dependencies, and more.</span></span>

<span data-ttu-id="14776-147">En lugar de un enfoque "inferior", otra alternativa es comenzar con la aplicación web (o incluso con toda la solución) y usar una herramienta automatizada para ayudarle con la actualización.</span><span class="sxs-lookup"><span data-stu-id="14776-147">Instead of a "bottom up" approach, another alternative is to start with the web app (or even the entire solution) and use an automated tool to assist with the upgrade.</span></span> <span data-ttu-id="14776-148">La [herramienta del Asistente para actualización de .net](https://aka.ms/dotnet-upgrade-assistant) se puede usar para ayudar a actualizar .NET Framework aplicaciones a .net Core/.net 5.</span><span class="sxs-lookup"><span data-stu-id="14776-148">The [.NET Upgrade Assistant tool](https://aka.ms/dotnet-upgrade-assistant) can be used to help upgrade .NET Framework apps to .NET Core / .NET 5.</span></span> <span data-ttu-id="14776-149">Automatiza muchas de las tareas comunes relacionadas con la actualización de aplicaciones, como la modificación del formato de archivo del proyecto, la configuración de las plataformas de destino adecuadas, la actualización de las dependencias de NuGet, etc.</span><span class="sxs-lookup"><span data-stu-id="14776-149">It automates many of the common tasks related to upgrading apps, such as modifying project file format, setting appropriate target frameworks, updating NuGet dependencies, and more.</span></span>

## <a name="references"></a><span data-ttu-id="14776-150">Referencias</span><span class="sxs-lookup"><span data-stu-id="14776-150">References</span></span>

- [<span data-ttu-id="14776-151">¿Qué es .NET Standard?</span><span class="sxs-lookup"><span data-stu-id="14776-151">What is .NET Standard?</span></span>](https://dotnet.microsoft.com/platform/dotnet-standard)
- [<span data-ttu-id="14776-152">Presentación de .NET 5</span><span class="sxs-lookup"><span data-stu-id="14776-152">Introducing .NET 5</span></span>](https://devblogs.microsoft.com/dotnet/introducing-net-5/)
- [<span data-ttu-id="14776-153">Migrar de ASP.NET Core 3,1 a 5,0</span><span class="sxs-lookup"><span data-stu-id="14776-153">Migrate from ASP.NET Core 3.1 to 5.0</span></span>](/aspnet/core/migration/31-to-50)
- [<span data-ttu-id="14776-154">Herramienta del Asistente para actualización de .NET</span><span class="sxs-lookup"><span data-stu-id="14776-154">.NET Upgrade Assistant tool</span></span>](https://aka.ms/dotnet-upgrade-assistant)

>[!div class="step-by-step"]
><span data-ttu-id="14776-155">[Anterior](choose-net-core-version.md)
>[Siguiente](migrate-web-forms.md)</span><span class="sxs-lookup"><span data-stu-id="14776-155">[Previous](choose-net-core-version.md)
[Next](migrate-web-forms.md)</span></span>
