---
title: Apéndice-gRPC para desarrolladores de WCF
description: Explicación de las transacciones distribuidas y su implementación en arquitecturas de microservicios modernas.
ms.date: 09/02/2019
ms.openlocfilehash: 9931681727f921e007c2f80852ad0e69cd7288de
ms.sourcegitcommit: 5fb5b6520b06d7f5e6131ec2ad854da302a28f2e
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 12/03/2019
ms.locfileid: "74711467"
---
# <a name="appendix-a---transactions"></a><span data-ttu-id="a89dd-103">Apéndice A: transacciones</span><span class="sxs-lookup"><span data-stu-id="a89dd-103">Appendix A - Transactions</span></span>

<span data-ttu-id="a89dd-104">Windows Communication Foundation (WCF) admite transacciones distribuidas, lo que le permite realizar operaciones atómicas en varios servicios.</span><span class="sxs-lookup"><span data-stu-id="a89dd-104">Windows Communication Foundation (WCF) supports distributed transactions, allowing you to perform atomic operations across multiple services.</span></span> <span data-ttu-id="a89dd-105">Esta funcionalidad se basa en [Microsoft Coordinador de transacciones distribuidas](https://docs.microsoft.com/previous-versions/windows/desktop/ms684146(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="a89dd-105">This functionality is based on the [Microsoft Distributed Transaction Coordinator](https://docs.microsoft.com/previous-versions/windows/desktop/ms684146(v=vs.85)).</span></span>

<span data-ttu-id="a89dd-106">En el panorama de microservicios más reciente, no es posible este tipo de procesamiento automatizado de transacciones distribuidas.</span><span class="sxs-lookup"><span data-stu-id="a89dd-106">In the newer microservices landscape, this type of automated distributed transaction processing isn't possible.</span></span> <span data-ttu-id="a89dd-107">Hay demasiadas tecnologías diferentes, como las bases de datos relacionales, los almacenes de datos NoSQL y los sistemas de mensajería.</span><span class="sxs-lookup"><span data-stu-id="a89dd-107">There are too many different technologies involved, including relational databases, NoSQL data stores, and messaging systems.</span></span> <span data-ttu-id="a89dd-108">También puede haber una combinación de sistemas operativos, lenguajes de programación y marcos de trabajo en uso en un solo entorno.</span><span class="sxs-lookup"><span data-stu-id="a89dd-108">There might also be a mix of operating systems, programming languages, and frameworks in use in a single environment.</span></span>

<span data-ttu-id="a89dd-109">La transacción distribuida de WCF es una implementación de lo que se conoce como [confirmación en dos fases (2pc)](https://en.wikipedia.org/wiki/Two-phase_commit_protocol).</span><span class="sxs-lookup"><span data-stu-id="a89dd-109">WCF distributed transaction is an implementation of what is known as a [two-phase commit (2PC)](https://en.wikipedia.org/wiki/Two-phase_commit_protocol).</span></span> <span data-ttu-id="a89dd-110">Puede implementar transacciones 2PC manualmente mediante la coordinación de mensajes entre servicios, la creación de transacciones abiertas dentro de cada servicio y el envío de mensajes de confirmación o reversión, dependiendo de si se ha realizado correctamente o no.</span><span class="sxs-lookup"><span data-stu-id="a89dd-110">You can implement 2PC transactions manually by coordinating messages across services, creating open transactions within each service, and sending commit or rollback messages, depending upon success or failure.</span></span> <span data-ttu-id="a89dd-111">Sin embargo, la complejidad implicada en la administración de 2PC puede aumentar exponencialmente a medida que evolucionan los sistemas.</span><span class="sxs-lookup"><span data-stu-id="a89dd-111">However, the complexity involved in managing 2PC can increase exponentially as systems evolve.</span></span> <span data-ttu-id="a89dd-112">Las transacciones abiertas contienen bloqueos de base de datos que pueden afectar negativamente al rendimiento o, lo que es peor, causan interbloqueos entre servicios.</span><span class="sxs-lookup"><span data-stu-id="a89dd-112">Open transactions hold database locks that can negatively affect performance, or, worse, cause cross-service deadlocks.</span></span>

<span data-ttu-id="a89dd-113">Si es posible, es mejor evitar todas las transacciones distribuidas.</span><span class="sxs-lookup"><span data-stu-id="a89dd-113">If possible, it's best to avoid distributed transactions altogether.</span></span> <span data-ttu-id="a89dd-114">Si dos elementos de datos están vinculados como para requerir actualizaciones atómicas, considere la posibilidad de controlarlas ambos con el mismo servicio.</span><span class="sxs-lookup"><span data-stu-id="a89dd-114">If two items of data are so linked as to require atomic updates, consider handling them both with the same service.</span></span> <span data-ttu-id="a89dd-115">Aplique esos cambios atómicos mediante una única solicitud o mensaje a ese servicio.</span><span class="sxs-lookup"><span data-stu-id="a89dd-115">Apply those atomic changes by using a single request or message to that service.</span></span>

<span data-ttu-id="a89dd-116">Si eso no es posible, una alternativa es usar el [patrón saga](https://microservices.io/patterns/data/saga.html).</span><span class="sxs-lookup"><span data-stu-id="a89dd-116">If that isn't possible, then one alternative is to use the [Saga pattern](https://microservices.io/patterns/data/saga.html).</span></span> <span data-ttu-id="a89dd-117">En un saga de actualización, las actualizaciones se procesan de forma secuencial. cuando cada actualización se realiza correctamente, se desencadena la siguiente.</span><span class="sxs-lookup"><span data-stu-id="a89dd-117">In a saga, updates are processed sequentially; as each update succeeds, the next one is triggered.</span></span> <span data-ttu-id="a89dd-118">Estos desencadenadores se pueden propagar de un servicio a otro o ser administrados por un coordinador o un orquestador de saga.</span><span class="sxs-lookup"><span data-stu-id="a89dd-118">These triggers can be propagated from service to service, or managed by a saga coordinator or orchestrator.</span></span> <span data-ttu-id="a89dd-119">Si se produce un error en una actualización en cualquier momento durante el proceso, los servicios que ya han completado sus actualizaciones aplican una lógica específica para invertirlas.</span><span class="sxs-lookup"><span data-stu-id="a89dd-119">If an update fails at any point during the process, the services that have already completed their updates apply specific logic to reverse them.</span></span>

<span data-ttu-id="a89dd-120">Otra opción es usar el diseño controlado por dominios (DDD) y la segregación de responsabilidad de comandos y consultas (CQRS), tal como se describe en el [libro electrónico de microservicios de .net](https://docs.microsoft.com/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/).</span><span class="sxs-lookup"><span data-stu-id="a89dd-120">Another option is to use Domain Driven Design (DDD) and Command/Query Responsibility Segregation (CQRS), as described in the [.NET Microservices e-book](https://docs.microsoft.com/dotnet/architecture/microservices/microservice-ddd-cqrs-patterns/).</span></span> <span data-ttu-id="a89dd-121">En concreto, el uso de eventos de dominio o de [orígenes de eventos](https://martinfowler.com/eaaDev/EventSourcing.html) puede ayudar a garantizar que las actualizaciones sean coherentes, si no se aplican inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="a89dd-121">In particular, using domain events or [event sourcing](https://martinfowler.com/eaaDev/EventSourcing.html) can help to ensure that updates are consistently, if not immediately, applied.</span></span>

>[!div class="step-by-step"]
>[<span data-ttu-id="a89dd-122">Anterior</span><span class="sxs-lookup"><span data-stu-id="a89dd-122">Previous</span></span>](application-performance-management.md)
