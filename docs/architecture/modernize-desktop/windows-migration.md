---
title: Migración de Windows 10
description: Profundice en las características de Windows 10 como el empaquetado y las islas XAML.
ms.date: 09/16/2019
ms.openlocfilehash: cd17088b086a32fd3bb37e617d3a1047acedde0e
ms.sourcegitcommit: 9a4488a3625866335e83a20da5e9c5286b1f034c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/15/2020
ms.locfileid: "97866672"
---
# <a name="windows-10-migration"></a><span data-ttu-id="4f2bc-103">Migración de Windows 10</span><span class="sxs-lookup"><span data-stu-id="4f2bc-103">Windows 10 migration</span></span>

<span data-ttu-id="4f2bc-104">Tenga en cuenta la situación siguiente: tiene una aplicación de escritorio de trabajo desarrollada en Windows 7 días.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-104">Consider the following situation: You have a working desktop application that was developed in the Windows 7 days.</span></span> <span data-ttu-id="4f2bc-105">Está usando la tecnología de WPF disponible en ese momento y funciona bien, pero tiene una interfaz de usuario y comportamientos obsoletos cuando se ejecuta en Windows 10.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-105">It's using WPF technology available at that time and working fine but it has an outdated UI and behaviors when you run it on Windows 10.</span></span> <span data-ttu-id="4f2bc-106">Es como cuando vea una película futurista como una matriz y verá neo con el dispositivo Nokia 8110.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-106">It is like when you watch a futuristic movie like Matrix and you see Neo using the Nokia 8110 device.</span></span> <span data-ttu-id="4f2bc-107">La película funciona bien después de 20 años, pero se beneficiaría de la modernización de un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-107">The film works great after 20 years but it would rather benefit from a device modernization.</span></span>

<span data-ttu-id="4f2bc-108">Con el lanzamiento de Windows 10, Microsoft presentó muchas innovaciones para admitir escenarios como tabletas y dispositivos táctiles, y para proporcionar la mejor experiencia para los usuarios de un sistema operativo de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-108">With the release of Windows 10, Microsoft introduced many innovations to support scenarios like tablets and touch devices and to provide the best experience for users for a Microsoft operating system ever.</span></span> <span data-ttu-id="4f2bc-109">Por ejemplo, puede:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-109">For example, you can:</span></span>

- <span data-ttu-id="4f2bc-110">Inicie sesión con su esfera con Windows Hello.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-110">Sign in with your face using Windows Hello.</span></span>
- <span data-ttu-id="4f2bc-111">Use un lápiz para dibujar o escribir a mano texto que se reconozca y digitale automáticamente.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-111">Use a pen to draw or handwrite text that is automatically recognized and digitalized.</span></span>
- <span data-ttu-id="4f2bc-112">Ejecute modelos de inteligencia artificial personalizados localmente basados en la nube con WinML.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-112">Run locally customized AI models built on the cloud using WinML.</span></span>

<span data-ttu-id="4f2bc-113">Todas estas características están habilitadas para los desarrolladores de Windows a través de bibliotecas de Windows Runtime (WinRT).</span><span class="sxs-lookup"><span data-stu-id="4f2bc-113">All these features are enabled for Windows developers through Windows Runtime (WinRT) libraries.</span></span> <span data-ttu-id="4f2bc-114">Puede aprovechar estas características en sus aplicaciones de escritorio existentes, ya que las bibliotecas se exponen también en el .NET Framework y .NET Core.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-114">You can take advantage of these features in your existing desktop apps because the libraries are exposed to both the .NET Framework and .NET Core as well.</span></span> <span data-ttu-id="4f2bc-115">Incluso puede modernizar la interfaz de usuario con el uso de islas XAML y mejorar los objetos visuales y el comportamiento de las aplicaciones de acuerdo con las horas.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-115">You can even modernize your UI with the use of XAML Islands and improve the visuals and behavior of your apps according to the times.</span></span>

<span data-ttu-id="4f2bc-116">Una cuestión importante que hay que tener en cuenta es que no es necesario abandonar .NET Framework tecnología para seguir esta ruta de modernización.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-116">One important thing to note here is that you don't need to abandon .NET Framework technology to follow this modernization path.</span></span> <span data-ttu-id="4f2bc-117">Puede permanecer de forma segura y tener todas las ventajas de Windows 10 sin la presión de migrar a .NET Core.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-117">You can safely stay on there and have all the benefits of Windows 10 without the pressure to migrate to .NET Core.</span></span> <span data-ttu-id="4f2bc-118">Por lo tanto, se obtiene la potencia y la flexibilidad para elegir la ruta de modernización.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-118">So, you get both the power and the flexibility to choose your modernization path.</span></span>

## <a name="winrt-apis"></a><span data-ttu-id="4f2bc-119">API de WinRT</span><span class="sxs-lookup"><span data-stu-id="4f2bc-119">WinRT APIs</span></span>

<span data-ttu-id="4f2bc-120">Las API de WinRT son interfaces de programación de aplicaciones (API) bien estructuradas y orientadas a objetos que proporcionan a los desarrolladores de Windows 10 acceso a todo lo que el sistema operativo tiene que ofrecer.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-120">WinRT APIs are object-oriented, well-structured application programming interfaces (APIs) that give Windows 10 developers access to everything the operating system has to offer.</span></span> <span data-ttu-id="4f2bc-121">A través de las API de WinRT, puede integrar funcionalidades como notificaciones de envío, API de dispositivos, Microsoft Ink y WinML, entre otras en sus aplicaciones de escritorio.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-121">Through WinRT APIs, you can integrate functionalities like Push Notifications, Device APIs, Microsoft Ink, and WinML, among others on your desktop apps.</span></span>

<span data-ttu-id="4f2bc-122">En general, se puede llamar a las API de WinRT desde una aplicación de escritorio clásica.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-122">In general, WinRT APIs can be called from a classic desktop app.</span></span> <span data-ttu-id="4f2bc-123">Sin embargo, dos áreas principales presentan una excepción a esta regla:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-123">However, two main areas present an exception to this rule:</span></span>

* <span data-ttu-id="4f2bc-124">API que requieren una identidad de paquete.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-124">APIs that require a package identity.</span></span>
* <span data-ttu-id="4f2bc-125">API que requieren visualización como XAML o composición.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-125">APIs that require visualization like XAML or Composition.</span></span>

### <a name="universal-windows-platform-uwp-packages"></a><span data-ttu-id="4f2bc-126">Paquetes de Plataforma universal de Windows (UWP)</span><span class="sxs-lookup"><span data-stu-id="4f2bc-126">Universal Windows Platform (UWP) packages</span></span>

#### <a name="application-package-identity"></a><span data-ttu-id="4f2bc-127">Identidad de paquete de aplicación</span><span class="sxs-lookup"><span data-stu-id="4f2bc-127">Application Package Identity</span></span>

<span data-ttu-id="4f2bc-128">Las aplicaciones UWP tienen un sistema de implementación en el que el sistema operativo administra la instalación y desinstalación de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-128">UWP apps have a deployment system where the OS manages the installation and uninstallation of application.</span></span> <span data-ttu-id="4f2bc-129">Esto requiere que la instalación sea declarativa, lo que significa que no se ejecuta ningún código de usuario durante la instalación.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-129">That requires the installation to be declarative, meaning that no user code is executed during install.</span></span> <span data-ttu-id="4f2bc-130">En su lugar, todo lo que la aplicación desea integrar con el sistema, como los protocolos, los tipos de archivo y las extensiones, se declara en el manifiesto de aplicación.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-130">Instead, everything the app wants to integrate with the system, such as protocols, file types, and extensions, is declared in the application manifest.</span></span> <span data-ttu-id="4f2bc-131">En el momento de la implementación, la canalización de implementación configura esos puntos de integración.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-131">At deployment time, the deployment pipeline configures those integration points.</span></span> <span data-ttu-id="4f2bc-132">La única forma para que el sistema operativo administre toda esta funcionalidad y realice un seguimiento de ella es que cada "paquete" tenga una identidad, un identificador único para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-132">The only way for the OS to manage all this functionality and keep track of it is for each 'package' to have an identity, a unique identifier for the application.</span></span>

<span data-ttu-id="4f2bc-133">Algunas API de WinRT requieren que esta identidad de paquete funcione según lo previsto.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-133">Some WinRT APIs require this package identity to work as expected.</span></span> <span data-ttu-id="4f2bc-134">Sin embargo, las aplicaciones de escritorio clásicas como las aplicaciones nativas de C++ o .NET usan sistemas de implementación diferentes que no requieren una identidad de paquete.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-134">However, classic desktop apps like native C++ or .NET apps, use different deployment systems that don't require a package identity.</span></span> <span data-ttu-id="4f2bc-135">Si desea usar estas API de WinRT en la aplicación de escritorio, debe proporcionarles una identidad de paquete.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-135">If you want to use these WinRT APIs in your desktop application, you need to provide them a package identity.</span></span>

<span data-ttu-id="4f2bc-136">Una manera de proceder es crear un proyecto de empaquetado adicional.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-136">One way to proceed is to build an additional packaging project.</span></span> <span data-ttu-id="4f2bc-137">Dentro del proyecto de empaquetado, seleccione el proyecto de código fuente original y especifique la información de identidad que desea proporcionar.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-137">Inside the packaging project, you point to the original source code project and specify the Identity information you want to provide.</span></span><span data-ttu-id="4f2bc-138">Si instala el paquete y ejecuta la aplicación instalada, obtendrá automáticamente una identificación habilitando el código para llamar a todas las API de WinRT que requieren identidad.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-138"> If you install the package and run the installed app, it will automatically get an identify enabling your code to call all WinRT APIs requiring Identity.</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<Package xmlns="http://schemas.microsoft.com/appx/manifest/foundation/windows10"
         xmlns:uap="http://schemas.microsoft.com/appx/manifest/uap/windows10">
    <Identity Name="YOUR-APP-GUID "
              Publisher="CN=YOUR COMPANY"
              Version="1.x.x.x" />
</Package>
```

<span data-ttu-id="4f2bc-139">Puede comprobar qué API necesitan una identidad de aplicación empaquetada si inspecciona si el tipo que contiene la API está marcado con el atributo [DualApiPartition](xref:Windows.Foundation.Metadata.DualApiPartitionAttribute) .</span><span class="sxs-lookup"><span data-stu-id="4f2bc-139">You can check which APIs need a packaged application identity by inspecting if the type that contains the API is marked with the [DualApiPartition](xref:Windows.Foundation.Metadata.DualApiPartitionAttribute) attribute.</span></span><span data-ttu-id="4f2bc-140">Si es así, puede llamar a si desde una aplicación de escritorio tradicional desempaquetada.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-140"> If it is, you can call if from an unpackaged traditional desktop app.</span></span> <span data-ttu-id="4f2bc-141">De lo contrario, debe convertir la aplicación de escritorio clásica en una UWP con la ayuda de un proyecto de empaquetado.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-141">Otherwise, you must convert your classic desktop app to a UWP with the help of a packaging project.</span></span>

<https://docs.microsoft.com/windows/desktop/apiindex/uwp-apis-callable-from-a-classic-desktop-app>

#### <a name="benefits-of-packaging"></a><span data-ttu-id="4f2bc-142">Ventajas del empaquetado</span><span class="sxs-lookup"><span data-stu-id="4f2bc-142">Benefits of packaging</span></span>

<span data-ttu-id="4f2bc-143">Además de tener acceso a estas API, obtendrá algunas ventajas adicionales mediante la creación de un paquete de aplicación de Windows para la aplicación de escritorio, entre los que se incluyen:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-143">Besides giving you access to these APIs, you get some additional benefits by creating a Windows App package for your desktop application including:</span></span>

* <span data-ttu-id="4f2bc-144">**Implementación simplificada**.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-144">**Streamlined deployment**.</span></span> <span data-ttu-id="4f2bc-145">Las aplicaciones tienen una excelente experiencia de implementación, lo que garantiza que los usuarios puedan instalar una aplicación con confianza y actualizarla.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-145">Apps have a great deployment experience ensuring that users can confidently install an application and update it.</span></span> <span data-ttu-id="4f2bc-146">Si un usuario decide desinstalar la aplicación, se quitará por completo y no se deja ningún seguimiento tras evitar el problema de la Rot de Windows.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-146">If a user chooses to uninstall the app, it's removed completely with no trace left behind preventing the Windows rot problem.</span></span>

* <span data-ttu-id="4f2bc-147">**Actualizaciones automáticas y licencias**.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-147">**Automatic updates and licensing**.</span></span> <span data-ttu-id="4f2bc-148">La aplicación puede participar en las herramientas integradas de licencias y actualizaciones automáticas de Microsoft Store.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-148">Your application can participate in the Microsoft Store's built-in licensing and automatic update facilities.</span></span> <span data-ttu-id="4f2bc-149">La actualización automática es un mecanismo muy confiable y eficaz, ya que solo se descargan las partes modificadas de los archivos.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-149">Automatic update is a highly reliable and efficient mechanism, because only the changed parts of files are downloaded.</span></span>

* <span data-ttu-id="4f2bc-150">**Mayor alcance y monetización simplificada**.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-150">**Increased reach and simplified monetization**.</span></span> <span data-ttu-id="4f2bc-151">Quizás no sea su caso, pero si decide distribuir la aplicación a través del Microsoft Store llega a millones de usuarios de Windows 10.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-151">Maybe not your case but if you choose to distribute your application through the Microsoft Store you reach millions of Windows 10 users.</span></span>

* <span data-ttu-id="4f2bc-152">**Incorporación de características de UWP**.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-152">**Add UWP features**.</span></span> <span data-ttu-id="4f2bc-153">Puede agregar características de UWP al paquete de la aplicación a su propio ritmo.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-153">You can add UWP features to your app's package at your own pace.</span></span>

#### <a name="prepare-for-packaging"></a><span data-ttu-id="4f2bc-154">Preparar el empaquetado</span><span class="sxs-lookup"><span data-stu-id="4f2bc-154">Prepare for packaging</span></span>

<span data-ttu-id="4f2bc-155">Antes de empezar a empaquetar la aplicación de escritorio, hay algunos puntos que debe abordar antes de iniciar el proceso.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-155">Before proceeding to package your desktop application, there are some points you have to address before starting the process.</span></span> <span data-ttu-id="4f2bc-156">La aplicación debe respetar cualquiera de las reglas y directivas de Microsoft Store y ejecutarse en el modelo de aplicación de UWP.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-156">Your application must respect any of the Microsoft Store rules and policies and run in the UWP application model.</span></span> <span data-ttu-id="4f2bc-157">Por ejemplo, tiene que ejecutarse en el .NET Framework 4.6.2 o posterior y las escrituras en el `HKEY_CURRENT_USER` subárbol del registro y las carpetas AppData se virtualizarán en una ubicación local de la aplicación específica del usuario.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-157">For example, it has to run on the .NET Framework 4.6.2 or later and writes to the `HKEY_CURRENT_USER` registry hive and the AppData folders will be virtualized to a user-specific app-local location.</span></span>

<span data-ttu-id="4f2bc-158">El objetivo de diseño para empaquetar es separar el estado de la aplicación del estado del sistema y mantener la compatibilidad con otras aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-158">The design goal for packaging is to separate the application state from system state while maintaining compatibility with other apps.</span></span> <span data-ttu-id="4f2bc-159">Windows 10 logra este objetivo colocando la aplicación dentro de un paquete de UWP.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-159">Windows 10 accomplishes this goal by placing the application inside a UWP package.</span></span> <span data-ttu-id="4f2bc-160">Detecta y redirige algunos cambios en el sistema de archivos y el registro en tiempo de ejecución para satisfacer la promesa de un comportamiento de instalación y desinstalación limpio y de confianza de una aplicación proporcionada por el empaquetado.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-160">It detects and redirects some changes to the file system and registry at run time to fulfill the promise of a trusted and clean install and uninstall behavior of an application provided by packaging.</span></span>

<span data-ttu-id="4f2bc-161">Los paquetes que crea para la aplicación de escritorio son aplicaciones de plena confianza que no están en un espacio aislado, aunque se aplica la virtualización ligera a la aplicación para escribir en `HKCU` y `AppData` .</span><span class="sxs-lookup"><span data-stu-id="4f2bc-161">Packages that you create for your desktop application are desktop-only, full-trust applications that aren't sandboxed, although there's lightweight virtualization applied to the app for writes to `HKCU` and `AppData`.</span></span> <span data-ttu-id="4f2bc-162">Esta virtualización les permite interactuar con otras aplicaciones de la misma manera que las aplicaciones de escritorio clásicas.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-162">This virtualization allows them to interact with other apps the same way classic desktop applications do.</span></span>

##### <a name="installation"></a><span data-ttu-id="4f2bc-163">Instalación</span><span class="sxs-lookup"><span data-stu-id="4f2bc-163">Installation</span></span>

<span data-ttu-id="4f2bc-164">Los paquetes de la aplicación se instalan en *% ProgramFiles% \\ WindowsApps \\ package_name*, con el archivo ejecutable titulado  `app_name.exe` .</span><span class="sxs-lookup"><span data-stu-id="4f2bc-164">App packages are installed under *%ProgramFiles%\\WindowsApps\\package_name*, with the executable titled `app_name.exe`.</span></span> <span data-ttu-id="4f2bc-165">Cada carpeta de paquete contiene un manifiesto (llamado `AppxManifest.xml` ) que contiene un espacio de nombres XML especial para aplicaciones empaquetadas.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-165">Each package folder contains a manifest (named `AppxManifest.xml`) that contains a special XML namespace for packaged apps.</span></span> <span data-ttu-id="4f2bc-166">Dentro de ese archivo de manifiesto hay un  `<EntryPoint>`   elemento, que hace referencia a la aplicación de plena confianza.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-166">Inside that manifest file is an `<EntryPoint>` element, which references the full-trust app.</span></span> <span data-ttu-id="4f2bc-167">Cuando se inicia la aplicación, no se ejecuta dentro de un contenedor de la aplicación, sino que se ejecuta como el usuario como lo haría normalmente.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-167">When that application is launched, it doesn't run inside an app container, but instead it runs as the user as it normally would.</span></span>

<span data-ttu-id="4f2bc-168">Después de la implementación, el sistema operativo marca los archivos del paquete como de solo lectura y los bloquea completamente.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-168">After deployment, package files are marked read-only and heavily locked down by the operating system.</span></span> <span data-ttu-id="4f2bc-169">Windows evita que las aplicaciones se inicien en caso de que se manipulen estos archivos.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-169">Windows prevents apps from launching if these files are tampered with.</span></span>

##### <a name="file-system"></a><span data-ttu-id="4f2bc-170">Sistema de archivos</span><span class="sxs-lookup"><span data-stu-id="4f2bc-170">File system</span></span>

<span data-ttu-id="4f2bc-171">El sistema operativo admite distintos niveles de operaciones del sistema de archivos para las aplicaciones de escritorio empaquetadas, en función de la ubicación de la carpeta.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-171">The OS supports different levels of file system operations for packaged desktop applications, depending on the folder location.</span></span>

<span data-ttu-id="4f2bc-172">Al intentar obtener acceso a la carpeta *AppData* del usuario, el sistema crea una ubicación privada por usuario y por aplicación en segundo plano.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-172">When trying to access the user's *AppData* folder, the system creates a private per-user, per-app location behind the scenes.</span></span> <span data-ttu-id="4f2bc-173">Esto crea la ilusión de que la aplicación empaquetada está editando la *AppData* real cuando realmente está modificando una copia privada.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-173">This creates the illusion that the packaged application is editing the real *AppData* when it's actually modifying a private copy.</span></span> <span data-ttu-id="4f2bc-174">Al redireccionar las escrituras de este modo, el sistema puede realizar un seguimiento de todas las modificaciones de archivos que realiza la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-174">By redirecting writes this way, the system can track all file modifications made by the app.</span></span> <span data-ttu-id="4f2bc-175">A continuación, puede limpiar todos los archivos al desinstalar la reducción del sistema "rot" y proporcionar una mejor experiencia de eliminación de aplicaciones para el usuario.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-175">It can then clean all those files when uninstalling reducing system "rot" and providing a better application removal experience for the user.</span></span>

##### <a name="registry"></a><span data-ttu-id="4f2bc-176">Registro</span><span class="sxs-lookup"><span data-stu-id="4f2bc-176">Registry</span></span>

<span data-ttu-id="4f2bc-177">Los paquetes de aplicaciones contienen un archivo Registry. dat, que actúa como el equivalente lógico de  `HKLM\Software`   en el registro real.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-177">App packages contain a registry.dat file, which serves as the logical equivalent of `HKLM\Software` in the real registry.</span></span> <span data-ttu-id="4f2bc-178">En tiempo de ejecución, este Registro virtual combina el contenido de este subárbol en el subárbol del sistema nativo para proporcionar una vista especial de ambos.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-178">At runtime, this virtual registry merges the contents of this hive into the native system hive to provide a singular view of both.</span></span>

<span data-ttu-id="4f2bc-179">Todas las escrituras se conservan durante la actualización del paquete y solo se eliminan cuando se desinstala la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-179">All writes are kept during package upgrade and only deleted when the application is uninstalled.</span></span>

##### <a name="uninstallation"></a><span data-ttu-id="4f2bc-180">Desinstalación</span><span class="sxs-lookup"><span data-stu-id="4f2bc-180">Uninstallation</span></span>

<span data-ttu-id="4f2bc-181">Cuando el usuario desinstala un paquete, se quitan todos los archivos y carpetas ubicados en  `C:\Program Files\WindowsApps\package_name` , así como las escrituras redirigidas a AppData o el registro que se capturaron durante el proceso.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-181">When the user uninstalls a package, all files and folders located under `C:\Program Files\WindowsApps\package_name` are removed, as well as any redirected writes to AppData or the registry that were captured during the process.</span></span>

<span data-ttu-id="4f2bc-182">Para obtener más información sobre cómo una aplicación empaquetada controla la instalación, el acceso a archivos, el registro y la desinstalación, vea <https://docs.microsoft.com/windows/msix/desktop/desktop-to-uwp-behind-the-scenes> .</span><span class="sxs-lookup"><span data-stu-id="4f2bc-182">For details about how a packaged application handles installation, file access, registry, and uninstallation, see <https://docs.microsoft.com/windows/msix/desktop/desktop-to-uwp-behind-the-scenes>.</span></span>

<span data-ttu-id="4f2bc-183">Puede obtener una lista completa de los elementos que se deben comprobar <https://docs.microsoft.com/windows/msix/desktop/desktop-to-uwp-prepare> .</span><span class="sxs-lookup"><span data-stu-id="4f2bc-183">You can get a complete list of things to check on <https://docs.microsoft.com/windows/msix/desktop/desktop-to-uwp-prepare>.</span></span>

## <a name="how-to-add-winrt-apis-to-your-desktop-project"></a><span data-ttu-id="4f2bc-184">Cómo agregar API de WinRT al proyecto de escritorio</span><span class="sxs-lookup"><span data-stu-id="4f2bc-184">How to add WinRT APIs to your desktop project</span></span>

<span data-ttu-id="4f2bc-185">En esta sección, puede encontrar un tutorial sobre cómo integrar las notificaciones del sistema en una aplicación de WPF existente.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-185">In this section, you can find a walkthrough on how to integrate Toast Notifications in an existing WPF application.</span></span> <span data-ttu-id="4f2bc-186">Aunque es sencilla desde la perspectiva del código, ayuda a ilustrar todo el proceso.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-186">Although it's simple from the code perspective, it helps illustrate the whole process.</span></span> <span data-ttu-id="4f2bc-187">Las notificaciones son una de las muchas API de WinRT disponibles que puede usar en la aplicación .NET.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-187">Notifications are one of the many available WinRT APIs available that you can use in .NET app.</span></span> <span data-ttu-id="4f2bc-188">En este caso, la API requiere una identidad de paquete.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-188">In this case, the API requires a Package Identity.</span></span> <span data-ttu-id="4f2bc-189">Este proceso es más sencillo si las API no requieren la identidad del paquete.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-189">This process is more straightforward if the APIs don't require Package Identity.</span></span>

<span data-ttu-id="4f2bc-190">Vamos a tomar una aplicación de ejemplo de WPF existente que lee archivos y muestra su contenido en la pantalla.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-190">Let's take an existing WPF sample app that reads files and shows its contents on the screen.</span></span> <span data-ttu-id="4f2bc-191">El objetivo es mostrar una notificación del sistema cuando se inicia la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-191">The goal is to display a Toast Notification when the application starts.</span></span>

![Captura de pantalla de la aplicación de ejemplo en ejecución](./media/windows-migration/sample-application.png)

<span data-ttu-id="4f2bc-193">En primer lugar, debe proteger el siguiente vínculo si la API de Windows 10 que usará requiere una identidad de paquete:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-193">First, you should check in the following link whether the Windows 10 API that you'll use requires a Package Identity:</span></span>

<https://docs.microsoft.com/windows/apps/desktop/modernize/desktop-to-uwp-supported-api>

<span data-ttu-id="4f2bc-194">Nuestro ejemplo usará la <xref:Windows.UI.Notifications.Notification?displayProperty=nameWithType> API que requiere una identidad empaquetada:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-194">Our sample will use the <xref:Windows.UI.Notifications.Notification?displayProperty=nameWithType> API that requires a packaged identity:</span></span>

![Clase de notificación en la documentación de Microsoft](./media/windows-migration/notification-class-documentation.png)

<span data-ttu-id="4f2bc-196">Para acceder a la API de WinRT, agregue una referencia al `Microsoft.Windows.SDK.Contracts`   paquete de NuGet y este paquete hará la magia en segundo plano (vea los detalles en <https://blogs.windows.com/windowsdeveloper/2019/04/30/calling-windows-10-apis-from-a-desktop-application-just-got-easier/> ).</span><span class="sxs-lookup"><span data-stu-id="4f2bc-196">To access the WinRT API, add a reference to the `Microsoft.Windows.SDK.Contracts` NuGet package and this package will do the magic behind the scenes (see details at <https://blogs.windows.com/windowsdeveloper/2019/04/30/calling-windows-10-apis-from-a-desktop-application-just-got-easier/>).</span></span>

<span data-ttu-id="4f2bc-197">Ahora está preparado para empezar a agregar código.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-197">You're now prepared to start adding some code.</span></span>

<span data-ttu-id="4f2bc-198">Cree un `ShowToastNotification` método al que se llamará en el inicio de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-198">Create a `ShowToastNotification` method that will be called on application startup.</span></span> <span data-ttu-id="4f2bc-199">Solo se compila una notificación del sistema a partir de un patrón XML:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-199">It just builds a toast notification from an XML pattern:</span></span>

```csharp
private void ShowNotification(string title, string content, string image)
{
    string xmlString = $@"<toast><visual><binding template = 'ToastGeneric'><text>{title}</text><text>{content}</text><image src=>'{image}'</image></binding></visual></toast>";
    XmlDocument toastXml = new XmlDocument();
    toastXml.LoadXml(xmlString);
    ToastNotification toast = new ToastNotification(toastXml);
    ToastNotificationManager.CreateToastNotifier().Show(toast);
}
```

<span data-ttu-id="4f2bc-200">Aunque el proyecto se compila, hay errores porque la API de notificaciones requiere una identidad de paquete y no se ha proporcionado.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-200">Although the project builds, there are errors because the Notifications API requires a Package Identity and you didn't provide it.</span></span> <span data-ttu-id="4f2bc-201">Si agrega un proyecto de empaquetado de Windows a la solución, se solucionará el problema:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-201">Adding a Windows Packaging Project to the solution will fix the issue:</span></span>

![Captura de pantalla del cuadro de diálogo Agregar nuevo proyecto en Visual Studio](./media/windows-migration/add-packaging-project.png)

<span data-ttu-id="4f2bc-203">Seleccione la versión mínima de Windows que desea admitir y la versión de destino.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-203">Select the minimum Windows version you want to support and the version you're targeting.</span></span> <span data-ttu-id="4f2bc-204">No todas las API de WinRT se admiten en todas las versiones de Windows 10.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-204">Not all the WinRT APIs are supported in all Windows 10 versions.</span></span> <span data-ttu-id="4f2bc-205">Cada actualización de Windows 10 agrega nuevas API que solo están disponibles en esta versión; la compatibilidad de nivel inferior no está disponible.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-205">Each Windows 10 update adds new APIs that are only available from this version; down-level support isn't available.</span></span>

![Seleccionar la versión mínima de Windows](./media/windows-migration/select-versions.png)

<span data-ttu-id="4f2bc-207">El siguiente paso consiste en agregar la aplicación WPF al proyecto de empaquetado de Windows mediante la adición de una referencia de proyecto:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-207">Next step is to add the WPF application to the Windows Packaging Project by adding a project reference:</span></span>

![Agregar una aplicación WPF al proyecto de empaquetado de Windows](./media/windows-migration/add-application.png)

![Administrador de referencias](./media/windows-migration/reference-manager.png)

<span data-ttu-id="4f2bc-210">Un proyecto de empaquetado de Windows puede empaquetar varias aplicaciones, por lo que debe establecer cuál es el punto de entrada:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-210">A Windows Packaging Project can package several apps so you should set which one is the Entry Point:</span></span>

![Establecer el punto de entrada](./media/windows-migration/set-entry-point.png)

<span data-ttu-id="4f2bc-212">El siguiente paso consiste en establecer el proyecto de WPF como proyecto de inicio en la configuración de la solución.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-212">Next step is to set the WPF Project as the startup Project in the solution configuration.</span></span> <span data-ttu-id="4f2bc-213">Puede presionar F5 para compilar y compilar y ver los resultados.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-213">You can press F5 to compile and build and see the results.</span></span>

![Aplicación de ejemplo que se ejecuta y muestra los resultados](./media/windows-migration/sample-app-result.png)

<span data-ttu-id="4f2bc-215">Vamos a generar el paquete para que pueda instalar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-215">Let's generate the package so you can install your app.</span></span> <span data-ttu-id="4f2bc-216">Haga clic con el botón derecho en **tienda**  >  **crear paquetes de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-216">Right click on **Store** > **Create App Packages**.</span></span>

![Cuadro de diálogo crear paquetes de aplicaciones](./media/windows-migration/create-app-packages.png)

<span data-ttu-id="4f2bc-218">Seleccione la opción instalación de prueba para implementar la aplicación desde el equipo:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-218">Select the sideloading option to deploy the app from your machine:</span></span>

![Seleccionar la opción de instalación de prueba](./media/windows-migration/select-sideloading-option.png)

<span data-ttu-id="4f2bc-220">Seleccione la arquitectura de aplicación de la aplicación:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-220">Select the application architecture of your app:</span></span>

![Seleccionar la arquitectura de la aplicación](./media/windows-migration/select-app-architecture.png)

<span data-ttu-id="4f2bc-222">Finalmente, haga clic en **crear** para crear el paquete.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-222">Finally, create the package by clicking on **Create**.</span></span>

## <a name="xaml-islands"></a><span data-ttu-id="4f2bc-223">Islas XAML</span><span class="sxs-lookup"><span data-stu-id="4f2bc-223">XAML Islands</span></span>

<span data-ttu-id="4f2bc-224">Las islas XAML son un conjunto de componentes que permiten a los desarrolladores de escritorio de Windows usar controles XAML de UWP en sus aplicaciones Win32 existentes, como Windows Forms y WPF.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-224">XAML Islands are a set of components that enable Windows desktop developers to use UWP XAML controls on their existing Win32 applications, including Windows Forms and WPF.</span></span>

![Estructura de islas XAML](./media/windows-migration/xaml-islands.png)

<span data-ttu-id="4f2bc-226">Puede crear una imagen de la aplicación Win32 con sus controles estándar y entre ellos una "isla" de la interfaz de usuario de UWP que contiene controles del mundo moderno.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-226">You can image your Win32 app with your standard controls and among them an "island" of UWP UI containing controls from the modern world.</span></span> <span data-ttu-id="4f2bc-227">El concepto es similar a tener un iFrame dentro de una página web que muestra el contenido de un `different page.`</span><span class="sxs-lookup"><span data-stu-id="4f2bc-227">The concept is similar as having an iFrame inside a web page that shows content from a `different page.`</span></span>

<span data-ttu-id="4f2bc-228">Además de agregar funcionalidad desde las API de Windows 10, puede agregar elementos de XAML de UWP dentro de la aplicación mediante islas XAML.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-228">Besides adding functionality from the Windows 10 APIs, you can add pieces of UWP XAML inside of your app using XAML Islands.</span></span>

<span data-ttu-id="4f2bc-229">Windows 10 1903 Update incluye un conjunto de API que permite hospedar contenido XAML de UWP en ventanas de Win32.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-229">Windows 10 1903 update introduces a set of APIs that allows hosting UWP XAML content in Win32 windows.</span></span> <span data-ttu-id="4f2bc-230">Solo las aplicaciones que se ejecutan en Windows 10 1903 pueden usar islas XAML.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-230">Only apps running on Windows 10 1903 can use XAML Islands.</span></span>

### <a name="the-road-to-xaml-islands"></a><span data-ttu-id="4f2bc-231">El camino a las islas XAML</span><span class="sxs-lookup"><span data-stu-id="4f2bc-231">The road to XAML Islands</span></span>

<span data-ttu-id="4f2bc-232">La ruta a las islas XAML comenzó en 2012 cuando Microsoft presentó las API de WinRT como un marco para modernizar las aplicaciones Win32 (Windows Forms, WPF y aplicaciones nativas de Win32).</span><span class="sxs-lookup"><span data-stu-id="4f2bc-232">The road to XAML Islands started in 2012 when Microsoft introduced the WinRT APIs as a framework to modernize the Win32 apps (Windows Forms, WPF, and native Win32 apps).</span></span> <span data-ttu-id="4f2bc-233">Sin embargo, los nuevos controles de IU dentro de WinRT estaban disponibles para las nuevas aplicaciones, pero no para los existentes.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-233">However, the new UI controls inside WinRT were available for new applications but not for existing ones.</span></span>

<span data-ttu-id="4f2bc-234">En 2015, junto con Windows 10, se nació UWP.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-234">In 2015, along with Windows 10, UWP was born.</span></span> <span data-ttu-id="4f2bc-235">UWP le permite crear aplicaciones que funcionan en dispositivos Windows como XBox, Mobile y Desktop.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-235">UWP allows you to create apps that work across Windows devices like XBox, Mobile, and Desktop.</span></span> <span data-ttu-id="4f2bc-236">Un año después, Microsoft anunció Desktop Bridge (antes conocido como Project Centennial).</span><span class="sxs-lookup"><span data-stu-id="4f2bc-236">One year later, Microsoft announced Desktop Bridge (formerly known as Project Centennial).</span></span> <span data-ttu-id="4f2bc-237">Puente de escritorio es un conjunto de herramientas que permiten a los desarrolladores traer sus aplicaciones Win32 existentes al Microsoft Store.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-237">Desktop Bridge is a set of tools that allowed developers to bring their existing Win32 apps to the Microsoft Store.</span></span> <span data-ttu-id="4f2bc-238">Se han agregado más funcionalidades en 2017, lo que permite a los desarrolladores mejorar sus aplicaciones Win32 aprovechando algunas de las nuevas API de Windows 10, como iconos dinámicos y notificaciones en el centro de actividades.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-238">More capabilities were added in 2017, allowing developers to enhance their Win32 apps leveraging some of the new Windows 10 APIs, like live tiles and notifications on the action center.</span></span> <span data-ttu-id="4f2bc-239">Pero todavía no hay nuevos controles de interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-239">But still, no new UI controls.</span></span>

<span data-ttu-id="4f2bc-240">En la compilación 2018, Microsoft anunció una manera para que los desarrolladores usen los nuevos controles XAML de Windows 10 en sus aplicaciones de Win32 actuales, sin migrar completamente sus aplicaciones a UWP.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-240">At Build 2018, Microsoft announced a way for developers to use the new Windows 10 XAML controls into their current Win32 apps, without fully migrating their apps to UWP.</span></span> <span data-ttu-id="4f2bc-241">Se marca como islas XAML de UWP.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-241">It was branded as UWP XAML Islands.</span></span>

### <a name="how-it-works"></a><span data-ttu-id="4f2bc-242">Cómo funciona</span><span class="sxs-lookup"><span data-stu-id="4f2bc-242">How it works</span></span>

<span data-ttu-id="4f2bc-243">La actualización de Windows 10 1903 presenta varias API de hospedaje de XAML.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-243">The Windows 10 1903 update introduces several XAML hosting APIs.</span></span> <span data-ttu-id="4f2bc-244">Dos de ellos son `WindowsXamlManager`   y  `DesktopWindowXamlSource` .</span><span class="sxs-lookup"><span data-stu-id="4f2bc-244">Two of them are `WindowsXamlManager` and `DesktopWindowXamlSource`.</span></span>

<span data-ttu-id="4f2bc-245">La  `WindowsXamlManager`   clase controla el marco XAML de UWP.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-245">The `WindowsXamlManager` class handles the UWP XAML Framework.</span></span> <span data-ttu-id="4f2bc-246">Su `InitializeForCurrentThread` método carga el marco XAML de UWP dentro del subproceso actual de la aplicación Win32.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-246">Its `InitializeForCurrentThread` method loads the UWP XAML Framework inside the current thread of the Win32 app.</span></span>

<span data-ttu-id="4f2bc-247"> `DesktopWindowXamlSource`   Es la instancia del contenido de la isla XAML.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-247">The `DesktopWindowXamlSource` is the instance of your XAML Island content.</span></span> <span data-ttu-id="4f2bc-248">Tiene la `Content` propiedad, que es responsable de la creación de instancias y la configuración de.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-248">It has the `Content` property, which you're responsible for instantiating and setting.</span></span> <span data-ttu-id="4f2bc-249">El `DesktopWindowXamlSource`   representa y obtiene la entrada de un HWND.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-249">The `DesktopWindowXamlSource` renders and gets its input from an HWND.</span></span> <span data-ttu-id="4f2bc-250">Debe saber a qué otro HWND adjuntará el de la isla XAML y será responsable de ajustar el tamaño y la posición del HWND del elemento primario.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-250">It needs to know to which other HWND it will attach the XAML Island's one, and you're responsible for sizing and positioning the parent's HWND.</span></span>

<span data-ttu-id="4f2bc-251">Los desarrolladores de WPF o Windows Forms no suelen tratar con HWND dentro de su código, por lo que puede ser difícil comprender y controlar punteros HWND y los contenidos de cableado subyacentes para comunicar los mundos de Win32 y UWP.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-251">WPF or Windows Forms developers don't usually deal with HWND inside their code, so it may be hard to understand and handle HWND pointers and the underlying wiring stuff to communicate Win32 and UWP worlds.</span></span>

#### <a name="the-xaml-islands-net-wrappers"></a><span data-ttu-id="4f2bc-252">Contenedores .NET de islas XAML</span><span class="sxs-lookup"><span data-stu-id="4f2bc-252">The XAML Islands .NET Wrappers</span></span>

<span data-ttu-id="4f2bc-253">El kit de herramientas de la comunidad de Windows tiene un conjunto de los contenedores .NET de las islas XAML para WPF o Windows Forms que facilitan el uso de las islas XAML.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-253">The Windows Community Toolkit has a set the XAML Islands .NET wrappers for WPF or Windows Forms that make easier to use XAML Islands.</span></span> <span data-ttu-id="4f2bc-254">Estos contenedores administran el HWND, la administración de enfoque, entre otras cosas.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-254">These wrappers manage the HWNDs, the focus management, among other things.</span></span> <span data-ttu-id="4f2bc-255">Los desarrolladores de Windows Forms y WPF deben usar estos contenedores.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-255">Windows Forms and WPF developers should use these wrappers.</span></span>

<span data-ttu-id="4f2bc-256">El kit de herramientas de la comunidad de Windows ofrece dos tipos de controles: controles ajustados y controles de hospedaje.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-256">The Windows Community Toolkit offers two types of controls: Wrapped Controls and Hosting Controls.</span></span>

##### <a name="wrapped-controls"></a><span data-ttu-id="4f2bc-257">Controles ajustados</span><span class="sxs-lookup"><span data-stu-id="4f2bc-257">Wrapped Controls</span></span>

<span data-ttu-id="4f2bc-258">Estos controles ajustados ajustan algunos controles de UWP en Windows Forms o controles de WPF, ocultando los conceptos de UWP para esos desarrolladores.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-258">These wrapped controls wrap some UWP controls into Windows Forms or WPF controls, hiding UWP concepts for those developers.</span></span> <span data-ttu-id="4f2bc-259">Estos controles son:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-259">These controls are:</span></span>

* <span data-ttu-id="4f2bc-260">WebView y WebViewCompatible</span><span class="sxs-lookup"><span data-stu-id="4f2bc-260">WebView and WebViewCompatible</span></span>
* <span data-ttu-id="4f2bc-261">InkCanvas e InkToolbar</span><span class="sxs-lookup"><span data-stu-id="4f2bc-261">InkCanvas and InkToolbar</span></span>
* <span data-ttu-id="4f2bc-262">MediaPlayerElement</span><span class="sxs-lookup"><span data-stu-id="4f2bc-262">MediaPlayerElement</span></span>
* <span data-ttu-id="4f2bc-263">MapControl</span><span class="sxs-lookup"><span data-stu-id="4f2bc-263">MapControl</span></span>

<span data-ttu-id="4f2bc-264">Agregue el `Microsoft.Toolkit.Wpf.UI.Controls` paquete al proyecto, incluya la referencia al espacio de nombres y empiece a usarlos.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-264">Add the `Microsoft.Toolkit.Wpf.UI.Controls` package to your project, include the reference to the namespace, and start using them.</span></span>

```xml
<Window
        ...
        xmlns:uwpControls="clr-namespace:Microsoft.Toolkit.Wpf.UI.Controls;assembly=Microsoft.Toolkit.Wpf.UI.Controls">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="\*"/>
    </Grid.RowDefinitions>
    <uwpControls:InkToolbar TargetInkCanvas="{x:Reference Name=inkCanvas}"/>
    <uwpControls:InkCanvas Grid.Row="1" x:Name="inkCanvas" />
</Grid>
```

##### <a name="hosting-controls"></a><span data-ttu-id="4f2bc-265">Hospedar controles</span><span class="sxs-lookup"><span data-stu-id="4f2bc-265">Hosting controls</span></span>

<span data-ttu-id="4f2bc-266">La eficacia de las islas XAML se extiende a la mayoría de los controles de primera parte, controles de terceros y controles personalizados desarrollados para UWP, que se pueden integrar en Windows Forms y WPF como "islas" con la interfaz de usuario totalmente funcional.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-266">The power of XAML Islands extends to most first-party controls, third-party controls, and custom controls developed for UWP, which can be integrated into Windows Forms and WPF as "Islands" with fully functional UI.</span></span> <span data-ttu-id="4f2bc-267">El `WindowsXamlHost` control para WPF y Windows Forms permite hacerlo.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-267">The `WindowsXamlHost` control for WPF and Windows Forms allows doing this.</span></span>

<span data-ttu-id="4f2bc-268">Por ejemplo, para usar el `WindowsXamlHost` control en WPF, agregue una referencia al `Microsoft.Toolkit.Wpf.UI.XamlHost` paquete proporcionado por el kit de herramientas de la comunidad de Windows.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-268">For example, to use the `WindowsXamlHost` control in WPF, add a reference to the `Microsoft.Toolkit.Wpf.UI.XamlHost` package provided by the Windows Community Toolkit.</span></span>

<span data-ttu-id="4f2bc-269">Una vez que haya colocado `WindowsXamlHost` en el código de la interfaz de usuario, especifique el tipo de UWP que quiere cargar.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-269">Once you've placed your `WindowsXamlHost` into your UI code, specify which UWP type you want to load.</span></span> <span data-ttu-id="4f2bc-270">Puede optar por usar un control ajustado como un `Button` o un más complejo compuesto por varios controles distintos, que son un control UWP personalizado.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-270">You can choose to use a wrapped control like a `Button` or a more complex one composed by several different controls, which are a custom UWP control.</span></span>

<span data-ttu-id="4f2bc-271">En el ejemplo siguiente se muestra cómo agregar un UWP `Button` :</span><span class="sxs-lookup"><span data-stu-id="4f2bc-271">The following example shows how to add a UWP `Button`:</span></span>

```xml
<Window
        ...
        xmlns:xamlhost="clr-namespace:Microsoft.Toolkit.Wpf.UI.XamlHost;assembly=Microsoft.Toolkit.Wpf.UI.XamlHost">

<xamlhost:WindowsXamlHost x:Name="myUwpButton"
                          InitialTypeName="Windows.UI.Xaml.Controls.Button" />
```

<span data-ttu-id="4f2bc-272">Hay una recomendación clara sobre cómo enfocar esto y es mejor tener una isla XAML única y más grande que contenga un control compuesto personalizado que tener varias islas con un control en cada una.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-272">There's a clear recommendation on how to approach this and it's better to have one single and bigger XAML Island containing a custom composite control than to have several islands with one control on each.</span></span>

<span data-ttu-id="4f2bc-273">Una de las características principales de XAML es el enlace y funciona entre el código Win32 y la isla.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-273">One of the core features of XAML is binding and it works between your Win32 code and the island.</span></span> <span data-ttu-id="4f2bc-274">Por lo tanto, puede enlazar, por ejemplo, un Win32 `Textbox` con un UWP `Textbox` .</span><span class="sxs-lookup"><span data-stu-id="4f2bc-274">So, you can bind, for instance, a Win32 `Textbox` with a UWP `Textbox`.</span></span> <span data-ttu-id="4f2bc-275">Es importante tener en cuenta que estos enlaces son enlaces unidireccionales, de UWP a Win32, por lo que si actualiza `Textbox` dentro de la isla XAML, el cuadro de texto Win32 se actualizará, pero no al revés.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-275">One important thing to consider is that these bindings are one-way bindings, from UWP to Win32, so if you update the `Textbox` inside the XAML Island the Win32 Textbox will be updated, but not the other way around.</span></span>

<span data-ttu-id="4f2bc-276">Para ver un tutorial sobre cómo usar las islas XAML, consulte:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-276">To see a walkthrough about how to use XAML Islands, see:</span></span>

<https://docs.microsoft.com/windows/apps/desktop/modernize/host-standard-control-with-xaml-islands>

#### <a name="adding-uwp-xaml-custom-controls"></a><span data-ttu-id="4f2bc-277">Agregar controles personalizados XAML de UWP</span><span class="sxs-lookup"><span data-stu-id="4f2bc-277">Adding UWP XAML custom controls</span></span>

<span data-ttu-id="4f2bc-278">Un control personalizado XAML es un control (o control de usuario) creado por usted o por terceros (incluidos los controles WinUI 2. x).</span><span class="sxs-lookup"><span data-stu-id="4f2bc-278">A XAML custom control is a control (or user control) created by you or by third parties (including WinUI 2.x controls).</span></span> <span data-ttu-id="4f2bc-279">Para hospedar un control personalizado de UWP en una aplicación Windows Forms o WPF, necesitará:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-279">To host a custom UWP control in a Windows Forms or WPF app, you'll need:</span></span>

- <span data-ttu-id="4f2bc-280">Para usar el `WindowsXamlHost` control UWP en la aplicación .net Core 3. x.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-280">To use the `WindowsXamlHost` UWP control in your .NET Core 3.x app.</span></span>
- <span data-ttu-id="4f2bc-281">Para crear un proyecto de aplicación para UWP que define un `XamlApplication` objeto.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-281">To create a UWP app project that defines a `XamlApplication` object.</span></span>

<span data-ttu-id="4f2bc-282">El proyecto de WPF o Windows Forms debe tener acceso a una instancia de la `Microsoft.Toolkit.Win32.UI.XamlHost.XamlApplication` clase proporcionada por el kit de herramientas de la comunidad de Windows.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-282">Your WPF or Windows Forms project must have access to an instance of the `Microsoft.Toolkit.Win32.UI.XamlHost.XamlApplication` class provided by the Windows Community Toolkit.</span></span> <span data-ttu-id="4f2bc-283">Este objeto actúa como proveedor de metadatos raíz para cargar los metadatos de los tipos XAML de UWP personalizados en los ensamblados en el directorio actual de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-283">This object acts as a root metadata provider for loading metadata for custom UWP XAML types in assemblies in the current directory of your application.</span></span> <span data-ttu-id="4f2bc-284">La manera recomendada de hacerlo es agregar un proyecto de aplicación vacía (Windows universal) a la misma solución que el proyecto de WPF o Windows Forms y revisar la clase de aplicación predeterminada en este proyecto.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-284">The recommended way to do this is to add a Blank App (Universal Windows) project to the same solution as your WPF or Windows Forms project and revise the default App class in this project.</span></span>

<span data-ttu-id="4f2bc-285">El control XAML de UWP personalizado se puede incluir en esta aplicación para UWP o en un proyecto de biblioteca de clases de UWP independiente al que haga referencia en la misma solución que el proyecto de WPF o Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-285">The custom UWP XAML control can be included on this UWP app or in an independent UWP Class Library project that you reference in the same solution as your WPF or Windows Forms project.</span></span>

<span data-ttu-id="4f2bc-286">Puede consultar una descripción detallada del proceso paso a paso en:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-286">You can check a detailed step-by-step process description at:</span></span>

<https://docs.microsoft.com/windows/apps/desktop/modernize/host-custom-control-with-xaml-islands>

#### <a name="the-windows-ui-library-winui-2"></a><span data-ttu-id="4f2bc-287">La biblioteca de la interfaz de usuario de Windows (WinUI 2)</span><span class="sxs-lookup"><span data-stu-id="4f2bc-287">The Windows UI Library (WinUI 2)</span></span>

<span data-ttu-id="4f2bc-288">Además de los controles de bandeja de entrada de Windows 10 que vienen con el sistema operativo, el mismo equipo XAML de UWP también proporciona controles adicionales en la biblioteca de la interfaz de usuario de Windows (**WinUI 2**).</span><span class="sxs-lookup"><span data-stu-id="4f2bc-288">Besides the inbox Windows 10 controls that comes with the OS, the same UWP XAML team also deliver additional controls in the Windows UI Library (**WinUI 2**).</span></span> <span data-ttu-id="4f2bc-289">WinUI 2 proporciona controles de interfaz de usuario nativos de Microsoft y características para las aplicaciones UWP de Windows y estos controles se pueden usar dentro de las islas XAML.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-289">WinUI 2 provides official native Microsoft UI controls and features for Windows UWP apps and these controls can be used inside of XAML Islands.</span></span>

<span data-ttu-id="4f2bc-290">WinUI 2 es de código abierto y puede encontrar información en <https://github.com/microsoft/microsoft-ui-xaml> .</span><span class="sxs-lookup"><span data-stu-id="4f2bc-290">WinUI 2 is open source and you can find information at <https://github.com/microsoft/microsoft-ui-xaml>.</span></span>

<span data-ttu-id="4f2bc-291">En el siguiente artículo se muestra cómo hospedar un control XAML de UWP de la biblioteca WinUI 2: <https://docs.microsoft.com/windows/apps/desktop/modernize/host-custom-control-with-xaml-islands></span><span class="sxs-lookup"><span data-stu-id="4f2bc-291">The following article demonstrates how to host a UWP XAML control from the WinUI 2 library: <https://docs.microsoft.com/windows/apps/desktop/modernize/host-custom-control-with-xaml-islands></span></span>

### <a name="do-you-need-xaml-islands"></a><span data-ttu-id="4f2bc-292">¿Necesita islas XAML?</span><span class="sxs-lookup"><span data-stu-id="4f2bc-292">Do you need XAML Islands</span></span>

<span data-ttu-id="4f2bc-293">Las islas XAML están pensadas para las aplicaciones Win32 existentes que quieren mejorar su experiencia de usuario aprovechando los nuevos controles y comportamientos de UWP sin necesidad de volver a escribir la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-293">XAML Islands are intended for existing Win32 apps that want to improve their user experience by leveraging new UWP controls and behaviors without a full rewrite of the app.</span></span> <span data-ttu-id="4f2bc-294">Ya puede [aprovechar las API de Windows 10](/windows/uwp/porting/desktop-to-uwp-enhance), pero hasta las islas XAML, solo las API relacionadas con la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-294">You could already [leverage Windows 10 APIs](/windows/uwp/porting/desktop-to-uwp-enhance), but up until XAML Islands, only non-UI related APIs.</span></span>

<span data-ttu-id="4f2bc-295">Si está desarrollando una nueva aplicación de Windows, [](/windows/uwp/get-started/universal-application-platform-guide)   es probable que una aplicación de UWP sea el enfoque correcto.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-295">If you're developing a new Windows App, a [UWP App](/windows/uwp/get-started/universal-application-platform-guide) is probably the right approach.</span></span>

### <a name="the-road-ahead-xaml-islands-winui-30"></a><span data-ttu-id="4f2bc-296">Islas XAML de la carretera anterior: WinUI 3,0</span><span class="sxs-lookup"><span data-stu-id="4f2bc-296">The road ahead XAML Islands: WinUI 3.0</span></span>

<span data-ttu-id="4f2bc-297">Desde Windows 8, la plataforma de la interfaz de usuario de Windows, incluido el marco de interfaz de usuario XAML, el nivel de composición visual y el procesamiento de entrada se ha enviado como parte integral de Windows.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-297">Since Windows 8, the Windows UI platform, including the XAML UI framework, visual composition layer, and input processing has been shipped as an integral part of Windows.</span></span> <span data-ttu-id="4f2bc-298">Esto significa que, para beneficiarse de las mejoras más recientes en las tecnologías de interfaz de usuario, debe actualizar a la versión más reciente de la interfaz de usuario, lo que ralentiza el ritmo de innovación al desarrollar sus aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-298">This means that to benefit from the latest improvements on UI technologies, you must upgrade to the latest version of the UI, slowing down the pace of innovation when you develop your apps.</span></span> <span data-ttu-id="4f2bc-299">Para desacoplar estos dos ciclos de evolución y fomentar la innovación, Microsoft está trabajando activamente en el proyecto WinUI.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-299">To decouple these two evolution cycles and foster innovation, Microsoft is actively working on the WinUI project.</span></span>

<span data-ttu-id="4f2bc-300">A partir de WinUI 2 en 2018, Microsoft comenzó a enviar algunos nuevos controles y características de la interfaz de usuario XAML como paquetes NuGet independientes que se basan en el SDK de UWP.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-300">Starting with WinUI 2 in 2018, Microsoft started shipping some new XAML UI controls and features as separate NuGet packages that build on top of the UWP SDK.</span></span>

![Estructura de WinUI 2,0](./media/windows-migration/winui2.png)

<span data-ttu-id="4f2bc-302">WinUI 3 está en desarrollo activo y expandirá en gran medida el ámbito de WinUI para incluir la plataforma completa de la interfaz de usuario, que estará totalmente desacoplada del SDK de UWP:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-302">WinUI 3 is under active development and will greatly expand the scope of WinUI to include the full UI platform, which will be fully decoupled from the UWP SDK:</span></span>

![Estructura de WinUI 3,0](./media/windows-migration/winui3.png)

<span data-ttu-id="4f2bc-304">El marco XAML ahora se desarrollará en GitHub y se enviará fuera de banda como paquetes [NuGet](/nuget/what-is-nuget)   .</span><span class="sxs-lookup"><span data-stu-id="4f2bc-304">XAML framework will now be developed on GitHub and shipped out of band as [NuGet](/nuget/what-is-nuget) packages.</span></span>

<span data-ttu-id="4f2bc-305">Las API de XAML de UWP existentes que se incluyen como parte del sistema operativo ya no recibirán nuevas actualizaciones de las características.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-305">The existing UWP XAML APIs that ship as part of the OS will no longer receive new feature updates.</span></span> <span data-ttu-id="4f2bc-306">Seguirán recibiendo actualizaciones de seguridad y correcciones críticas según el ciclo de vida de soporte técnico de Windows 10.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-306">They will still receive security updates and critical fixes according to the Windows 10 support lifecycle.</span></span>

<span data-ttu-id="4f2bc-307">El Plataforma universal de Windows contiene algo más que solo el marco XAML (por ejemplo, la aplicación y el modelo de seguridad, la canalización multimedia, las integraciones de Shell de Xbox y Windows 10, la amplia compatibilidad con dispositivos) y continuará evolucionando.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-307">The Universal Windows Platform contains more than just the XAML framework (for example, application and security model, media pipeline, Xbox and Windows 10 shell integrations, broad device support) and will continue to evolve.</span></span> <span data-ttu-id="4f2bc-308">Todas las nuevas características XAML se desarrollarán y se enviarán como parte de WinUI en su lugar.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-308">All new XAML features will just be developed and ship as part of WinUI instead.</span></span>

#### <a name="winui-3-in-desktop-app-and-winui-xaml-islands"></a><span data-ttu-id="4f2bc-309">WinUI 3 en la aplicación de escritorio y islas XAML de WinUI</span><span class="sxs-lookup"><span data-stu-id="4f2bc-309">WinUI 3 in desktop app and WinUI XAML Islands</span></span>

<span data-ttu-id="4f2bc-310">Como puede ver, WinUI 3 es la evolución del XAML de UWP y funciona de forma natural en el modelo de aplicación de UWP y en todos sus requisitos (identificador empaquetado de MSIX, espacio aislado, CoreWindow, etc.).</span><span class="sxs-lookup"><span data-stu-id="4f2bc-310">As you can see, WinUI 3 is the evolution of UWP XAML and it works naturally within the UWP app model and all its requirements (MSIX packaged ID, sandbox, CoreWindow, and so on.</span></span> <span data-ttu-id="4f2bc-311">Para usar simplemente WinUI 3 en un modelo de aplicación de Win32, el contenido de WinUI debe estar hospedado por otro marco de interfaz de usuario (Windows Forms, WPF, etc.) mediante **islas XAML de WinUI**.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-311">To use just WinUI 3 in a Win32 app model, the WinUI content should be hosted by another UI Framework (Windows Forms, WPF, and so on) using **WinUI XAML Islands**.</span></span> <span data-ttu-id="4f2bc-312">Esta es la ruta de acceso correcta si desea desarrollar la aplicación y mezclar tecnologías.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-312">This is the right path if you want to evolve your app and mix technologies.</span></span> <span data-ttu-id="4f2bc-313">Sin embargo, si desea reemplazar toda la interfaz de usuario antigua de WinUI, la aplicación no debe cargar marcos de interfaz de usuario para hospedar únicamente WinUI.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-313">However, if you want to replace your entire old UI for WinUI, your app shouldn't load UI Frameworks for just hosting WinUI.</span></span>

<span data-ttu-id="4f2bc-314">WinUI 3 abordará esta información crítica agregando **WinUI en aplicaciones de escritorio**.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-314">WinUI 3 will address this critical feedback adding **WinUI in desktop apps**.</span></span> <span data-ttu-id="4f2bc-315">Esto permitirá que las aplicaciones Win32 puedan usar WinUI 3 como marco de interfaz de usuario independiente. no es necesario cargar Windows Forms o WPF.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-315">This will allow that Win32 apps can use WinUI 3 as standalone UI Framework; no need to load Windows Forms or WPF.</span></span>

<span data-ttu-id="4f2bc-316">Dentro de esta agregación, WinUI 3 permitirá a los desarrolladores combinar y encontrar fácilmente la combinación correcta de:</span><span class="sxs-lookup"><span data-stu-id="4f2bc-316">Within this aggregation, WinUI 3 will let developers easily mix and match the right combination of:</span></span>

* <span data-ttu-id="4f2bc-317">Modelo de aplicación: UWP, Win32</span><span class="sxs-lookup"><span data-stu-id="4f2bc-317">App model: UWP, Win32</span></span>
* <span data-ttu-id="4f2bc-318">Plataforma: .NET Core o nativo</span><span class="sxs-lookup"><span data-stu-id="4f2bc-318">Platform: .NET Core or Native</span></span>
* <span data-ttu-id="4f2bc-319">Lenguaje: .NET (C \# , Visual Basic), C++ estándar</span><span class="sxs-lookup"><span data-stu-id="4f2bc-319">Language: .NET (C\#, Visual Basic), standard C++</span></span>
* <span data-ttu-id="4f2bc-320">Empaquetado: MSIX, AppX para el Microsoft Store, desempaquetado</span><span class="sxs-lookup"><span data-stu-id="4f2bc-320">Packaging: MSIX, AppX for the Microsoft Store, unpackaged</span></span>
* <span data-ttu-id="4f2bc-321">Interop: Use WinUI 3 para ampliar las aplicaciones existentes de WPF, WinForms y MFC con islas XAML de WinUI.</span><span class="sxs-lookup"><span data-stu-id="4f2bc-321">Interop: use WinUI 3 to extend existing WPF, WinForms, and MFC apps using WinUI XAML Islands.</span></span>

<span data-ttu-id="4f2bc-322">Si desea conocer más detalles, Microsoft está compartiendo esta guía básica en <https://github.com/microsoft/microsoft-ui-xaml/blob/master/docs/roadmap.md> .</span><span class="sxs-lookup"><span data-stu-id="4f2bc-322">If you want to know more details, Microsoft is sharing this roadmap in <https://github.com/microsoft/microsoft-ui-xaml/blob/master/docs/roadmap.md>.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="4f2bc-323">[Anterior](migrate-modern-applications.md)
>[Siguiente](example-migration-core.md)</span><span class="sxs-lookup"><span data-stu-id="4f2bc-323">[Previous](migrate-modern-applications.md)
[Next](example-migration-core.md)</span></span>
