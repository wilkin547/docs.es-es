---
title: Puesta al día del runtime para implementaciones de aplicaciones autocontenidas de .NET Core.
description: Obtenga información sobre los cambios de dotnet publish para implementaciones autocontenidas.
author: KathleenDollard
ms.date: 05/31/2018
ms.openlocfilehash: 6bc578c63b28f51f1dd98e3e7e56fbe2c7a3e7cf
ms.sourcegitcommit: f2ab02d9a780819ca2e5310bbcf5cfe5b7993041
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 02/03/2021
ms.locfileid: "99505913"
---
# <a name="self-contained-deployment-runtime-roll-forward"></a><span data-ttu-id="ca125-103">Puesta al día del runtime de implementación autocontenida</span><span class="sxs-lookup"><span data-stu-id="ca125-103">Self-contained deployment runtime roll forward</span></span>

<span data-ttu-id="ca125-104">Las [implementaciones de aplicaciones autocontenidas](index.md) de .NET Core incluyen las bibliotecas de .NET Core y el runtime de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="ca125-104">.NET Core [self-contained application deployments](index.md) include both the .NET Core libraries and the .NET Core runtime.</span></span> <span data-ttu-id="ca125-105">A partir del SDK de .NET Core 2.1 (versión 2.1.300), una implementación de aplicación autocontenida [publica el runtime con la revisión superior en el equipo](https://github.com/dotnet/designs/blob/main/accepted/2018/self-contained-roll-forward.md).</span><span class="sxs-lookup"><span data-stu-id="ca125-105">Starting in .NET Core 2.1 SDK (version 2.1.300), a self-contained application deployment [publishes the highest patch runtime on your machine](https://github.com/dotnet/designs/blob/main/accepted/2018/self-contained-roll-forward.md).</span></span> <span data-ttu-id="ca125-106">De forma predeterminada, el comando [`dotnet publish`](../tools/dotnet-publish.md) para una implementación autocontenida selecciona la versión más reciente instalada como parte del SDK en el equipo de publicación.</span><span class="sxs-lookup"><span data-stu-id="ca125-106">By default, [`dotnet publish`](../tools/dotnet-publish.md) for a self-contained deployment selects the latest version installed as part of the SDK on the publishing machine.</span></span> <span data-ttu-id="ca125-107">Esto permite que la aplicación implementada se ejecute con las revisiones de seguridad (y otras correcciones) disponibles en el momento de usar el comando `publish`.</span><span class="sxs-lookup"><span data-stu-id="ca125-107">This enables your deployed application to run with security fixes (and other fixes) available during `publish`.</span></span> <span data-ttu-id="ca125-108">La aplicación debe volver a publicarse para obtener una nueva revisión.</span><span class="sxs-lookup"><span data-stu-id="ca125-108">The application must be republished to obtain a new patch.</span></span> <span data-ttu-id="ca125-109">Para crear una aplicación autocontenida, se especifica `-r <RID>` en el comando `dotnet publish` o se especifica el [identificador de runtime (RID)](../rid-catalog.md) en el archivo de proyecto (csproj o vbproj) o en la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="ca125-109">Self-contained applications are created by specifying `-r <RID>` on the `dotnet publish` command or by specifying the [runtime identifier (RID)](../rid-catalog.md) in the project file (csproj / vbproj) or on the command line.</span></span>

## <a name="patch-version-roll-forward-overview"></a><span data-ttu-id="ca125-110">Información general sobre la puesta al día de una versión de revisión</span><span class="sxs-lookup"><span data-stu-id="ca125-110">Patch version roll forward overview</span></span>

<span data-ttu-id="ca125-111">[`restore`](../tools/dotnet-restore.md), [`build`](../tools/dotnet-build.md) y [`publish`](../tools/dotnet-publish.md) son comandos de `dotnet` que se pueden ejecutar por separado.</span><span class="sxs-lookup"><span data-stu-id="ca125-111">[`restore`](../tools/dotnet-restore.md), [`build`](../tools/dotnet-build.md) and [`publish`](../tools/dotnet-publish.md) are `dotnet` commands that can run separately.</span></span> <span data-ttu-id="ca125-112">La opción de runtime forma parte de la operación `restore`, no de `publish` ni de `build`.</span><span class="sxs-lookup"><span data-stu-id="ca125-112">The runtime choice is part of the `restore` operation, not `publish` or `build`.</span></span> <span data-ttu-id="ca125-113">Si se llama a `publish`, se elegirá la versión de revisión más reciente.</span><span class="sxs-lookup"><span data-stu-id="ca125-113">If you call `publish`, the latest patch version will be chosen.</span></span> <span data-ttu-id="ca125-114">Si se llama a `publish` con el argumento `--no-restore`, podría no obtenerse la versión de revisión deseada porque es posible que un `restore` anterior no se haya ejecutado con la directiva de publicación de la nueva aplicación autocontenida.</span><span class="sxs-lookup"><span data-stu-id="ca125-114">If you call `publish` with the `--no-restore` argument, then you may not get the desired patch version because a prior `restore` may not have been executed with the new self-contained application publishing policy.</span></span> <span data-ttu-id="ca125-115">En este caso, se genera un error de compilación con un texto similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="ca125-115">In this case, a build error is generated with text similar to the following:</span></span>

  <span data-ttu-id="ca125-116">"El proyecto se restauró usando Microsoft.NETCore.App versión 2.0.0, pero con la configuración actual, la versión 2.0.6 se usará en su lugar.</span><span class="sxs-lookup"><span data-stu-id="ca125-116">"The project was restored using Microsoft.NETCore.App version 2.0.0, but with current settings, version 2.0.6 would be used instead.</span></span> <span data-ttu-id="ca125-117">Para resolver este problema, asegúrese de que se usa la misma configuración para la restauración y para operaciones posteriores tales como compilar o publicar.</span><span class="sxs-lookup"><span data-stu-id="ca125-117">To resolve this issue, make sure the same settings are used for restore and for subsequent operations such as build or publish.</span></span> <span data-ttu-id="ca125-118">Normalmente este problema puede producirse si la propiedad RuntimeIdentifier se establece durante la compilación o publicación, pero no durante la restauración".</span><span class="sxs-lookup"><span data-stu-id="ca125-118">Typically this issue can occur if the RuntimeIdentifier property is set during build or publish but not during restore."</span></span>

> [!NOTE]
> <span data-ttu-id="ca125-119">`restore` y `build` pueden ejecutarse implícitamente como parte de otro comando, como `publish`.</span><span class="sxs-lookup"><span data-stu-id="ca125-119">`restore` and `build` can be run implicitly as part of another command, like `publish`.</span></span> <span data-ttu-id="ca125-120">Cuando se ejecutan implícitamente como parte de otro comando, se les proporciona contexto adicional para que se produzcan los artefactos correctos.</span><span class="sxs-lookup"><span data-stu-id="ca125-120">When run implicitly as part of another command, they are provided with additional context so that the right artifacts are produced.</span></span> <span data-ttu-id="ca125-121">Cuando se usa el comando `publish` con un runtime (por ejemplo, `dotnet publish -r linux-x64`), la parte implícita `restore` restaura los paquetes para el runtime de linux-x64.</span><span class="sxs-lookup"><span data-stu-id="ca125-121">When you `publish` with a runtime (for example, `dotnet publish -r linux-x64`), the implicit `restore` restores packages for the linux-x64 runtime.</span></span> <span data-ttu-id="ca125-122">Si se llama a `restore` explícitamente, no se restauran los paquetes de runtime de forma predeterminada, dado que carece del contexto.</span><span class="sxs-lookup"><span data-stu-id="ca125-122">If you call `restore` explicitly, it does not restore runtime packages by default, because it doesn't have that context.</span></span>

## <a name="how-to-avoid-restore-during-publish"></a><span data-ttu-id="ca125-123">Cómo evitar la restauración durante la publicación</span><span class="sxs-lookup"><span data-stu-id="ca125-123">How to avoid restore during publish</span></span>

<span data-ttu-id="ca125-124">Ejecutar `restore` como parte de la operación `publish` puede no ser adecuado para su escenario.</span><span class="sxs-lookup"><span data-stu-id="ca125-124">Running `restore` as part of the `publish` operation may be undesirable for your scenario.</span></span> <span data-ttu-id="ca125-125">Para evitar `restore` durante `publish` al crear aplicaciones autocontenidas, haga lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="ca125-125">To avoid `restore` during `publish` while creating self-contained applications, do the following:</span></span>

- <span data-ttu-id="ca125-126">Establezca la propiedad `RuntimeIdentifiers` en una lista separada por punto y coma de todos los [RID](../rid-catalog.md) que se van a publicar.</span><span class="sxs-lookup"><span data-stu-id="ca125-126">Set the `RuntimeIdentifiers` property to a semicolon-separated list of all the [RIDs](../rid-catalog.md) to be published.</span></span>
- <span data-ttu-id="ca125-127">Establezca la propiedad `TargetLatestRuntimePatch` en `true`.</span><span class="sxs-lookup"><span data-stu-id="ca125-127">Set the `TargetLatestRuntimePatch` property to `true`.</span></span>

## <a name="no-restore-argument-with-dotnet-publish-options"></a><span data-ttu-id="ca125-128">Argumento no-restore con opciones de dotnet publish</span><span class="sxs-lookup"><span data-stu-id="ca125-128">No-restore argument with dotnet publish options</span></span>

<span data-ttu-id="ca125-129">Si quiere crear aplicaciones autocontenidas y [aplicaciones dependientes del marco de trabajo](index.md) con el mismo archivo de proyecto, y además quiere utilizar el argumento `--no-restore` con `dotnet publish`, elija una de las opciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="ca125-129">If you want to create both self-contained applications and [framework-dependent applications](index.md) with the same project file, and you want to use the `--no-restore` argument with `dotnet publish`, then choose one of the following:</span></span>

1. <span data-ttu-id="ca125-130">Preferir el comportamiento dependiente del marco de trabajo.</span><span class="sxs-lookup"><span data-stu-id="ca125-130">Prefer the framework-dependent behavior.</span></span> <span data-ttu-id="ca125-131">Si la aplicación depende del marco de trabajo, este es el comportamiento predeterminado.</span><span class="sxs-lookup"><span data-stu-id="ca125-131">If the application is framework-dependent, this is the default behavior.</span></span> <span data-ttu-id="ca125-132">Si la aplicación es autocontenida y puede usar un runtime local 2.1.0 sin revisiones, establezca `TargetLatestRuntimePatch` en `false` en el archivo de proyecto.</span><span class="sxs-lookup"><span data-stu-id="ca125-132">If the application is self-contained, and can use an unpatched 2.1.0 local runtime, set the `TargetLatestRuntimePatch` to `false` in the project file.</span></span>

2. <span data-ttu-id="ca125-133">Preferir el comportamiento autocontenido.</span><span class="sxs-lookup"><span data-stu-id="ca125-133">Prefer the self-contained behavior.</span></span> <span data-ttu-id="ca125-134">Si la aplicación es autocontenida, este es el comportamiento predeterminado.</span><span class="sxs-lookup"><span data-stu-id="ca125-134">If the application is self-contained, this is the default behavior.</span></span> <span data-ttu-id="ca125-135">Si la aplicación depende del marco de trabajo y requiere que esté instalada la revisión más reciente, establezca `TargetLatestRuntimePatch` en `true` en el archivo de proyecto.</span><span class="sxs-lookup"><span data-stu-id="ca125-135">If the application is framework-dependent, and requires the latest patch installed, set `TargetLatestRuntimePatch` to `true` in the project file.</span></span>

3. <span data-ttu-id="ca125-136">Para tomar el control explícito del marco de trabajo del runtime, establezca `RuntimeFrameworkVersion` en la versión de revisión específica en el archivo de proyecto.</span><span class="sxs-lookup"><span data-stu-id="ca125-136">Take explicit control of the runtime framework version by setting `RuntimeFrameworkVersion` to the specific patch version in the project file.</span></span>
