---
title: 'Volcados de memoria: .NET'
description: Una introducción a los volcados de memoria en .NET.
ms.date: 10/12/2020
ms.openlocfilehash: f68d9bd804350366625df014df4d9ca0641d5d4d
ms.sourcegitcommit: a4cecb7389f02c27e412b743f9189bd2a6dea4d6
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 01/14/2021
ms.locfileid: "98188561"
---
# <a name="dumps"></a><span data-ttu-id="594d3-103">Volcados</span><span class="sxs-lookup"><span data-stu-id="594d3-103">Dumps</span></span>

<span data-ttu-id="594d3-104">Un volcado de memoria es un archivo que contiene una instantánea del proceso en el momento en que se ha creado y puede ser útil para examinar el estado de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="594d3-104">A dump is a file that contains a snapshot of the process at the time it was created and can be useful for examining the state of your application.</span></span> <span data-ttu-id="594d3-105">Los volcados de memoria se pueden usar para depurar la aplicación de .NET cuando es difícil asociarle un depurador, como los entornos de producción o de CI.</span><span class="sxs-lookup"><span data-stu-id="594d3-105">Dumps can be used to debug your .NET application when it is difficult to attach a debugger to it such as production or CI environments.</span></span> <span data-ttu-id="594d3-106">El uso de volcados de memoria permite capturar el estado del proceso con problemas y examinarlo sin tener que detener la aplicación.</span><span class="sxs-lookup"><span data-stu-id="594d3-106">Using dumps allows you to capture the state of the problematic process and examine it without having to stop the application.</span></span>

## <a name="collect-dumps"></a><span data-ttu-id="594d3-107">Recopilación de volcados de memoria</span><span class="sxs-lookup"><span data-stu-id="594d3-107">Collect dumps</span></span>

<span data-ttu-id="594d3-108">Los volcados de memoria se pueden recopilar de varias maneras, en función de la plataforma en la que se ejecute la aplicación.</span><span class="sxs-lookup"><span data-stu-id="594d3-108">Dumps can be collected in a variety of ways depending on which platform you are running your app on.</span></span>

> [!NOTE]
> <span data-ttu-id="594d3-109">La recopilación de un volcado de memoria dentro de un contenedor requiere la funcionalidad PTRACE, que se puede agregar a través de `--cap-add=SYS_PTRACE` o `--privileged`.</span><span class="sxs-lookup"><span data-stu-id="594d3-109">Collecting a dump inside a container requires PTRACE capability, which can be added via `--cap-add=SYS_PTRACE` or `--privileged`.</span></span>
> [!NOTE]
> <span data-ttu-id="594d3-110">Los volcados de memoria pueden incluir información confidencial, ya que pueden contener la memoria completa del proceso en ejecución.</span><span class="sxs-lookup"><span data-stu-id="594d3-110">Dumps may contain sensitive information because they can contain the full memory of the running process.</span></span> <span data-ttu-id="594d3-111">Para controlarlos, siga las restricciones e instrucciones de seguridad.</span><span class="sxs-lookup"><span data-stu-id="594d3-111">Handle them with any security restrictions and guidances in mind.</span></span>

### <a name="collecting-dumps-on-crash"></a><span data-ttu-id="594d3-112">Recopilación de volcados de memoria durante un bloqueo</span><span class="sxs-lookup"><span data-stu-id="594d3-112">Collecting dumps on crash</span></span>

<span data-ttu-id="594d3-113">Puede usar variables de entorno a fin de configurar la aplicación para que recopile un volcado de memoria tras un bloqueo.</span><span class="sxs-lookup"><span data-stu-id="594d3-113">You can use environment variables to configure your application to collect a dump upon a crash.</span></span> <span data-ttu-id="594d3-114">Esto resulta útil si quiere comprender por qué se ha producido un bloqueo.</span><span class="sxs-lookup"><span data-stu-id="594d3-114">This is helpful when you want to get an understanding of why a crash happened.</span></span> <span data-ttu-id="594d3-115">Por ejemplo, la captura de un volcado de memoria cuando se inicia una excepción le ayuda a identificar un problema mediante el examen del estado de la aplicación en el momento del bloqueo.</span><span class="sxs-lookup"><span data-stu-id="594d3-115">For example, capturing a dump when an exception is thrown helps you identify an issue by examining the state of the app when it crashed.</span></span>

<span data-ttu-id="594d3-116">En la tabla siguiente se muestran las variables de entorno que se pueden configurar para la recopilación de volcados de memoria en caso de bloqueo.</span><span class="sxs-lookup"><span data-stu-id="594d3-116">The following table shows the environment variables you can configure for collecting dumps on a crash.</span></span>

|<span data-ttu-id="594d3-117">Variable de entorno</span><span class="sxs-lookup"><span data-stu-id="594d3-117">Environment variable</span></span>|<span data-ttu-id="594d3-118">Descripción</span><span class="sxs-lookup"><span data-stu-id="594d3-118">Description</span></span>|<span data-ttu-id="594d3-119">Valor predeterminado</span><span class="sxs-lookup"><span data-stu-id="594d3-119">Default value</span></span>|
|-------|---------|---|
|`COMPlus_DbgEnableMiniDump`|<span data-ttu-id="594d3-120">Si se establece en 1, se habilita la generación de volcado de memoria principal.</span><span class="sxs-lookup"><span data-stu-id="594d3-120">If set to 1, enable core dump generation.</span></span>|<span data-ttu-id="594d3-121">0</span><span class="sxs-lookup"><span data-stu-id="594d3-121">0</span></span>|
|`COMPlus_DbgMiniDumpType`|<span data-ttu-id="594d3-122">Tipo de volcado de memoria que se va a recopilar.</span><span class="sxs-lookup"><span data-stu-id="594d3-122">Type of dump to be collected.</span></span> <span data-ttu-id="594d3-123">Para obtener más información, vea la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="594d3-123">For more information, see the table below</span></span>|<span data-ttu-id="594d3-124">2 (`MiniDumpWithPrivateReadWriteMemory`)</span><span class="sxs-lookup"><span data-stu-id="594d3-124">2 (`MiniDumpWithPrivateReadWriteMemory`)</span></span>|
|`COMPlus_DbgMiniDumpName`|<span data-ttu-id="594d3-125">Ruta de acceso a un archivo en el que se escribirá el volcado de memoria.</span><span class="sxs-lookup"><span data-stu-id="594d3-125">Path to a file to write the dump to.</span></span>|`/tmp/coredump.<pid>`|
|`COMPlus_CreateDumpDiagnostics`|<span data-ttu-id="594d3-126">Si se establece en 1, se habilita el registro de diagnóstico del proceso de volcado.</span><span class="sxs-lookup"><span data-stu-id="594d3-126">If set to 1, enable diagnostic logging of dump process.</span></span>|<span data-ttu-id="594d3-127">0</span><span class="sxs-lookup"><span data-stu-id="594d3-127">0</span></span>|

<span data-ttu-id="594d3-128">En la tabla siguiente se muestran todas las opciones que puede usar para `COMPlus_DbgMiniDumpType` que se pueden especificar como un valor.</span><span class="sxs-lookup"><span data-stu-id="594d3-128">The table below shows all the options you may use for `COMPlus_DbgMiniDumpType` which can be specified as a value.</span></span> <span data-ttu-id="594d3-129">Por ejemplo, si `COMPlus_DbgMiniDumpType` se establece en 1, significa que el volcado de tipo `MiniDumpNormal` se recopilará al producirse un bloqueo.</span><span class="sxs-lookup"><span data-stu-id="594d3-129">For example, setting `COMPlus_DbgMiniDumpType` to 1 means `MiniDumpNormal` type dump will be collected on a crash.</span></span>

|<span data-ttu-id="594d3-130">Value</span><span class="sxs-lookup"><span data-stu-id="594d3-130">Value</span></span>|<span data-ttu-id="594d3-131">Nombre</span><span class="sxs-lookup"><span data-stu-id="594d3-131">Name</span></span>|<span data-ttu-id="594d3-132">Descripción</span><span class="sxs-lookup"><span data-stu-id="594d3-132">Description</span></span>|
|-----|----|-----------|
|<span data-ttu-id="594d3-133">1</span><span class="sxs-lookup"><span data-stu-id="594d3-133">1</span></span>|`MiniDumpNormal`|<span data-ttu-id="594d3-134">Incluya solo la información necesaria para capturar seguimientos de pila para todos los subprocesos existentes en un proceso.</span><span class="sxs-lookup"><span data-stu-id="594d3-134">Include just the information necessary to capture stack traces for all existing threads in a process.</span></span> <span data-ttu-id="594d3-135">Información y memoria del montón de GC limitadas.</span><span class="sxs-lookup"><span data-stu-id="594d3-135">Limited GC heap memory and information.</span></span>|
|<span data-ttu-id="594d3-136">2</span><span class="sxs-lookup"><span data-stu-id="594d3-136">2</span></span>|`MiniDumpWithPrivateReadWriteMemory`|<span data-ttu-id="594d3-137">Incluye la información y los montones de GC necesarios para capturar seguimientos de pila para todos los subprocesos existentes en un proceso.</span><span class="sxs-lookup"><span data-stu-id="594d3-137">Includes the GC heaps and information necessary to capture stack traces for all existing threads in a process.</span></span>|
|<span data-ttu-id="594d3-138">3</span><span class="sxs-lookup"><span data-stu-id="594d3-138">3</span></span>|`MiniDumpFilterTriage`|<span data-ttu-id="594d3-139">Incluya solo la información necesaria para capturar seguimientos de pila para todos los subprocesos existentes en un proceso.</span><span class="sxs-lookup"><span data-stu-id="594d3-139">Include just the information necessary to capture stack traces for all existing threads in a process.</span></span> <span data-ttu-id="594d3-140">Información y memoria del montón de GC limitadas.</span><span class="sxs-lookup"><span data-stu-id="594d3-140">Limited GC heap memory and information.</span></span>|
|<span data-ttu-id="594d3-141">4</span><span class="sxs-lookup"><span data-stu-id="594d3-141">4</span></span>|`MiniDumpWithFullMemory`|<span data-ttu-id="594d3-142">Incluya toda la memoria accesible en el proceso.</span><span class="sxs-lookup"><span data-stu-id="594d3-142">Include all accessible memory in the process.</span></span> <span data-ttu-id="594d3-143">Los datos de memoria sin procesar se incluyen al final, de modo que las estructuras iniciales se pueden asignar directamente sin la información de memoria sin procesar.</span><span class="sxs-lookup"><span data-stu-id="594d3-143">The raw memory data is included at the end, so that the initial structures can be mapped directly without the raw memory information.</span></span> <span data-ttu-id="594d3-144">Esta opción puede dar lugar a un archivo muy grande.</span><span class="sxs-lookup"><span data-stu-id="594d3-144">This option can result in a very large file.</span></span>|

### <a name="collecting-dumps-at-specific-point-in-time"></a><span data-ttu-id="594d3-145">Recopilación de volcados de memoria en un momento dado</span><span class="sxs-lookup"><span data-stu-id="594d3-145">Collecting dumps at specific point in time</span></span>

<span data-ttu-id="594d3-146">Es posible que quiera recopilar un volcado de memoria cuando la aplicación todavía no se ha bloqueado.</span><span class="sxs-lookup"><span data-stu-id="594d3-146">You may want to collect a dump when the app hasn't crashed yet.</span></span> <span data-ttu-id="594d3-147">Por ejemplo, si quiere examinar el estado de una aplicación que parece estar en un interbloqueo, la configuración de las variables de entorno para recopilar volcados de memoria al producirse un bloqueo no será útil porque la aplicación todavía está en ejecución.</span><span class="sxs-lookup"><span data-stu-id="594d3-147">For example, if you want to examine the state of an application that seems to be in a deadlock, configuring the environment variables to collect dumps on crash will not be helpful because the app is still running.</span></span>

<span data-ttu-id="594d3-148">Para recopilar el volcado de memoria cuando prefiera, puede usar `dotnet-dump`, que es una herramienta de la CLI para la recopilación y el análisis de volcados de memoria.</span><span class="sxs-lookup"><span data-stu-id="594d3-148">To collect dump at your own request, you can use `dotnet-dump`, which is a CLI tool for collecting and analyzing dumps.</span></span> <span data-ttu-id="594d3-149">Para obtener más información sobre cómo usarla para recopilar volcados de memoria con `dotnet-dump`, vea [Utilidad de recopilación y análisis de volcados de memoria](dotnet-dump.md).</span><span class="sxs-lookup"><span data-stu-id="594d3-149">For more information on how to use it to collect dumps with `dotnet-dump`, see [Dump collection and analysis utility](dotnet-dump.md).</span></span>

## <a name="analyze-dumps"></a><span data-ttu-id="594d3-150">Análisis de volcados de memoria</span><span class="sxs-lookup"><span data-stu-id="594d3-150">Analyze dumps</span></span>

<span data-ttu-id="594d3-151">Puede analizar volcados mediante la herramienta de la CLI [`dotnet-dump`](dotnet-dump.md) o con [Visual Studio](/visualstudio/debugger/using-dump-files).</span><span class="sxs-lookup"><span data-stu-id="594d3-151">You can anlayze dumps using the [`dotnet-dump`](dotnet-dump.md) CLI tool or with [Visual Studio](/visualstudio/debugger/using-dump-files).</span></span>

> [!NOTE]
> <span data-ttu-id="594d3-152">La versión 16.8 y posteriores de Visual Studio le permite [abrir volcados de Linux](https://devblogs.microsoft.com/visualstudio/linux-managed-memory-dump-debugging/) generados en .NET Core 3.1.7 o versiones posteriores.</span><span class="sxs-lookup"><span data-stu-id="594d3-152">Visual Studio version 16.8 and later allows you to [open Linux dumps](https://devblogs.microsoft.com/visualstudio/linux-managed-memory-dump-debugging/) generated on .NET Core 3.1.7 or later.</span></span>  
> [!NOTE]
> <span data-ttu-id="594d3-153">Si es necesaria la depuración nativa, se puede usar la [extensión del depurador de SOS](sos-debugging-extension.md) con [LLDB en Linux y macOS](debug-linux-dumps.md#analyze-dumps-on-linux).</span><span class="sxs-lookup"><span data-stu-id="594d3-153">If native debugging is necessary, the [SOS debugger extension](sos-debugging-extension.md) can be used with [LLDB on Linux and macOS](debug-linux-dumps.md#analyze-dumps-on-linux).</span></span> <span data-ttu-id="594d3-154">También se admite SOS con [WinDbg/cdb](/windows-hardware/drivers/debugger/debugger-download-tools) en Windows, aunque se recomienda Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="594d3-154">SOS is also supported with [Windbg/cdb](/windows-hardware/drivers/debugger/debugger-download-tools) on Windows, although Visual Studio is recommended.</span></span>

## <a name="see-also"></a><span data-ttu-id="594d3-155">Consulte también</span><span class="sxs-lookup"><span data-stu-id="594d3-155">See also</span></span>

<span data-ttu-id="594d3-156">Obtenga más información sobre cómo puede aprovechar los volcados de memoria para ayudar a diagnosticar problemas en la aplicación de .NET.</span><span class="sxs-lookup"><span data-stu-id="594d3-156">Learn more about how you can leverage dumps to help diagnosing problems in your .NET application.</span></span>

* <span data-ttu-id="594d3-157">En el tutorial [Depuración de volcados de Linux](debug-linux-dumps.md) se le guía a través de la depuración de un volcado de memoria recopilado en Linux.</span><span class="sxs-lookup"><span data-stu-id="594d3-157">[Debug Linux dumps](debug-linux-dumps.md) tutorial walks you through how to debug a dump that was collected in Linux.</span></span>

* <span data-ttu-id="594d3-158">En el tutorial [Depuración de interbloqueo](debug-deadlock.md) se le guía a través de la depuración de un interbloqueo en la aplicación de .NET mediante volcados de memoria.</span><span class="sxs-lookup"><span data-stu-id="594d3-158">[Debug deadlock](debug-deadlock.md) tutorial walks you through how to debug a deadlock in your .NET application using dumps.</span></span>
