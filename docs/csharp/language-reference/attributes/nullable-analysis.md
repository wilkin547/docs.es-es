---
title: 'Atributos reservados de C#: Análisis estático que admite un valor NULL'
ms.date: 02/02/2021
description: El compilador interpreta estos atributos para proporcionar un mejor análisis estático para los tipos de referencia que aceptan y que no aceptan valores NULL.
ms.openlocfilehash: c1c3e0a0fe1ee9000e0a1a85ee08e6e966200be5
ms.sourcegitcommit: 4df8e005c074ceb1f978f007b222fe253be2baf3
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 02/04/2021
ms.locfileid: "99548362"
---
# <a name="reserved-attributes-contribute-to-the-compilers-null-state-static-analysis"></a><span data-ttu-id="44b3b-103">Los atributos reservados contribuyen al análisis estático del estado NULL del compilador.</span><span class="sxs-lookup"><span data-stu-id="44b3b-103">Reserved attributes contribute to the compiler's null state static analysis</span></span>

<span data-ttu-id="44b3b-104">En un contexto que admite un valor NULL, el compilador realiza un análisis estático del código para determinar el estado NULL de todas las variables de tipo de referencia:</span><span class="sxs-lookup"><span data-stu-id="44b3b-104">In a nullable context, the compiler performs static analysis of code to determine the null state of all reference type variables:</span></span>

- <span data-ttu-id="44b3b-105">*not null*: el análisis estático determina que a la variable se le asigna un valor distinto de NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-105">*not null*: Static analysis determines that a variable is assigned a non-null value.</span></span>
- <span data-ttu-id="44b3b-106">*maybe null*: el análisis estático no puede determinar que a la variable se le asigna un valor distinto de NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-106">*maybe null*: Static analysis can't determine that a variable is assigned a non-null value.</span></span>

<span data-ttu-id="44b3b-107">Puede aplicar atributos que proporcionan información al compilador sobre la semántica de las API.</span><span class="sxs-lookup"><span data-stu-id="44b3b-107">You can apply attributes that provide information to the compiler about the semantics of your APIs.</span></span> <span data-ttu-id="44b3b-108">Esa información ayuda al compilador a realizar análisis estáticos y a determinar si una variable no es NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-108">That information helps the compiler perform static analysis and determine when a variable isn't null.</span></span> <span data-ttu-id="44b3b-109">En este artículo se proporciona una breve descripción de cada uno de esos atributos y cómo usarlos.</span><span class="sxs-lookup"><span data-stu-id="44b3b-109">This article provides a brief description of each of those attributes and how to use them.</span></span> <span data-ttu-id="44b3b-110">En todos los ejemplos se asume el uso de C# 8.0 o una versión más reciente, y que el código se encuentra en un contexto que admite un valor NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-110">All the examples assume C# 8.0 or newer, and the code is in a nullable context.</span></span>

<span data-ttu-id="44b3b-111">Para empezar, se usará un ejemplo conocido.</span><span class="sxs-lookup"><span data-stu-id="44b3b-111">Let's start with a familiar example.</span></span> <span data-ttu-id="44b3b-112">Imagine que la biblioteca tiene la siguiente API para recuperar una cadena de recursos:</span><span class="sxs-lookup"><span data-stu-id="44b3b-112">Imagine your library has the following API to retrieve a resource string:</span></span>

```csharp
bool TryGetMessage(string key, out string message)
```

<span data-ttu-id="44b3b-113">En el ejemplo anterior se sigue el conocido patrón de `Try*` en .NET.</span><span class="sxs-lookup"><span data-stu-id="44b3b-113">The preceding example follows the familiar `Try*` pattern in .NET.</span></span> <span data-ttu-id="44b3b-114">Hay dos argumentos de referencia para esta API: los parámetros `key` y `message`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-114">There are two reference arguments for this API: the `key` and the `message` parameter.</span></span> <span data-ttu-id="44b3b-115">Esta API tiene las siguientes reglas relacionadas con la obtención del valor NULL de estos argumentos:</span><span class="sxs-lookup"><span data-stu-id="44b3b-115">This API has the following rules relating to the nullness of these arguments:</span></span>

- <span data-ttu-id="44b3b-116">Los autores de la llamada no deben pasar `null` como argumento para `key`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-116">Callers shouldn't pass `null` as the argument for `key`.</span></span>
- <span data-ttu-id="44b3b-117">Los autores de la llamada pueden pasar una variable cuyo valor sea `null` como argumento de `message`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-117">Callers can pass a variable whose value is `null` as the argument for `message`.</span></span>
- <span data-ttu-id="44b3b-118">Si el método `TryGetMessage` devuelve `true`, el valor de `message` no es NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-118">If the `TryGetMessage` method returns `true`, the value of `message` isn't null.</span></span> <span data-ttu-id="44b3b-119">Si el valor devuelto es `false,`, el valor de `message` (y su estado NULL) es NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-119">If the return value is `false,` the value of `message` (and its null state) is null.</span></span>

<span data-ttu-id="44b3b-120">La regla para `key` se puede expresar mediante el tipo de variable: `key` debe ser un tipo de referencia que no acepte valores NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-120">The rule for `key` can be expressed by the variable type: `key` should be a non-nullable reference type.</span></span> <span data-ttu-id="44b3b-121">El parámetro `message` es más complejo.</span><span class="sxs-lookup"><span data-stu-id="44b3b-121">The `message` parameter is more complex.</span></span> <span data-ttu-id="44b3b-122">Permite `null` como argumento, pero garantiza que, si se ejecuta correctamente, el argumento `out` no sea NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-122">It allows `null` as the argument, but guarantees that, on success, that `out` argument isn't null.</span></span> <span data-ttu-id="44b3b-123">En estos escenarios, necesita un vocabulario más completo para describir las expectativas.</span><span class="sxs-lookup"><span data-stu-id="44b3b-123">For these scenarios, you need a richer vocabulary to describe the expectations.</span></span>

<span data-ttu-id="44b3b-124">Se han agregado varios atributos para expresar información adicional sobre el estado NULL de las variables.</span><span class="sxs-lookup"><span data-stu-id="44b3b-124">Several attributes have been added to express additional information about the null state of variables.</span></span> <span data-ttu-id="44b3b-125">Todo el código escrito antes de que C# 8 introdujera los tipos de referencia que aceptan valores NULL *desconocía los valores NULL*.</span><span class="sxs-lookup"><span data-stu-id="44b3b-125">All code you wrote before C# 8 introduced nullable reference types was *null oblivious*.</span></span> <span data-ttu-id="44b3b-126">Esto significa que es posible que cualquier variable de tipo de referencia sea NULL, pero no se necesitan comprobaciones de valores NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-126">That means any reference type variable may be null, but null checks aren't required.</span></span> <span data-ttu-id="44b3b-127">Una vez que el código *admite valores NULL*, esas reglas cambian.</span><span class="sxs-lookup"><span data-stu-id="44b3b-127">Once your code is *nullable aware*, those rules change.</span></span> <span data-ttu-id="44b3b-128">Los tipos de referencia nunca deben ser del valor `null`, y los que admitan valores NULL se deben comprobar con `null` antes de desreferenciarlos.</span><span class="sxs-lookup"><span data-stu-id="44b3b-128">Reference types should never be the `null` value, and nullable reference types must be checked against `null` before being dereferenced.</span></span>

<span data-ttu-id="44b3b-129">Es probable que las reglas de las API sean más complicadas, como se ha visto en el escenario de la API `TryGetValue`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-129">The rules for your APIs are likely more complicated, as you saw with the `TryGetValue` API scenario.</span></span> <span data-ttu-id="44b3b-130">Muchas de las API tienen reglas más complejas para cuando las variables pueden ser `null` o no.</span><span class="sxs-lookup"><span data-stu-id="44b3b-130">Many of your APIs have more complex rules for when variables can or can't be `null`.</span></span> <span data-ttu-id="44b3b-131">En estos casos, usará uno de los atributos siguientes para expresar estas reglas:</span><span class="sxs-lookup"><span data-stu-id="44b3b-131">In these cases, you'll use one of the following attributes to express those rules:</span></span>

- <span data-ttu-id="44b3b-132">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): un argumento de entrada que no acepta valores NULL puede ser NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-132">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="44b3b-133">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): un argumento de entrada que admite un valor NULL nunca debe ser NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-133">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>
- <span data-ttu-id="44b3b-134">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): un valor devuelto que no acepta valores NULL puede ser NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-134">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="44b3b-135">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): un valor devuelto que admite un valor NULL nunca será NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-135">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>
- <span data-ttu-id="44b3b-136">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): un argumento de entrada que no acepta valores NULL puede ser NULL cuando el método devuelve el valor `bool` especificado.</span><span class="sxs-lookup"><span data-stu-id="44b3b-136">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="44b3b-137">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): un argumento de entrada que admite un valor NULL nunca será NULL cuando el método devuelva el valor `bool` especificado.</span><span class="sxs-lookup"><span data-stu-id="44b3b-137">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument won't be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="44b3b-138">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): un valor devuelto no es NULL si el argumento del parámetro especificado no es NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-138">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the argument for the specified parameter isn't null.</span></span>
- <span data-ttu-id="44b3b-139">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): un método nunca devuelve un valor.</span><span class="sxs-lookup"><span data-stu-id="44b3b-139">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): A method never returns.</span></span> <span data-ttu-id="44b3b-140">Es decir, siempre inicia una excepción.</span><span class="sxs-lookup"><span data-stu-id="44b3b-140">In other words, it always throws an exception.</span></span>
- <span data-ttu-id="44b3b-141">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): este método nunca devuelve un valor si el parámetro `bool` asociado tiene el valor especificado.</span><span class="sxs-lookup"><span data-stu-id="44b3b-141">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): This method never returns if the associated `bool` parameter has the specified value.</span></span>
- <span data-ttu-id="44b3b-142">[MemberNotNull](xref:System.Diagnostics.CodeAnalysis.MemberNotNullAttribute): el miembro de la lista no será NULL cuando el método devuelva un valor.</span><span class="sxs-lookup"><span data-stu-id="44b3b-142">[MemberNotNull](xref:System.Diagnostics.CodeAnalysis.MemberNotNullAttribute): The listed member won't be null when the method returns.</span></span>
- <span data-ttu-id="44b3b-143">[MemberNotNullWhen](xref:System.Diagnostics.CodeAnalysis.MemberNotNullWhenAttribute): el miembro de la lista no será NULL cuando el método devuelva el valor `bool` especificado.</span><span class="sxs-lookup"><span data-stu-id="44b3b-143">[MemberNotNullWhen](xref:System.Diagnostics.CodeAnalysis.MemberNotNullWhenAttribute): The listed member won't be null when the method returns the specified `bool` value.</span></span>

<span data-ttu-id="44b3b-144">Las descripciones anteriores son una referencia rápida a lo que hace cada atributo.</span><span class="sxs-lookup"><span data-stu-id="44b3b-144">The preceding descriptions are a quick reference to what each attribute does.</span></span> <span data-ttu-id="44b3b-145">En cada una de las secciones siguientes se describen el comportamiento y el significado con más detalle.</span><span class="sxs-lookup"><span data-stu-id="44b3b-145">Each following section describes the behavior and meaning more thoroughly.</span></span>

<span data-ttu-id="44b3b-146">Al agregar estos atributos, se proporciona más información al compilador sobre las reglas de la API.</span><span class="sxs-lookup"><span data-stu-id="44b3b-146">Adding these attributes gives the compiler more information about the rules for your API.</span></span> <span data-ttu-id="44b3b-147">Cuando el código que realiza la llamada se compila en un contexto habilitado para aceptar valores NULL, el compilador advertirá a los autores de la llamada cuando infrinjan esas reglas.</span><span class="sxs-lookup"><span data-stu-id="44b3b-147">When calling code is compiled in a nullable enabled context, the compiler will warn callers when they violate those rules.</span></span> <span data-ttu-id="44b3b-148">Estos atributos no habilitan más comprobaciones en la implementación.</span><span class="sxs-lookup"><span data-stu-id="44b3b-148">These attributes don't enable more checks on your implementation.</span></span>

## <a name="specify-preconditions-allownull-and-disallownull"></a><span data-ttu-id="44b3b-149">Especificación de condiciones previas: `AllowNull` y `DisallowNull`</span><span class="sxs-lookup"><span data-stu-id="44b3b-149">Specify preconditions: `AllowNull` and `DisallowNull`</span></span>

<span data-ttu-id="44b3b-150">Considere una propiedad de lectura y escritura que nunca devuelve `null` porque tiene un valor predeterminado razonable.</span><span class="sxs-lookup"><span data-stu-id="44b3b-150">Consider a read/write property that never returns `null` because it has a reasonable default value.</span></span> <span data-ttu-id="44b3b-151">Los autores de la llamada pasan `null` al descriptor de acceso set cuando lo establecen en el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="44b3b-151">Callers pass `null` to the set accessor when setting it to that default value.</span></span> <span data-ttu-id="44b3b-152">Por ejemplo, imagine un sistema de mensajería que solicita un nombre de pantalla en un salón de chat.</span><span class="sxs-lookup"><span data-stu-id="44b3b-152">For example, consider a messaging system that asks for a screen name in a chat room.</span></span> <span data-ttu-id="44b3b-153">Si no se proporciona ninguno, el sistema genera uno aleatorio:</span><span class="sxs-lookup"><span data-stu-id="44b3b-153">If none is provided, the system generates a random name:</span></span>

```csharp
public string ScreenName
{
   get => _screenName;
   set => _screenName = value ?? GenerateRandomScreenName();
}
private string _screenName;
```

<span data-ttu-id="44b3b-154">Al compilar el código anterior en un contexto en el que se desconocen los valores NULL, todo es correcto.</span><span class="sxs-lookup"><span data-stu-id="44b3b-154">When you compile the preceding code in a nullable oblivious context, everything is fine.</span></span> <span data-ttu-id="44b3b-155">Una vez que se habilitan los tipos de referencia que admiten un valor NULL, la propiedad `ScreenName` se convierte en una referencia que no acepta valores NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-155">Once you enable nullable reference types, the `ScreenName` property becomes a non-nullable reference.</span></span> <span data-ttu-id="44b3b-156">Eso es correcto para el descriptor de acceso `get`: nunca devuelve `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-156">That's correct for the `get` accessor: it never returns `null`.</span></span> <span data-ttu-id="44b3b-157">No es necesario que los autores de la llamada comprueben `null` en la propiedad devuelta.</span><span class="sxs-lookup"><span data-stu-id="44b3b-157">Callers don't need to check the returned property for `null`.</span></span> <span data-ttu-id="44b3b-158">Pero ahora, al establecer la propiedad en `null`, se genera una advertencia.</span><span class="sxs-lookup"><span data-stu-id="44b3b-158">But now setting the property to `null` generates a warning.</span></span> <span data-ttu-id="44b3b-159">Para admitir este tipo de código, agregue el atributo <xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute?displayProperty=nameWithType> a la propiedad, como se muestra en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="44b3b-159">To support this type of code, you add the <xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute?displayProperty=nameWithType> attribute to the property, as shown in the following code:</span></span>

```csharp
[AllowNull]
public string ScreenName
{
   get => _screenName;
   set => _screenName = value ?? GenerateRandomScreenName();
}
private string _screenName = GenerateRandomScreenName();
```

<span data-ttu-id="44b3b-160">Es posible que tenga que agregar una directiva `using` para <xref:System.Diagnostics.CodeAnalysis> a fin de usar este y otros atributos descritos en este artículo.</span><span class="sxs-lookup"><span data-stu-id="44b3b-160">You may need to add a `using` directive for <xref:System.Diagnostics.CodeAnalysis> to use this and other attributes discussed in this article.</span></span> <span data-ttu-id="44b3b-161">El atributo se aplica a la propiedad, no al descriptor de acceso `set`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-161">The attribute is applied to the property, not the `set` accessor.</span></span> <span data-ttu-id="44b3b-162">El atributo `AllowNull` especifica *condiciones previas* y solo se aplica a las entradas.</span><span class="sxs-lookup"><span data-stu-id="44b3b-162">The `AllowNull` attribute specifies *pre-conditions*, and only applies to inputs.</span></span> <span data-ttu-id="44b3b-163">El descriptor de acceso `get` tiene un valor devuelto, pero no tiene argumentos de entrada.</span><span class="sxs-lookup"><span data-stu-id="44b3b-163">The `get` accessor has a return value, but no input arguments.</span></span> <span data-ttu-id="44b3b-164">Por tanto, el atributo `AllowNull` solo se aplica al descriptor de acceso `set`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-164">Therefore, the `AllowNull` attribute only applies to the `set` accessor.</span></span>

<span data-ttu-id="44b3b-165">En el ejemplo anterior se muestra qué se debe buscar al agregar el atributo `AllowNull` en un argumento:</span><span class="sxs-lookup"><span data-stu-id="44b3b-165">The preceding example demonstrates what to look for when adding the `AllowNull` attribute on an argument:</span></span>

1. <span data-ttu-id="44b3b-166">El contrato general para esa variable es que no debe ser `null`, por lo que quiere un tipo de referencia que no acepte valores NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-166">The general contract for that variable is that it shouldn't be `null`, so you want a non-nullable reference type.</span></span>
1. <span data-ttu-id="44b3b-167">Hay escenarios para que la variable de entrada sea `null`, aunque no sean el uso más común.</span><span class="sxs-lookup"><span data-stu-id="44b3b-167">There are scenarios for the input variable to be `null`, though they aren't the most common usage.</span></span>

<span data-ttu-id="44b3b-168">En la mayoría de los casos necesitará este atributo para las propiedades, o bien para los argumentos `in`, `out` y `ref`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-168">Most often you'll need this attribute for properties, or `in`, `out`, and `ref` arguments.</span></span> <span data-ttu-id="44b3b-169">El atributo `AllowNull` es la mejor opción cuando una variable normalmente no es NULL, pero debe permitir `null` como condición previa.</span><span class="sxs-lookup"><span data-stu-id="44b3b-169">The `AllowNull` attribute is the best choice when a variable is typically non-null, but you need to allow `null` as a precondition.</span></span>

<span data-ttu-id="44b3b-170">Compare esto con los escenarios para usar `DisallowNull`: este atributo se usa para especificar que una variable de entrada de un tipo de referencia que admite un valor NULL no debe ser `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-170">Contrast that with scenarios for using `DisallowNull`: You use this attribute to specify that an input variable of a nullable reference type shouldn't be `null`.</span></span> <span data-ttu-id="44b3b-171">Considere una propiedad donde `null` es el valor predeterminado, pero los clientes solo pueden establecerla en un valor que no sea NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-171">Consider a property where `null` is the default value, but clients can only set it to a non-null value.</span></span> <span data-ttu-id="44b3b-172">Observe el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="44b3b-172">Consider the following code:</span></span>

```csharp
public string ReviewComment
{
    get => _comment;
    set => _comment = value ?? throw new ArgumentNullException(nameof(value), "Cannot set to null");
}
string _comment;
```

<span data-ttu-id="44b3b-173">El código anterior es la mejor manera de expresar el diseño de que `ReviewComment` pueda ser `null`, pero no se puede establecer en `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-173">The preceding code is the best way to express your design that the `ReviewComment` could be `null`, but can't be set to `null`.</span></span> <span data-ttu-id="44b3b-174">Una vez que este código admita valores NULL, puede expresar este concepto con más claridad para los autores de la llamada mediante <xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute?displayProperty=nameWithType>:</span><span class="sxs-lookup"><span data-stu-id="44b3b-174">Once this code is nullable aware, you can express this concept more clearly to callers using the <xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute?displayProperty=nameWithType>:</span></span>

```csharp
[DisallowNull]
public string? ReviewComment
{
    get => _comment;
    set => _comment = value ?? throw new ArgumentNullException(nameof(value), "Cannot set to null");
}
string? _comment;
```

<span data-ttu-id="44b3b-175">En un contexto que admite un valor NULL, el descriptor de acceso `get` de `ReviewComment` podría devolver el valor predeterminado de `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-175">In a nullable context, the `ReviewComment` `get` accessor could return the default value of `null`.</span></span> <span data-ttu-id="44b3b-176">El compilador advierte que se debe comprobar antes del acceso.</span><span class="sxs-lookup"><span data-stu-id="44b3b-176">The compiler warns that it must be checked before access.</span></span> <span data-ttu-id="44b3b-177">Además, advierte a los autores de la llamada que, aunque podría ser `null`, no deberían establecerlo de forma explícita en `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-177">Furthermore, it warns callers that, even though it could be `null`, callers shouldn't explicitly set it to `null`.</span></span> <span data-ttu-id="44b3b-178">El atributo `DisallowNull` también especifica una *condición previa*, no afecta al descriptor de acceso `get`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-178">The `DisallowNull` attribute also specifies a *pre-condition*, it doesn't affect the `get` accessor.</span></span> <span data-ttu-id="44b3b-179">Use el atributo `DisallowNull` cuando observe estas características:</span><span class="sxs-lookup"><span data-stu-id="44b3b-179">You use the `DisallowNull` attribute when you observe these characteristics about:</span></span>

1. <span data-ttu-id="44b3b-180">La variable podría ser `null` en escenarios principales, a menudo cuando se crea su primera instancia.</span><span class="sxs-lookup"><span data-stu-id="44b3b-180">The variable could be `null` in core scenarios, often when first instantiated.</span></span>
1. <span data-ttu-id="44b3b-181">La variable no se debe establecer de forma explícita en `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-181">The variable shouldn't be explicitly set to `null`.</span></span>

<span data-ttu-id="44b3b-182">Estas situaciones son comunes en el código en el que originalmente *se desconocían los valores NULL*.</span><span class="sxs-lookup"><span data-stu-id="44b3b-182">These situations are common in code that was originally *null oblivious*.</span></span> <span data-ttu-id="44b3b-183">Es posible que las propiedades de objeto se establezcan en dos operaciones de inicialización distintas.</span><span class="sxs-lookup"><span data-stu-id="44b3b-183">It may be that object properties are set in two distinct initialization operations.</span></span> <span data-ttu-id="44b3b-184">Es posible que algunas propiedades se establezcan solo después de que se haya completado algún trabajo asincrónico.</span><span class="sxs-lookup"><span data-stu-id="44b3b-184">It may be that some properties are set only after some asynchronous work has completed.</span></span>

<span data-ttu-id="44b3b-185">Los atributos `AllowNull` y `DisallowNull` permiten especificar que las condiciones previas de las variables puedan no coincidir con las anotaciones que admiten un valor NULL en esas variables.</span><span class="sxs-lookup"><span data-stu-id="44b3b-185">The `AllowNull` and `DisallowNull` attributes enable you to specify that preconditions on variables may not match the nullable annotations on those variables.</span></span> <span data-ttu-id="44b3b-186">Proporcionan más detalles sobre las características de la API.</span><span class="sxs-lookup"><span data-stu-id="44b3b-186">These provide more detail about the characteristics of your API.</span></span> <span data-ttu-id="44b3b-187">Esta información adicional ayuda a los autores de la llamada a usar la API de manera correcta.</span><span class="sxs-lookup"><span data-stu-id="44b3b-187">This additional information helps callers use your API correctly.</span></span> <span data-ttu-id="44b3b-188">Recuerde que debe especificar las condiciones previas mediante los atributos siguientes:</span><span class="sxs-lookup"><span data-stu-id="44b3b-188">Remember you specify preconditions using the following attributes:</span></span>

- <span data-ttu-id="44b3b-189">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): un argumento de entrada que no acepta valores NULL puede ser NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-189">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="44b3b-190">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): un argumento de entrada que admite un valor NULL nunca debe ser NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-190">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>

## <a name="specify-post-conditions-maybenull-and-notnull"></a><span data-ttu-id="44b3b-191">Especificación de condiciones posteriores: `MaybeNull` y `NotNull`</span><span class="sxs-lookup"><span data-stu-id="44b3b-191">Specify post-conditions: `MaybeNull` and `NotNull`</span></span>

<span data-ttu-id="44b3b-192">Imagine que tiene un método con la siguiente firma:</span><span class="sxs-lookup"><span data-stu-id="44b3b-192">Suppose you have a method with the following signature:</span></span>

```csharp
public Customer FindCustomer(string lastName, string firstName)
```

<span data-ttu-id="44b3b-193">Probablemente haya escrito un método como este para devolver `null` cuando no se encuentra el nombre que se busca.</span><span class="sxs-lookup"><span data-stu-id="44b3b-193">You've likely written a method like this to return `null` when the name sought wasn't found.</span></span> <span data-ttu-id="44b3b-194">`null` indica claramente que no se ha encontrado el registro.</span><span class="sxs-lookup"><span data-stu-id="44b3b-194">The `null` clearly indicates that the record wasn't found.</span></span> <span data-ttu-id="44b3b-195">En este ejemplo, es probable que cambie el tipo de valor devuelto de `Customer` a `Customer?`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-195">In this example, you'd likely change the return type from `Customer` to `Customer?`.</span></span> <span data-ttu-id="44b3b-196">Al declarar el valor devuelto como un tipo de referencia que admite un valor NULL, se especifica claramente la intención de esta API.</span><span class="sxs-lookup"><span data-stu-id="44b3b-196">Declaring the return value as a nullable reference type specifies the intent of this API clearly.</span></span>

<span data-ttu-id="44b3b-197">Por los motivos descritos en [Definiciones genéricas y nulabilidad](../../nullable-migration-strategies.md#generic-definitions-and-nullability), esa técnica no funciona con los métodos genéricos.</span><span class="sxs-lookup"><span data-stu-id="44b3b-197">For reasons covered under [Generic definitions and nullability](../../nullable-migration-strategies.md#generic-definitions-and-nullability) that technique doesn't work with generic methods.</span></span> <span data-ttu-id="44b3b-198">Puede tener un método genérico que siga un patrón similar:</span><span class="sxs-lookup"><span data-stu-id="44b3b-198">You may have a generic method that follows a similar pattern:</span></span>

```csharp
public T Find<T>(IEnumerable<T> sequence, Func<T, bool> predicate)
```

<span data-ttu-id="44b3b-199">No puede especificar que el valor devuelto sea `T?`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-199">You can't specify that the return value is `T?`.</span></span> <span data-ttu-id="44b3b-200">El método devuelve `null` cuando no se encuentra el elemento buscado.</span><span class="sxs-lookup"><span data-stu-id="44b3b-200">The method returns `null` when the sought item isn't found.</span></span> <span data-ttu-id="44b3b-201">Como no puede declarar un tipo de valor devuelto `T?`, agregue la anotación `MaybeNull` al valor devuelto del método:</span><span class="sxs-lookup"><span data-stu-id="44b3b-201">Since you can't declare a `T?` return type, you add the `MaybeNull` annotation to the method return:</span></span>

```csharp
[return: MaybeNull]
public T Find<T>(IEnumerable<T> sequence, Func<T, bool> predicate)
```

<span data-ttu-id="44b3b-202">El código anterior informa a los autores de la llamada de que el contrato implica un tipo que no acepta valores NULL, pero el valor devuelto *puede* realmente ser NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-202">The preceding code informs callers that the contract implies a non-nullable type, but the return value *may* actually be null.</span></span>  <span data-ttu-id="44b3b-203">Use el atributo `MaybeNull` cuando la API deba ser un tipo que no acepta valores NULL, normalmente un parámetro de tipo genérico, pero puede haber casos en los que se devuelva `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-203">Use the `MaybeNull` attribute when your API should be a non-nullable type, typically a generic type parameter, but there may be instances where `null` would be returned.</span></span>

<span data-ttu-id="44b3b-204">También puede especificar que un valor devuelto o un argumento `out` o `ref` no sea NULL aunque el tipo sea un tipo de referencia que admite un valor NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-204">You can also specify that a return value or an `out` or `ref` argument isn't null even though the type is a nullable reference type.</span></span> <span data-ttu-id="44b3b-205">Considere un método que garantiza que una matriz es lo suficientemente grande como para contener un número de elementos.</span><span class="sxs-lookup"><span data-stu-id="44b3b-205">Consider a method that ensures an array is large enough to hold a number of elements.</span></span> <span data-ttu-id="44b3b-206">Si el argumento de entrada no tiene capacidad, la rutina asignará una nueva matriz y copiará todos los elementos existentes en ella.</span><span class="sxs-lookup"><span data-stu-id="44b3b-206">If the input argument doesn't have capacity, the routine would allocate a new array and copy all the existing elements into it.</span></span> <span data-ttu-id="44b3b-207">Si el argumento de entrada es `null`, la rutina asignará un almacenamiento nuevo.</span><span class="sxs-lookup"><span data-stu-id="44b3b-207">If the input argument is `null`, the routine would allocate new storage.</span></span> <span data-ttu-id="44b3b-208">Si hay capacidad suficiente, la rutina no hace nada:</span><span class="sxs-lookup"><span data-stu-id="44b3b-208">If there's sufficient capacity, the routine does nothing:</span></span>

```csharp
public void EnsureCapacity<T>(ref T[] storage, int size)
```

<span data-ttu-id="44b3b-209">Puede llamar a esta rutina de esta forma:</span><span class="sxs-lookup"><span data-stu-id="44b3b-209">You could call this routine as follows:</span></span>

```csharp
// messages has the default value (null) when EnsureCapacity is called:
EnsureCapacity<string>(ref messages, 10);
// messages is not null.
EnsureCapacity<string>(messages, 50);
```

<span data-ttu-id="44b3b-210">Después de habilitar los tipos de referencia NULL, querrá asegurarse de que el código anterior se compila sin advertencias.</span><span class="sxs-lookup"><span data-stu-id="44b3b-210">After enabling null reference types, you want to ensure that the preceding code compiles without warnings.</span></span> <span data-ttu-id="44b3b-211">Cuando el método devuelve un valor, se garantiza que el argumento `storage` no es NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-211">When the method returns, the `storage` argument is guaranteed to be not null.</span></span> <span data-ttu-id="44b3b-212">Pero es aceptable llamar a `EnsureCapacity` con una referencia nula.</span><span class="sxs-lookup"><span data-stu-id="44b3b-212">However, it's acceptable to call `EnsureCapacity` with a null reference.</span></span> <span data-ttu-id="44b3b-213">Puede convertir a `storage` en un tipo de referencia que acepte valores NULL y agregar la condición posterior `NotNull` a la declaración del parámetro:</span><span class="sxs-lookup"><span data-stu-id="44b3b-213">You can make `storage` a nullable reference type, and add the `NotNull` post-condition to the parameter declaration:</span></span>

```csharp
public void EnsureCapacity<T>([NotNull] ref T[]? storage, int size)
```

<span data-ttu-id="44b3b-214">En el código anterior se expresa con claridad el contrato existente: Los autores de la llamada pueden pasar una variable con el valor `null`, pero se garantiza que el valor devuelto nunca será NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-214">The preceding code expresses the existing contract clearly: Callers can pass a variable with the `null` value, but the return value is guaranteed to never be null.</span></span> <span data-ttu-id="44b3b-215">El atributo `NotNull` es muy útil para los argumentos `ref` y `out`, donde `null` se puede pasar como argumento, pero se garantiza que ese argumento no será NULL cuando el método devuelva un valor.</span><span class="sxs-lookup"><span data-stu-id="44b3b-215">The `NotNull` attribute is most useful for `ref` and `out` arguments where `null` may be passed as an argument, but that argument is guaranteed to be not null when the method returns.</span></span>

<span data-ttu-id="44b3b-216">Las condiciones posteriores condicionales se especifican mediante los atributos siguientes:</span><span class="sxs-lookup"><span data-stu-id="44b3b-216">You specify unconditional postconditions using the following attributes:</span></span>

- <span data-ttu-id="44b3b-217">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): un valor devuelto que no acepta valores NULL puede ser NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-217">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="44b3b-218">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): un valor devuelto que admite un valor NULL nunca será NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-218">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>

## <a name="specify-conditional-post-conditions-notnullwhen-maybenullwhen-and-notnullifnotnull"></a><span data-ttu-id="44b3b-219">Especificación de condiciones posteriores condicionales: `NotNullWhen`, `MaybeNullWhen` y `NotNullIfNotNull`</span><span class="sxs-lookup"><span data-stu-id="44b3b-219">Specify conditional post-conditions: `NotNullWhen`, `MaybeNullWhen`, and `NotNullIfNotNull`</span></span>

<span data-ttu-id="44b3b-220">Es probable que esté familiarizado con el método `string` de <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="44b3b-220">You're likely familiar with the `string` method <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType>.</span></span> <span data-ttu-id="44b3b-221">Este método devuelve `true` cuando el argumento es NULL o una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="44b3b-221">This method returns `true` when the argument is null or an empty string.</span></span> <span data-ttu-id="44b3b-222">Es una forma de comprobación de valores NULL: No es necesario que los autores de la llamada comprueben los valores NULL del argumento si el método devuelve `false`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-222">It's a form of null-check: Callers don't need to null-check the argument if the method returns `false`.</span></span> <span data-ttu-id="44b3b-223">Para hacer que un método como este admita valores NULL, tendría que establecer el argumento en un tipo de referencia que admite un valor NULL y agregar el atributo `NotNullWhen`:</span><span class="sxs-lookup"><span data-stu-id="44b3b-223">To make a method like this nullable aware, you'd set the argument to a nullable reference type, and add the `NotNullWhen` attribute:</span></span>

```csharp
bool IsNullOrEmpty([NotNullWhen(false)] string? value);
```

<span data-ttu-id="44b3b-224">Esto informa al compilador de que no es necesario comprobar los valores NULL en el código cuyo valor devuelto sea `false`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-224">That informs the compiler that any code where the return value is `false` doesn't need null checks.</span></span> <span data-ttu-id="44b3b-225">La adición del atributo informa al análisis estático del compilador que `IsNullOrEmpty` realiza la comprobación de valores NULL necesaria: cuando devuelve `false`, el argumento de entrada no es `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-225">The addition of the attribute informs the compiler's static analysis that `IsNullOrEmpty` performs the necessary null check: when it returns `false`, the input argument isn't `null`.</span></span>

```csharp
string? userInput = GetUserInput();
if (!string.IsNullOrEmpty(userInput))
{
   int messageLength = userInput.Length; // no null check needed.
}
// null check needed on userInput here.
```

<span data-ttu-id="44b3b-226">El método <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType> se anotará como se ha mostrado antes para .NET Core 3.0.</span><span class="sxs-lookup"><span data-stu-id="44b3b-226">The <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType> method will be annotated as shown above for .NET Core 3.0.</span></span> <span data-ttu-id="44b3b-227">Es posible que tenga métodos similares en el código base que comprueben valores NULL en el estado de los objetos.</span><span class="sxs-lookup"><span data-stu-id="44b3b-227">You may have similar methods in your codebase that check the state of objects for null values.</span></span> <span data-ttu-id="44b3b-228">El compilador no reconocerá los métodos de comprobación de valores NULL personalizados y tendrá que agregar personalmente las anotaciones.</span><span class="sxs-lookup"><span data-stu-id="44b3b-228">The compiler won't recognize custom null check methods, and you'll need to add the annotations yourself.</span></span> <span data-ttu-id="44b3b-229">Al agregar el atributo, el análisis estático del compilador sabe cuándo se han comprobado los valores NULL en la variable.</span><span class="sxs-lookup"><span data-stu-id="44b3b-229">When you add the attribute, the compiler's static analysis knows when the tested variable has been null checked.</span></span>

<span data-ttu-id="44b3b-230">Otro uso de estos atributos es el patrón `Try*`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-230">Another use for these attributes is the `Try*` pattern.</span></span> <span data-ttu-id="44b3b-231">Las condiciones posteriores para las variables `ref` y `out` se comunican a través del valor devuelto.</span><span class="sxs-lookup"><span data-stu-id="44b3b-231">The postconditions for `ref` and `out` variables are communicated through the return value.</span></span> <span data-ttu-id="44b3b-232">Observe este método mostrado antes:</span><span class="sxs-lookup"><span data-stu-id="44b3b-232">Consider this method shown earlier:</span></span>

```csharp
bool TryGetMessage(string key, out string message)
```

<span data-ttu-id="44b3b-233">El método anterior sigue una expresión de .NET típica: el valor devuelto indica si `message` se ha establecido en el valor encontrado o, si no se ha encontrado ningún mensaje, en el valor predeterminado.</span><span class="sxs-lookup"><span data-stu-id="44b3b-233">The preceding method follows a typical .NET idiom: the return value indicates if `message` was set to the found value or, if no message is found, to the default value.</span></span> <span data-ttu-id="44b3b-234">Si el método devuelve `true`, el valor de `message` no es NULL; de lo contrario, el método establece `message` en NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-234">If the method returns `true`, the value of `message` isn't null; otherwise, the method sets `message` to null.</span></span>

<span data-ttu-id="44b3b-235">Puede comunicar esa expresión mediante el atributo `NotNullWhen`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-235">You can communicate that idiom using the `NotNullWhen` attribute.</span></span> <span data-ttu-id="44b3b-236">Al actualizar la firma para los tipos de referencia que admiten un valor NULL, convierta `message` en `string?` y agregue un atributo:</span><span class="sxs-lookup"><span data-stu-id="44b3b-236">When you update the signature for nullable reference types, make `message` a `string?` and add an attribute:</span></span>

```csharp
bool TryGetMessage(string key, [NotNullWhen(true)] out string? message)
```

<span data-ttu-id="44b3b-237">En el ejemplo anterior, se sabe que el valor de `message` no es NULL cuando `TryGetMessage` devuelve `true`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-237">In the preceding example, the value of `message` is known to be not null when `TryGetMessage` returns `true`.</span></span> <span data-ttu-id="44b3b-238">Debe anotar de la misma forma los métodos similares en el código base: los argumentos pueden ser `null`, y se sabe que no son NULL cuando el método devuelve `true`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-238">You should annotate similar methods in your codebase in the same way: the arguments could be `null`, and are known to be not null when the method returns `true`.</span></span>

<span data-ttu-id="44b3b-239">Hay un atributo final que también puede necesitar.</span><span class="sxs-lookup"><span data-stu-id="44b3b-239">There's one final attribute you may also need.</span></span> <span data-ttu-id="44b3b-240">En ocasiones, el estado NULL de un valor devuelto depende del estado NULL de uno o más argumentos de entrada.</span><span class="sxs-lookup"><span data-stu-id="44b3b-240">Sometimes the null state of a return value depends on the null state of one or more input arguments.</span></span> <span data-ttu-id="44b3b-241">Estos métodos devolverán un valor no NULL siempre que determinados argumentos de entrada no sean `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-241">These methods will return a non-null value whenever certain input arguments aren't `null`.</span></span> <span data-ttu-id="44b3b-242">Para anotar correctamente estos métodos, use el atributo `NotNullIfNotNull`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-242">To correctly annotate these methods, you use the `NotNullIfNotNull` attribute.</span></span> <span data-ttu-id="44b3b-243">Observe el método siguiente:</span><span class="sxs-lookup"><span data-stu-id="44b3b-243">Consider the following method:</span></span>

```csharp
string GetTopLevelDomainFromFullUrl(string url);
```

<span data-ttu-id="44b3b-244">Si el argumento `url` no es NULL, el resultado no es `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-244">If the `url` argument isn't null, the output isn't `null`.</span></span> <span data-ttu-id="44b3b-245">Una vez que se hayan habilitado las referencias nulas, esa firma funcionará correctamente, siempre que la API no acepte nunca una entrada NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-245">Once nullable references are enabled, that signature works correctly, provided your API never accepts a null input.</span></span> <span data-ttu-id="44b3b-246">Pero si la entrada puede ser NULL, el valor devuelto también podría serlo.</span><span class="sxs-lookup"><span data-stu-id="44b3b-246">However, if the input could be null, then return value could also be null.</span></span> <span data-ttu-id="44b3b-247">Podría cambiar la firma por el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="44b3b-247">You could change the signature to the following code:</span></span>

```csharp
string? GetTopLevelDomainFromFullUrl(string? url);
```

<span data-ttu-id="44b3b-248">Esto también funciona, pero a menudo obliga a los autores de la llamada a implementar comprobaciones de `null` adicionales.</span><span class="sxs-lookup"><span data-stu-id="44b3b-248">That also works, but will often force callers to implement extra `null` checks.</span></span> <span data-ttu-id="44b3b-249">El contrato es que el valor devuelto solo será `null` cuando el argumento de entrada `url` sea `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-249">The contract is that the return value would be `null` only when the input argument `url` is `null`.</span></span> <span data-ttu-id="44b3b-250">Para expresar ese contrato, tendría que anotar este método como se muestra en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="44b3b-250">To express that contract, you would annotate this method as shown in the following code:</span></span>

```csharp
[return: NotNullIfNotNull("url")]
string? GetTopLevelDomainFromFullUrl(string? url);
```

<span data-ttu-id="44b3b-251">El valor devuelto y el argumento se han anotado con `?`, lo que indica que cualquiera podría ser `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-251">The return value and the argument have both been annotated with the `?` indicating that either could be `null`.</span></span> <span data-ttu-id="44b3b-252">El atributo aclara todavía más que el valor devuelto no será NULL cuando el argumento `url` no sea `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-252">The attribute further clarifies that the return value won't be null when the `url` argument isn't `null`.</span></span>

<span data-ttu-id="44b3b-253">Las condiciones posteriores condicionales se especifican mediante estos atributos:</span><span class="sxs-lookup"><span data-stu-id="44b3b-253">You specify conditional postconditions using these attributes:</span></span>

- <span data-ttu-id="44b3b-254">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): un argumento de entrada que no acepta valores NULL puede ser NULL cuando el método devuelve el valor `bool` especificado.</span><span class="sxs-lookup"><span data-stu-id="44b3b-254">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="44b3b-255">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): un argumento de entrada que admite un valor NULL nunca será NULL cuando el método devuelva el valor `bool` especificado.</span><span class="sxs-lookup"><span data-stu-id="44b3b-255">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument won't be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="44b3b-256">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): un valor devuelto no es NULL si el argumento de entrada del parámetro especificado no es NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-256">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the input argument for the specified parameter isn't null.</span></span>

## <a name="constructor-helper-methods-membernotnull-and-membernotnullwhen"></a><span data-ttu-id="44b3b-257">Métodos auxiliares de constructor: `MemberNotNull` y `MemberNotNullWhen`</span><span class="sxs-lookup"><span data-stu-id="44b3b-257">Constructor helper methods: `MemberNotNull` and `MemberNotNullWhen`</span></span>

<span data-ttu-id="44b3b-258">Estos atributos especifican su intención cuando se ha refactorizado código común de los constructores en métodos auxiliares.</span><span class="sxs-lookup"><span data-stu-id="44b3b-258">These attributes specify your intent when you've refactored common code from constructors into helper methods.</span></span> <span data-ttu-id="44b3b-259">El compilador de C# analiza los constructores y los inicializadores de campo para asegurarse de que todos los campos de referencia que no aceptan valores NULL se han inicializado antes de que se devuelva cada constructor.</span><span class="sxs-lookup"><span data-stu-id="44b3b-259">The C# compiler analyzes constructors and field initializers to make sure that all non-nullable reference fields have been initialized before each constructor returns.</span></span> <span data-ttu-id="44b3b-260">Sin embargo, el compilador de C# no realiza un seguimiento de las asignaciones de campo a través de todos los métodos auxiliares.</span><span class="sxs-lookup"><span data-stu-id="44b3b-260">However, the C# compiler doesn't track field assignments through all helper methods.</span></span> <span data-ttu-id="44b3b-261">El compilador emite una advertencia `CS8618` cuando los campos no se inicializan directamente en el constructor, sino en un método auxiliar.</span><span class="sxs-lookup"><span data-stu-id="44b3b-261">The compiler issues warning `CS8618` when fields aren't initialized directly in the constructor, but rather in a helper method.</span></span> <span data-ttu-id="44b3b-262">Agrega <xref:System.Diagnostics.CodeAnalysis.MemberNotNullAttribute> a una declaración de método a los campos que se inicializan en un valor distinto de NULL en el método.</span><span class="sxs-lookup"><span data-stu-id="44b3b-262">You add the <xref:System.Diagnostics.CodeAnalysis.MemberNotNullAttribute> to a method declaration to fields that are initialized to a non-null value in the method.</span></span> <span data-ttu-id="44b3b-263">Por ejemplo, considere el siguiente ejemplo:</span><span class="sxs-lookup"><span data-stu-id="44b3b-263">For example, consider the following example:</span></span>

:::code language="csharp" source="snippets/InitializeMembers.cs" ID="MemberNotNullExample":::

<span data-ttu-id="44b3b-264">Puede especificar varios nombres de campo como argumentos para el constructor de atributo `MemberNotNull`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-264">You can specify multiple field names as arguments to the `MemberNotNull` attribute constructor.</span></span>

<span data-ttu-id="44b3b-265"><xref:System.Diagnostics.CodeAnalysis.MemberNotNullWhenAttribute> tiene un argumento `bool`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-265">The <xref:System.Diagnostics.CodeAnalysis.MemberNotNullWhenAttribute> has a `bool` argument.</span></span> <span data-ttu-id="44b3b-266">Utiliza `MemberNotNullWhen` en situaciones en las que el método auxiliar devuelve `bool`, lo cual indica si el método auxiliar ha inicializado los campos.</span><span class="sxs-lookup"><span data-stu-id="44b3b-266">You use `MemberNotNullWhen` in situations where your helper method returns a `bool` indicating whether your helper method initialized fields.</span></span>

## <a name="verify-unreachable-code"></a><span data-ttu-id="44b3b-267">Comprobación de código inaccesible</span><span class="sxs-lookup"><span data-stu-id="44b3b-267">Verify unreachable code</span></span>

<span data-ttu-id="44b3b-268">Algunos métodos, normalmente los asistentes de excepciones u otros métodos de utilidad, siempre salen mediante el inicio de una excepción.</span><span class="sxs-lookup"><span data-stu-id="44b3b-268">Some methods, typically exception helpers or other utility methods, always exit by throwing an exception.</span></span> <span data-ttu-id="44b3b-269">O bien, un asistente puede iniciar una excepción basada en el valor de un argumento booleano.</span><span class="sxs-lookup"><span data-stu-id="44b3b-269">Or, a helper may throw an exception based on the value of a Boolean argument.</span></span>

<span data-ttu-id="44b3b-270">En el primer caso, puede agregar el atributo `DoesNotReturn` a la declaración del método.</span><span class="sxs-lookup"><span data-stu-id="44b3b-270">In the first case, you can add the `DoesNotReturn` attribute to the method declaration.</span></span> <span data-ttu-id="44b3b-271">El compilador le ayuda de tres maneras.</span><span class="sxs-lookup"><span data-stu-id="44b3b-271">The compiler helps you in three ways.</span></span> <span data-ttu-id="44b3b-272">En primer lugar, emite una advertencia si hay una ruta de acceso por la que el método puede salir sin iniciar una excepción.</span><span class="sxs-lookup"><span data-stu-id="44b3b-272">First, the compiler issues a warning if there's a path where the method can exit without throwing an exception.</span></span> <span data-ttu-id="44b3b-273">En segundo lugar, el compilador marca cualquier código después de una llamada a ese método como *inaccesible*, hasta que se encuentre una cláusula `catch` adecuada.</span><span class="sxs-lookup"><span data-stu-id="44b3b-273">Second, the compiler marks any code after a call to that method as *unreachable*, until an appropriate `catch` clause is found.</span></span> <span data-ttu-id="44b3b-274">Por último, el código inaccesible no afectará a ningún estado NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-274">Third, the unreachable code won't affect any null states.</span></span> <span data-ttu-id="44b3b-275">Considere este método:</span><span class="sxs-lookup"><span data-stu-id="44b3b-275">Consider this method:</span></span>

```csharp
[DoesNotReturn]
private void FailFast()
{
    throw new InvalidOperationException();
}

public void SetState(object containedField)
{
    if (!isInitialized)
    {
        FailFast();
    }

    // unreachable code:
    _field = containedField;
}
```

<span data-ttu-id="44b3b-276">En el segundo caso, se agrega el atributo `DoesNotReturnIf` a un parámetro booleano del método.</span><span class="sxs-lookup"><span data-stu-id="44b3b-276">In the second case, you add the `DoesNotReturnIf` attribute to a Boolean parameter of the method.</span></span> <span data-ttu-id="44b3b-277">Puede modificar el ejemplo anterior de esta manera:</span><span class="sxs-lookup"><span data-stu-id="44b3b-277">You can modify the previous example as follows:</span></span>

```csharp
private void FailFast([DoesNotReturnIf(false)] bool isValid)
{
    if (!isValid)
    {
        throw new InvalidOperationException();
    }
}

public void SetState(object containedField)
{
    FailFast(isInitialized);

    // unreachable code when "isInitialized" is false:
    _field = containedField;
}
```

## <a name="summary"></a><span data-ttu-id="44b3b-278">Resumen</span><span class="sxs-lookup"><span data-stu-id="44b3b-278">Summary</span></span>

[!INCLUDE [C# version alert](../../includes/csharp-version-alert.md)]

<span data-ttu-id="44b3b-279">Agregar tipos de referencia que aceptan valores NULL proporciona un vocabulario inicial para describir las expectativas de las API para las variables que podrían ser `null`.</span><span class="sxs-lookup"><span data-stu-id="44b3b-279">Adding nullable reference types provides an initial vocabulary to describe your APIs expectations for variables that could be `null`.</span></span> <span data-ttu-id="44b3b-280">Los atributos proporcionan un vocabulario más completo para describir el estado NULL de las variables como condiciones previas y posteriores.</span><span class="sxs-lookup"><span data-stu-id="44b3b-280">The attributes provide a richer vocabulary to describe the null state of variables as preconditions and postconditions.</span></span> <span data-ttu-id="44b3b-281">Estos atributos describen con más claridad las expectativas y proporcionan una mejor experiencia para los desarrolladores que usan las API.</span><span class="sxs-lookup"><span data-stu-id="44b3b-281">These attributes more clearly describe your expectations and provide a better experience for the developers using your APIs.</span></span>

<span data-ttu-id="44b3b-282">A medida que actualice las bibliotecas para un contexto que admite un valor NULL, agregue estos atributos para guiar a los usuarios de las API al uso correcto.</span><span class="sxs-lookup"><span data-stu-id="44b3b-282">As you update libraries for a nullable context, add these attributes to guide users of your APIs to the correct usage.</span></span> <span data-ttu-id="44b3b-283">Estos atributos ayudan a describir de forma completa el estado NULL de los argumentos de entrada y los valores devueltos:</span><span class="sxs-lookup"><span data-stu-id="44b3b-283">These attributes help you fully describe the null-state of input arguments and return values:</span></span>

- <span data-ttu-id="44b3b-284">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): un argumento de entrada que no acepta valores NULL puede ser NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-284">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="44b3b-285">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): un argumento de entrada que admite un valor NULL nunca debe ser NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-285">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>
- <span data-ttu-id="44b3b-286">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): un valor devuelto que no acepta valores NULL puede ser NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-286">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="44b3b-287">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): un valor devuelto que admite un valor NULL nunca será NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-287">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>
- <span data-ttu-id="44b3b-288">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): un argumento de entrada que no acepta valores NULL puede ser NULL cuando el método devuelve el valor `bool` especificado.</span><span class="sxs-lookup"><span data-stu-id="44b3b-288">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="44b3b-289">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): un argumento de entrada que admite un valor NULL nunca será NULL cuando el método devuelva el valor `bool` especificado.</span><span class="sxs-lookup"><span data-stu-id="44b3b-289">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument won't be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="44b3b-290">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): un valor devuelto no es NULL si el argumento de entrada del parámetro especificado no es NULL.</span><span class="sxs-lookup"><span data-stu-id="44b3b-290">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the input argument for the specified parameter isn't null.</span></span>
- <span data-ttu-id="44b3b-291">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): un método nunca devuelve un valor.</span><span class="sxs-lookup"><span data-stu-id="44b3b-291">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): A method never returns.</span></span> <span data-ttu-id="44b3b-292">Es decir, siempre inicia una excepción.</span><span class="sxs-lookup"><span data-stu-id="44b3b-292">In other words, it always throws an exception.</span></span>
- <span data-ttu-id="44b3b-293">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): este método nunca devuelve un valor si el parámetro `bool` asociado tiene el valor especificado.</span><span class="sxs-lookup"><span data-stu-id="44b3b-293">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): This method never returns if the associated `bool` parameter has the specified value.</span></span>
