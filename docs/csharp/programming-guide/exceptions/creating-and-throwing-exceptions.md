---
title: Creación y producción de excepciones - Guía de programación de C#
description: Aprenda a crear e iniciar excepciones. Se usan excepciones para indicar que se ha producido un error mientras se ejecutaba un programa.
ms.date: 12/09/2020
helpviewer_keywords:
- catching exceptions [C#]
- throwing exceptions [C#]
- exceptions [C#], creating
- exceptions [C#], throwing
ms.assetid: 6bbba495-a115-4c6d-90cc-1f4d7b5f39e2
ms.openlocfilehash: a6998c5b274736b290460808ad4c7cb22be7ebf6
ms.sourcegitcommit: 9b877e160c326577e8aa5ead22a937110d80fa44
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 12/11/2020
ms.locfileid: "97110213"
---
# <a name="creating-and-throwing-exceptions-c-programming-guide"></a><span data-ttu-id="1388a-104">Crear y producir excepciones (Guía de programación de C#)</span><span class="sxs-lookup"><span data-stu-id="1388a-104">Creating and Throwing Exceptions (C# Programming Guide)</span></span>

<span data-ttu-id="1388a-105">Las excepciones se usan para indicar que se ha producido un error mientras se ejecutaba el programa.</span><span class="sxs-lookup"><span data-stu-id="1388a-105">Exceptions are used to indicate that an error has occurred while running the program.</span></span> <span data-ttu-id="1388a-106">Se crean los objetos de excepción que describen un error y, luego, se *producen* con la palabra clave [throw](../../language-reference/keywords/throw.md).</span><span class="sxs-lookup"><span data-stu-id="1388a-106">Exception objects that describe an error are created and then *thrown* with the [throw](../../language-reference/keywords/throw.md) keyword.</span></span> <span data-ttu-id="1388a-107">Después, el tiempo de ejecución busca el controlador de excepciones más compatible.</span><span class="sxs-lookup"><span data-stu-id="1388a-107">The runtime then searches for the most compatible exception handler.</span></span>

<span data-ttu-id="1388a-108">Los programadores deberían producir excepciones cuando una o varias de las siguientes condiciones sean verdaderas:</span><span class="sxs-lookup"><span data-stu-id="1388a-108">Programmers should throw exceptions when one or more of the following conditions are true:</span></span>

- <span data-ttu-id="1388a-109">El método no puede finalizar su función definida.</span><span class="sxs-lookup"><span data-stu-id="1388a-109">The method can't complete its defined functionality.</span></span> <span data-ttu-id="1388a-110">Por ejemplo, si un parámetro de un método tiene un valor no válido:</span><span class="sxs-lookup"><span data-stu-id="1388a-110">For example, if a parameter to a method has an invalid value:</span></span>
  :::code language="csharp" source="snippets/exceptions/Program.cs" ID="CantComplete":::
- <span data-ttu-id="1388a-111">Se realiza una llamada inadecuada a un objeto, en función del estado del objeto.</span><span class="sxs-lookup"><span data-stu-id="1388a-111">An inappropriate call to an object is made, based on the object state.</span></span> <span data-ttu-id="1388a-112">Un ejemplo podría ser intentar escribir en un archivo de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="1388a-112">One example might be trying to write to a read-only file.</span></span> <span data-ttu-id="1388a-113">En los casos en los que un estado de objeto no permite una operación, genere una instancia de <xref:System.InvalidOperationException> o un objeto con base en una derivación de esta clase.</span><span class="sxs-lookup"><span data-stu-id="1388a-113">In cases where an object state doesn't allow an operation, throw an instance of <xref:System.InvalidOperationException> or an object based on a derivation of this class.</span></span> <span data-ttu-id="1388a-114">El código siguiente es un ejemplo de un método que genera un objeto <xref:System.InvalidOperationException>:</span><span class="sxs-lookup"><span data-stu-id="1388a-114">The following code is an example of a method that throws an <xref:System.InvalidOperationException> object:</span></span>
  :::code language="csharp" source="snippets/exceptions/ProgramLog.cs" ID="ProgramLog":::
- <span data-ttu-id="1388a-115">Cuando un argumento de un método genera una excepción.</span><span class="sxs-lookup"><span data-stu-id="1388a-115">When an argument to a method causes an exception.</span></span> <span data-ttu-id="1388a-116">En este caso, se debe detectar la excepción original y se debe crear una instancia de <xref:System.ArgumentException>.</span><span class="sxs-lookup"><span data-stu-id="1388a-116">In this case, the original exception should be caught and an <xref:System.ArgumentException> instance should be created.</span></span> <span data-ttu-id="1388a-117">La excepción original debe pasarse al constructor de <xref:System.ArgumentException> como el parámetro <xref:System.Exception.InnerException%2A>:</span><span class="sxs-lookup"><span data-stu-id="1388a-117">The original exception should be passed to the constructor of the <xref:System.ArgumentException> as the <xref:System.Exception.InnerException%2A> parameter:</span></span>
  :::code language="csharp" source="snippets/exceptions/Program.cs" ID="InvalidArg":::

<span data-ttu-id="1388a-118">Las excepciones contienen una propiedad denominada <xref:System.Exception.StackTrace%2A>.</span><span class="sxs-lookup"><span data-stu-id="1388a-118">Exceptions contain a property named <xref:System.Exception.StackTrace%2A>.</span></span> <span data-ttu-id="1388a-119">Esta cadena contiene el nombre de los métodos de la pila de llamadas actual, junto con el nombre de archivo y el número de la línea en la que se ha producido la excepción para cada método.</span><span class="sxs-lookup"><span data-stu-id="1388a-119">This string contains the name of the methods on the current call stack, together with the file name and line number where the exception was thrown for each method.</span></span> <span data-ttu-id="1388a-120">Common Language Runtime (CLR) crea automáticamente un objeto <xref:System.Exception.StackTrace%2A> desde el punto de la instrucción `throw`, de manera que todas las excepciones se deben producir desde el punto en el que debe comenzar el seguimiento de la pila.</span><span class="sxs-lookup"><span data-stu-id="1388a-120">A <xref:System.Exception.StackTrace%2A> object is created automatically by the common language runtime (CLR) from the point of the `throw` statement, so that exceptions must be thrown from the point where the stack trace should begin.</span></span>

<span data-ttu-id="1388a-121">Todas las excepciones contienen una propiedad denominada <xref:System.Exception.Message%2A>.</span><span class="sxs-lookup"><span data-stu-id="1388a-121">All exceptions contain a property named <xref:System.Exception.Message%2A>.</span></span> <span data-ttu-id="1388a-122">Esta cadena debe establecerse para que explique el motivo de la excepción.</span><span class="sxs-lookup"><span data-stu-id="1388a-122">This string should be set to explain the reason for the exception.</span></span> <span data-ttu-id="1388a-123">No se debe colocar información confidencial en materia de seguridad en el texto del mensaje.</span><span class="sxs-lookup"><span data-stu-id="1388a-123">Information that is sensitive to security shouldn't be put in the message text.</span></span> <span data-ttu-id="1388a-124">Además de <xref:System.Exception.Message%2A>, <xref:System.ArgumentException> contiene una propiedad denominada <xref:System.ArgumentException.ParamName%2A> que debe establecerse en el nombre del argumento que ha provocado que se genere la excepción.</span><span class="sxs-lookup"><span data-stu-id="1388a-124">In addition to <xref:System.Exception.Message%2A>, <xref:System.ArgumentException> contains a property named <xref:System.ArgumentException.ParamName%2A> that should be set to the name of the argument that caused the exception to be thrown.</span></span> <span data-ttu-id="1388a-125">En un establecedor de propiedades, <xref:System.ArgumentException.ParamName%2A> debe establecerse en `value`.</span><span class="sxs-lookup"><span data-stu-id="1388a-125">In a property setter, <xref:System.ArgumentException.ParamName%2A> should be set to `value`.</span></span>

<span data-ttu-id="1388a-126">Los métodos públicos y protegidos generan excepciones siempre que no puedan finalizar sus funciones previstas.</span><span class="sxs-lookup"><span data-stu-id="1388a-126">Public and protected methods throw exceptions whenever they can't complete their intended functions.</span></span> <span data-ttu-id="1388a-127">La clase de excepciones generada es la excepción más específica disponible que se ajuste a las condiciones de error.</span><span class="sxs-lookup"><span data-stu-id="1388a-127">The exception class thrown is the most specific exception available that fits the error conditions.</span></span> <span data-ttu-id="1388a-128">Estas excepciones se deben documentar como parte de la funcionalidad de la clase, y las clases derivadas o actualizaciones de la clase original deben mantener el mismo comportamiento para la compatibilidad con versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="1388a-128">These exceptions should be documented as part of the class functionality, and derived classes or updates to the original class should retain the same behavior for backward compatibility.</span></span>

## <a name="things-to-avoid-when-throwing-exceptions"></a><span data-ttu-id="1388a-129">Aspectos que se deben evitar al producir excepciones</span><span class="sxs-lookup"><span data-stu-id="1388a-129">Things to Avoid When Throwing Exceptions</span></span>

<span data-ttu-id="1388a-130">En la siguiente lista se identifican los procedimientos que se deben evitar al producir excepciones:</span><span class="sxs-lookup"><span data-stu-id="1388a-130">The following list identifies practices to avoid when throwing exceptions:</span></span>

- <span data-ttu-id="1388a-131">No use excepciones para cambiar el flujo de un programa como parte de la ejecución normal.</span><span class="sxs-lookup"><span data-stu-id="1388a-131">Don't use exceptions to change the flow of a program as part of ordinary execution.</span></span> <span data-ttu-id="1388a-132">Use excepciones para notificar y controlar condiciones de error.</span><span class="sxs-lookup"><span data-stu-id="1388a-132">Use exceptions to report and handle error conditions.</span></span>
- <span data-ttu-id="1388a-133">Las excepciones no se deben devolver como un parámetro o valor devuelto en lugar de producirse.</span><span class="sxs-lookup"><span data-stu-id="1388a-133">Exceptions shouldn't be returned as a return value or parameter instead of being thrown.</span></span>
- <span data-ttu-id="1388a-134">No genere <xref:System.Exception?displayProperty=nameWithType>, <xref:System.SystemException?displayProperty=nameWithType>, <xref:System.NullReferenceException?displayProperty=nameWithType> ni <xref:System.IndexOutOfRangeException?displayProperty=nameWithType> de manera intencionada desde su propio código fuente.</span><span class="sxs-lookup"><span data-stu-id="1388a-134">Don't throw <xref:System.Exception?displayProperty=nameWithType>, <xref:System.SystemException?displayProperty=nameWithType>, <xref:System.NullReferenceException?displayProperty=nameWithType>, or <xref:System.IndexOutOfRangeException?displayProperty=nameWithType> intentionally from your own source code.</span></span>
- <span data-ttu-id="1388a-135">No cree excepciones que se puedan producir en el modo de depuración, pero no en el modo de lanzamiento.</span><span class="sxs-lookup"><span data-stu-id="1388a-135">Don't create exceptions that can be thrown in debug mode but not release mode.</span></span> <span data-ttu-id="1388a-136">Para identificar los errores en tiempo de ejecución durante la fase de desarrollo, use la aserción de depuración.</span><span class="sxs-lookup"><span data-stu-id="1388a-136">To identify run-time errors during the development phase, use Debug Assert instead.</span></span>

## <a name="defining-exception-classes"></a><span data-ttu-id="1388a-137">Definir clases de excepción</span><span class="sxs-lookup"><span data-stu-id="1388a-137">Defining Exception Classes</span></span>

<span data-ttu-id="1388a-138">Los programas pueden producir una clase de excepción predefinida en el espacio de nombres <xref:System> (excepto en los casos indicados anteriormente) o crear sus propias clases de excepción mediante la derivación de <xref:System.Exception>.</span><span class="sxs-lookup"><span data-stu-id="1388a-138">Programs can throw a predefined exception class in the <xref:System> namespace (except where previously noted), or create their own exception classes by deriving from <xref:System.Exception>.</span></span> <span data-ttu-id="1388a-139">Las clases derivadas deben definir al menos cuatro constructores: un constructor sin parámetros, uno que establezca la propiedad de mensaje y otro que establezca las propiedades <xref:System.Exception.Message%2A> y <xref:System.Exception.InnerException%2A>.</span><span class="sxs-lookup"><span data-stu-id="1388a-139">The derived classes should define at least four constructors: one parameterless constructor, one that sets the message property, and one that sets both the <xref:System.Exception.Message%2A> and <xref:System.Exception.InnerException%2A> properties.</span></span> <span data-ttu-id="1388a-140">El cuarto constructor se usa para serializar la excepción.</span><span class="sxs-lookup"><span data-stu-id="1388a-140">The fourth constructor is used to serialize the exception.</span></span> <span data-ttu-id="1388a-141">Las nuevas clases de excepción deben ser serializables.</span><span class="sxs-lookup"><span data-stu-id="1388a-141">New exception classes should be serializable.</span></span> <span data-ttu-id="1388a-142">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="1388a-142">For example:</span></span>

:::code language="csharp" source="snippets/exceptions/InvalidDepartmentException.cs" id="DefineExceptionClass":::

<span data-ttu-id="1388a-143">Agregue propiedades nuevas a la clase de excepción cuando los datos que proporcionan sean útiles para resolver la excepción.</span><span class="sxs-lookup"><span data-stu-id="1388a-143">Add new properties to the exception class when the data they provide is useful to resolving the exception.</span></span> <span data-ttu-id="1388a-144">Si se agregan nuevas propiedades a la clase de excepción derivada, se debe invalidar `ToString()` para devolver la información agregada.</span><span class="sxs-lookup"><span data-stu-id="1388a-144">If new properties are added to the derived exception class, `ToString()` should be overridden to return the added information.</span></span>

## <a name="c-language-specification"></a><span data-ttu-id="1388a-145">Especificación del lenguaje C#</span><span class="sxs-lookup"><span data-stu-id="1388a-145">C# Language Specification</span></span>

<span data-ttu-id="1388a-146">Para obtener más información, vea las secciones [Excepciones](~/_csharplang/spec/exceptions.md) y [La instrucción throw](~/_csharplang/spec/statements.md#the-throw-statement) de la [Especificación del lenguaje C#](/dotnet/csharp/language-reference/language-specification/introduction).</span><span class="sxs-lookup"><span data-stu-id="1388a-146">For more information, see [Exceptions](~/_csharplang/spec/exceptions.md) and [The throw statement](~/_csharplang/spec/statements.md#the-throw-statement) in the [C# Language Specification](/dotnet/csharp/language-reference/language-specification/introduction).</span></span> <span data-ttu-id="1388a-147">La especificación del lenguaje es la fuente definitiva de la sintaxis y el uso de C#.</span><span class="sxs-lookup"><span data-stu-id="1388a-147">The language specification is the definitive source for C# syntax and usage.</span></span>

## <a name="see-also"></a><span data-ttu-id="1388a-148">Vea también</span><span class="sxs-lookup"><span data-stu-id="1388a-148">See also</span></span>

- [<span data-ttu-id="1388a-149">Jerarquía de excepciones</span><span class="sxs-lookup"><span data-stu-id="1388a-149">Exception Hierarchy</span></span>](../../../standard/exceptions/index.md)
