---
title: 'Utilizar delegados: Guía de programación de C#'
ms.date: 07/20/2015
helpviewer_keywords:
- delegates [C#], how to use
ms.assetid: 99a2fc27-a32e-4a34-921c-e65497520eec
ms.openlocfilehash: dcc73aba738d6296a44c48aad8b66cd6fc7f4a7b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 03/14/2020
ms.locfileid: "77448444"
---
# <a name="using-delegates-c-programming-guide"></a><span data-ttu-id="d8e9a-102">Utilizar delegados (Guía de programación de C#)</span><span class="sxs-lookup"><span data-stu-id="d8e9a-102">Using Delegates (C# Programming Guide)</span></span>

<span data-ttu-id="d8e9a-103">Un [delegado](../../language-reference/builtin-types/reference-types.md) es un tipo que encapsula de forma segura un método, similar a un puntero de función en C y C++.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-103">A [delegate](../../language-reference/builtin-types/reference-types.md) is a type that safely encapsulates a method, similar to a function pointer in C and C++.</span></span> <span data-ttu-id="d8e9a-104">A diferencia de los punteros de función de C, los delegados están orientados a objetos, proporcionan seguridad de tipos y son seguros.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-104">Unlike C function pointers, delegates are object-oriented, type safe, and secure.</span></span> <span data-ttu-id="d8e9a-105">El tipo de un delegado se define por el nombre del delegado.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-105">The type of a delegate is defined by the name of the delegate.</span></span> <span data-ttu-id="d8e9a-106">En el ejemplo siguiente, se declara un delegado denominado `Del` que puede encapsular un método que toma una [string](../../language-reference/builtin-types/reference-types.md) como argumento y devuelve [void](../../language-reference/builtin-types/void.md):</span><span class="sxs-lookup"><span data-stu-id="d8e9a-106">The following example declares a delegate named `Del` that can encapsulate a method that takes a [string](../../language-reference/builtin-types/reference-types.md) as an argument and returns [void](../../language-reference/builtin-types/void.md):</span></span>

[!code-csharp[csProgGuideDelegates#21](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#21)]

<span data-ttu-id="d8e9a-107">Normalmente, un objeto delegado se construye al proporcionar el nombre del método que el delegado encapsulará o con una [función anónima](../statements-expressions-operators/anonymous-functions.md).</span><span class="sxs-lookup"><span data-stu-id="d8e9a-107">A delegate object is normally constructed by providing the name of the method the delegate will wrap, or with an [anonymous function](../statements-expressions-operators/anonymous-functions.md).</span></span> <span data-ttu-id="d8e9a-108">Una vez que se crea una instancia de delegado, el delegado pasará al método una llamada de método realizada al delegado.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-108">Once a delegate is instantiated, a method call made to the delegate will be passed by the delegate to that method.</span></span> <span data-ttu-id="d8e9a-109">Los parámetros pasados al delegado por el autor de la llamada se pasan a su vez al método, y el valor devuelto desde el método, si lo hubiera, es devuelto por el delegado al autor de la llamada.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-109">The parameters passed to the delegate by the caller are passed to the method, and the return value, if any, from the method is returned to the caller by the delegate.</span></span> <span data-ttu-id="d8e9a-110">Esto se conoce como invocar al delegado.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-110">This is known as invoking the delegate.</span></span> <span data-ttu-id="d8e9a-111">Un delegado con instancias se puede invocar como si fuera el propio método encapsulado.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-111">An instantiated delegate can be invoked as if it were the wrapped method itself.</span></span> <span data-ttu-id="d8e9a-112">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="d8e9a-112">For example:</span></span>

[!code-csharp[csProgGuideDelegates#22](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#22)]  

[!code-csharp[csProgGuideDelegates#23](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#23)]

<span data-ttu-id="d8e9a-113">Los tipos de delegado se derivan de la clase <xref:System.Delegate> en .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-113">Delegate types are derived from the <xref:System.Delegate> class in the .NET Framework.</span></span> <span data-ttu-id="d8e9a-114">Los tipos de delegados son [sealed](../../language-reference/keywords/sealed.md) (no se pueden derivar) y no se pueden derivar clases personalizadas de <xref:System.Delegate>.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-114">Delegate types are [sealed](../../language-reference/keywords/sealed.md)—they cannot be derived from— and it is not possible to derive custom classes from <xref:System.Delegate>.</span></span> <span data-ttu-id="d8e9a-115">Dado que el delegado con instancias es un objeto, puede pasarse como parámetro o asignarse a una propiedad.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-115">Because the instantiated delegate is an object, it can be passed as a parameter, or assigned to a property.</span></span> <span data-ttu-id="d8e9a-116">De este modo, un método puede aceptar un delegado como parámetro y llamar al delegado en algún momento posterior.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-116">This allows a method to accept a delegate as a parameter, and call the delegate at some later time.</span></span> <span data-ttu-id="d8e9a-117">Esto se conoce como devolución de llamada asincrónica y es un método común para notificar a un llamador que un proceso largo ha finalizado.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-117">This is known as an asynchronous callback, and is a common method of notifying a caller when a long process has completed.</span></span> <span data-ttu-id="d8e9a-118">Cuando se utiliza un delegado de esta manera, el código que usa al delegado no necesita ningún conocimiento de la implementación del método empleado.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-118">When a delegate is used in this fashion, the code using the delegate does not need any knowledge of the implementation of the method being used.</span></span> <span data-ttu-id="d8e9a-119">La funcionalidad es similar a la encapsulación que proporcionan las interfaces.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-119">The functionality is similar to the encapsulation interfaces provide.</span></span>

<span data-ttu-id="d8e9a-120">Otro uso común de devoluciones de llamada es definir un método de comparación personalizado y pasar ese delegado a un método de ordenación.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-120">Another common use of callbacks is defining a custom comparison method and passing that delegate to a sort method.</span></span> <span data-ttu-id="d8e9a-121">Permite que el código del llamador se convierta en parte del algoritmo de ordenación.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-121">It allows the caller's code to become part of the sort algorithm.</span></span> <span data-ttu-id="d8e9a-122">En el siguiente método de ejemplo se usa el tipo `Del` como parámetro:</span><span class="sxs-lookup"><span data-stu-id="d8e9a-122">The following example method uses the `Del` type as a parameter:</span></span>

[!code-csharp[csProgGuideDelegates#24](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#24)]

<span data-ttu-id="d8e9a-123">Luego puede pasar el delegado creado anteriormente a ese método:</span><span class="sxs-lookup"><span data-stu-id="d8e9a-123">You can then pass the delegate created above to that method:</span></span>

[!code-csharp[csProgGuideDelegates#25](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#25)]

<span data-ttu-id="d8e9a-124">Y recibir los siguientes resultados en la consola:</span><span class="sxs-lookup"><span data-stu-id="d8e9a-124">and receive the following output to the console:</span></span>

```console
The number is: 3
```

<span data-ttu-id="d8e9a-125">Si se usa el delegado como abstracción, no es necesario que `MethodWithCallback` llame directamente a la consola —no tiene que estar diseñado pensando en una consola—.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-125">Using the delegate as an abstraction, `MethodWithCallback` does not need to call the console directly—it does not have to be designed with a console in mind.</span></span> <span data-ttu-id="d8e9a-126">Lo que `MethodWithCallback` hace es simplemente preparar una cadena y pasarla a otro método.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-126">What `MethodWithCallback` does is simply prepare a string and pass the string to another method.</span></span> <span data-ttu-id="d8e9a-127">Esto es especialmente eficaz, puesto que un método delegado puede utilizar cualquier número de parámetros.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-127">This is especially powerful since a delegated method can use any number of parameters.</span></span>

<span data-ttu-id="d8e9a-128">Cuando se crea un delegado para encapsular un método de instancia, el delegado hace referencia tanto a la instancia como al método.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-128">When a delegate is constructed to wrap an instance method, the delegate references both the instance and the method.</span></span> <span data-ttu-id="d8e9a-129">Un delegado no tiene conocimiento del tipo de instancia —aparte del método al que encapsula—, por lo que un delegado puede hacer referencia a cualquier tipo de objeto siempre que haya un método en ese objeto que coincida con la signatura del delegado.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-129">A delegate has no knowledge of the instance type aside from the method it wraps, so a delegate can refer to any type of object as long as there is a method on that object that matches the delegate signature.</span></span> <span data-ttu-id="d8e9a-130">Cuando se crea un delegado para encapsular un método estático, solo hace referencia al método.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-130">When a delegate is constructed to wrap a static method, it only references the method.</span></span> <span data-ttu-id="d8e9a-131">Considere las siguientes declaraciones:</span><span class="sxs-lookup"><span data-stu-id="d8e9a-131">Consider the following declarations:</span></span>

[!code-csharp[csProgGuideDelegates#26](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#26)]

<span data-ttu-id="d8e9a-132">Junto con el `DelegateMethod` estático mostrado anteriormente, ahora tenemos tres métodos que se pueden encapsularse mediante una instancia de `Del`.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-132">Along with the static `DelegateMethod` shown previously, we now have three methods that can be wrapped by a `Del` instance.</span></span>

<span data-ttu-id="d8e9a-133">Un delegado puede llamar a más de un método cuando se invoca.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-133">A delegate can call more than one method when invoked.</span></span> <span data-ttu-id="d8e9a-134">Esto se conoce como multidifusión.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-134">This is referred to as multicasting.</span></span> <span data-ttu-id="d8e9a-135">Para agregar un método adicional a la lista de métodos del delegado —la lista de invocación—, simplemente es necesario agregar dos delegados mediante los operadores de adición o asignación y suma ('+' o '+=').</span><span class="sxs-lookup"><span data-stu-id="d8e9a-135">To add an extra method to the delegate's list of methods—the invocation list—simply requires adding two delegates using the addition or addition assignment operators ('+' or '+=').</span></span> <span data-ttu-id="d8e9a-136">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="d8e9a-136">For example:</span></span>

[!code-csharp[csProgGuideDelegates#27](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#27)]

<span data-ttu-id="d8e9a-137">En este momento `allMethodsDelegate` contiene tres métodos en su lista de invocación: `Method1`, `Method2` y `DelegateMethod`.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-137">At this point `allMethodsDelegate` contains three methods in its invocation list—`Method1`, `Method2`, and `DelegateMethod`.</span></span> <span data-ttu-id="d8e9a-138">Los tres delegados originales, `d1`, `d2` y `d3`, permanecen sin cambios.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-138">The original three delegates, `d1`, `d2`, and `d3`, remain unchanged.</span></span> <span data-ttu-id="d8e9a-139">Cuando se invoca `allMethodsDelegate`, todos los métodos se llaman en orden.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-139">When `allMethodsDelegate` is invoked, all three methods are called in order.</span></span> <span data-ttu-id="d8e9a-140">Si el delegado usa parámetros de referencia, la referencia se pasa secuencialmente a cada uno de los tres métodos por turnos, y cualquier cambio que realice un método es visible para el siguiente método.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-140">If the delegate uses reference parameters, the reference is passed sequentially to each of the three methods in turn, and any changes by one method are visible to the next method.</span></span> <span data-ttu-id="d8e9a-141">Cuando alguno de los métodos produce una excepción que no se captura dentro del método, esa excepción se pasa al llamador del delegado y no se llama a los métodos siguientes de la lista de invocación.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-141">When any of the methods throws an exception that is not caught within the method, that exception is passed to the caller of the delegate and no subsequent methods in the invocation list are called.</span></span> <span data-ttu-id="d8e9a-142">Si el delegado tiene un valor devuelto o los parámetros de salida, devuelve el valor devuelto y los parámetros del último método invocado.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-142">If the delegate has a return value and/or out parameters, it returns the return value and parameters of the last method invoked.</span></span> <span data-ttu-id="d8e9a-143">Para quitar un método de la lista de invocación, utilice los [operadores de decremento o de asignación de decremento](../../language-reference/operators/subtraction-operator.md) (`-` o `-=`).</span><span class="sxs-lookup"><span data-stu-id="d8e9a-143">To remove a method from the invocation list, use the [subtraction or subtraction assignment operators](../../language-reference/operators/subtraction-operator.md) (`-` or `-=`).</span></span> <span data-ttu-id="d8e9a-144">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="d8e9a-144">For example:</span></span>

[!code-csharp[csProgGuideDelegates#28](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#28)]

<span data-ttu-id="d8e9a-145">Dado que los tipos de delegado se derivan de `System.Delegate`, los métodos y propiedades definidas por esa clase se pueden llamar en el delegado.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-145">Because delegate types are derived from `System.Delegate`, the methods and properties defined by that class can be called on the delegate.</span></span> <span data-ttu-id="d8e9a-146">Por ejemplo, para buscar el número de métodos en la lista de invocación de un delegado, se puede escribir:</span><span class="sxs-lookup"><span data-stu-id="d8e9a-146">For example, to find the number of methods in a delegate's invocation list, you may write:</span></span>

[!code-csharp[csProgGuideDelegates#29](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#29)]

<span data-ttu-id="d8e9a-147">Los delegados con más de un método en su lista de invocación derivan de <xref:System.MulticastDelegate>, que es una subclase de `System.Delegate`.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-147">Delegates with more than one method in their invocation list derive from <xref:System.MulticastDelegate>, which is a subclass of `System.Delegate`.</span></span> <span data-ttu-id="d8e9a-148">El código anterior funciona en ambos casos porque las dos clases admiten `GetInvocationList`.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-148">The above code works in either case because both classes support `GetInvocationList`.</span></span>

<span data-ttu-id="d8e9a-149">Los delegados de multidifusión se utilizan mucho en el control de eventos.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-149">Multicast delegates are used extensively in event handling.</span></span> <span data-ttu-id="d8e9a-150">Los objetos de origen de evento envían notificaciones de evento a los objetos de destinatario que se han registrado para recibir ese evento.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-150">Event source objects send event notifications to recipient objects that have registered to receive that event.</span></span> <span data-ttu-id="d8e9a-151">Para suscribirse a un evento, el destinatario crea un método diseñado para controlar el evento; a continuación, crea a un delegado para dicho método y pasa el delegado al origen de eventos.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-151">To register for an event, the recipient creates a method designed to handle the event, then creates a delegate for that method and passes the delegate to the event source.</span></span> <span data-ttu-id="d8e9a-152">El origen llama al delegado cuando se produce el evento.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-152">The source calls the delegate when the event occurs.</span></span> <span data-ttu-id="d8e9a-153">Después, el delegado llama al método que controla los eventos en el destinatario y entrega los datos del evento.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-153">The delegate then calls the event handling method on the recipient, delivering the event data.</span></span> <span data-ttu-id="d8e9a-154">El origen del evento define el tipo de delegado para un evento determinado.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-154">The delegate type for a given event is defined by the event source.</span></span> <span data-ttu-id="d8e9a-155">Para obtener más información, consulte [Eventos](../events/index.md).</span><span class="sxs-lookup"><span data-stu-id="d8e9a-155">For more, see [Events](../events/index.md).</span></span>

<span data-ttu-id="d8e9a-156">La comparación de delegados de dos tipos distintos asignados en tiempo de compilación generará un error de compilación.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-156">Comparing delegates of two different types assigned at compile-time will result in a compilation error.</span></span> <span data-ttu-id="d8e9a-157">Si las instancias de delegado son estáticamente del tipo `System.Delegate`, entonces se permite la comparación, pero devolverá false en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="d8e9a-157">If the delegate instances are statically of the type `System.Delegate`, then the comparison is allowed, but will return false at run time.</span></span> <span data-ttu-id="d8e9a-158">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="d8e9a-158">For example:</span></span>

[!code-csharp[csProgGuideDelegates#30](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#30)]

## <a name="see-also"></a><span data-ttu-id="d8e9a-159">Vea también</span><span class="sxs-lookup"><span data-stu-id="d8e9a-159">See also</span></span>

- [<span data-ttu-id="d8e9a-160">Guía de programación de C#</span><span class="sxs-lookup"><span data-stu-id="d8e9a-160">C# Programming Guide</span></span>](../index.md)
- [<span data-ttu-id="d8e9a-161">Delegados</span><span class="sxs-lookup"><span data-stu-id="d8e9a-161">Delegates</span></span>](./index.md)
- [<span data-ttu-id="d8e9a-162">Uso de varianza en delegados</span><span class="sxs-lookup"><span data-stu-id="d8e9a-162">Using Variance in Delegates</span></span>](../concepts/covariance-contravariance/using-variance-in-delegates.md)
- [<span data-ttu-id="d8e9a-163">Varianza en delegados</span><span class="sxs-lookup"><span data-stu-id="d8e9a-163">Variance in Delegates</span></span>](../concepts/covariance-contravariance/variance-in-delegates.md)
- [<span data-ttu-id="d8e9a-164">Uso de varianza para los delegados genéricos Func y Action</span><span class="sxs-lookup"><span data-stu-id="d8e9a-164">Using Variance for Func and Action Generic Delegates</span></span>](../concepts/covariance-contravariance/using-variance-for-func-and-action-generic-delegates.md)
- [<span data-ttu-id="d8e9a-165">Eventos</span><span class="sxs-lookup"><span data-stu-id="d8e9a-165">Events</span></span>](../events/index.md)
