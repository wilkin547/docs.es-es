---
title: 'Tutorial: Crear y usar objetos dinámicos (C# y Visual Basic)'
description: En este tutorial, aprenderá a crear y usar objetos dinámicos. Cree un objeto dinámico personalizado y un proyecto que use una biblioteca "IronPython".
ms.date: 07/20/2015
dev_langs:
- csharp
- vb
helpviewer_keywords:
- dynamic objects [Visual Basic]
- dynamic objects
- dynamic objects [C#]
ms.assetid: 568f1645-1305-4906-8625-5d77af81e04f
ms.openlocfilehash: 144651d3b14f6f6093ab07f1df7be10e6d05ae89
ms.sourcegitcommit: 552b4b60c094559db9d8178fa74f5bafaece0caf
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 07/29/2020
ms.locfileid: "87381260"
---
# <a name="walkthrough-creating-and-using-dynamic-objects-c-and-visual-basic"></a><span data-ttu-id="5b6ec-104">Tutorial: Crear y usar objetos dinámicos (C# y Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5b6ec-104">Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)</span></span>

<span data-ttu-id="5b6ec-105">Los objetos dinámicos exponen miembros como propiedades y métodos en tiempo de ejecución, en lugar de en tiempo de compilación.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-105">Dynamic objects expose members such as properties and methods at run time, instead of at compile time.</span></span> <span data-ttu-id="5b6ec-106">Esto le permite crear objetos para trabajar con estructuras que no coinciden con un formato o tipo estático.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-106">This enables you to create objects to work with structures that do not match a static type or format.</span></span> <span data-ttu-id="5b6ec-107">Por ejemplo, puede usar un objeto dinámico para hacer referencia a Document Object Model (DOM) HTML, que puede contener cualquier combinación de atributos y elementos de marcado HTML válidos.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-107">For example, you can use a dynamic object to reference the HTML Document Object Model (DOM), which can contain any combination of valid HTML markup elements and attributes.</span></span> <span data-ttu-id="5b6ec-108">Dado que cada documento HTML es único, los miembros de un documento HTML específico se determinan en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-108">Because each HTML document is unique, the members for a particular HTML document are determined at run time.</span></span> <span data-ttu-id="5b6ec-109">Un método común para hacer referencia a un atributo de un elemento HTML consiste en pasar el nombre del atributo al método `GetProperty` del elemento.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-109">A common method to reference an attribute of an HTML element is to pass the name of the attribute to the `GetProperty` method of the element.</span></span> <span data-ttu-id="5b6ec-110">Para hacer referencia al atributo `id` del elemento HTML `<div id="Div1">`, primero debe obtener una referencia al elemento `<div>` y, después, usar `divElement.GetProperty("id")`.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-110">To reference the `id` attribute of the HTML element `<div id="Div1">`, you first obtain a reference to the `<div>` element, and then use `divElement.GetProperty("id")`.</span></span> <span data-ttu-id="5b6ec-111">Si usa un objeto dinámico, puede hacer referencia al atributo `id` como `divElement.id`.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-111">If you use a dynamic object, you can reference the `id` attribute as `divElement.id`.</span></span>  
  
 <span data-ttu-id="5b6ec-112">Los objetos dinámicos también proporcionan un acceso cómodo a lenguajes dinámicos como IronPython e IronRuby.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-112">Dynamic objects also provide convenient access to dynamic languages such as IronPython and IronRuby.</span></span> <span data-ttu-id="5b6ec-113">Puede usar un objeto dinámico para hacer referencia a un script dinámico que se interpreta en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-113">You can use a dynamic object to refer to a dynamic script that is interpreted at run time.</span></span>  
  
 <span data-ttu-id="5b6ec-114">Para hacer referencia a un objeto dinámico, use un enlace en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-114">You reference a dynamic object by using late binding.</span></span> <span data-ttu-id="5b6ec-115">En C#, el tipo de un objeto enlazado en tiempo de ejecución se especifica como `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-115">In C#, you specify the type of a late-bound object as `dynamic`.</span></span> <span data-ttu-id="5b6ec-116">En Visual Basic, el tipo de un objeto enlazado en tiempo de ejecución se especifica como `Object`.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-116">In Visual Basic, you specify the type of a late-bound object as `Object`.</span></span> <span data-ttu-id="5b6ec-117">Para obtener más información, vea [dynamic](../../language-reference/builtin-types/reference-types.md) y [Enlace en tiempo de compilación y en tiempo de ejecución](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span><span class="sxs-lookup"><span data-stu-id="5b6ec-117">For more information, see [dynamic](../../language-reference/builtin-types/reference-types.md) and [Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span></span>  
  
 <span data-ttu-id="5b6ec-118">Puede crear objetos dinámicos personalizados con las clases del espacio de nombres <xref:System.Dynamic?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-118">You can create custom dynamic objects by using the classes in the <xref:System.Dynamic?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="5b6ec-119">Por ejemplo, puede crear un objeto <xref:System.Dynamic.ExpandoObject> y especificar los miembros de ese objeto en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-119">For example, you can create an <xref:System.Dynamic.ExpandoObject> and specify the members of that object at run time.</span></span> <span data-ttu-id="5b6ec-120">También puede crear su propio tipo que hereda la clase <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-120">You can also create your own type that inherits the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="5b6ec-121">Después, puede invalidar los miembros de la clase <xref:System.Dynamic.DynamicObject> para proporcionar funciones dinámicas en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-121">You can then override the members of the <xref:System.Dynamic.DynamicObject> class to provide run-time dynamic functionality.</span></span>  
  
 <span data-ttu-id="5b6ec-122">En este tutorial realizará las tareas siguientes:</span><span class="sxs-lookup"><span data-stu-id="5b6ec-122">In this walkthrough you will perform the following tasks:</span></span>  
  
- <span data-ttu-id="5b6ec-123">Crear un objeto personalizado que expone dinámicamente el contenido de un archivo de texto como propiedades de un objeto.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-123">Create a custom object that dynamically exposes the contents of a text file as properties of an object.</span></span>  
  
- <span data-ttu-id="5b6ec-124">Crear un proyecto que usa una biblioteca `IronPython`.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-124">Create a project that uses an `IronPython` library.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="5b6ec-125">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="5b6ec-125">Prerequisites</span></span>  

<span data-ttu-id="5b6ec-126">Necesita [IronPython](https://ironpython.net/) para .NET para poder seguir este tutorial.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-126">You need [IronPython](https://ironpython.net/) for .NET to complete this walkthrough.</span></span> <span data-ttu-id="5b6ec-127">Vaya a su [página de descarga](https://ironpython.net/download/) para obtener la versión más reciente.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-127">Go to their [Download page](https://ironpython.net/download/) to obtain the latest version.</span></span>
  
[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  
  
## <a name="creating-a-custom-dynamic-object"></a><span data-ttu-id="5b6ec-128">Crear un objeto dinámico personalizado</span><span class="sxs-lookup"><span data-stu-id="5b6ec-128">Creating a Custom Dynamic Object</span></span>

<span data-ttu-id="5b6ec-129">El primer proyecto que se crea en este tutorial define un objeto dinámico personalizado que busca en el contenido de un archivo de texto.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-129">The first project that you create in this walkthrough defines a custom dynamic object that searches the contents of a text file.</span></span> <span data-ttu-id="5b6ec-130">El texto que se va a buscar se especifica mediante el nombre de una propiedad dinámica.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-130">Text to search for is specified by the name of a dynamic property.</span></span> <span data-ttu-id="5b6ec-131">Por ejemplo, si el código de llamada especifica `dynamicFile.Sample`, la clase dinámica devuelve una lista genérica de cadenas que contiene todas las líneas del archivo que comienzan con "Sample".</span><span class="sxs-lookup"><span data-stu-id="5b6ec-131">For example, if calling code specifies `dynamicFile.Sample`, the dynamic class returns a generic list of strings that contains all of the lines from the file that begin with "Sample".</span></span> <span data-ttu-id="5b6ec-132">La búsqueda no distingue entre mayúsculas y minúsculas.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-132">The search is case-insensitive.</span></span> <span data-ttu-id="5b6ec-133">La clase dinámica también admite dos argumentos opcionales.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-133">The dynamic class also supports two optional arguments.</span></span> <span data-ttu-id="5b6ec-134">El primer argumento es un valor de enumeración de opción de búsqueda que especifica que la clase dinámica debe buscar coincidencias al principio de la línea, al final de la línea o en cualquier parte de la línea.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-134">The first argument is a search option enum value that specifies that the dynamic class should search for matches at the start of the line, the end of the line, or anywhere in the line.</span></span> <span data-ttu-id="5b6ec-135">El segundo argumento especifica que la clase dinámica debe recortar los espacios iniciales y finales de cada línea antes de buscar.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-135">The second argument specifies that the dynamic class should trim leading and trailing spaces from each line before searching.</span></span> <span data-ttu-id="5b6ec-136">Por ejemplo, si el código de llamada especifica `dynamicFile.Sample(StringSearchOption.Contains)`, la clase dinámica busca "Sample" en cualquier parte de una línea.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-136">For example, if calling code specifies `dynamicFile.Sample(StringSearchOption.Contains)`, the dynamic class searches for "Sample" anywhere in a line.</span></span> <span data-ttu-id="5b6ec-137">Si el código de llamada especifica `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, la clase dinámica busca "Sample" al principio de cada línea y no quita los espacios iniciales y finales.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-137">If calling code specifies `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, the dynamic class searches for "Sample" at the start of each line, and does not remove leading and trailing spaces.</span></span> <span data-ttu-id="5b6ec-138">El comportamiento predeterminado de la clase dinámica es buscar una coincidencia al principio de cada línea y quitar los espacios iniciales y finales.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-138">The default behavior of the dynamic class is to search for a match at the start of each line and to remove leading and trailing spaces.</span></span>  
  
### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="5b6ec-139">Para crear una clase dinámica personalizada</span><span class="sxs-lookup"><span data-stu-id="5b6ec-139">To create a custom dynamic class</span></span>  
  
1. <span data-ttu-id="5b6ec-140">Inicie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-140">Start Visual Studio.</span></span>  
  
2. <span data-ttu-id="5b6ec-141">En el menú **Archivo** , elija **Nuevo** y haga clic en **Proyecto**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-141">On the **File** menu, point to **New** and then click **Project**.</span></span>  
  
3. <span data-ttu-id="5b6ec-142">En el panel **Tipos de proyecto** del cuadro de diálogo **Nuevo proyecto**, asegúrese de que esté seleccionado **Windows**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-142">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="5b6ec-143">Seleccione **Aplicación de consola** en el panel **Plantillas**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-143">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="5b6ec-144">En el cuadro **Nombre**, escriba `DynamicSample` y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-144">In the **Name** box, type `DynamicSample`, and then click **OK**.</span></span> <span data-ttu-id="5b6ec-145">Se crea el proyecto.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-145">The new project is created.</span></span>  
  
4. <span data-ttu-id="5b6ec-146">Haga clic con el botón derecho en el proyecto DynamicSample, seleccione **Agregar** y, después, haga clic en **Clase**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-146">Right-click the DynamicSample project and point to **Add**, and then click **Class**.</span></span> <span data-ttu-id="5b6ec-147">En el cuadro **Nombre**, escriba `ReadOnlyFile` y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-147">In the **Name** box, type `ReadOnlyFile`, and then click **OK**.</span></span> <span data-ttu-id="5b6ec-148">Se agrega un nuevo archivo que contiene la clase ReadOnlyFile.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-148">A new file is added that contains the ReadOnlyFile class.</span></span>  
  
5. <span data-ttu-id="5b6ec-149">En la parte superior del archivo ReadOnlyFile.cs o ReadOnlyFile.vb, agregue el código siguiente para importar los espacios de nombres <xref:System.IO?displayProperty=nameWithType> y <xref:System.Dynamic?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-149">At the top of the ReadOnlyFile.cs or ReadOnlyFile.vb file, add the following code to import the <xref:System.IO?displayProperty=nameWithType> and <xref:System.Dynamic?displayProperty=nameWithType> namespaces.</span></span>  

    [!code-csharp[VbDynamicWalkthrough#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#1)]
    [!code-vb[VbDynamicWalkthrough#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#1)]  

6. <span data-ttu-id="5b6ec-150">El objeto dinámico personalizado usa una enumeración para determinar los criterios de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-150">The custom dynamic object uses an enum to determine the search criteria.</span></span> <span data-ttu-id="5b6ec-151">Antes de la instrucción de clase, agregue la siguiente definición de enumeración.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-151">Before the class statement, add the following enum definition.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#2)]
    [!code-vb[VbDynamicWalkthrough#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#2)]
  
7. <span data-ttu-id="5b6ec-152">Actualice la instrucción de clase para heredar la clase `DynamicObject`, como se muestra en el ejemplo de código siguiente.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-152">Update the class statement to inherit the `DynamicObject` class, as shown in the following code example.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#3)]
    [!code-vb[VbDynamicWalkthrough#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#3)]

8. <span data-ttu-id="5b6ec-153">Agregue el código siguiente a la clase `ReadOnlyFile` para definir un campo privado para la ruta de acceso y un constructor para la clase `ReadOnlyFile`.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-153">Add the following code to the `ReadOnlyFile` class to define a private field for the file path and a constructor for the `ReadOnlyFile` class.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#4](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#4)]
    [!code-vb[VbDynamicWalkthrough#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#4)]
  
9. <span data-ttu-id="5b6ec-154">Agregue el método `GetPropertyValue` siguiente a la clase `ReadOnlyFile`.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-154">Add the following `GetPropertyValue` method to the `ReadOnlyFile` class.</span></span> <span data-ttu-id="5b6ec-155">El método `GetPropertyValue` toma como entrada criterios de búsqueda y devuelve las líneas de un archivo de texto que coinciden con los criterios de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-155">The `GetPropertyValue` method takes, as input, search criteria and returns the lines from a text file that match that search criteria.</span></span> <span data-ttu-id="5b6ec-156">Los métodos dinámicos proporcionados por la clase `ReadOnlyFile` llaman al método `GetPropertyValue` para recuperar los resultados correspondientes.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-156">The dynamic methods provided by the `ReadOnlyFile` class call the `GetPropertyValue` method to retrieve their respective results.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#5](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#5)]
    [!code-vb[VbDynamicWalkthrough#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#5)]  
  
10. <span data-ttu-id="5b6ec-157">Después del método `GetPropertyValue`, agregue el código siguiente para invalidar el método <xref:System.Dynamic.DynamicObject.TryGetMember%2A> de la clase <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-157">After the `GetPropertyValue` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="5b6ec-158">Se llama al método <xref:System.Dynamic.DynamicObject.TryGetMember%2A> cuando se solicita un miembro de una clase dinámica y no se especifican argumentos.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-158">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method is called when a member of a dynamic class is requested and no arguments are specified.</span></span> <span data-ttu-id="5b6ec-159">El argumento `binder` contiene información sobre el miembro al que se hace referencia y el argumento `result` hace referencia al resultado devuelto para el miembro especificado.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-159">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="5b6ec-160">El método <xref:System.Dynamic.DynamicObject.TryGetMember%2A> devuelve un valor booleano que devuelve `true` si el miembro solicitado existe. En caso contrario, devuelve `false`.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-160">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#6](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#6)]
    [!code-vb[VbDynamicWalkthrough#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#6)]
  
11. <span data-ttu-id="5b6ec-161">Después del método `TryGetMember`, agregue el código siguiente para invalidar el método <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> de la clase <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-161">After the `TryGetMember` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="5b6ec-162">Se llama al método <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> cuando se solicita un miembro de una clase dinámica con argumentos.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-162">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method is called when a member of a dynamic class is requested with arguments.</span></span> <span data-ttu-id="5b6ec-163">El argumento `binder` contiene información sobre el miembro al que se hace referencia y el argumento `result` hace referencia al resultado devuelto para el miembro especificado.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-163">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="5b6ec-164">El argumento `args` contiene una matriz de los argumentos que se pasan al miembro.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-164">The `args` argument contains an array of the arguments that are passed to the member.</span></span> <span data-ttu-id="5b6ec-165">El método <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> devuelve un valor booleano que devuelve `true` si el miembro solicitado existe. En caso contrario, devuelve `false`.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-165">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
    <span data-ttu-id="5b6ec-166">La versión personalizada del método `TryInvokeMember` espera que el primer argumento sea un valor del enumerador `StringSearchOption` que se ha definido en un paso anterior.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-166">The custom version of the `TryInvokeMember` method expects the first argument to be a value from the `StringSearchOption` enum that you defined in a previous step.</span></span> <span data-ttu-id="5b6ec-167">El método `TryInvokeMember` espera que el segundo argumento sea un valor booleano.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-167">The `TryInvokeMember` method expects the second argument to be a Boolean value.</span></span> <span data-ttu-id="5b6ec-168">Si uno o ambos argumentos son valores válidos, se pasan al método `GetPropertyValue` para recuperar los resultados.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-168">If one or both arguments are valid values, they are passed to the `GetPropertyValue` method to retrieve the results.</span></span>  
  
    [!code-csharp[VbDynamicWalkthrough#7](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#7)]
    [!code-vb[VbDynamicWalkthrough#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#7)]
  
12. <span data-ttu-id="5b6ec-169">Guarde y cierre el archivo.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-169">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-text-file"></a><span data-ttu-id="5b6ec-170">Para crear un archivo de texto de ejemplo</span><span class="sxs-lookup"><span data-stu-id="5b6ec-170">To create a sample text file</span></span>  
  
1. <span data-ttu-id="5b6ec-171">Haga clic con el botón derecho en el proyecto DynamicSample, seleccione **Agregar** y, después, haga clic en **Nuevo elemento**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-171">Right-click the DynamicSample project and point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="5b6ec-172">En el panel **Plantillas instaladas** seleccione **General** y, luego, la plantilla **Archivo de texto**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-172">In the **Installed Templates** pane, select **General**, and then select the **Text File** template.</span></span> <span data-ttu-id="5b6ec-173">Deje el nombre predeterminado TextFile1.txt en el cuadro **Nombre** y haga clic en **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-173">Leave the default name of TextFile1.txt in the **Name** box, and then click **Add**.</span></span> <span data-ttu-id="5b6ec-174">Se agregará un archivo de texto nuevo al proyecto.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-174">A new text file is added to the project.</span></span>  
  
2. <span data-ttu-id="5b6ec-175">Copie el texto siguiente en el archivo TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-175">Copy the following text to the TextFile1.txt file.</span></span>  
  
    ```text  
    List of customers and suppliers  
  
    Supplier: Lucerne Publishing (https://www.lucernepublishing.com/)  
    Customer: Preston, Chris  
    Customer: Hines, Patrick  
    Customer: Cameron, Maria  
    Supplier: Graphic Design Institute (https://www.graphicdesigninstitute.com/)
    Supplier: Fabrikam, Inc. (https://www.fabrikam.com/)
    Customer: Seubert, Roxanne  
    Supplier: Proseware, Inc. (http://www.proseware.com/)
    Customer: Adolphi, Stephan  
    Customer: Koch, Paul  
    ```  
  
3. <span data-ttu-id="5b6ec-176">Guarde y cierre el archivo.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-176">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-application-that-uses-the-custom-dynamic-object"></a><span data-ttu-id="5b6ec-177">Para crear una aplicación de ejemplo que usa el objeto dinámico personalizado</span><span class="sxs-lookup"><span data-stu-id="5b6ec-177">To create a sample application that uses the custom dynamic object</span></span>  
  
1. <span data-ttu-id="5b6ec-178">En el **Explorador de soluciones**, haga doble clic en el archivo Module1.vb si usa Visual Basic o en el archivo Program.cs si usa Visual C#.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-178">In **Solution Explorer**, double-click the Module1.vb file if you are using Visual Basic or the Program.cs file if you are using Visual C#.</span></span>  
  
2. <span data-ttu-id="5b6ec-179">Agregue el código siguiente al procedimiento Main para crear una instancia de la clase `ReadOnlyFile` para el archivo TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-179">Add the following code to the Main procedure to create an instance of the `ReadOnlyFile` class for the TextFile1.txt file.</span></span> <span data-ttu-id="5b6ec-180">El código usa el enlace en tiempo de ejecución para llamar a miembros dinámicos y recuperar líneas de texto que contienen la cadena "Customer".</span><span class="sxs-lookup"><span data-stu-id="5b6ec-180">The code uses late binding to call dynamic members and retrieve lines of text that contain the string "Customer".</span></span>  
  
     [!code-csharp[VbDynamicWalkthrough#8](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/program.cs#8)]
     [!code-vb[VbDynamicWalkthrough#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/module1.vb#8)]
  
3. <span data-ttu-id="5b6ec-181">Guarde el archivo y presione CTRL+F5 para compilar y ejecutar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-181">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="calling-a-dynamic-language-library"></a><span data-ttu-id="5b6ec-182">Llamar a una biblioteca de lenguaje dinámico</span><span class="sxs-lookup"><span data-stu-id="5b6ec-182">Calling a Dynamic Language Library</span></span>  

<span data-ttu-id="5b6ec-183">El siguiente proyecto que cree en este tutorial tendrá acceso a una biblioteca escrita en el lenguaje dinámico IronPython.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-183">The next project that you create in this walkthrough accesses a library that is written in the dynamic language IronPython.</span></span>
  
### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="5b6ec-184">Para crear una clase dinámica personalizada</span><span class="sxs-lookup"><span data-stu-id="5b6ec-184">To create a custom dynamic class</span></span>
  
1. <span data-ttu-id="5b6ec-185">En el menú **Archivo** de Visual Studio, apunte a **Nuevo** y haga clic en **Proyecto**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-185">In Visual Studio, on the **File** menu, point to **New** and then click **Project**.</span></span>  
  
2. <span data-ttu-id="5b6ec-186">En el panel **Tipos de proyecto** del cuadro de diálogo **Nuevo proyecto**, asegúrese de que esté seleccionado **Windows**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-186">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="5b6ec-187">Seleccione **Aplicación de consola** en el panel **Plantillas**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-187">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="5b6ec-188">En el cuadro **Nombre**, escriba `DynamicIronPythonSample` y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-188">In the **Name** box, type `DynamicIronPythonSample`, and then click **OK**.</span></span> <span data-ttu-id="5b6ec-189">Se crea el proyecto.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-189">The new project is created.</span></span>  
  
3. <span data-ttu-id="5b6ec-190">Si usa Visual Basic, haga clic con el botón derecho en el proyecto DynamicIronPythonSample y luego haga clic en **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-190">If you are using Visual Basic, right-click the DynamicIronPythonSample project and then click **Properties**.</span></span> <span data-ttu-id="5b6ec-191">Haga clic en la pestaña **Referencias**. Haga clic en el botón **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-191">Click the **References** tab. Click the **Add** button.</span></span> <span data-ttu-id="5b6ec-192">Si usa Visual C#, en el **Explorador de soluciones**, haga clic con el botón derecho en la carpeta **Referencias** y, después, haga clic en **Agregar referencia**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-192">If you are using Visual C#, in **Solution Explorer**, right-click the **References** folder and then click **Add Reference**.</span></span>  
  
4. <span data-ttu-id="5b6ec-193">En la pestaña **Examinar**, vaya a la carpeta donde están instaladas las bibliotecas de IronPython.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-193">On the **Browse** tab, browse to the folder where the IronPython libraries are installed.</span></span> <span data-ttu-id="5b6ec-194">Por ejemplo, C:\Program Files\IronPython 2.6 para .NET 4.0.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-194">For example, C:\Program Files\IronPython 2.6 for .NET 4.0.</span></span> <span data-ttu-id="5b6ec-195">Seleccione las bibliotecas **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll** y **Microsoft.Dynamic.dll**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-195">Select the **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll**, and **Microsoft.Dynamic.dll** libraries.</span></span> <span data-ttu-id="5b6ec-196">Haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-196">Click **OK**.</span></span>  
  
5. <span data-ttu-id="5b6ec-197">Si usa Visual Basic, edite el archivo Module1.vb.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-197">If you are using Visual Basic, edit the Module1.vb file.</span></span> <span data-ttu-id="5b6ec-198">Si usa Visual C#, edite el archivo Program.cs.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-198">If you are using Visual C#, edit the Program.cs file.</span></span>  
  
6. <span data-ttu-id="5b6ec-199">En la parte superior del archivo, agregue el código siguiente para importar los espacios de nombres `Microsoft.Scripting.Hosting` y `IronPython.Hosting` de las bibliotecas de IronPython.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-199">At the top of the file, add the following code to import the `Microsoft.Scripting.Hosting` and `IronPython.Hosting` namespaces from the IronPython libraries.</span></span>  
  
    [!code-csharp[VbDynamicWalkthroughIronPython#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#1)]
    [!code-vb[VbDynamicWalkthroughIronPython#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#1)]
  
7. <span data-ttu-id="5b6ec-200">En el método Main, agregue el código siguiente para crear un objeto `Microsoft.Scripting.Hosting.ScriptRuntime` que hospede las bibliotecas de IronPython.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-200">In the Main method, add the following code to create a new `Microsoft.Scripting.Hosting.ScriptRuntime` object to host the IronPython libraries.</span></span> <span data-ttu-id="5b6ec-201">El objeto `ScriptRuntime` carga el módulo de biblioteca de IronPython random.py.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-201">The `ScriptRuntime` object loads the IronPython library module random.py.</span></span>  
  
     [!code-csharp[VbDynamicWalkthroughIronPython#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#2)]
     [!code-vb[VbDynamicWalkthroughIronPython#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#2)]
  
8. <span data-ttu-id="5b6ec-202">Una vez que el código haya cargado el módulo random.py, agregue el código siguiente para crear una matriz de enteros.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-202">After the code to load the random.py module, add the following code to create an array of integers.</span></span> <span data-ttu-id="5b6ec-203">La matriz se pasa al método `shuffle` del módulo random.py, que ordena aleatoriamente los valores de la matriz.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-203">The array is passed to the `shuffle` method of the random.py module, which randomly sorts the values in the array.</span></span>  
  
     [!code-csharp[VbDynamicWalkthroughIronPython#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#3)]
     [!code-vb[VbDynamicWalkthroughIronPython#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#3)]
  
9. <span data-ttu-id="5b6ec-204">Guarde el archivo y presione CTRL+F5 para compilar y ejecutar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="5b6ec-204">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5b6ec-205">Consulte también</span><span class="sxs-lookup"><span data-stu-id="5b6ec-205">See also</span></span>

- <xref:System.Dynamic?displayProperty=nameWithType>
- <xref:System.Dynamic.DynamicObject?displayProperty=nameWithType>
- [<span data-ttu-id="5b6ec-206">Uso de tipo dinámico</span><span class="sxs-lookup"><span data-stu-id="5b6ec-206">Using Type dynamic</span></span>](./using-type-dynamic.md)
- [<span data-ttu-id="5b6ec-207">Enlace en tiempo de compilación y en tiempo de ejecución</span><span class="sxs-lookup"><span data-stu-id="5b6ec-207">Early and Late Binding</span></span>](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md)
- [<span data-ttu-id="5b6ec-208">dynamic</span><span class="sxs-lookup"><span data-stu-id="5b6ec-208">dynamic</span></span>](../../language-reference/builtin-types/reference-types.md)
- [<span data-ttu-id="5b6ec-209">Implementar interfaces dinámicas (PDF descargable de Microsoft TechNet)</span><span class="sxs-lookup"><span data-stu-id="5b6ec-209">Implementing Dynamic Interfaces (downloadable PDF from Microsoft TechNet)</span></span>](https://download.microsoft.com/download/5/4/B/54B83DFE-D7AA-4155-9687-B0CF58FF65D7/implementing-dynamic-interfaces.pdf)
