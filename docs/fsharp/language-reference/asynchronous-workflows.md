---
title: "Flujos de trabajo asincrónicos (F#)"
description: "Obtenga información acerca del soporte técnico en el lenguaje de programación para realizar cálculos de forma asincrónica, F # que se ejecutan sin bloquear la ejecución de otro trabajo."
keywords: "visual f#, f#, programación funcional"
author: cartermp
ms.author: phcart
ms.date: 05/16/2016
ms.topic: language-reference
ms.prod: .net
ms.technology: devlang-fsharp
ms.devlang: fsharp
ms.assetid: ee2bb9bf-e04a-4fbe-bf58-46d07229e981
ms.openlocfilehash: e1cbdb452c8f77d97a0231a5ec75d752a98d2ed6
ms.sourcegitcommit: 655fd4f78741967f80c409cef98347fdcf77857d
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/28/2018
---
# <a name="asynchronous-workflows"></a><span data-ttu-id="28ca8-104">Flujos de trabajo asincrónicos</span><span class="sxs-lookup"><span data-stu-id="28ca8-104">Asynchronous Workflows</span></span>

> [!NOTE]
<span data-ttu-id="28ca8-105">El vínculo de la referencia de API le llevará a MSDN.</span><span class="sxs-lookup"><span data-stu-id="28ca8-105">The API reference link will take you to MSDN.</span></span>  <span data-ttu-id="28ca8-106">La referencia de API de docs.microsoft.com no está completa.</span><span class="sxs-lookup"><span data-stu-id="28ca8-106">The docs.microsoft.com API reference is not complete.</span></span>

<span data-ttu-id="28ca8-107">Este tema describe la compatibilidad de F # para realizar cálculos de forma asincrónica, es decir, sin bloquear la ejecución de otro trabajo.</span><span class="sxs-lookup"><span data-stu-id="28ca8-107">This topic describes support in F# for performing computations asynchronously, that is, without blocking execution of other work.</span></span> <span data-ttu-id="28ca8-108">Por ejemplo, los cálculos asincrónicos se pueden utilizar para escribir aplicaciones que tienen interfaces de usuario que sigan respondiendo a los usuarios mientras la aplicación realiza otro trabajo.</span><span class="sxs-lookup"><span data-stu-id="28ca8-108">For example, asynchronous computations can be used to write applications that have UIs that remain responsive to users as the application performs other work.</span></span>

## <a name="syntax"></a><span data-ttu-id="28ca8-109">Sintaxis</span><span class="sxs-lookup"><span data-stu-id="28ca8-109">Syntax</span></span>

```fsharp
async { expression }
```

## <a name="remarks"></a><span data-ttu-id="28ca8-110">Comentarios</span><span class="sxs-lookup"><span data-stu-id="28ca8-110">Remarks</span></span>

<span data-ttu-id="28ca8-111">En la sintaxis anterior, el cálculo se representa mediante `expression` está configurado para ejecutar de forma asincrónica, es decir, sin bloquear el subproceso de cálculo actual cuando se realizan operaciones de suspensión asincrónica, la E/S y otras operaciones asincrónicas.</span><span class="sxs-lookup"><span data-stu-id="28ca8-111">In the previous syntax, the computation represented by `expression` is set up to run asynchronously, that is, without blocking the current computation thread when asynchronous sleep operations, I/O, and other asynchronous operations are performed.</span></span> <span data-ttu-id="28ca8-112">A menudo, los cálculos asincrónicos se inician en un subproceso en segundo plano mientras continúa la ejecución en el subproceso actual.</span><span class="sxs-lookup"><span data-stu-id="28ca8-112">Asynchronous computations are often started on a background thread while execution continues on the current thread.</span></span> <span data-ttu-id="28ca8-113">El tipo de la expresión es `Async<'T>`, donde `'T` es el tipo devuelto por la expresión cuando el `return` se utiliza la palabra clave.</span><span class="sxs-lookup"><span data-stu-id="28ca8-113">The type of the expression is `Async<'T>`, where `'T` is the type returned by the expression when the `return` keyword is used.</span></span> <span data-ttu-id="28ca8-114">El código de dicha expresión se conoce como un *bloque asincrónico*, o *bloque asincrónico*.</span><span class="sxs-lookup"><span data-stu-id="28ca8-114">The code in such an expression is referred to as an *asynchronous block*, or *async block*.</span></span>

<span data-ttu-id="28ca8-115">Hay una variedad de formas de programación asincrónica y el [ `Async` ](https://msdn.microsoft.com/library/03eb4d12-a01a-4565-a077-5e83f17cf6f7) clase proporciona métodos que admiten varios escenarios.</span><span class="sxs-lookup"><span data-stu-id="28ca8-115">There are a variety of ways of programming asynchronously, and the [`Async`](https://msdn.microsoft.com/library/03eb4d12-a01a-4565-a077-5e83f17cf6f7) class provides methods that support several scenarios.</span></span> <span data-ttu-id="28ca8-116">El enfoque general consiste en crear `Async` objetos que representan el cálculo o los cálculos que se va a ejecutar de forma asincrónica y, a continuación, inician estos cálculos mediante una de las funciones de activación.</span><span class="sxs-lookup"><span data-stu-id="28ca8-116">The general approach is to create `Async` objects that represent the computation or computations that you want to run asynchronously, and then start these computations by using one of the triggering functions.</span></span> <span data-ttu-id="28ca8-117">Las diversas funciones desencadenadoras proporcionan diferentes maneras de ejecución de cálculos asincrónicos y que utilice depende de si desea usar el subproceso actual, un subproceso en segundo plano o un objeto de tarea de .NET Framework, y determinar si hay continuación funciones que deben ejecutarse cuando finaliza el cálculo.</span><span class="sxs-lookup"><span data-stu-id="28ca8-117">The various triggering functions provide different ways of running asynchronous computations, and which one you use depends on whether you want to use the current thread, a background thread, or a .NET Framework task object, and whether there are continuation functions that should run when the computation finishes.</span></span> <span data-ttu-id="28ca8-118">Por ejemplo, para iniciar un cálculo asincrónico en el subproceso actual, puede usar [ `Async.StartImmediate` ](https://msdn.microsoft.com/library/2f71d1cc-187f-48cf-ac66-e7fda41c46e3).</span><span class="sxs-lookup"><span data-stu-id="28ca8-118">For example, to start an asynchronous computation on the current thread, you can use [`Async.StartImmediate`](https://msdn.microsoft.com/library/2f71d1cc-187f-48cf-ac66-e7fda41c46e3).</span></span> <span data-ttu-id="28ca8-119">Cuando se inicia un cálculo asincrónico desde el subproceso de interfaz de usuario, no se bloquean el bucle de eventos principal que procesa las acciones del usuario, como pulsaciones de teclas y la actividad del mouse, por lo que la aplicación sigue respondiendo.</span><span class="sxs-lookup"><span data-stu-id="28ca8-119">When you start an asynchronous computation from the UI thread, you do not block the main event loop that processes user actions such as keystrokes and mouse activity, so your application remains responsive.</span></span>

## <a name="asynchronous-binding-by-using-let"></a><span data-ttu-id="28ca8-120">¡Enlace asincrónico mediante let!</span><span class="sxs-lookup"><span data-stu-id="28ca8-120">Asynchronous Binding by Using let!</span></span>

<span data-ttu-id="28ca8-121">En un flujo de trabajo asincrónico, algunas expresiones y operaciones son sincrónicas y otras son más largas que están diseñados para devolver un resultado de forma asincrónica.</span><span class="sxs-lookup"><span data-stu-id="28ca8-121">In an asynchronous workflow, some expressions and operations are synchronous, and some are longer computations that are designed to return a result asynchronously.</span></span> <span data-ttu-id="28ca8-122">Cuando se llama a un método de forma asincrónica, en lugar de una normal `let` enlace, use `let!`.</span><span class="sxs-lookup"><span data-stu-id="28ca8-122">When you call a method asynchronously, instead of an ordinary `let` binding, you use `let!`.</span></span> <span data-ttu-id="28ca8-123">El efecto de `let!` es permitir que continúe en otros cálculos o subprocesos, tal y como se realiza el cálculo de la ejecución.</span><span class="sxs-lookup"><span data-stu-id="28ca8-123">The effect of `let!` is to enable execution to continue on other computations or threads as the computation is being performed.</span></span> <span data-ttu-id="28ca8-124">Después de la derecha de la `let!` devuelve el enlace, el resto del flujo de trabajo asincrónico reanuda la ejecución.</span><span class="sxs-lookup"><span data-stu-id="28ca8-124">After the right side of the `let!` binding returns, the rest of the asynchronous workflow resumes execution.</span></span>

<span data-ttu-id="28ca8-125">El código siguiente muestra la diferencia entre `let` y `let!`.</span><span class="sxs-lookup"><span data-stu-id="28ca8-125">The following code shows the difference between `let` and `let!`.</span></span> <span data-ttu-id="28ca8-126">La línea de código que usa `let` simplemente crea un cálculo asincrónico como un objeto que se puede ejecutar más adelante mediante, por ejemplo, `Async.StartImmediate` o [ `Async.RunSynchronously` ](https://msdn.microsoft.com/library/0a6663a9-50f2-4d38-8bf3-cefd1a51fd6b).</span><span class="sxs-lookup"><span data-stu-id="28ca8-126">The line of code that uses `let` just creates an asynchronous computation as an object that you can run later by using, for example, `Async.StartImmediate` or [`Async.RunSynchronously`](https://msdn.microsoft.com/library/0a6663a9-50f2-4d38-8bf3-cefd1a51fd6b).</span></span> <span data-ttu-id="28ca8-127">La línea de código que usa `let!` inicia el cálculo y, a continuación, se suspende el subproceso hasta que el resultado esté disponible, en qué punto de la ejecución continúa.</span><span class="sxs-lookup"><span data-stu-id="28ca8-127">The line of code that uses `let!` starts the computation, and then the thread is suspended until the result is available, at which point execution continues.</span></span>

```fsharp
// let just stores the result as an asynchronous operation.
let (result1 : Async<byte[]>) = stream.AsyncRead(bufferSize)
// let! completes the asynchronous operation and returns the data.
let! (result2 : byte[])  = stream.AsyncRead(bufferSize)
```

<span data-ttu-id="28ca8-128">Además `let!`, puede usar `use!` para realizar enlaces asincrónicos.</span><span class="sxs-lookup"><span data-stu-id="28ca8-128">In addition to `let!`, you can use `use!` to perform asynchronous bindings.</span></span> <span data-ttu-id="28ca8-129">La diferencia entre `let!` y `use!` es igual que la diferencia entre `let` y `use`.</span><span class="sxs-lookup"><span data-stu-id="28ca8-129">The difference between `let!` and `use!` is the same as the difference between `let` and `use`.</span></span> <span data-ttu-id="28ca8-130">Para `use!`, se elimina el objeto al final del ámbito actual.</span><span class="sxs-lookup"><span data-stu-id="28ca8-130">For `use!`, the object is disposed of at the close of the current scope.</span></span> <span data-ttu-id="28ca8-131">Tenga en cuenta que en la versión actual del lenguaje de F #, `use!` no permite un valor que se inicializa como null, aunque `use` does.</span><span class="sxs-lookup"><span data-stu-id="28ca8-131">Note that in the current release of the F# language, `use!` does not allow a value to be initialized to null, even though `use` does.</span></span>

## <a name="asynchronous-primitives"></a><span data-ttu-id="28ca8-132">Métodos primitivos asincrónicos</span><span class="sxs-lookup"><span data-stu-id="28ca8-132">Asynchronous Primitives</span></span>

<span data-ttu-id="28ca8-133">Se llama a un método que realiza una sola tarea asincrónica y devuelve el resultado un *primitivo asincrónico*, y estos están diseñados específicamente para su uso con `let!`.</span><span class="sxs-lookup"><span data-stu-id="28ca8-133">A method that performs a single asynchronous task and returns the result is called an *asynchronous primitive*, and these are designed specifically for use with `let!`.</span></span> <span data-ttu-id="28ca8-134">Varios métodos primitivos asincrónicos se definen en la biblioteca básica de F #.</span><span class="sxs-lookup"><span data-stu-id="28ca8-134">Several asynchronous primitives are defined in the F# core library.</span></span> <span data-ttu-id="28ca8-135">Dos de estos métodos para las aplicaciones Web se definen en el módulo [ `Microsoft.FSharp.Control.WebExtensions` ](https://msdn.microsoft.com/library/95ef17bc-ee3f-44ba-8a11-c90fcf4cf003): [ `WebRequest.AsyncGetResponse` ](https://msdn.microsoft.com/library/09a60c31-e6e2-4b5c-ad23-92a86e50060c) y [ `WebClient.AsyncDownloadString` ](https://msdn.microsoft.com/library/8a85a9b7-f712-4cac-a0ce-0a797f8ea32a).</span><span class="sxs-lookup"><span data-stu-id="28ca8-135">Two such methods for Web applications are defined in the module [`Microsoft.FSharp.Control.WebExtensions`](https://msdn.microsoft.com/library/95ef17bc-ee3f-44ba-8a11-c90fcf4cf003): [`WebRequest.AsyncGetResponse`](https://msdn.microsoft.com/library/09a60c31-e6e2-4b5c-ad23-92a86e50060c) and [`WebClient.AsyncDownloadString`](https://msdn.microsoft.com/library/8a85a9b7-f712-4cac-a0ce-0a797f8ea32a).</span></span> <span data-ttu-id="28ca8-136">Ambos métodos primitivos descargan datos desde una página Web, especificar una dirección URL.</span><span class="sxs-lookup"><span data-stu-id="28ca8-136">Both primitives download data from a Web page, given a URL.</span></span> <span data-ttu-id="28ca8-137">`AsyncGetResponse` genera un `System.Net.WebResponse` objeto, y `AsyncDownloadString` genera una cadena que representa el código HTML de una página Web.</span><span class="sxs-lookup"><span data-stu-id="28ca8-137">`AsyncGetResponse` produces a `System.Net.WebResponse` object, and `AsyncDownloadString` produces a string that represents the HTML for a Web page.</span></span>

<span data-ttu-id="28ca8-138">Varias primitivas para operaciones de E/S asincrónicas se incluyen en el [ `Microsoft.FSharp.Control.CommonExtensions` ](https://msdn.microsoft.com/library/2edb67cb-6814-4a30-849f-b6dbdd042396) módulo.</span><span class="sxs-lookup"><span data-stu-id="28ca8-138">Several primitives for asynchronous I/O operations are included in the [`Microsoft.FSharp.Control.CommonExtensions`](https://msdn.microsoft.com/library/2edb67cb-6814-4a30-849f-b6dbdd042396) module.</span></span> <span data-ttu-id="28ca8-139">Estos métodos de extensión de la `System.IO.Stream` clase [ `Stream.AsyncRead` ](https://msdn.microsoft.com/library/85698aaa-bdda-47e6-abed-3730f59fda5e) y [ `Stream.AsyncWrite` ](https://msdn.microsoft.com/library/1b0a2751-e42a-47e1-bd27-020224adc618).</span><span class="sxs-lookup"><span data-stu-id="28ca8-139">These extension methods of the `System.IO.Stream` class are [`Stream.AsyncRead`](https://msdn.microsoft.com/library/85698aaa-bdda-47e6-abed-3730f59fda5e) and [`Stream.AsyncWrite`](https://msdn.microsoft.com/library/1b0a2751-e42a-47e1-bd27-020224adc618).</span></span>

<span data-ttu-id="28ca8-140">Primitivas asincrónicas adicionales están disponibles en la [F # PowerTools](https://fsprojects.github.io/VisualFSharpPowerTools/).</span><span class="sxs-lookup"><span data-stu-id="28ca8-140">Additional asynchronous primitives are available in the [F# PowerTools](https://fsprojects.github.io/VisualFSharpPowerTools/).</span></span> <span data-ttu-id="28ca8-141">También puede escribir a sus propios métodos primitivos asincrónicos definiendo una función cuyo cuerpo completo se incluye en un bloque asincrónico.</span><span class="sxs-lookup"><span data-stu-id="28ca8-141">You can also write your own asynchronous primitives by defining a function whose complete body is enclosed in an async block.</span></span>

<span data-ttu-id="28ca8-142">Para usar métodos asincrónicos de .NET Framework que se han diseñado para otros modelos asincrónicos con el modelo de programación asincrónico de F #, cree una función que devuelve una F # `Async` objeto.</span><span class="sxs-lookup"><span data-stu-id="28ca8-142">To use asynchronous methods in the .NET Framework that are designed for other asynchronous models with the F# asynchronous programming model, you create a function that returns an F# `Async` object.</span></span> <span data-ttu-id="28ca8-143">La biblioteca de F # tiene funciones que facilitan este proceso realizar.</span><span class="sxs-lookup"><span data-stu-id="28ca8-143">The F# library has functions that make this easy to do.</span></span>

<span data-ttu-id="28ca8-144">Aquí, y se incluye un ejemplo del uso de flujos de trabajo asincrónicos Hay muchas otras en la documentación de los métodos de la [Async (clase)](https://msdn.microsoft.com/library/03eb4d12-a01a-4565-a077-5e83f17cf6f7).</span><span class="sxs-lookup"><span data-stu-id="28ca8-144">One example of using asynchronous workflows is included here; there are many others in the documentation for the methods of the [Async class](https://msdn.microsoft.com/library/03eb4d12-a01a-4565-a077-5e83f17cf6f7).</span></span>

<span data-ttu-id="28ca8-145">En este ejemplo se muestra cómo usar flujos de trabajo asincrónicos para realizar cálculos en paralelo.</span><span class="sxs-lookup"><span data-stu-id="28ca8-145">This example shows how to use asynchronous workflows to perform computations in parallel.</span></span>

<span data-ttu-id="28ca8-146">En el ejemplo de código siguiente, una función `fetchAsync` Obtiene el texto HTLM devuelto por una solicitud Web.</span><span class="sxs-lookup"><span data-stu-id="28ca8-146">In the following code example, a function `fetchAsync` gets the HTML text returned from a Web request.</span></span> <span data-ttu-id="28ca8-147">El `fetchAsync` función contiene un bloque de código asincrónico.</span><span class="sxs-lookup"><span data-stu-id="28ca8-147">The `fetchAsync` function contains an asynchronous block of code.</span></span> <span data-ttu-id="28ca8-148">Cuando se realiza un enlace con el resultado de un método primitivo asincrónico, en este caso [ `AsyncDownloadString` ](https://msdn.microsoft.com/library/8a85a9b7-f712-4cac-a0ce-0a797f8ea32a), permiten!</span><span class="sxs-lookup"><span data-stu-id="28ca8-148">When a binding is made to the result of an asynchronous primitive, in this case [`AsyncDownloadString`](https://msdn.microsoft.com/library/8a85a9b7-f712-4cac-a0ce-0a797f8ea32a), let!</span></span> <span data-ttu-id="28ca8-149">se utiliza en lugar de let.</span><span class="sxs-lookup"><span data-stu-id="28ca8-149">is used instead of let.</span></span>

<span data-ttu-id="28ca8-150">Use la función [ `Async.RunSynchronously` ](https://msdn.microsoft.com/library/0a6663a9-50f2-4d38-8bf3-cefd1a51fd6b) para ejecutar una operación asincrónica y espera su resultado.</span><span class="sxs-lookup"><span data-stu-id="28ca8-150">You use the function [`Async.RunSynchronously`](https://msdn.microsoft.com/library/0a6663a9-50f2-4d38-8bf3-cefd1a51fd6b) to execute an asynchronous operation and wait for its result.</span></span> <span data-ttu-id="28ca8-151">Por ejemplo, puede ejecutar varias operaciones asincrónicas en paralelo mediante la [ `Async.Parallel` ](https://msdn.microsoft.com/library/aa9b0355-2d55-4858-b943-cbe428de9dc4) funciona junto con el `Async.RunSynchronously` función.</span><span class="sxs-lookup"><span data-stu-id="28ca8-151">As an example, you can execute multiple asynchronous operations in parallel by using the [`Async.Parallel`](https://msdn.microsoft.com/library/aa9b0355-2d55-4858-b943-cbe428de9dc4) function together with the `Async.RunSynchronously` function.</span></span> <span data-ttu-id="28ca8-152">El `Async.Parallel` función toma una lista de los `Async` los objetos, configura el código para cada `Async` que se ejecute en paralelo y devuelve el objeto de tarea un `Async` objeto que representa el cálculo en paralelo.</span><span class="sxs-lookup"><span data-stu-id="28ca8-152">The `Async.Parallel` function takes a list of the `Async` objects, sets up the code for each `Async` task object to run in parallel, and returns an `Async` object that represents the parallel computation.</span></span> <span data-ttu-id="28ca8-153">Como ocurre con una sola operación, se llama a `Async.RunSynchronously` para iniciar la ejecución.</span><span class="sxs-lookup"><span data-stu-id="28ca8-153">Just as for a single operation, you call `Async.RunSynchronously` to start the execution.</span></span>

<span data-ttu-id="28ca8-154">El `runAll` función inicia tres flujos de trabajo asincrónicos en paralelo y espera hasta que todos hayan finalizado.</span><span class="sxs-lookup"><span data-stu-id="28ca8-154">The `runAll` function launches three asynchronous workflows in parallel and waits until they have all completed.</span></span>

[!code-fsharp[Main](../../../samples/snippets/fsharp/lang-ref-2/snippet8003.fs)]

## <a name="see-also"></a><span data-ttu-id="28ca8-155">Vea también</span><span class="sxs-lookup"><span data-stu-id="28ca8-155">See Also</span></span>

[<span data-ttu-id="28ca8-156">Referencia del lenguaje F#</span><span class="sxs-lookup"><span data-stu-id="28ca8-156">F# Language Reference</span></span>](index.md)

[<span data-ttu-id="28ca8-157">Expresiones de cálculo</span><span class="sxs-lookup"><span data-stu-id="28ca8-157">Computation Expressions</span></span>](computation-expressions.md)

[<span data-ttu-id="28ca8-158">Control.Async (clase)</span><span class="sxs-lookup"><span data-stu-id="28ca8-158">Control.Async Class</span></span>](https://msdn.microsoft.com/visualfsharpdocs/conceptual/control.async-class-%5bfsharp%5d)
