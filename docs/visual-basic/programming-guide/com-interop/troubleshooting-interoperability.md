---
title: Solucionar problemas de interoperabilidad (Visual Basic)
ms.date: 07/20/2015
helpviewer_keywords:
- interop, deploying assemblies
- assemblies [Visual Basic]
- interop, installing assemblies that share components
- COM objects, troubleshooting
- interop, sharing components
- troubleshooting interoperability [Visual Basic]
- interoperability, troubleshooting
- COM interop [Visual Basic], troubleshooting
- assemblies [Visual Basic], deploying
- troubleshooting Visual Basic, interoperability
- interop assemblies
- interoperability, sharing components
- shared components, using with assemblies
ms.assetid: b324cc1e-b03c-4f39-aea6-6a6d5bfd0e37
ms.openlocfilehash: 413c9331611d3406c13df58f25db1ef0255339b6
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/23/2019
ms.locfileid: "54517674"
---
# <a name="troubleshooting-interoperability-visual-basic"></a><span data-ttu-id="b1e66-102">Solucionar problemas de interoperabilidad (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="b1e66-102">Troubleshooting Interoperability (Visual Basic)</span></span>
<span data-ttu-id="b1e66-103">Cuando se interoperar entre COM y el código administrado de la [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)], puede encontrar uno o varios de los siguientes problemas comunes.</span><span class="sxs-lookup"><span data-stu-id="b1e66-103">When you interoperate between COM and the managed code of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)], you may encounter one or more of the following common issues.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor1"></a> <span data-ttu-id="b1e66-104">Serialización de interoperabilidad</span><span class="sxs-lookup"><span data-stu-id="b1e66-104">Interop Marshaling</span></span>  
 <span data-ttu-id="b1e66-105">En ocasiones, es posible que deba utilizar tipos de datos que no son parte de la [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="b1e66-105">At times, you may have to use data types that are not part of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="b1e66-106">Ensamblados de interoperabilidad controlan la mayoría del trabajo para objetos COM, pero es posible que deba controlar los tipos de datos que se usan cuando los objetos administrados se exponen a COM.</span><span class="sxs-lookup"><span data-stu-id="b1e66-106">Interop assemblies handle most of the work for COM objects, but you may have to control the data types that are used when managed objects are exposed to COM.</span></span> <span data-ttu-id="b1e66-107">Por ejemplo, las estructuras de las bibliotecas de clases deben especificar el `BStr` tipo en las cadenas enviadas a los objetos COM creados con Visual Basic 6.0 y versiones anteriores no administrado.</span><span class="sxs-lookup"><span data-stu-id="b1e66-107">For example, structures in class libraries must specify the `BStr` unmanaged type on strings sent to COM objects created by Visual Basic 6.0 and earlier versions.</span></span> <span data-ttu-id="b1e66-108">En tales casos, puede usar el <xref:System.Runtime.InteropServices.MarshalAsAttribute> atributo para tipos administrados se expongan como tipos no administrados.</span><span class="sxs-lookup"><span data-stu-id="b1e66-108">In such cases, you can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute to cause managed types to be exposed as unmanaged types.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor2"></a> <span data-ttu-id="b1e66-109">Exportación de cadenas de longitud fija a código no administrado</span><span class="sxs-lookup"><span data-stu-id="b1e66-109">Exporting Fixed-Length Strings to Unmanaged Code</span></span>  
 <span data-ttu-id="b1e66-110">En Visual Basic 6.0 y versiones anteriores, las cadenas se exportan a objetos COM como secuencias de bytes sin un carácter de terminación null.</span><span class="sxs-lookup"><span data-stu-id="b1e66-110">In Visual Basic 6.0 and earlier versions, strings are exported to COM objects as sequences of bytes without a null termination character.</span></span> <span data-ttu-id="b1e66-111">Por compatibilidad con otros lenguajes, Visual Basic .NET incluye un carácter de terminación al exportar cadenas.</span><span class="sxs-lookup"><span data-stu-id="b1e66-111">For compatibility with other languages, Visual Basic .NET includes a termination character when exporting strings.</span></span> <span data-ttu-id="b1e66-112">La mejor manera de solucionar esta incompatibilidad es exportar las cadenas que falta el carácter de terminación como matrices de `Byte` o `Char`.</span><span class="sxs-lookup"><span data-stu-id="b1e66-112">The best way to address this incompatibility is to export strings that lack the termination character as arrays of `Byte` or `Char`.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor3"></a> <span data-ttu-id="b1e66-113">Exportación de jerarquías de herencia</span><span class="sxs-lookup"><span data-stu-id="b1e66-113">Exporting Inheritance Hierarchies</span></span>  
 <span data-ttu-id="b1e66-114">Jerarquías desaparecen cuando se exponen como objetos COM de clase administrada.</span><span class="sxs-lookup"><span data-stu-id="b1e66-114">Managed class hierarchies flatten out when exposed as COM objects.</span></span> <span data-ttu-id="b1e66-115">Por ejemplo, si define una clase base con un miembro y, a continuación, heredar la clase base en una clase derivada que se expone como un objeto COM, los clientes que usan la clase derivada en el objeto COM no podrá utilizar a los miembros heredados.</span><span class="sxs-lookup"><span data-stu-id="b1e66-115">For example, if you define a base class with a member, and then inherit the base class in a derived class that is exposed as a COM object, clients that use the derived class in the COM object will not be able to use the inherited members.</span></span> <span data-ttu-id="b1e66-116">Los miembros de clase base se pueden acceder desde los objetos COM sólo como instancias de una clase base y, a continuación, solo si la clase base también se crea como un objeto COM.</span><span class="sxs-lookup"><span data-stu-id="b1e66-116">Base class members can be accessed from COM objects only as instances of a base class, and then only if the base class is also created as a COM object.</span></span>  
  
## <a name="overloaded-methods"></a><span data-ttu-id="b1e66-117">Métodos sobrecargados</span><span class="sxs-lookup"><span data-stu-id="b1e66-117">Overloaded Methods</span></span>  
 <span data-ttu-id="b1e66-118">Aunque puede crear métodos sobrecargados con Visual Basic, no son compatibles con COM.</span><span class="sxs-lookup"><span data-stu-id="b1e66-118">Although you can create overloaded methods with Visual Basic, they are not supported by COM.</span></span> <span data-ttu-id="b1e66-119">Cuando una clase que contiene métodos sobrecargados se expone como un objeto COM, se generan nuevos nombres de método para los métodos sobrecargados.</span><span class="sxs-lookup"><span data-stu-id="b1e66-119">When a class that contains overloaded methods is exposed as a COM object, new method names are generated for the overloaded methods.</span></span>  
  
 <span data-ttu-id="b1e66-120">Por ejemplo, considere la posibilidad de una clase que tiene dos sobrecargas de los `Synch` método.</span><span class="sxs-lookup"><span data-stu-id="b1e66-120">For example, consider a class that has two overloads of the `Synch` method.</span></span> <span data-ttu-id="b1e66-121">Cuando la clase se expone como un objeto COM, los nuevos nombres de método generados podrían ser `Synch` y `Synch_2`.</span><span class="sxs-lookup"><span data-stu-id="b1e66-121">When the class is exposed as a COM object, the new generated method names could be `Synch` and `Synch_2`.</span></span>  
  
 <span data-ttu-id="b1e66-122">El cambio de nombre puede producir dos problemas para los consumidores del objeto COM.</span><span class="sxs-lookup"><span data-stu-id="b1e66-122">The renaming can cause two problems for consumers of the COM object.</span></span>  
  
1.  <span data-ttu-id="b1e66-123">Los clientes no podrían esperar que los nombres de método generado.</span><span class="sxs-lookup"><span data-stu-id="b1e66-123">Clients might not expect the generated method names.</span></span>  
  
2.  <span data-ttu-id="b1e66-124">Pueden cambiar los nombres de método generado en la clase que se expone como un objeto COM cuando se agregan nuevas sobrecargas a la clase o su clase base.</span><span class="sxs-lookup"><span data-stu-id="b1e66-124">The generated method names in the class exposed as a COM object can change when new overloads are added to the class or its base class.</span></span> <span data-ttu-id="b1e66-125">Esto puede causar problemas de control de versiones.</span><span class="sxs-lookup"><span data-stu-id="b1e66-125">This can cause versioning problems.</span></span>  
  
 <span data-ttu-id="b1e66-126">Para solucionar dos problemas, dele a cada método un nombre único, en lugar de usar la sobrecarga, al desarrollar los objetos que se expondrán como objetos COM.</span><span class="sxs-lookup"><span data-stu-id="b1e66-126">To solve both problems, give each method a unique name, instead of using overloading, when you develop objects that will be exposed as COM objects.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor4"></a> <span data-ttu-id="b1e66-127">Uso de objetos COM mediante ensamblados de interoperabilidad</span><span class="sxs-lookup"><span data-stu-id="b1e66-127">Use of COM Objects Through Interop Assemblies</span></span>  
 <span data-ttu-id="b1e66-128">Usar ensamblados de interoperabilidad casi como si fueran equivalentes de código administrado para los objetos COM que representan.</span><span class="sxs-lookup"><span data-stu-id="b1e66-128">You use interop assemblies almost as if they are managed code replacements for the COM objects they represent.</span></span> <span data-ttu-id="b1e66-129">Sin embargo, dado que son contenedores y no objetos COM reales, hay algunas diferencias entre el uso de ensamblados de interoperabilidad y ensamblados estándar.</span><span class="sxs-lookup"><span data-stu-id="b1e66-129">However, because they are wrappers and not actual COM objects, there are some differences between using interop assemblies and standard assemblies.</span></span> <span data-ttu-id="b1e66-130">Estas áreas de diferencia incluyen la exposición de las clases y tipos de datos para los parámetros y valores devueltos.</span><span class="sxs-lookup"><span data-stu-id="b1e66-130">These areas of difference include the exposure of classes, and data types for parameters and return values.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor5"></a> <span data-ttu-id="b1e66-131">Clases expuestas como ambas Interfaces y clases</span><span class="sxs-lookup"><span data-stu-id="b1e66-131">Classes Exposed as Both Interfaces and Classes</span></span>  
 <span data-ttu-id="b1e66-132">A diferencia de las clases de ensamblados estándares, las clases COM se exponen en los ensamblados de interoperabilidad como una interfaz y una clase que representa la clase COM.</span><span class="sxs-lookup"><span data-stu-id="b1e66-132">Unlike classes in standard assemblies, COM classes are exposed in interop assemblies as both an interface and a class that represents the COM class.</span></span> <span data-ttu-id="b1e66-133">Nombre de la interfaz es idéntico de la clase COM.</span><span class="sxs-lookup"><span data-stu-id="b1e66-133">The interface's name is identical to that of the COM class.</span></span> <span data-ttu-id="b1e66-134">El nombre de la clase de interoperabilidad es el mismo que el de la clase COM original, pero con la palabra "Class" anexado.</span><span class="sxs-lookup"><span data-stu-id="b1e66-134">The name of the interop class is the same as that of the original COM class, but with the word "Class" appended.</span></span> <span data-ttu-id="b1e66-135">Por ejemplo, suponga que tiene un proyecto con una referencia a un ensamblado de interoperabilidad para un objeto COM.</span><span class="sxs-lookup"><span data-stu-id="b1e66-135">For example, suppose you have a project with a reference to an interop assembly for a COM object.</span></span> <span data-ttu-id="b1e66-136">Si la clase COM se denomina `MyComClass`, IntelliSense y el Examinador de objetos muestran una interfaz denominada `MyComClass` y una clase denominada `MyComClassClass`.</span><span class="sxs-lookup"><span data-stu-id="b1e66-136">If the COM class is named `MyComClass`, IntelliSense and the Object Browser show an interface named `MyComClass` and a class named `MyComClassClass`.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor6"></a> <span data-ttu-id="b1e66-137">Creación de instancias de una clase de .NET Framework</span><span class="sxs-lookup"><span data-stu-id="b1e66-137">Creating Instances of a .NET Framework Class</span></span>  
 <span data-ttu-id="b1e66-138">Por lo general, se crea una instancia de un [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] clase utilizando el `New` instrucción con un nombre de clase.</span><span class="sxs-lookup"><span data-stu-id="b1e66-138">Generally, you create an instance of a [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] class using the `New` statement with a class name.</span></span> <span data-ttu-id="b1e66-139">Una clase COM representada por un ensamblado de interoperabilidad es el caso en que se puede utilizar el `New` instrucción con una interfaz.</span><span class="sxs-lookup"><span data-stu-id="b1e66-139">Having a COM class represented by an interop assembly is the one case in which you can use the `New` statement with an interface.</span></span> <span data-ttu-id="b1e66-140">A menos que se utiliza la clase COM con un `Inherits` instrucción, puede usar la interfaz tal como lo haría en una clase.</span><span class="sxs-lookup"><span data-stu-id="b1e66-140">Unless you are using the COM class with an `Inherits` statement, you can use the interface just as you would a class.</span></span> <span data-ttu-id="b1e66-141">El código siguiente muestra cómo crear un `Command` objeto en un proyecto que tiene una referencia al objeto COM de la biblioteca de Microsoft ActiveX Data Objects 2.8:</span><span class="sxs-lookup"><span data-stu-id="b1e66-141">The following code demonstrates how to create a `Command` object in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object:</span></span>  
  
 [!code-vb[VbVbalrInterop#20](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_1.vb)]  
  
 <span data-ttu-id="b1e66-142">Sin embargo, si usas la clase COM como base para una clase derivada, debe usar la clase de interoperabilidad que representa la clase COM, como se muestra en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="b1e66-142">However, if you are using the COM class as the base for a derived class, you must use the interop class that represents the COM class, as in the following code:</span></span>  
  
 [!code-vb[VbVbalrInterop#21](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_2.vb)]  
  
> [!NOTE]
>  <span data-ttu-id="b1e66-143">Ensamblados de interoperabilidad implementan implícitamente interfaces que representan las clases COM.</span><span class="sxs-lookup"><span data-stu-id="b1e66-143">Interop assemblies implicitly implement interfaces that represent COM classes.</span></span> <span data-ttu-id="b1e66-144">No debe intentar usar el `Implements` dará como resultado la instrucción para implementar estas interfaces o un error.</span><span class="sxs-lookup"><span data-stu-id="b1e66-144">You should not try to use the `Implements` statement to implement these interfaces or an error will result.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor7"></a> <span data-ttu-id="b1e66-145">Tipos de datos para los parámetros y valores devueltos</span><span class="sxs-lookup"><span data-stu-id="b1e66-145">Data Types for Parameters and Return Values</span></span>  
 <span data-ttu-id="b1e66-146">A diferencia de los miembros de los ensamblados estándar, los miembros del ensamblado de interoperabilidad pueden tener tipos de datos que difieren de aquéllos utilizados en la declaración del objeto original.</span><span class="sxs-lookup"><span data-stu-id="b1e66-146">Unlike members of standard assemblies, interop assembly members may have data types that differ from those used in the  original object declaration.</span></span> <span data-ttu-id="b1e66-147">Aunque los ensamblados de interoperabilidad convierten implícitamente los tipos COM en tipos compatibles con common language runtime, debe prestar atención a los tipos de datos que se usan en los dos lados para evitar errores en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="b1e66-147">Although interop assemblies implicitly convert COM types to compatible common language runtime types, you should pay attention to the data types that are used by both sides to prevent runtime errors.</span></span> <span data-ttu-id="b1e66-148">Por ejemplo, en los objetos COM creados en Visual Basic 6.0 y versiones anteriores, los valores de tipo `Integer` suponen la [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] tipo equivalente, `Short`.</span><span class="sxs-lookup"><span data-stu-id="b1e66-148">For example, in COM objects created in Visual Basic 6.0 and earlier versions, values of type `Integer` assume the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] equivalent type, `Short`.</span></span> <span data-ttu-id="b1e66-149">Se recomienda que use el Examinador de objetos para examinar las características de los miembros importados antes de usarlos.</span><span class="sxs-lookup"><span data-stu-id="b1e66-149">It is recommended that you use the Object Browser to examine the characteristics of imported members before you use them.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor8"></a> <span data-ttu-id="b1e66-150">Métodos COM de nivel de módulo</span><span class="sxs-lookup"><span data-stu-id="b1e66-150">Module level COM methods</span></span>  
 <span data-ttu-id="b1e66-151">Se usa la mayoría de los objetos COM mediante la creación de una instancia de una clase COM mediante la `New` palabra clave y, a continuación, llamar a métodos del objeto.</span><span class="sxs-lookup"><span data-stu-id="b1e66-151">Most COM objects are used by creating an instance of a COM class using the `New` keyword and then calling methods of the object.</span></span> <span data-ttu-id="b1e66-152">Una excepción a esta regla implica objetos COM que contienen `AppObj` o `GlobalMultiUse` clases COM.</span><span class="sxs-lookup"><span data-stu-id="b1e66-152">One exception to this rule involves COM objects that contain `AppObj` or `GlobalMultiUse` COM classes.</span></span> <span data-ttu-id="b1e66-153">Estas clases son similares a los métodos de nivel de módulo en las clases de Visual Basic. NET.</span><span class="sxs-lookup"><span data-stu-id="b1e66-153">Such classes resemble module level methods in Visual Basic .NET classes.</span></span> <span data-ttu-id="b1e66-154">Visual Basic 6.0 y versiones anteriores crean implícitamente instancias de estos objetos la primera vez que se llame a uno de sus métodos.</span><span class="sxs-lookup"><span data-stu-id="b1e66-154">Visual Basic 6.0 and earlier versions implicitly create instances of such objects for you the first time that you call one of their methods.</span></span> <span data-ttu-id="b1e66-155">Por ejemplo, en Visual Basic 6.0 puede agregar una referencia a la biblioteca de objetos de Microsoft DAO 3.6 y llamar a la `DBEngine` método sin crear primero una instancia:</span><span class="sxs-lookup"><span data-stu-id="b1e66-155">For example, in Visual Basic 6.0 you can add a reference to the Microsoft DAO 3.6 Object Library and call the `DBEngine` method without first creating an instance:</span></span>  
  
```vb  
Dim db As DAO.Database  
' Open the database.  
Set db = DBEngine.OpenDatabase("C:\nwind.mdb")  
' Use the database object.  
```  
  
 <span data-ttu-id="b1e66-156">Visual Basic .NET requiere que siempre se creen instancias de objetos COM para poder usar sus métodos.</span><span class="sxs-lookup"><span data-stu-id="b1e66-156">Visual Basic .NET requires that you always create instances of COM objects before you can use their methods.</span></span> <span data-ttu-id="b1e66-157">Para usar estos métodos en Visual Basic, declare una variable de la clase deseada y usar la palabra clave new para asignar el objeto a la variable de objeto.</span><span class="sxs-lookup"><span data-stu-id="b1e66-157">To use these methods in Visual Basic, declare a variable of the desired class and use the new keyword to assign the object to the object variable.</span></span> <span data-ttu-id="b1e66-158">El `Shared` palabra clave se puede usar cuando desee asegurarse de que solo una instancia de la clase se crea.</span><span class="sxs-lookup"><span data-stu-id="b1e66-158">The `Shared` keyword can be used when you want to make sure that only one instance of the class is created.</span></span>  
  
 [!code-vb[VbVbalrInterop#23](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_3.vb)]  
  
##  <a name="vbconinteroperabilitymarshalinganchor9"></a> <span data-ttu-id="b1e66-159">Errores no controlados en los controladores de eventos</span><span class="sxs-lookup"><span data-stu-id="b1e66-159">Unhandled Errors in Event Handlers</span></span>  
 <span data-ttu-id="b1e66-160">Un problema de interoperabilidad común implica errores en los controladores de eventos que controlan los eventos generados por objetos COM.</span><span class="sxs-lookup"><span data-stu-id="b1e66-160">One common interop problem involves errors in event handlers that handle events raised by COM objects.</span></span> <span data-ttu-id="b1e66-161">Estos errores se omiten a menos que busque específicamente errores mediante `On Error` o `Try...Catch...Finally` instrucciones.</span><span class="sxs-lookup"><span data-stu-id="b1e66-161">Such errors are ignored unless you specifically check for errors using `On Error` or `Try...Catch...Finally` statements.</span></span> <span data-ttu-id="b1e66-162">Por ejemplo, el siguiente ejemplo es de un proyecto de Visual Basic .NET que tiene una referencia al objeto COM de la biblioteca de Microsoft ActiveX Data Objects 2.8.</span><span class="sxs-lookup"><span data-stu-id="b1e66-162">For example, the following example is from a Visual Basic .NET project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object.</span></span>  
  
 [!code-vb[VbVbalrInterop#24](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_4.vb)]  
  
 <span data-ttu-id="b1e66-163">En este ejemplo genera un error según lo previsto.</span><span class="sxs-lookup"><span data-stu-id="b1e66-163">This example raises an error as expected.</span></span> <span data-ttu-id="b1e66-164">Sin embargo, si intenta el mismo ejemplo sin el `Try...Catch...Finally` bloque, el error se omite como si ha usado el `OnError Resume Next` instrucción.</span><span class="sxs-lookup"><span data-stu-id="b1e66-164">However, if you try the same example without the `Try...Catch...Finally` block, the error is ignored as if you used the `OnError Resume Next` statement.</span></span> <span data-ttu-id="b1e66-165">Sin control de errores, la división por cero en modo silencioso se produce un error.</span><span class="sxs-lookup"><span data-stu-id="b1e66-165">Without error handling, the division by zero silently fails.</span></span> <span data-ttu-id="b1e66-166">Dado que tales errores nunca producen errores de excepción no controlada, es importante usar algún tipo de control de excepciones en los controladores de eventos que controlan los eventos de objetos COM.</span><span class="sxs-lookup"><span data-stu-id="b1e66-166">Because such errors never raise unhandled exception errors, it is important that you use some form of exception handling in event handlers that handle events from COM objects.</span></span>  
  
### <a name="understanding-com-interop-errors"></a><span data-ttu-id="b1e66-167">Descripción de los errores de interoperabilidad COM</span><span class="sxs-lookup"><span data-stu-id="b1e66-167">Understanding COM interop errors</span></span>  
 <span data-ttu-id="b1e66-168">Sin control de errores, las llamadas de interoperabilidad suelen generan errores que proporcionan poca información.</span><span class="sxs-lookup"><span data-stu-id="b1e66-168">Without error handling, interop calls often generate errors that provide little information.</span></span> <span data-ttu-id="b1e66-169">Siempre que sea posible, utilice el control para proporcionar más información acerca de los problemas cuando surjan de errores estructurado.</span><span class="sxs-lookup"><span data-stu-id="b1e66-169">Whenever possible, use structured error handling to provide more information about problems when they occur.</span></span> <span data-ttu-id="b1e66-170">Esto puede resultar especialmente útil al depurar aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="b1e66-170">This can be especially helpful when you debug applications.</span></span> <span data-ttu-id="b1e66-171">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="b1e66-171">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#25](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_5.vb)]  
  
 <span data-ttu-id="b1e66-172">Puede encontrar información como la descripción del error, HRESULT y el origen de errores de COM examinando el contenido del objeto de excepción.</span><span class="sxs-lookup"><span data-stu-id="b1e66-172">You can find information such as the error description, HRESULT, and the source of COM errors by examining the contents of the exception object.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor10"></a> <span data-ttu-id="b1e66-173">Problemas con el Control ActiveX</span><span class="sxs-lookup"><span data-stu-id="b1e66-173">ActiveX Control Issues</span></span>  
 <span data-ttu-id="b1e66-174">La mayoría de los controles ActiveX que funcionan con Visual Basic 6.0 funcionan con Visual Basic .NET sin problemas.</span><span class="sxs-lookup"><span data-stu-id="b1e66-174">Most ActiveX controls that work with Visual Basic 6.0 work with Visual Basic .NET without trouble.</span></span> <span data-ttu-id="b1e66-175">Las excepciones principales son los controles del contenedor o los controles que contienen visualmente de otros controles.</span><span class="sxs-lookup"><span data-stu-id="b1e66-175">The main exceptions are container controls, or controls that visually contain other controls.</span></span> <span data-ttu-id="b1e66-176">Algunos ejemplos de controles más antiguos que no funcionan correctamente con Visual Studio son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="b1e66-176">Some examples of older controls that do not work correctly with Visual Studio are as follows:</span></span>  
  
-   <span data-ttu-id="b1e66-177">Microsoft Forms 2.0 Frame (control)</span><span class="sxs-lookup"><span data-stu-id="b1e66-177">Microsoft Forms 2.0 Frame control</span></span>  
  
-   <span data-ttu-id="b1e66-178">Control de flechas, también conocido como el control de número</span><span class="sxs-lookup"><span data-stu-id="b1e66-178">Up-Down control, also known as the spin control</span></span>  
  
-   <span data-ttu-id="b1e66-179">Control Tab Sheridan</span><span class="sxs-lookup"><span data-stu-id="b1e66-179">Sheridan Tab Control</span></span>  
  
 <span data-ttu-id="b1e66-180">Hay sólo unas pocas soluciones para problemas de control de ActiveX no admitidos.</span><span class="sxs-lookup"><span data-stu-id="b1e66-180">There are only a few workarounds for unsupported ActiveX control problems.</span></span> <span data-ttu-id="b1e66-181">Puede migrar los controles existentes a Visual Studio si es propietario del código fuente original.</span><span class="sxs-lookup"><span data-stu-id="b1e66-181">You can migrate existing controls to Visual Studio if you own the original source code.</span></span> <span data-ttu-id="b1e66-182">En caso contrario, puede comprobar con proveedores de software para actualizar. Las versiones compatibles con NET de controles para reemplazar no admite controles ActiveX.</span><span class="sxs-lookup"><span data-stu-id="b1e66-182">Otherwise, you can check with software vendors for updated .NET-compatible versions of controls to replace unsupported ActiveX controls.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor11"></a> <span data-ttu-id="b1e66-183">Pasar propiedades ReadOnly de controles ByRef</span><span class="sxs-lookup"><span data-stu-id="b1e66-183">Passing ReadOnly Properties of Controls ByRef</span></span>  
 <span data-ttu-id="b1e66-184">Visual Basic .NET a veces genera errores COM como "Error 0x800A017F CTL_E_SETNOTSUPPORTED", al pasar `ReadOnly` propiedades de algunos controles ActiveX antiguos como `ByRef` parámetros a otros procedimientos.</span><span class="sxs-lookup"><span data-stu-id="b1e66-184">Visual Basic .NET sometimes raises COM errors such as, "Error 0x800A017F CTL_E_SETNOTSUPPORTED", when you pass `ReadOnly` properties of some older ActiveX controls as `ByRef` parameters to other procedures.</span></span> <span data-ttu-id="b1e66-185">Llamadas a procedimientos similares de Visual Basic 6.0 no producen un error y los parámetros se tratan como si se pasaran por valor.</span><span class="sxs-lookup"><span data-stu-id="b1e66-185">Similar procedure calls from Visual Basic 6.0 do not raise an error, and the parameters are treated as if you passed them by value.</span></span> <span data-ttu-id="b1e66-186">El mensaje de error de Visual Basic .NET indica que está intentando cambiar una propiedad que no tiene una propiedad `Set` procedimiento.</span><span class="sxs-lookup"><span data-stu-id="b1e66-186">The Visual Basic .NET error message indicates that you are trying to change a property that does not have a property `Set` procedure.</span></span>  
  
 <span data-ttu-id="b1e66-187">Si tiene acceso al procedimiento que se llama, puede evitar este error mediante el `ByVal` palabra clave para declarar los parámetros que aceptan `ReadOnly` propiedades.</span><span class="sxs-lookup"><span data-stu-id="b1e66-187">If you have access to the procedure being called, you can prevent this error by using the `ByVal` keyword to declare parameters that accept `ReadOnly` properties.</span></span> <span data-ttu-id="b1e66-188">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="b1e66-188">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#26](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_6.vb)]  
  
 <span data-ttu-id="b1e66-189">Si no tiene acceso al código fuente para el procedimiento que se llama, puede forzar la propiedad que se pasará por valor mediante la adición de un conjunto adicional de los corchetes que encierran el procedimiento que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="b1e66-189">If you do not have access to the source code for the procedure being called, you can force the property to be passed by value by adding an extra set of brackets around the calling procedure.</span></span> <span data-ttu-id="b1e66-190">Por ejemplo, en un proyecto que tiene una referencia al objeto COM de la biblioteca de Microsoft ActiveX Data Objects 2.8, puede usar:</span><span class="sxs-lookup"><span data-stu-id="b1e66-190">For example, in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object, you can use:</span></span>  
  
 [!code-vb[VbVbalrInterop#27](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_7.vb)]  
  
##  <a name="vbconinteroperabilitymarshalinganchor12"></a> <span data-ttu-id="b1e66-191">Implementar ensamblados que expongan interoperabilidad</span><span class="sxs-lookup"><span data-stu-id="b1e66-191">Deploying Assemblies That Expose Interop</span></span>  
 <span data-ttu-id="b1e66-192">Implementar ensamblados que expongan interfaces COM presenta algunos desafíos únicos.</span><span class="sxs-lookup"><span data-stu-id="b1e66-192">Deploying assemblies that expose COM interfaces presents some unique challenges.</span></span> <span data-ttu-id="b1e66-193">Por ejemplo, un posible problema se produce cuando las aplicaciones independientes hacen referencia al mismo ensamblado COM.</span><span class="sxs-lookup"><span data-stu-id="b1e66-193">For example, a potential problem occurs when separate applications reference the same COM assembly.</span></span> <span data-ttu-id="b1e66-194">Esta situación es común cuando se instala una nueva versión de un ensamblado y otra aplicación todavía está utilizando la versión anterior del ensamblado.</span><span class="sxs-lookup"><span data-stu-id="b1e66-194">This situation is common when a new version of an assembly is installed and another application is still using the old version of the assembly.</span></span> <span data-ttu-id="b1e66-195">Si desinstala un ensamblado que comparte un archivo DLL, puede involuntariamente hacerlo disponible para otros ensamblados.</span><span class="sxs-lookup"><span data-stu-id="b1e66-195">If you uninstall an assembly that shares a DLL, you can unintentionally make it unavailable to the other assemblies.</span></span>  
  
 <span data-ttu-id="b1e66-196">Para evitar este problema, debe instalar a los ensamblados compartidos en la caché de ensamblados Global (GAC) y usar un módulo de combinación para el componente.</span><span class="sxs-lookup"><span data-stu-id="b1e66-196">To avoid this problem, you should install shared assemblies to the Global Assembly Cache (GAC) and use a MergeModule for the component.</span></span> <span data-ttu-id="b1e66-197">Si no se puede instalar la aplicación en la GAC, debe instalarse en CommonFilesFolder en un subdirectorio específico de la versión.</span><span class="sxs-lookup"><span data-stu-id="b1e66-197">If you cannot install the application in the GAC, it should be installed to CommonFilesFolder in a version-specific subdirectory.</span></span>  
  
 <span data-ttu-id="b1e66-198">Los ensamblados compartidos no deben estar en paralelo en el directorio con la aplicación que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="b1e66-198">Assemblies that are not shared should be located side by side in the directory with the calling application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b1e66-199">Vea también</span><span class="sxs-lookup"><span data-stu-id="b1e66-199">See also</span></span>

- <xref:System.Runtime.InteropServices.MarshalAsAttribute>
- [<span data-ttu-id="b1e66-200">Interoperabilidad COM</span><span class="sxs-lookup"><span data-stu-id="b1e66-200">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)
- [<span data-ttu-id="b1e66-201">TlbImp.exe (Importador de la biblioteca de tipos)</span><span class="sxs-lookup"><span data-stu-id="b1e66-201">Tlbimp.exe (Type Library Importer)</span></span>](../../../framework/tools/tlbimp-exe-type-library-importer.md)
- [<span data-ttu-id="b1e66-202">Tlbexp.exe (Exportador de la biblioteca de tipos)</span><span class="sxs-lookup"><span data-stu-id="b1e66-202">Tlbexp.exe (Type Library Exporter)</span></span>](../../../framework/tools/tlbexp-exe-type-library-exporter.md)
- [<span data-ttu-id="b1e66-203">Tutorial: Implementar la herencia mediante objetos COM</span><span class="sxs-lookup"><span data-stu-id="b1e66-203">Walkthrough: Implementing Inheritance with COM Objects</span></span>](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)
- [<span data-ttu-id="b1e66-204">Inherits (instrucción)</span><span class="sxs-lookup"><span data-stu-id="b1e66-204">Inherits Statement</span></span>](../../../visual-basic/language-reference/statements/inherits-statement.md)
- [<span data-ttu-id="b1e66-205">Caché global de ensamblados</span><span class="sxs-lookup"><span data-stu-id="b1e66-205">Global Assembly Cache</span></span>](../../../framework/app-domains/gac.md)
