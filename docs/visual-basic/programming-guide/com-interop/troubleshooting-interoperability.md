---
title: Solución de problemas de interoperabilidad
ms.date: 07/20/2015
helpviewer_keywords:
- interop, deploying assemblies
- assemblies [Visual Basic]
- interop, installing assemblies that share components
- COM objects, troubleshooting
- interop, sharing components
- troubleshooting interoperability [Visual Basic]
- interoperability, troubleshooting
- COM interop [Visual Basic], troubleshooting
- assemblies [Visual Basic], deploying
- troubleshooting Visual Basic, interoperability
- interop assemblies
- interoperability, sharing components
- shared components, using with assemblies
ms.assetid: b324cc1e-b03c-4f39-aea6-6a6d5bfd0e37
ms.openlocfilehash: 0890bac80396feaf37d4ba917c1e3fafb8579981
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 06/04/2020
ms.locfileid: "84396771"
---
# <a name="troubleshooting-interoperability-visual-basic"></a><span data-ttu-id="f6d9a-102">Solucionar problemas de interoperabilidad (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="f6d9a-102">Troubleshooting Interoperability (Visual Basic)</span></span>
<span data-ttu-id="f6d9a-103">Al interoperar entre COM y el código administrado del .NET Framework, puede encontrar uno o varios de los siguientes problemas comunes.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-103">When you interoperate between COM and the managed code of the .NET Framework, you may encounter one or more of the following common issues.</span></span>  
  
## <a name="interop-marshaling"></a><a name="vbconinteroperabilitymarshalinganchor1"></a><span data-ttu-id="f6d9a-104">Serialización de interoperabilidad</span><span class="sxs-lookup"><span data-stu-id="f6d9a-104">Interop Marshaling</span></span>  
 <span data-ttu-id="f6d9a-105">En ocasiones, puede que tenga que usar tipos de datos que no forman parte de la .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-105">At times, you may have to use data types that are not part of the .NET Framework.</span></span> <span data-ttu-id="f6d9a-106">Los ensamblados de interoperabilidad controlan la mayor parte del trabajo de los objetos COM, pero puede que tenga que controlar los tipos de datos que se utilizan cuando los objetos administrados se exponen a COM.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-106">Interop assemblies handle most of the work for COM objects, but you may have to control the data types that are used when managed objects are exposed to COM.</span></span> <span data-ttu-id="f6d9a-107">Por ejemplo, las estructuras de las bibliotecas de clases deben especificar el `BStr` tipo no administrado en las cadenas enviadas a los objetos com creados por Visual Basic 6,0 y versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-107">For example, structures in class libraries must specify the `BStr` unmanaged type on strings sent to COM objects created by Visual Basic 6.0 and earlier versions.</span></span> <span data-ttu-id="f6d9a-108">En tales casos, puede usar el <xref:System.Runtime.InteropServices.MarshalAsAttribute> atributo para que los tipos administrados se expongan como tipos no administrados.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-108">In such cases, you can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute to cause managed types to be exposed as unmanaged types.</span></span>  
  
## <a name="exporting-fixed-length-strings-to-unmanaged-code"></a><a name="vbconinteroperabilitymarshalinganchor2"></a><span data-ttu-id="f6d9a-109">Exportar cadenas de longitud fija a código no administrado</span><span class="sxs-lookup"><span data-stu-id="f6d9a-109">Exporting Fixed-Length Strings to Unmanaged Code</span></span>  
 <span data-ttu-id="f6d9a-110">En Visual Basic 6,0 y versiones anteriores, las cadenas se exportan a objetos COM como secuencias de bytes sin un carácter de terminación null.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-110">In Visual Basic 6.0 and earlier versions, strings are exported to COM objects as sequences of bytes without a null termination character.</span></span> <span data-ttu-id="f6d9a-111">Por compatibilidad con otros lenguajes, Visual Basic .NET incluye un carácter de terminación al exportar cadenas.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-111">For compatibility with other languages, Visual Basic .NET includes a termination character when exporting strings.</span></span> <span data-ttu-id="f6d9a-112">La mejor manera de abordar esta incompatibilidad es exportar cadenas que no tienen el carácter de terminación como matrices de `Byte` o `Char` .</span><span class="sxs-lookup"><span data-stu-id="f6d9a-112">The best way to address this incompatibility is to export strings that lack the termination character as arrays of `Byte` or `Char`.</span></span>  
  
## <a name="exporting-inheritance-hierarchies"></a><a name="vbconinteroperabilitymarshalinganchor3"></a><span data-ttu-id="f6d9a-113">Exportar jerarquías de herencia</span><span class="sxs-lookup"><span data-stu-id="f6d9a-113">Exporting Inheritance Hierarchies</span></span>  
 <span data-ttu-id="f6d9a-114">Las jerarquías de clases administradas se acoplan cuando se exponen como objetos COM.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-114">Managed class hierarchies flatten out when exposed as COM objects.</span></span> <span data-ttu-id="f6d9a-115">Por ejemplo, si define una clase base con un miembro y, a continuación, hereda la clase base en una clase derivada que se expone como un objeto COM, los clientes que usan la clase derivada en el objeto COM no podrán usar los miembros heredados.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-115">For example, if you define a base class with a member, and then inherit the base class in a derived class that is exposed as a COM object, clients that use the derived class in the COM object will not be able to use the inherited members.</span></span> <span data-ttu-id="f6d9a-116">Solo se puede tener acceso a los miembros de clase base desde objetos COM como instancias de una clase base y, a continuación, solo si la clase base también se crea como un objeto COM.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-116">Base class members can be accessed from COM objects only as instances of a base class, and then only if the base class is also created as a COM object.</span></span>  
  
## <a name="overloaded-methods"></a><span data-ttu-id="f6d9a-117">Métodos sobrecargados</span><span class="sxs-lookup"><span data-stu-id="f6d9a-117">Overloaded Methods</span></span>  
 <span data-ttu-id="f6d9a-118">Aunque puede crear métodos sobrecargados con Visual Basic, no son compatibles con COM.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-118">Although you can create overloaded methods with Visual Basic, they are not supported by COM.</span></span> <span data-ttu-id="f6d9a-119">Cuando una clase que contiene métodos sobrecargados se expone como un objeto COM, se generan nuevos nombres de método para los métodos sobrecargados.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-119">When a class that contains overloaded methods is exposed as a COM object, new method names are generated for the overloaded methods.</span></span>  
  
 <span data-ttu-id="f6d9a-120">Por ejemplo, considere una clase que tiene dos sobrecargas del `Synch` método.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-120">For example, consider a class that has two overloads of the `Synch` method.</span></span> <span data-ttu-id="f6d9a-121">Cuando la clase se expone como un objeto COM, los nuevos nombres de método generados podrían ser `Synch` y `Synch_2` .</span><span class="sxs-lookup"><span data-stu-id="f6d9a-121">When the class is exposed as a COM object, the new generated method names could be `Synch` and `Synch_2`.</span></span>  
  
 <span data-ttu-id="f6d9a-122">El cambio de nombre puede producir dos problemas para los consumidores del objeto COM.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-122">The renaming can cause two problems for consumers of the COM object.</span></span>  
  
1. <span data-ttu-id="f6d9a-123">Es posible que los clientes no esperen los nombres de método generados.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-123">Clients might not expect the generated method names.</span></span>  
  
2. <span data-ttu-id="f6d9a-124">Los nombres de método generados en la clase expuesta como un objeto COM pueden cambiar cuando se agregan nuevas sobrecargas a la clase o a su clase base.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-124">The generated method names in the class exposed as a COM object can change when new overloads are added to the class or its base class.</span></span> <span data-ttu-id="f6d9a-125">Esto puede producir problemas de control de versiones.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-125">This can cause versioning problems.</span></span>  
  
 <span data-ttu-id="f6d9a-126">Para resolver ambos problemas, asigne a cada método un nombre único, en lugar de usar sobrecarga, al desarrollar objetos que se expondrán como objetos COM.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-126">To solve both problems, give each method a unique name, instead of using overloading, when you develop objects that will be exposed as COM objects.</span></span>  
  
## <a name="use-of-com-objects-through-interop-assemblies"></a><a name="vbconinteroperabilitymarshalinganchor4"></a><span data-ttu-id="f6d9a-127">Uso de objetos COM mediante ensamblados de interoperabilidad</span><span class="sxs-lookup"><span data-stu-id="f6d9a-127">Use of COM Objects Through Interop Assemblies</span></span>  
 <span data-ttu-id="f6d9a-128">Los ensamblados de interoperabilidad se usan casi como si fueran reemplazos de código administrados para los objetos COM que representan.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-128">You use interop assemblies almost as if they are managed code replacements for the COM objects they represent.</span></span> <span data-ttu-id="f6d9a-129">Sin embargo, dado que son contenedores y no objetos COM reales, existen algunas diferencias entre el uso de ensamblados de interoperabilidad y ensamblados estándar.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-129">However, because they are wrappers and not actual COM objects, there are some differences between using interop assemblies and standard assemblies.</span></span> <span data-ttu-id="f6d9a-130">Estas áreas de diferencia incluyen la exposición de las clases y los tipos de datos de los parámetros y los valores devueltos.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-130">These areas of difference include the exposure of classes, and data types for parameters and return values.</span></span>  
  
## <a name="classes-exposed-as-both-interfaces-and-classes"></a><a name="vbconinteroperabilitymarshalinganchor5"></a><span data-ttu-id="f6d9a-131">Clases que se exponen como interfaces y clases</span><span class="sxs-lookup"><span data-stu-id="f6d9a-131">Classes Exposed as Both Interfaces and Classes</span></span>  
 <span data-ttu-id="f6d9a-132">A diferencia de las clases de los ensamblados estándar, las clases COM se exponen en ensamblados de interoperabilidad como una interfaz y una clase que representa la clase COM.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-132">Unlike classes in standard assemblies, COM classes are exposed in interop assemblies as both an interface and a class that represents the COM class.</span></span> <span data-ttu-id="f6d9a-133">El nombre de la interfaz es idéntico al de la clase COM.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-133">The interface's name is identical to that of the COM class.</span></span> <span data-ttu-id="f6d9a-134">El nombre de la clase de interoperabilidad es el mismo que el de la clase COM original, pero con la palabra "class" anexada.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-134">The name of the interop class is the same as that of the original COM class, but with the word "Class" appended.</span></span> <span data-ttu-id="f6d9a-135">Por ejemplo, supongamos que tiene un proyecto con una referencia a un ensamblado de interoperabilidad para un objeto COM.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-135">For example, suppose you have a project with a reference to an interop assembly for a COM object.</span></span> <span data-ttu-id="f6d9a-136">Si la clase COM se denomina `MyComClass` , IntelliSense y el examinador de objetos muestran una interfaz denominada `MyComClass` y una clase denominada `MyComClassClass` .</span><span class="sxs-lookup"><span data-stu-id="f6d9a-136">If the COM class is named `MyComClass`, IntelliSense and the Object Browser show an interface named `MyComClass` and a class named `MyComClassClass`.</span></span>  
  
## <a name="creating-instances-of-a-net-framework-class"></a><a name="vbconinteroperabilitymarshalinganchor6"></a><span data-ttu-id="f6d9a-137">Crear instancias de una clase .NET Framework</span><span class="sxs-lookup"><span data-stu-id="f6d9a-137">Creating Instances of a .NET Framework Class</span></span>  
 <span data-ttu-id="f6d9a-138">Generalmente, se crea una instancia de una clase .NET Framework utilizando la `New` instrucción con un nombre de clase.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-138">Generally, you create an instance of a .NET Framework class using the `New` statement with a class name.</span></span> <span data-ttu-id="f6d9a-139">Tener una clase COM representada por un ensamblado de interoperabilidad es el único caso en el que se puede utilizar la `New` instrucción con una interfaz.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-139">Having a COM class represented by an interop assembly is the one case in which you can use the `New` statement with an interface.</span></span> <span data-ttu-id="f6d9a-140">A menos que use la clase COM con una `Inherits` instrucción, puede usar la interfaz como lo haría con una clase.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-140">Unless you are using the COM class with an `Inherits` statement, you can use the interface just as you would a class.</span></span> <span data-ttu-id="f6d9a-141">En el código siguiente se muestra cómo crear un `Command` objeto en un proyecto que tiene una referencia al objeto com de la biblioteca de Microsoft Objetos de datos ActiveX 2,8:</span><span class="sxs-lookup"><span data-stu-id="f6d9a-141">The following code demonstrates how to create a `Command` object in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object:</span></span>  
  
 [!code-vb[VbVbalrInterop#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#20)]  
  
 <span data-ttu-id="f6d9a-142">Sin embargo, si usa la clase COM como base para una clase derivada, debe usar la clase de interoperabilidad que representa la clase COM, como en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="f6d9a-142">However, if you are using the COM class as the base for a derived class, you must use the interop class that represents the COM class, as in the following code:</span></span>  
  
 [!code-vb[VbVbalrInterop#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#21)]  
  
> [!NOTE]
> <span data-ttu-id="f6d9a-143">Los ensamblados de interoperabilidad implementan implícitamente interfaces que representan clases COM.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-143">Interop assemblies implicitly implement interfaces that represent COM classes.</span></span> <span data-ttu-id="f6d9a-144">No debe intentar usar la `Implements` instrucción para implementar estas interfaces o se producirá un error.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-144">You should not try to use the `Implements` statement to implement these interfaces or an error will result.</span></span>  
  
## <a name="data-types-for-parameters-and-return-values"></a><a name="vbconinteroperabilitymarshalinganchor7"></a><span data-ttu-id="f6d9a-145">Tipos de datos de parámetros y valores devueltos</span><span class="sxs-lookup"><span data-stu-id="f6d9a-145">Data Types for Parameters and Return Values</span></span>  
 <span data-ttu-id="f6d9a-146">A diferencia de los miembros de ensamblados estándar, los miembros de ensamblado de interoperabilidad pueden tener tipos de datos que difieren de los usados en la declaración del objeto original.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-146">Unlike members of standard assemblies, interop assembly members may have data types that differ from those used in the  original object declaration.</span></span> <span data-ttu-id="f6d9a-147">Aunque los ensamblados de interoperabilidad convierten implícitamente los tipos COM en tipos de Common Language Runtime compatibles, debe prestar atención a los tipos de datos que se usan en ambos lados para evitar errores en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-147">Although interop assemblies implicitly convert COM types to compatible common language runtime types, you should pay attention to the data types that are used by both sides to prevent runtime errors.</span></span> <span data-ttu-id="f6d9a-148">Por ejemplo, en los objetos COM creados en Visual Basic 6,0 y versiones anteriores, los valores de tipo `Integer` suponen el .NET Framework tipo equivalente, `Short` .</span><span class="sxs-lookup"><span data-stu-id="f6d9a-148">For example, in COM objects created in Visual Basic 6.0 and earlier versions, values of type `Integer` assume the .NET Framework equivalent type, `Short`.</span></span> <span data-ttu-id="f6d9a-149">Se recomienda usar el Examinador de objetos para examinar las características de los miembros importados antes de usarlos.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-149">It is recommended that you use the Object Browser to examine the characteristics of imported members before you use them.</span></span>  
  
## <a name="module-level-com-methods"></a><a name="vbconinteroperabilitymarshalinganchor8"></a><span data-ttu-id="f6d9a-150">Métodos COM de nivel de módulo</span><span class="sxs-lookup"><span data-stu-id="f6d9a-150">Module level COM methods</span></span>  
 <span data-ttu-id="f6d9a-151">La mayoría de los objetos COM se utilizan creando una instancia de una clase COM mediante la `New` palabra clave y llamando a los métodos del objeto.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-151">Most COM objects are used by creating an instance of a COM class using the `New` keyword and then calling methods of the object.</span></span> <span data-ttu-id="f6d9a-152">Una excepción a esta regla implica objetos COM que contienen `AppObj` clases de o `GlobalMultiUse` com.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-152">One exception to this rule involves COM objects that contain `AppObj` or `GlobalMultiUse` COM classes.</span></span> <span data-ttu-id="f6d9a-153">Estas clases son similares a los métodos de nivel de módulo en Visual Basic clases .NET.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-153">Such classes resemble module level methods in Visual Basic .NET classes.</span></span> <span data-ttu-id="f6d9a-154">Visual Basic 6,0 y versiones anteriores crean implícitamente instancias de estos objetos por primera vez que se llama a uno de sus métodos.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-154">Visual Basic 6.0 and earlier versions implicitly create instances of such objects for you the first time that you call one of their methods.</span></span> <span data-ttu-id="f6d9a-155">Por ejemplo, en Visual Basic 6,0 puede Agregar una referencia a la biblioteca de objetos de Microsoft DAO 3,6 y llamar al `DBEngine` método sin crear primero una instancia:</span><span class="sxs-lookup"><span data-stu-id="f6d9a-155">For example, in Visual Basic 6.0 you can add a reference to the Microsoft DAO 3.6 Object Library and call the `DBEngine` method without first creating an instance:</span></span>  
  
```vb  
Dim db As DAO.Database  
' Open the database.  
Set db = DBEngine.OpenDatabase("C:\nwind.mdb")  
' Use the database object.  
```  
  
 <span data-ttu-id="f6d9a-156">Visual Basic .NET requiere que siempre se creen instancias de objetos COM antes de poder usar sus métodos.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-156">Visual Basic .NET requires that you always create instances of COM objects before you can use their methods.</span></span> <span data-ttu-id="f6d9a-157">Para usar estos métodos en Visual Basic, declare una variable de la clase deseada y use la palabra clave New para asignar el objeto a la variable de objeto.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-157">To use these methods in Visual Basic, declare a variable of the desired class and use the new keyword to assign the object to the object variable.</span></span> <span data-ttu-id="f6d9a-158">La `Shared` palabra clave se puede usar cuando se desea asegurarse de que solo se crea una instancia de la clase.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-158">The `Shared` keyword can be used when you want to make sure that only one instance of the class is created.</span></span>  
  
 [!code-vb[VbVbalrInterop#23](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#23)]  
  
## <a name="unhandled-errors-in-event-handlers"></a><a name="vbconinteroperabilitymarshalinganchor9"></a><span data-ttu-id="f6d9a-159">Errores no controlados en los controladores de eventos</span><span class="sxs-lookup"><span data-stu-id="f6d9a-159">Unhandled Errors in Event Handlers</span></span>  
 <span data-ttu-id="f6d9a-160">Un problema común de interoperabilidad implica errores en los controladores de eventos que controlan los eventos generados por objetos COM.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-160">One common interop problem involves errors in event handlers that handle events raised by COM objects.</span></span> <span data-ttu-id="f6d9a-161">Estos errores se omiten a menos que compruebe específicamente si hay errores mediante `On Error` `Try...Catch...Finally` instrucciones o.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-161">Such errors are ignored unless you specifically check for errors using `On Error` or `Try...Catch...Finally` statements.</span></span> <span data-ttu-id="f6d9a-162">Por ejemplo, el ejemplo siguiente es de un proyecto Visual Basic .NET que tiene una referencia al objeto COM de la biblioteca de Microsoft Objetos de datos ActiveX 2,8.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-162">For example, the following example is from a Visual Basic .NET project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object.</span></span>  
  
 [!code-vb[VbVbalrInterop#24](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#24)]  
  
 <span data-ttu-id="f6d9a-163">Este ejemplo genera un error según lo esperado.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-163">This example raises an error as expected.</span></span> <span data-ttu-id="f6d9a-164">Sin embargo, si intenta usar el mismo ejemplo sin el `Try...Catch...Finally` bloque, se omitirá el error como si utilizara la `OnError Resume Next` instrucción.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-164">However, if you try the same example without the `Try...Catch...Finally` block, the error is ignored as if you used the `OnError Resume Next` statement.</span></span> <span data-ttu-id="f6d9a-165">Sin el control de errores, se produce un error en la división por cero de forma silenciosa.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-165">Without error handling, the division by zero silently fails.</span></span> <span data-ttu-id="f6d9a-166">Dado que tales errores nunca generan errores de excepción no controlados, es importante usar algún tipo de control de excepciones en los controladores de eventos que controlan los eventos de los objetos COM.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-166">Because such errors never raise unhandled exception errors, it is important that you use some form of exception handling in event handlers that handle events from COM objects.</span></span>  
  
### <a name="understanding-com-interop-errors"></a><span data-ttu-id="f6d9a-167">Descripción de los errores de interoperabilidad COM</span><span class="sxs-lookup"><span data-stu-id="f6d9a-167">Understanding COM interop errors</span></span>  
 <span data-ttu-id="f6d9a-168">Sin el control de errores, las llamadas de interoperabilidad a menudo generan errores que proporcionan poca información.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-168">Without error handling, interop calls often generate errors that provide little information.</span></span> <span data-ttu-id="f6d9a-169">Siempre que sea posible, utilice el control de errores estructurado para proporcionar más información acerca de los problemas cuando se producen.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-169">Whenever possible, use structured error handling to provide more information about problems when they occur.</span></span> <span data-ttu-id="f6d9a-170">Esto puede ser especialmente útil al depurar aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-170">This can be especially helpful when you debug applications.</span></span> <span data-ttu-id="f6d9a-171">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="f6d9a-171">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#25](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#25)]  
  
 <span data-ttu-id="f6d9a-172">Puede encontrar información como la descripción del error, HRESULT y el origen de los errores COM mediante el examen del contenido del objeto de excepción.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-172">You can find information such as the error description, HRESULT, and the source of COM errors by examining the contents of the exception object.</span></span>  
  
## <a name="activex-control-issues"></a><a name="vbconinteroperabilitymarshalinganchor10"></a><span data-ttu-id="f6d9a-173">Problemas de controles ActiveX</span><span class="sxs-lookup"><span data-stu-id="f6d9a-173">ActiveX Control Issues</span></span>  
 <span data-ttu-id="f6d9a-174">La mayoría de los controles ActiveX que funcionan con Visual Basic 6,0 funcionan con Visual Basic .NET sin problemas.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-174">Most ActiveX controls that work with Visual Basic 6.0 work with Visual Basic .NET without trouble.</span></span> <span data-ttu-id="f6d9a-175">Las excepciones principales son los controles de contenedor o los controles que contienen visualmente otros controles.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-175">The main exceptions are container controls, or controls that visually contain other controls.</span></span> <span data-ttu-id="f6d9a-176">A continuación se indican algunos ejemplos de controles anteriores que no funcionan correctamente con Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="f6d9a-176">Some examples of older controls that do not work correctly with Visual Studio are as follows:</span></span>  
  
- <span data-ttu-id="f6d9a-177">Control de marco de Microsoft Forms 2,0</span><span class="sxs-lookup"><span data-stu-id="f6d9a-177">Microsoft Forms 2.0 Frame control</span></span>  
  
- <span data-ttu-id="f6d9a-178">Control de flechas, también conocido como control de número</span><span class="sxs-lookup"><span data-stu-id="f6d9a-178">Up-Down control, also known as the spin control</span></span>  
  
- <span data-ttu-id="f6d9a-179">Control de pestaña Sheridan</span><span class="sxs-lookup"><span data-stu-id="f6d9a-179">Sheridan Tab Control</span></span>  
  
 <span data-ttu-id="f6d9a-180">Solo existen algunas soluciones alternativas para los problemas de control ActiveX no admitidos.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-180">There are only a few workarounds for unsupported ActiveX control problems.</span></span> <span data-ttu-id="f6d9a-181">Puede migrar los controles existentes a Visual Studio si es el propietario del código fuente original.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-181">You can migrate existing controls to Visual Studio if you own the original source code.</span></span> <span data-ttu-id="f6d9a-182">De lo contrario, puede consultar a los proveedores de software para actualizarlos. Versiones de controles compatibles con NET para reemplazar controles ActiveX no compatibles.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-182">Otherwise, you can check with software vendors for updated .NET-compatible versions of controls to replace unsupported ActiveX controls.</span></span>  
  
## <a name="passing-readonly-properties-of-controls-byref"></a><a name="vbconinteroperabilitymarshalinganchor11"></a><span data-ttu-id="f6d9a-183">Pasar propiedades ReadOnly de controles ByRef</span><span class="sxs-lookup"><span data-stu-id="f6d9a-183">Passing ReadOnly Properties of Controls ByRef</span></span>  
 <span data-ttu-id="f6d9a-184">Visual Basic .NET genera a veces errores COM como, "error 0x800A017F CTL_E_SETNOTSUPPORTED", cuando se pasan `ReadOnly` propiedades de algunos controles ActiveX antiguos como `ByRef` parámetros a otros procedimientos.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-184">Visual Basic .NET sometimes raises COM errors such as, "Error 0x800A017F CTL_E_SETNOTSUPPORTED", when you pass `ReadOnly` properties of some older ActiveX controls as `ByRef` parameters to other procedures.</span></span> <span data-ttu-id="f6d9a-185">Las llamadas a procedimientos similares desde Visual Basic 6,0 no generan un error, y los parámetros se tratan como si se hubieran pasado por valor.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-185">Similar procedure calls from Visual Basic 6.0 do not raise an error, and the parameters are treated as if you passed them by value.</span></span> <span data-ttu-id="f6d9a-186">El mensaje de error de Visual Basic .NET indica que está intentando cambiar una propiedad que no tiene un procedimiento de propiedad `Set` .</span><span class="sxs-lookup"><span data-stu-id="f6d9a-186">The Visual Basic .NET error message indicates that you are trying to change a property that does not have a property `Set` procedure.</span></span>  
  
 <span data-ttu-id="f6d9a-187">Si tiene acceso al procedimiento al que se llama, puede evitar este error si usa la `ByVal` palabra clave para declarar los parámetros que aceptan `ReadOnly` propiedades.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-187">If you have access to the procedure being called, you can prevent this error by using the `ByVal` keyword to declare parameters that accept `ReadOnly` properties.</span></span> <span data-ttu-id="f6d9a-188">Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="f6d9a-188">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#26](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#26)]  
  
 <span data-ttu-id="f6d9a-189">Si no tiene acceso al código fuente para el procedimiento al que se llama, puede forzar que la propiedad se pase por valor agregando un conjunto adicional de corchetes alrededor del procedimiento que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-189">If you do not have access to the source code for the procedure being called, you can force the property to be passed by value by adding an extra set of brackets around the calling procedure.</span></span> <span data-ttu-id="f6d9a-190">Por ejemplo, en un proyecto que tenga una referencia al objeto COM de la biblioteca de Microsoft Objetos de datos ActiveX 2,8, puede usar:</span><span class="sxs-lookup"><span data-stu-id="f6d9a-190">For example, in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object, you can use:</span></span>  
  
 [!code-vb[VbVbalrInterop#27](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrInterop/VB/Class1.vb#27)]  
  
## <a name="deploying-assemblies-that-expose-interop"></a><a name="vbconinteroperabilitymarshalinganchor12"></a><span data-ttu-id="f6d9a-191">Implementar ensamblados que exponen la interoperabilidad</span><span class="sxs-lookup"><span data-stu-id="f6d9a-191">Deploying Assemblies That Expose Interop</span></span>  
 <span data-ttu-id="f6d9a-192">La implementación de ensamblados que exponen interfaces COM presenta algunos desafíos únicos.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-192">Deploying assemblies that expose COM interfaces presents some unique challenges.</span></span> <span data-ttu-id="f6d9a-193">Por ejemplo, un posible problema se produce cuando las aplicaciones independientes hacen referencia al mismo ensamblado COM.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-193">For example, a potential problem occurs when separate applications reference the same COM assembly.</span></span> <span data-ttu-id="f6d9a-194">Esta situación es habitual cuando se instala una nueva versión de un ensamblado y otra aplicación sigue usando la versión anterior del ensamblado.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-194">This situation is common when a new version of an assembly is installed and another application is still using the old version of the assembly.</span></span> <span data-ttu-id="f6d9a-195">Si desinstala un ensamblado que comparte un archivo DLL, puede hacer que no esté disponible de forma involuntaria para los demás ensamblados.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-195">If you uninstall an assembly that shares a DLL, you can unintentionally make it unavailable to the other assemblies.</span></span>  
  
 <span data-ttu-id="f6d9a-196">Para evitar este problema, debe instalar los ensamblados compartidos en la caché de ensamblados global (GAC) y utilizar un módulo CRT para el componente.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-196">To avoid this problem, you should install shared assemblies to the Global Assembly Cache (GAC) and use a MergeModule for the component.</span></span> <span data-ttu-id="f6d9a-197">Si no puede instalar la aplicación en la GAC, debe instalarse en CommonFilesFolder en un subdirectorio específico de la versión.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-197">If you cannot install the application in the GAC, it should be installed to CommonFilesFolder in a version-specific subdirectory.</span></span>  
  
 <span data-ttu-id="f6d9a-198">Los ensamblados que no se comparten se deben ubicar en paralelo en el directorio con la aplicación que realiza la llamada.</span><span class="sxs-lookup"><span data-stu-id="f6d9a-198">Assemblies that are not shared should be located side by side in the directory with the calling application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f6d9a-199">Consulte también</span><span class="sxs-lookup"><span data-stu-id="f6d9a-199">See also</span></span>

- <xref:System.Runtime.InteropServices.MarshalAsAttribute>
- [<span data-ttu-id="f6d9a-200">Interoperabilidad COM</span><span class="sxs-lookup"><span data-stu-id="f6d9a-200">COM Interop</span></span>](index.md)
- [<span data-ttu-id="f6d9a-201">TlbImp.exe (Importador de la biblioteca de tipos)</span><span class="sxs-lookup"><span data-stu-id="f6d9a-201">Tlbimp.exe (Type Library Importer)</span></span>](../../../framework/tools/tlbimp-exe-type-library-importer.md)
- [<span data-ttu-id="f6d9a-202">Tlbexp.exe (Exportador de la biblioteca de tipos)</span><span class="sxs-lookup"><span data-stu-id="f6d9a-202">Tlbexp.exe (Type Library Exporter)</span></span>](../../../framework/tools/tlbexp-exe-type-library-exporter.md)
- [<span data-ttu-id="f6d9a-203">Tutorial: Implementación de la herencia mediante objetos COM</span><span class="sxs-lookup"><span data-stu-id="f6d9a-203">Walkthrough: Implementing Inheritance with COM Objects</span></span>](walkthrough-implementing-inheritance-with-com-objects.md)
- [<span data-ttu-id="f6d9a-204">Inherits Statement</span><span class="sxs-lookup"><span data-stu-id="f6d9a-204">Inherits Statement</span></span>](../../language-reference/statements/inherits-statement.md)
- [<span data-ttu-id="f6d9a-205">Caché global de ensamblados</span><span class="sxs-lookup"><span data-stu-id="f6d9a-205">Global Assembly Cache</span></span>](../../../framework/app-domains/gac.md)
