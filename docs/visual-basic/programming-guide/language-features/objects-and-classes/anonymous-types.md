---
description: 'Más información sobre: tipos anónimos (Visual Basic)'
title: Tipos anónimos
ms.date: 07/20/2015
f1_keywords:
- vb.AnonymousType
helpviewer_keywords:
- anonymous types [Visual Basic], about anonymous types
- anonymous types [Visual Basic]
- types [Visual Basic], anonymous
ms.assetid: 7b87532c-4b3e-4398-8503-6ea9d67574a4
ms.openlocfilehash: 447ca914726d4b426ad4ba2ec370a4bbe9589b81
ms.sourcegitcommit: 10e719780594efc781b15295e499c66f316068b8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/14/2021
ms.locfileid: "100425625"
---
# <a name="anonymous-types-visual-basic"></a><span data-ttu-id="08eb6-103">Tipos anónimos (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08eb6-103">Anonymous Types (Visual Basic)</span></span>

<span data-ttu-id="08eb6-104">Visual Basic admite tipos anónimos, que permiten crear objetos sin escribir una definición de clase para el tipo de datos.</span><span class="sxs-lookup"><span data-stu-id="08eb6-104">Visual Basic supports anonymous types, which enable you to create objects without writing a class definition for the data type.</span></span> <span data-ttu-id="08eb6-105">En su lugar, el compilador genera una clase.</span><span class="sxs-lookup"><span data-stu-id="08eb6-105">Instead, the compiler generates a class for you.</span></span> <span data-ttu-id="08eb6-106">La clase no tiene ningún nombre utilizable, hereda directamente de <xref:System.Object> y contiene las propiedades que se especifican para declarar el objeto.</span><span class="sxs-lookup"><span data-stu-id="08eb6-106">The class has no usable name, inherits directly from <xref:System.Object>, and contains the properties you specify in declaring the object.</span></span> <span data-ttu-id="08eb6-107">Dado que no se especifica el nombre del tipo de datos, se hace referencia a él como un *tipo anónimo*.</span><span class="sxs-lookup"><span data-stu-id="08eb6-107">Because the name of the data type is not specified, it is referred to as an *anonymous type*.</span></span>  
  
 <span data-ttu-id="08eb6-108">En el ejemplo siguiente se declara y `product` se crea una variable como una instancia de un tipo anónimo que tiene dos propiedades, `Name` y `Price` .</span><span class="sxs-lookup"><span data-stu-id="08eb6-108">The following example declares and creates variable `product` as an instance of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#1)]  
  
 <span data-ttu-id="08eb6-109">Una *expresión de consulta* utiliza tipos anónimos para combinar columnas de datos seleccionados por una consulta.</span><span class="sxs-lookup"><span data-stu-id="08eb6-109">A *query expression* uses anonymous types to combine columns of data selected by a query.</span></span> <span data-ttu-id="08eb6-110">No se puede definir el tipo del resultado de antemano porque no se pueden predecir las columnas que puede seleccionar una consulta determinada.</span><span class="sxs-lookup"><span data-stu-id="08eb6-110">You cannot define the type of the result in advance, because you cannot predict the columns a particular query might select.</span></span> <span data-ttu-id="08eb6-111">Los tipos anónimos permiten escribir una consulta que selecciona cualquier número de columnas, en cualquier orden.</span><span class="sxs-lookup"><span data-stu-id="08eb6-111">Anonymous types enable you to write a query that selects any number of columns, in any order.</span></span> <span data-ttu-id="08eb6-112">El compilador crea un tipo de datos que coincide con las propiedades especificadas y el orden especificado.</span><span class="sxs-lookup"><span data-stu-id="08eb6-112">The compiler creates a data type that matches the specified properties and the specified order.</span></span>  
  
 <span data-ttu-id="08eb6-113">En los ejemplos siguientes, `products` es una lista de objetos product, cada uno de los cuales tiene muchas propiedades.</span><span class="sxs-lookup"><span data-stu-id="08eb6-113">In the following examples, `products` is a list of product objects, each of which has many properties.</span></span> <span data-ttu-id="08eb6-114">`namePriceQuery`La variable contiene la definición de una consulta que, cuando se ejecuta, devuelve una colección de instancias de un tipo anónimo que tiene dos propiedades, `Name` y `Price` .</span><span class="sxs-lookup"><span data-stu-id="08eb6-114">Variable `namePriceQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#2)]  
  
 <span data-ttu-id="08eb6-115">`nameQuantityQuery`La variable contiene la definición de una consulta que, cuando se ejecuta, devuelve una colección de instancias de un tipo anónimo que tiene dos propiedades, `Name` y `OnHand` .</span><span class="sxs-lookup"><span data-stu-id="08eb6-115">Variable `nameQuantityQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `OnHand`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#3)]  
  
 <span data-ttu-id="08eb6-116">Para obtener más información sobre el código creado por el compilador para un tipo anónimo, vea [definición de tipo anónimo](anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="08eb6-116">For more information about the code created by the compiler for an anonymous type, see [Anonymous Type Definition](anonymous-type-definition.md).</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="08eb6-117">El nombre del tipo anónimo es generado por el compilador y puede variar de la compilación a la compilación.</span><span class="sxs-lookup"><span data-stu-id="08eb6-117">The name of the anonymous type is compiler generated and may vary from compilation to compilation.</span></span> <span data-ttu-id="08eb6-118">El código no debe utilizar o confiar en el nombre de un tipo anónimo porque el nombre puede cambiar cuando se vuelve a compilar un proyecto.</span><span class="sxs-lookup"><span data-stu-id="08eb6-118">Your code should not use or rely on the name of an anonymous type because the name might change when a project is recompiled.</span></span>  
  
## <a name="declaring-an-anonymous-type"></a><span data-ttu-id="08eb6-119">Declarar un tipo anónimo</span><span class="sxs-lookup"><span data-stu-id="08eb6-119">Declaring an Anonymous Type</span></span>  

 <span data-ttu-id="08eb6-120">La declaración de una instancia de un tipo anónimo usa una lista de inicializadores para especificar las propiedades del tipo.</span><span class="sxs-lookup"><span data-stu-id="08eb6-120">The declaration of an instance of an anonymous type uses an initializer list to specify the properties of the type.</span></span> <span data-ttu-id="08eb6-121">Solo se pueden especificar propiedades cuando se declara un tipo anónimo, no otros elementos de clase, como métodos o eventos.</span><span class="sxs-lookup"><span data-stu-id="08eb6-121">You can specify only properties when you declare an anonymous type, not other class elements such as methods or events.</span></span> <span data-ttu-id="08eb6-122">En el ejemplo siguiente, `product1` es una instancia de un tipo anónimo que tiene dos propiedades: `Name` y `Price` .</span><span class="sxs-lookup"><span data-stu-id="08eb6-122">In the following example, `product1` is an instance of an anonymous type that has two properties: `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#4)]  
  
 <span data-ttu-id="08eb6-123">Si designa propiedades como propiedades clave, puede utilizarlas para comparar la igualdad de dos instancias de tipo anónimo.</span><span class="sxs-lookup"><span data-stu-id="08eb6-123">If you designate properties as key properties, you can use them to compare two anonymous type instances for equality.</span></span> <span data-ttu-id="08eb6-124">Sin embargo, no se pueden cambiar los valores de las propiedades de clave.</span><span class="sxs-lookup"><span data-stu-id="08eb6-124">However, the values of key properties cannot be changed.</span></span> <span data-ttu-id="08eb6-125">Vea la sección Propiedades de clave más adelante en este tema para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="08eb6-125">See the Key Properties section later in this topic for more information.</span></span>  
  
 <span data-ttu-id="08eb6-126">Observe que declarar una instancia de un tipo anónimo es como declarar una instancia de un tipo con nombre mediante un inicializador de objeto:</span><span class="sxs-lookup"><span data-stu-id="08eb6-126">Notice that declaring an instance of an anonymous type is like declaring an instance of a named type by using an object initializer:</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#5)]  
  
 <span data-ttu-id="08eb6-127">Para obtener más información sobre otras formas de especificar propiedades de tipo anónimo, vea [Cómo: inferir nombres y tipos de propiedades en declaraciones de tipos anónimos](how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span><span class="sxs-lookup"><span data-stu-id="08eb6-127">For more information about other ways to specify anonymous type properties, see [How to: Infer Property Names and Types in Anonymous Type Declarations](how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span></span>  
  
## <a name="key-properties"></a><span data-ttu-id="08eb6-128">Propiedades clave</span><span class="sxs-lookup"><span data-stu-id="08eb6-128">Key Properties</span></span>  

 <span data-ttu-id="08eb6-129">Las propiedades clave difieren de las propiedades que no son de clave de varias maneras fundamentales:</span><span class="sxs-lookup"><span data-stu-id="08eb6-129">Key properties differ from non-key properties in several fundamental ways:</span></span>  
  
- <span data-ttu-id="08eb6-130">Solo se comparan los valores de las propiedades de clave para determinar si dos instancias son iguales.</span><span class="sxs-lookup"><span data-stu-id="08eb6-130">Only the values of key properties are compared in order to determine whether two instances are equal.</span></span>  
  
- <span data-ttu-id="08eb6-131">Los valores de las propiedades de clave son de solo lectura y no se pueden cambiar.</span><span class="sxs-lookup"><span data-stu-id="08eb6-131">The values of key properties are read-only and cannot be changed.</span></span>  
  
- <span data-ttu-id="08eb6-132">Solo los valores de propiedad clave se incluyen en el algoritmo de código hash generado por el compilador para un tipo anónimo.</span><span class="sxs-lookup"><span data-stu-id="08eb6-132">Only key property values are included in the compiler-generated hash code algorithm for an anonymous type.</span></span>  
  
### <a name="equality"></a><span data-ttu-id="08eb6-133">Igualdad</span><span class="sxs-lookup"><span data-stu-id="08eb6-133">Equality</span></span>  

 <span data-ttu-id="08eb6-134">Las instancias de tipos anónimos solo pueden ser iguales si son instancias del mismo tipo anónimo.</span><span class="sxs-lookup"><span data-stu-id="08eb6-134">Instances of anonymous types can be equal only if they are instances of the same anonymous type.</span></span> <span data-ttu-id="08eb6-135">El compilador trata dos instancias como instancias del mismo tipo si cumplen las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="08eb6-135">The compiler treats two instances as instances of the same type if they meet the following conditions:</span></span>  
  
- <span data-ttu-id="08eb6-136">Se declaran en el mismo ensamblado.</span><span class="sxs-lookup"><span data-stu-id="08eb6-136">They are declared in the same assembly.</span></span>  
  
- <span data-ttu-id="08eb6-137">Sus propiedades tienen los mismos nombres, los mismos tipos deducidos y se declaran en el mismo orden.</span><span class="sxs-lookup"><span data-stu-id="08eb6-137">Their properties have the same names, the same inferred types, and are declared in the same order.</span></span> <span data-ttu-id="08eb6-138">Las comparaciones de nombres no distinguen mayúsculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="08eb6-138">Name comparisons are not case-sensitive.</span></span>  
  
- <span data-ttu-id="08eb6-139">Las mismas propiedades de cada se marcan como propiedades de clave.</span><span class="sxs-lookup"><span data-stu-id="08eb6-139">The same properties in each are marked as key properties.</span></span>  
  
- <span data-ttu-id="08eb6-140">Al menos una propiedad de cada declaración es una propiedad de clave.</span><span class="sxs-lookup"><span data-stu-id="08eb6-140">At least one property in each declaration is a key property.</span></span>  
  
 <span data-ttu-id="08eb6-141">Una instancia de tipos anónimos que no tiene propiedades de clave es igual a sí misma.</span><span class="sxs-lookup"><span data-stu-id="08eb6-141">An instance of an anonymous types that has no key properties is equal only to itself.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#6)]  
  
 <span data-ttu-id="08eb6-142">Dos instancias del mismo tipo anónimo son iguales si los valores de sus propiedades de clave son iguales.</span><span class="sxs-lookup"><span data-stu-id="08eb6-142">Two instances of the same anonymous type are equal if the values of their key properties are equal.</span></span> <span data-ttu-id="08eb6-143">En los siguientes ejemplos se muestra cómo se prueba la igualdad.</span><span class="sxs-lookup"><span data-stu-id="08eb6-143">The following examples illustrate how equality is tested.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#7)]  
  
### <a name="read-only-values"></a><span data-ttu-id="08eb6-144">Read-Only valores</span><span class="sxs-lookup"><span data-stu-id="08eb6-144">Read-Only Values</span></span>  

 <span data-ttu-id="08eb6-145">No se pueden cambiar los valores de las propiedades de clave.</span><span class="sxs-lookup"><span data-stu-id="08eb6-145">The values of key properties cannot be changed.</span></span> <span data-ttu-id="08eb6-146">Por ejemplo, en `prod8` el ejemplo anterior, los `Name` campos y `Price` son `read-only` , pero se `OnHand` pueden cambiar.</span><span class="sxs-lookup"><span data-stu-id="08eb6-146">For example, in `prod8` in the previous example, the `Name` and `Price` fields are `read-only`, but `OnHand` can be changed.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#8)]  
  
## <a name="anonymous-types-from-query-expressions"></a><span data-ttu-id="08eb6-147">Tipos anónimos de expresiones de consulta</span><span class="sxs-lookup"><span data-stu-id="08eb6-147">Anonymous Types from Query Expressions</span></span>  

 <span data-ttu-id="08eb6-148">Las expresiones de consulta no siempre requieren la creación de tipos anónimos.</span><span class="sxs-lookup"><span data-stu-id="08eb6-148">Query expressions do not always require the creation of anonymous types.</span></span> <span data-ttu-id="08eb6-149">Siempre que sea posible, usan un tipo existente para contener los datos de la columna.</span><span class="sxs-lookup"><span data-stu-id="08eb6-149">When possible, they use an existing type to hold the column data.</span></span> <span data-ttu-id="08eb6-150">Esto sucede cuando la consulta devuelve registros completos del origen de datos o solo un campo de cada registro.</span><span class="sxs-lookup"><span data-stu-id="08eb6-150">This occurs when the query returns either whole records from the data source, or only one field from each record.</span></span> <span data-ttu-id="08eb6-151">En los siguientes ejemplos de código, `customers` es una colección de objetos de una `Customer` clase.</span><span class="sxs-lookup"><span data-stu-id="08eb6-151">In the following code examples, `customers` is a collection of objects of a `Customer` class.</span></span> <span data-ttu-id="08eb6-152">La clase tiene muchas propiedades, y puede incluir una o más en el resultado de la consulta, en cualquier orden.</span><span class="sxs-lookup"><span data-stu-id="08eb6-152">The class has many properties, and you can include one or more of them in the query result, in any order.</span></span> <span data-ttu-id="08eb6-153">En los dos primeros ejemplos, no se requieren tipos anónimos porque las consultas seleccionan elementos de tipos con nombre:</span><span class="sxs-lookup"><span data-stu-id="08eb6-153">In the first two examples, no anonymous types are required because the queries select elements of named types:</span></span>  
  
- <span data-ttu-id="08eb6-154">`custs1` contiene una colección de cadenas, porque `cust.Name` es una cadena.</span><span class="sxs-lookup"><span data-stu-id="08eb6-154">`custs1` contains a collection of strings, because `cust.Name` is a string.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#30](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#30)]  
  
- <span data-ttu-id="08eb6-155">`custs2` contiene una colección de `Customer` objetos, porque cada elemento de `customers` es un `Customer` objeto y la consulta selecciona todo el elemento.</span><span class="sxs-lookup"><span data-stu-id="08eb6-155">`custs2` contains a collection of `Customer` objects, because each element of `customers` is a `Customer` object, and the whole element is selected by the query.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#31](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#31)]  
  
 <span data-ttu-id="08eb6-156">Sin embargo, los tipos con nombre adecuados no siempre están disponibles.</span><span class="sxs-lookup"><span data-stu-id="08eb6-156">However, appropriate named types are not always available.</span></span> <span data-ttu-id="08eb6-157">Es posible que desee seleccionar nombres y direcciones de clientes para un propósito, números de ID. de cliente y ubicaciones para otro, y nombres de cliente, direcciones y historiales de pedidos para un tercer.</span><span class="sxs-lookup"><span data-stu-id="08eb6-157">You might want to select customer names and addresses for one purpose, customer ID numbers and locations for another, and customer names, addresses, and order histories for a third.</span></span> <span data-ttu-id="08eb6-158">Los tipos anónimos le permiten seleccionar cualquier combinación de propiedades, en cualquier orden, sin declarar primero un nuevo tipo con nombre para contener el resultado.</span><span class="sxs-lookup"><span data-stu-id="08eb6-158">Anonymous types enable you to select any combination of properties, in any order, without first declaring a new named type to hold the result.</span></span> <span data-ttu-id="08eb6-159">En su lugar, el compilador crea un tipo anónimo para cada compilación de propiedades.</span><span class="sxs-lookup"><span data-stu-id="08eb6-159">Instead, the compiler creates an anonymous type for each compilation of properties.</span></span> <span data-ttu-id="08eb6-160">La siguiente consulta selecciona solo el nombre del cliente y el número de identificador de cada `Customer` objeto de `customers` .</span><span class="sxs-lookup"><span data-stu-id="08eb6-160">The following query selects only the customer's name and ID number from each `Customer` object in `customers`.</span></span> <span data-ttu-id="08eb6-161">Por consiguiente, el compilador crea un tipo anónimo que solo contiene esas dos propiedades.</span><span class="sxs-lookup"><span data-stu-id="08eb6-161">Therefore, the compiler creates an anonymous type that contains only those two properties.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTYpes#32](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#32)]  
  
 <span data-ttu-id="08eb6-162">Tanto los nombres como los tipos de datos de las propiedades del tipo anónimo se toman de los argumentos de `Select` , `cust.Name` y `cust.ID` .</span><span class="sxs-lookup"><span data-stu-id="08eb6-162">Both the names and the data types of the properties in the anonymous type are taken from the arguments to `Select`, `cust.Name` and `cust.ID`.</span></span> <span data-ttu-id="08eb6-163">Las propiedades de un tipo anónimo creado por una consulta son siempre propiedades clave.</span><span class="sxs-lookup"><span data-stu-id="08eb6-163">The properties in an anonymous type that is created by a query are always key properties.</span></span> <span data-ttu-id="08eb6-164">Cuando `custs3` se ejecuta en el `For Each` bucle siguiente, el resultado es una colección de instancias de un tipo anónimo con dos propiedades de clave, `Name` y `ID` .</span><span class="sxs-lookup"><span data-stu-id="08eb6-164">When `custs3` is executed in the following `For Each` loop, the result is a collection of instances of an anonymous type with two key properties, `Name` and `ID`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#33](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#33)]  
  
 <span data-ttu-id="08eb6-165">Los elementos de la colección representados por `custs3` están fuertemente tipados y puede usar IntelliSense para navegar por las propiedades disponibles y comprobar sus tipos.</span><span class="sxs-lookup"><span data-stu-id="08eb6-165">The elements in the collection represented by `custs3` are strongly typed, and you can use IntelliSense to navigate through the available properties and to verify their types.</span></span>  
  
 <span data-ttu-id="08eb6-166">Para más información, vea [Introducción a LINQ en Visual Basic](../linq/introduction-to-linq.md).</span><span class="sxs-lookup"><span data-stu-id="08eb6-166">For more information, see [Introduction to LINQ in Visual Basic](../linq/introduction-to-linq.md).</span></span>  
  
## <a name="deciding-whether-to-use-anonymous-types"></a><span data-ttu-id="08eb6-167">Decidir si usar tipos anónimos</span><span class="sxs-lookup"><span data-stu-id="08eb6-167">Deciding Whether to Use Anonymous Types</span></span>  

 <span data-ttu-id="08eb6-168">Antes de crear un objeto como una instancia de una clase anónima, tenga en cuenta si es la mejor opción.</span><span class="sxs-lookup"><span data-stu-id="08eb6-168">Before you create an object as an instance of an anonymous class, consider whether that is the best option.</span></span> <span data-ttu-id="08eb6-169">Por ejemplo, si desea crear un objeto temporal que contenga datos relacionados y no necesita otros campos y métodos que pueda contener una clase completa, un tipo anónimo es una buena solución.</span><span class="sxs-lookup"><span data-stu-id="08eb6-169">For example, if you want to create a temporary object to contain related data, and you have no need for other fields and methods that a complete class might contain, an anonymous type is a good solution.</span></span> <span data-ttu-id="08eb6-170">Los tipos anónimos también son útiles si desea una selección diferente de las propiedades de cada declaración, o si desea cambiar el orden de las propiedades.</span><span class="sxs-lookup"><span data-stu-id="08eb6-170">Anonymous types are also convenient if you want a different selection of properties for each declaration, or if you want to change the order of the properties.</span></span> <span data-ttu-id="08eb6-171">Sin embargo, si el proyecto incluye varios objetos que tienen las mismas propiedades, en un orden fijo, puede declararlos más fácilmente utilizando un tipo con nombre con un constructor de clase.</span><span class="sxs-lookup"><span data-stu-id="08eb6-171">However, if your project includes several objects that have the same properties, in a fixed order, you can declare them more easily by using a named type with a class constructor.</span></span> <span data-ttu-id="08eb6-172">Por ejemplo, con un constructor adecuado, es más fácil declarar varias instancias de una `Product` clase que declarar varias instancias de un tipo anónimo.</span><span class="sxs-lookup"><span data-stu-id="08eb6-172">For example, with an appropriate constructor, it is easier to declare several instances of a `Product` class than it is to declare several instances of an anonymous type.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#9)]  
  
 <span data-ttu-id="08eb6-173">Otra ventaja de los tipos con nombre es que el compilador puede detectar un error de escritura accidental de un nombre de propiedad.</span><span class="sxs-lookup"><span data-stu-id="08eb6-173">Another advantage of named types is that the compiler can catch an accidental mistyping of a property name.</span></span> <span data-ttu-id="08eb6-174">En los ejemplos anteriores, `firstProd2` , `secondProd2` y `thirdProd2` están diseñados para ser instancias del mismo tipo anónimo.</span><span class="sxs-lookup"><span data-stu-id="08eb6-174">In the previous examples, `firstProd2`, `secondProd2`, and `thirdProd2` are intended to be instances of the same anonymous type.</span></span> <span data-ttu-id="08eb6-175">Sin embargo, si fuera a declarar accidentalmente `thirdProd2` en una de las siguientes maneras, su tipo sería diferente del de `firstProd2` y `secondProd2` .</span><span class="sxs-lookup"><span data-stu-id="08eb6-175">However, if you were to accidentally declare `thirdProd2` in one of the following ways, its type would be different from that of `firstProd2` and `secondProd2`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#10)]  
  
 <span data-ttu-id="08eb6-176">Lo que es más importante, existen limitaciones en el uso de tipos anónimos que no se aplican a las instancias de tipos con nombre.</span><span class="sxs-lookup"><span data-stu-id="08eb6-176">More importantly, there are limitations on the use of anonymous types that do not apply to instances of named types.</span></span> <span data-ttu-id="08eb6-177">`firstProd2`, `secondProd2` y `thirdProd2` son instancias del mismo tipo anónimo.</span><span class="sxs-lookup"><span data-stu-id="08eb6-177">`firstProd2`, `secondProd2`, and `thirdProd2` are instances of the same anonymous type.</span></span> <span data-ttu-id="08eb6-178">Sin embargo, el nombre del tipo anónimo compartido no está disponible y no puede aparecer donde se espera un nombre de tipo en el código.</span><span class="sxs-lookup"><span data-stu-id="08eb6-178">However, the name for the shared anonymous type is not available and cannot appear where a type name is expected in your code.</span></span> <span data-ttu-id="08eb6-179">Por ejemplo, un tipo anónimo no se puede usar para definir una firma de método, para declarar otra variable o campo, o en cualquier declaración de tipo.</span><span class="sxs-lookup"><span data-stu-id="08eb6-179">For example, an anonymous type cannot be used to define a method signature, to declare another variable or field, or in any type declaration.</span></span> <span data-ttu-id="08eb6-180">Como resultado, los tipos anónimos no son adecuados cuando es necesario compartir información entre métodos.</span><span class="sxs-lookup"><span data-stu-id="08eb6-180">As a result, anonymous types are not appropriate when you have to share information across methods.</span></span>  
  
## <a name="an-anonymous-type-definition"></a><span data-ttu-id="08eb6-181">Una definición de tipo anónimo</span><span class="sxs-lookup"><span data-stu-id="08eb6-181">An Anonymous Type Definition</span></span>  

 <span data-ttu-id="08eb6-182">En respuesta a la declaración de una instancia de un tipo anónimo, el compilador crea una nueva definición de clase que contiene las propiedades especificadas.</span><span class="sxs-lookup"><span data-stu-id="08eb6-182">In response to the declaration of an instance of an anonymous type, the compiler creates a new class definition that contains the specified properties.</span></span>  
  
 <span data-ttu-id="08eb6-183">Si el tipo anónimo contiene al menos una propiedad de clave, la definición invalida tres miembros heredados de <xref:System.Object> : <xref:System.Object.Equals%2A> , <xref:System.Object.GetHashCode%2A> y <xref:System.Object.ToString%2A> .</span><span class="sxs-lookup"><span data-stu-id="08eb6-183">If the anonymous type contains at least one key property, the definition overrides three members inherited from <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>.</span></span> <span data-ttu-id="08eb6-184">El código generado para probar la igualdad y determinar el valor del código hash solo tiene en cuenta las propiedades clave.</span><span class="sxs-lookup"><span data-stu-id="08eb6-184">The code produced for testing equality and determining the hash code value considers only the key properties.</span></span> <span data-ttu-id="08eb6-185">Si el tipo anónimo no contiene propiedades de clave, solo <xref:System.Object.ToString%2A> se invalida.</span><span class="sxs-lookup"><span data-stu-id="08eb6-185">If the anonymous type contains no key properties, only <xref:System.Object.ToString%2A> is overridden.</span></span> <span data-ttu-id="08eb6-186">Las propiedades con nombre explícito de un tipo anónimo no pueden entrar en conflicto con estos métodos generados.</span><span class="sxs-lookup"><span data-stu-id="08eb6-186">Explicitly named properties of an anonymous type cannot conflict with these generated methods.</span></span> <span data-ttu-id="08eb6-187">Es decir, no puede utilizar `.Equals` , `.GetHashCode` o `.ToString` para asignar un nombre a una propiedad.</span><span class="sxs-lookup"><span data-stu-id="08eb6-187">That is, you cannot use `.Equals`, `.GetHashCode`, or `.ToString` to name a property.</span></span>  
  
 <span data-ttu-id="08eb6-188">Las definiciones de tipos anónimos que tienen al menos una propiedad de clave también implementan la <xref:System.IEquatable%601?displayProperty=nameWithType> interfaz, donde `T` es el tipo del tipo anónimo.</span><span class="sxs-lookup"><span data-stu-id="08eb6-188">Anonymous type definitions that have at least one key property also implement the <xref:System.IEquatable%601?displayProperty=nameWithType> interface, where `T` is the type of the anonymous type.</span></span>  
  
 <span data-ttu-id="08eb6-189">Para obtener más información sobre el código creado por el compilador y la funcionalidad de los métodos invalidados, vea [definición de tipo anónimo](anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="08eb6-189">For more information about the code created by the compiler and the functionality of the overridden methods, see [Anonymous Type Definition](anonymous-type-definition.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="08eb6-190">Consulte también</span><span class="sxs-lookup"><span data-stu-id="08eb6-190">See also</span></span>

- [<span data-ttu-id="08eb6-191">Inicializadores de objeto: tipos con nombre y anónimos</span><span class="sxs-lookup"><span data-stu-id="08eb6-191">Object Initializers: Named and Anonymous Types</span></span>](object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="08eb6-192">Inferencia de tipo de variable local</span><span class="sxs-lookup"><span data-stu-id="08eb6-192">Local Type Inference</span></span>](../variables/local-type-inference.md)
- [<span data-ttu-id="08eb6-193">Introducción a LINQ en Visual Basic</span><span class="sxs-lookup"><span data-stu-id="08eb6-193">Introduction to LINQ in Visual Basic</span></span>](../linq/introduction-to-linq.md)
- [<span data-ttu-id="08eb6-194">Procedimiento para deducir tipos y nombres de propiedades en declaraciones de tipos anónimos</span><span class="sxs-lookup"><span data-stu-id="08eb6-194">How to: Infer Property Names and Types in Anonymous Type Declarations</span></span>](how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)
- [<span data-ttu-id="08eb6-195">Definición de tipo anónimo</span><span class="sxs-lookup"><span data-stu-id="08eb6-195">Anonymous Type Definition</span></span>](anonymous-type-definition.md)
- [<span data-ttu-id="08eb6-196">Key</span><span class="sxs-lookup"><span data-stu-id="08eb6-196">Key</span></span>](../../../language-reference/modifiers/key.md)
