---
description: 'Más información sobre: estructuras y clases (Visual Basic)'
title: Estructuras y clases
ms.date: 07/20/2015
helpviewer_keywords:
- classes [Visual Basic], vs. structures
- structures [Visual Basic]
- classes [Visual Basic]
- structures [Visual Basic], compared to classes
- structures [Visual Basic], structure variables
- structure variables [Visual Basic]
ms.assetid: a221e74a-ffcf-4bdc-a0f6-a088a9bf26cc
ms.openlocfilehash: 129948bd9a16309ffea5b1e4c690d8883c450b74
ms.sourcegitcommit: 10e719780594efc781b15295e499c66f316068b8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 02/14/2021
ms.locfileid: "100430630"
---
# <a name="structures-and-classes-visual-basic"></a><span data-ttu-id="c4717-103">Estructuras y clases (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="c4717-103">Structures and Classes (Visual Basic)</span></span>

<span data-ttu-id="c4717-104">Visual Basic unifica la sintaxis de las estructuras y las clases, con el resultado de que ambas entidades admiten la mayoría de las mismas características.</span><span class="sxs-lookup"><span data-stu-id="c4717-104">Visual Basic unifies the syntax for structures and classes, with the result that both entities support most of the same features.</span></span> <span data-ttu-id="c4717-105">Sin embargo, también hay diferencias importantes entre estructuras y clases.</span><span class="sxs-lookup"><span data-stu-id="c4717-105">However, there are also important differences between structures and classes.</span></span>  
  
 <span data-ttu-id="c4717-106">Las clases tienen la ventaja de ser tipos de referencia: pasar una referencia es más eficaz que pasar una variable de estructura con todos sus datos.</span><span class="sxs-lookup"><span data-stu-id="c4717-106">Classes have the advantage of being reference types — passing a reference is more efficient than passing a structure variable with all its data.</span></span> <span data-ttu-id="c4717-107">Por otro lado, las estructuras no requieren la asignación de memoria en el montón global.</span><span class="sxs-lookup"><span data-stu-id="c4717-107">On the other hand, structures do not require allocation of memory on the global heap.</span></span>  
  
 <span data-ttu-id="c4717-108">Dado que no se puede heredar de una estructura, las estructuras deben usarse solo para los objetos que no es necesario extender.</span><span class="sxs-lookup"><span data-stu-id="c4717-108">Because you cannot inherit from a structure, structures should be used only for objects that do not need to be extended.</span></span> <span data-ttu-id="c4717-109">Use estructuras cuando el objeto que desea crear tenga un tamaño de instancia pequeño y tenga en cuenta las características de rendimiento de clases frente a estructuras.</span><span class="sxs-lookup"><span data-stu-id="c4717-109">Use structures when the object you wish to create has a small instance size, and take into account the performance characteristics of classes versus structures.</span></span>  
  
## <a name="similarities"></a><span data-ttu-id="c4717-110">Similitudes</span><span class="sxs-lookup"><span data-stu-id="c4717-110">Similarities</span></span>  

 <span data-ttu-id="c4717-111">Las estructuras y clases son similares en los siguientes aspectos:</span><span class="sxs-lookup"><span data-stu-id="c4717-111">Structures and classes are similar in the following respects:</span></span>  
  
- <span data-ttu-id="c4717-112">Ambos son tipos de *contenedor* , lo que significa que contienen otros tipos como miembros.</span><span class="sxs-lookup"><span data-stu-id="c4717-112">Both are *container* types, meaning that they contain other types as members.</span></span>  
  
- <span data-ttu-id="c4717-113">Ambos tienen miembros, que pueden incluir constructores, métodos, propiedades, campos, constantes, enumeraciones, eventos y controladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="c4717-113">Both have members, which can include constructors, methods, properties, fields, constants, enumerations, events, and event handlers.</span></span> <span data-ttu-id="c4717-114">Sin embargo, no confunda estos miembros con los *elementos* declarados de una estructura.</span><span class="sxs-lookup"><span data-stu-id="c4717-114">However, do not confuse these members with the declared *elements* of a structure.</span></span>  
  
- <span data-ttu-id="c4717-115">Los miembros de ambos pueden tener niveles de acceso individualizados.</span><span class="sxs-lookup"><span data-stu-id="c4717-115">Members of both can have individualized access levels.</span></span> <span data-ttu-id="c4717-116">Por ejemplo, se puede declarar un miembro `Public` y otro `Private` .</span><span class="sxs-lookup"><span data-stu-id="c4717-116">For example, one member can be declared `Public` and another `Private`.</span></span>  
  
- <span data-ttu-id="c4717-117">Ambos pueden implementar interfaces.</span><span class="sxs-lookup"><span data-stu-id="c4717-117">Both can implement interfaces.</span></span>  
  
- <span data-ttu-id="c4717-118">Ambos pueden tener constructores compartidos, con o sin parámetros.</span><span class="sxs-lookup"><span data-stu-id="c4717-118">Both can have shared constructors, with or without parameters.</span></span>  
  
- <span data-ttu-id="c4717-119">Ambos pueden exponer una *propiedad predeterminada*, siempre que la propiedad tome al menos un parámetro.</span><span class="sxs-lookup"><span data-stu-id="c4717-119">Both can expose a *default property*, provided that property takes at least one parameter.</span></span>  
  
- <span data-ttu-id="c4717-120">Ambos pueden declarar y generar eventos y ambos pueden declarar delegados.</span><span class="sxs-lookup"><span data-stu-id="c4717-120">Both can declare and raise events, and both can declare delegates.</span></span>  
  
## <a name="differences"></a><span data-ttu-id="c4717-121">Diferencias</span><span class="sxs-lookup"><span data-stu-id="c4717-121">Differences</span></span>  

 <span data-ttu-id="c4717-122">Las estructuras y las clases difieren en los siguientes detalles:</span><span class="sxs-lookup"><span data-stu-id="c4717-122">Structures and classes differ in the following particulars:</span></span>  
  
- <span data-ttu-id="c4717-123">Las estructuras son *tipos de valor*; las clases son *tipos de referencia*.</span><span class="sxs-lookup"><span data-stu-id="c4717-123">Structures are *value types*; classes are *reference types*.</span></span> <span data-ttu-id="c4717-124">Una variable de un tipo de estructura contiene los datos de la estructura, en lugar de contener una referencia a los datos como un tipo de clase.</span><span class="sxs-lookup"><span data-stu-id="c4717-124">A variable of a structure type contains the structure's data, rather than containing a reference to the data as a class type does.</span></span>  
  
- <span data-ttu-id="c4717-125">Las estructuras usan la asignación de la pila; las clases usan la asignación del montón.</span><span class="sxs-lookup"><span data-stu-id="c4717-125">Structures use stack allocation; classes use heap allocation.</span></span>  
  
- <span data-ttu-id="c4717-126">De forma predeterminada, todos los elementos de estructura son `Public` variables y constantes de clase `Private` , mientras que otros miembros de clase son `Public` de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="c4717-126">All structure elements are `Public` by default; class variables and constants are `Private` by default, while other class members are `Public` by default.</span></span> <span data-ttu-id="c4717-127">Este comportamiento para los miembros de clase proporciona compatibilidad con el sistema Visual Basic de los valores predeterminados 6,0.</span><span class="sxs-lookup"><span data-stu-id="c4717-127">This behavior for class members provides compatibility with the Visual Basic 6.0 system of defaults.</span></span>  
  
- <span data-ttu-id="c4717-128">Una estructura debe tener al menos una variable no compartida o un elemento de evento no compartido no personalizado; una clase puede estar completamente vacía.</span><span class="sxs-lookup"><span data-stu-id="c4717-128">A structure must have at least one nonshared variable or nonshared, noncustom event element; a class can be completely empty.</span></span>  
  
- <span data-ttu-id="c4717-129">Los elementos de estructura no se pueden declarar como `Protected` ; los miembros de clase pueden.</span><span class="sxs-lookup"><span data-stu-id="c4717-129">Structure elements cannot be declared as `Protected`; class members can.</span></span>  
  
- <span data-ttu-id="c4717-130">Un procedimiento de estructura solo puede controlar eventos si se trata de un procedimiento [compartido](../../../language-reference/modifiers/shared.md) `Sub` y solo por medio de la [instrucción AddHandler](../../../language-reference/statements/addhandler-statement.md); cualquier procedimiento de clase puede controlar eventos mediante la palabra clave [Handles](../../../language-reference/statements/handles-clause.md) o la `AddHandler` instrucción.</span><span class="sxs-lookup"><span data-stu-id="c4717-130">A structure procedure can handle events only if it is a [Shared](../../../language-reference/modifiers/shared.md)`Sub` procedure, and only by means of the [AddHandler Statement](../../../language-reference/statements/addhandler-statement.md); any class procedure can handle events, using either the [Handles](../../../language-reference/statements/handles-clause.md) keyword or the `AddHandler` statement.</span></span> <span data-ttu-id="c4717-131">Para más información, vea [Eventos](../events/index.md).</span><span class="sxs-lookup"><span data-stu-id="c4717-131">For more information, see [Events](../events/index.md).</span></span>  
  
- <span data-ttu-id="c4717-132">Las declaraciones de variables de estructura no pueden especificar inicializadores ni tamaños iniciales para matrices; las declaraciones de variables de clase pueden.</span><span class="sxs-lookup"><span data-stu-id="c4717-132">Structure variable declarations cannot specify initializers or initial sizes for arrays; class variable declarations can.</span></span>  
  
- <span data-ttu-id="c4717-133">Las estructuras heredan implícitamente de la <xref:System.ValueType?displayProperty=nameWithType> clase y no pueden heredar de ningún otro tipo; las clases pueden heredar de cualquier clase o clases que no sean <xref:System.ValueType?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="c4717-133">Structures implicitly inherit from the <xref:System.ValueType?displayProperty=nameWithType> class and cannot inherit from any other type; classes can inherit from any class or classes other than <xref:System.ValueType?displayProperty=nameWithType>.</span></span>  
  
- <span data-ttu-id="c4717-134">Las estructuras no se pueden heredar; las clases son.</span><span class="sxs-lookup"><span data-stu-id="c4717-134">Structures are not inheritable; classes are.</span></span>  
  
- <span data-ttu-id="c4717-135">Las estructuras nunca finalizan, por lo que el Common Language Runtime (CLR) nunca llama al <xref:System.Object.Finalize%2A> método en ninguna estructura; las clases las termina el recolector de elementos no utilizados (GC), que llama a <xref:System.Object.Finalize%2A> en una clase cuando detecta que no quedan referencias activas.</span><span class="sxs-lookup"><span data-stu-id="c4717-135">Structures are never terminated, so the common language runtime (CLR) never calls the <xref:System.Object.Finalize%2A> method on any structure; classes are terminated by the garbage collector (GC), which calls <xref:System.Object.Finalize%2A> on a class when it detects there are no active references remaining.</span></span>  
  
- <span data-ttu-id="c4717-136">Una estructura no requiere un constructor; una clase.</span><span class="sxs-lookup"><span data-stu-id="c4717-136">A structure does not require a constructor; a class does.</span></span>  
  
- <span data-ttu-id="c4717-137">Las estructuras pueden tener constructores no compartidos solo si toman parámetros; las clases pueden tenerlos con o sin parámetros.</span><span class="sxs-lookup"><span data-stu-id="c4717-137">Structures can have nonshared constructors only if they take parameters; classes can have them with or without parameters.</span></span>  
  
 <span data-ttu-id="c4717-138">Cada estructura tiene un constructor público implícito sin parámetros.</span><span class="sxs-lookup"><span data-stu-id="c4717-138">Every structure has an implicit public constructor without parameters.</span></span> <span data-ttu-id="c4717-139">Este constructor inicializa todos los elementos de datos de la estructura en sus valores predeterminados.</span><span class="sxs-lookup"><span data-stu-id="c4717-139">This constructor initializes all the structure's data elements to their default values.</span></span> <span data-ttu-id="c4717-140">Este comportamiento no se puede volver a definir.</span><span class="sxs-lookup"><span data-stu-id="c4717-140">You cannot redefine this behavior.</span></span>  
  
## <a name="instances-and-variables"></a><span data-ttu-id="c4717-141">Instancias y variables</span><span class="sxs-lookup"><span data-stu-id="c4717-141">Instances and Variables</span></span>  

 <span data-ttu-id="c4717-142">Dado que las estructuras son tipos de valor, cada variable de estructura se enlaza de forma permanente a una instancia de la estructura individual.</span><span class="sxs-lookup"><span data-stu-id="c4717-142">Because structures are value types, each structure variable is permanently bound to an individual structure instance.</span></span> <span data-ttu-id="c4717-143">Pero las clases son tipos de referencia y una variable de objeto puede hacer referencia a varias instancias de clase en momentos diferentes.</span><span class="sxs-lookup"><span data-stu-id="c4717-143">But classes are reference types, and an object variable can refer to various class instances at different times.</span></span> <span data-ttu-id="c4717-144">Esta distinción afecta al uso de estructuras y clases de las siguientes maneras:</span><span class="sxs-lookup"><span data-stu-id="c4717-144">This distinction affects your usage of structures and classes in the following ways:</span></span>  
  
- <span data-ttu-id="c4717-145">**Inicial.**</span><span class="sxs-lookup"><span data-stu-id="c4717-145">**Initialization.**</span></span> <span data-ttu-id="c4717-146">Una variable de estructura incluye implícitamente una inicialización de los elementos mediante el constructor sin parámetros de la estructura.</span><span class="sxs-lookup"><span data-stu-id="c4717-146">A structure variable implicitly includes an initialization of the elements using the structure's parameterless constructor.</span></span> <span data-ttu-id="c4717-147">Por lo tanto, `Dim s As struct1` es equivalente a `Dim s As struct1 = New struct1()` .</span><span class="sxs-lookup"><span data-stu-id="c4717-147">Therefore, `Dim s As struct1` is equivalent to `Dim s As struct1 = New struct1()`.</span></span>  
  
- <span data-ttu-id="c4717-148">**Asignación de variables.**</span><span class="sxs-lookup"><span data-stu-id="c4717-148">**Assigning Variables.**</span></span> <span data-ttu-id="c4717-149">Cuando se asigna una variable de estructura a otra, o se pasa una instancia de la estructura a un argumento de procedimiento, los valores actuales de todos los elementos variables se copian en la nueva estructura.</span><span class="sxs-lookup"><span data-stu-id="c4717-149">When you assign one structure variable to another, or pass a structure instance to a procedure argument, the current values of all the variable elements are copied to the new structure.</span></span> <span data-ttu-id="c4717-150">Al asignar una variable de objeto a otra, o pasar una variable de objeto a un procedimiento, solo se copia el puntero de referencia.</span><span class="sxs-lookup"><span data-stu-id="c4717-150">When you assign one object variable to another, or pass an object variable to a procedure, only the reference pointer is copied.</span></span>  
  
- <span data-ttu-id="c4717-151">**No asignar nada.**</span><span class="sxs-lookup"><span data-stu-id="c4717-151">**Assigning Nothing.**</span></span> <span data-ttu-id="c4717-152">Puede asignar el valor [Nothing](../../../language-reference/nothing.md) a una variable de estructura, pero la instancia continúa asociada a la variable.</span><span class="sxs-lookup"><span data-stu-id="c4717-152">You can assign the value [Nothing](../../../language-reference/nothing.md) to a structure variable, but the instance continues to be associated with the variable.</span></span> <span data-ttu-id="c4717-153">Todavía puede llamar a sus métodos y obtener acceso a sus elementos de datos, aunque la asignación reinicializa los elementos de variable.</span><span class="sxs-lookup"><span data-stu-id="c4717-153">You can still call its methods and access its data elements, although variable elements are reinitialized by the assignment.</span></span>  
  
     <span data-ttu-id="c4717-154">Por el contrario, si se establece una variable de objeto en `Nothing` , se desasocia de cualquier instancia de clase y no se puede tener acceso a los miembros a través de la variable hasta que se le asigne otra instancia.</span><span class="sxs-lookup"><span data-stu-id="c4717-154">In contrast, if you set an object variable to `Nothing`, you dissociate it from any class instance, and you cannot access any members through the variable until you assign another instance to it.</span></span>  
  
- <span data-ttu-id="c4717-155">**Varias instancias.**</span><span class="sxs-lookup"><span data-stu-id="c4717-155">**Multiple Instances.**</span></span> <span data-ttu-id="c4717-156">Una variable de objeto puede tener asignadas instancias de clase diferentes en momentos diferentes, y varias variables de objeto pueden hacer referencia a la misma instancia de clase al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="c4717-156">An object variable can have different class instances assigned to it at different times, and several object variables can refer to the same class instance at the same time.</span></span> <span data-ttu-id="c4717-157">Los cambios que realice en los valores de los miembros de clase afectan a esos miembros cuando se obtiene acceso a ellos a través de otra variable que apunta a la misma instancia.</span><span class="sxs-lookup"><span data-stu-id="c4717-157">Changes you make to the values of class members affect those members when accessed through another variable pointing to the same instance.</span></span>  
  
     <span data-ttu-id="c4717-158">Los elementos de la estructura, sin embargo, están aislados dentro de su propia instancia.</span><span class="sxs-lookup"><span data-stu-id="c4717-158">Structure elements, however, are isolated within their own instance.</span></span> <span data-ttu-id="c4717-159">Los cambios en sus valores no se reflejan en otras variables de estructura, incluso en otras instancias de la misma `Structure` declaración.</span><span class="sxs-lookup"><span data-stu-id="c4717-159">Changes to their values are not reflected in any other structure variables, even in other instances of the same `Structure` declaration.</span></span>  
  
- <span data-ttu-id="c4717-160">**Determinar.**</span><span class="sxs-lookup"><span data-stu-id="c4717-160">**Equality.**</span></span> <span data-ttu-id="c4717-161">Las pruebas de igualdad de dos estructuras deben realizarse con una prueba elemento a elemento.</span><span class="sxs-lookup"><span data-stu-id="c4717-161">Equality testing of two structures must be performed with an element-by-element test.</span></span> <span data-ttu-id="c4717-162">Se pueden comparar dos variables de objeto mediante el <xref:System.Object.Equals%2A> método.</span><span class="sxs-lookup"><span data-stu-id="c4717-162">Two object variables can be compared using the <xref:System.Object.Equals%2A> method.</span></span> <span data-ttu-id="c4717-163"><xref:System.Object.Equals%2A> indica si las dos variables apuntan a la misma instancia.</span><span class="sxs-lookup"><span data-stu-id="c4717-163"><xref:System.Object.Equals%2A> indicates whether the two variables point to the same instance.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c4717-164">Consulte también</span><span class="sxs-lookup"><span data-stu-id="c4717-164">See also</span></span>

- [<span data-ttu-id="c4717-165">Tipo de datos</span><span class="sxs-lookup"><span data-stu-id="c4717-165">Data Types</span></span>](index.md)
- [<span data-ttu-id="c4717-166">Tipos de datos compuestos</span><span class="sxs-lookup"><span data-stu-id="c4717-166">Composite Data Types</span></span>](composite-data-types.md)
- [<span data-ttu-id="c4717-167">Tipos de valor y tipos de referencia</span><span class="sxs-lookup"><span data-stu-id="c4717-167">Value Types and Reference Types</span></span>](value-types-and-reference-types.md)
- [<span data-ttu-id="c4717-168">Estructuras</span><span class="sxs-lookup"><span data-stu-id="c4717-168">Structures</span></span>](structures.md)
- [<span data-ttu-id="c4717-169">Solución de problemas de los tipos de datos</span><span class="sxs-lookup"><span data-stu-id="c4717-169">Troubleshooting Data Types</span></span>](troubleshooting-data-types.md)
- [<span data-ttu-id="c4717-170">Estructuras y otros elementos de programación</span><span class="sxs-lookup"><span data-stu-id="c4717-170">Structures and Other Programming Elements</span></span>](structures-and-other-programming-elements.md)
- [<span data-ttu-id="c4717-171">Objetos y clases</span><span class="sxs-lookup"><span data-stu-id="c4717-171">Objects and Classes</span></span>](../objects-and-classes/index.md)
